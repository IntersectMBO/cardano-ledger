<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-comment">-- | Defines what types can be used in the SetAlgebra, and</span><span>
</span><span id="line-9"></span><span class="hs-comment">--   what operations those types must support (Iter, Basic, Embed)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Iterate.BaseTypes</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html"><span class="hs-identifier">Control.Iterate.Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier">hasElem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#isempty"><span class="hs-identifier">isempty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#none"><span class="hs-identifier">none</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier">one</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#when"><span class="hs-identifier">when</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sortBy</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.MapExtras.html"><span class="hs-identifier">Data.MapExtras</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.MapExtras.html#StrictTriple"><span class="hs-identifier">StrictTriple</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.MapExtras.html#splitMemberSet"><span class="hs-identifier">splitMemberSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-comment">--  $ClassesForSetAlgebra</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- ================= The Iter class =================================================</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-comment">-- | The Set algebra include types that encode finite sets and maps of some type. They</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- have a finite domain, and for each domain element they pair a single range</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- element (unit for sets). We are interested in those finite maps that can iterate their</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- pairs in ascending domain order. The operations are: `nxt` and `lub` .</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- lub can skip over many items in sub-linear time, it can make things really fast.</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- Many finite maps can support a support lub operation in sub-linear time. Some examples:</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- Balanced binary trees, Arrays (using binary search), Tries, etc. There are basic and compound</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- Iter instances. Compound types include components with types that have Iter instances.</span><span>
</span><span id="line-32"></span><span class="hs-keyword">class</span><span> </span><span id="Iter"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-var">Iter</span></a></span></span><span> </span><span id="local-6989586621679119638"><span class="annot"><a href="#local-6989586621679119638"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>  </span><span id="nxt"><span class="annot"><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-type">nxt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679119646"><span id="local-6989586621679119647"><span class="annot"><a href="#local-6989586621679119638"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119646"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119647"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119646"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679119647"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679119638"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119646"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119647"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-34"></span><span>  </span><span id="lub"><span class="annot"><a href="Control.Iterate.BaseTypes.html#lub"><span class="hs-identifier hs-type">lub</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679119652"><span id="local-6989586621679119653"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679119652"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119652"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119638"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119652"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119653"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119652"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679119653"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679119638"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119652"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119653"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-comment">-- | The next few methods can all be defined via nxt and lub, but for base types there often exist</span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-comment">-- much more efficent means, so the default definitions should be overwritten for such basic types.</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-comment">-- For compound types with Guards, these are often the only way to define them.</span><span>
</span><span id="line-39"></span><span>  </span><span id="hasNxt"><span class="annot"><a href="Control.Iterate.BaseTypes.html#hasNxt"><span class="hs-identifier hs-type">hasNxt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679119639"><span id="local-6989586621679119640"><span class="annot"><a href="#local-6989586621679119638"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119639"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119640"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119639"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679119640"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679119638"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119639"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119640"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-40"></span><span>  </span><span id="local-6989586621679119920"><span class="annot"><a href="Control.Iterate.BaseTypes.html#hasNxt"><span class="hs-identifier hs-var hs-var">hasNxt</span></a></span><span> </span><span id="local-6989586621679119922"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679119922"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (a, b, f a b) -&gt; Maybe (a, b, f a b)
forall t. Collect t -&gt; Maybe t
</span><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier hs-var">hasElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a b -&gt; Collect (a, b, f a b)
forall a b. f a b -&gt; Collect (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679119922"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>  </span><span id="hasLub"><span class="annot"><a href="Control.Iterate.BaseTypes.html#hasLub"><span class="hs-identifier hs-type">hasLub</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679119648"><span id="local-6989586621679119649"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679119648"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119648"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119638"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119648"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119649"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119648"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679119649"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679119638"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119648"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119649"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-43"></span><span>  </span><span id="local-6989586621679119924"><span class="annot"><a href="Control.Iterate.BaseTypes.html#hasLub"><span class="hs-identifier hs-var hs-var">hasLub</span></a></span><span> </span><span id="local-6989586621679119928"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679119928"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679119929"><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679119929"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (k, b, f k b) -&gt; Maybe (k, b, f k b)
forall t. Collect t -&gt; Maybe t
</span><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier hs-var">hasElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; f k b -&gt; Collect (k, b, f k b)
forall k b. Ord k =&gt; k -&gt; f k b -&gt; Collect (k, b, f k b)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Collect (k, b, f k b)
</span><a href="Control.Iterate.BaseTypes.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679119928"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679119929"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-44"></span><span>  </span><span id="haskey"><span class="annot"><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-type">haskey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679119654"><span id="local-6989586621679119655"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679119654"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119654"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119638"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119654"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119655"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-45"></span><span>  </span><span id="local-6989586621679119931"><span class="annot"><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-var hs-var">haskey</span></a></span><span> </span><span id="local-6989586621679119938"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679119938"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679119939"><span class="annot"><span class="annottext">f key b
</span><a href="#local-6989586621679119939"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">key -&gt; f key b -&gt; Maybe (key, b, f key b)
forall k b. Ord k =&gt; k -&gt; f k b -&gt; Maybe (k, b, f k b)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Maybe (k, b, f k b)
</span><a href="Control.Iterate.BaseTypes.html#hasLub"><span class="hs-identifier hs-var">hasLub</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679119938"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f key b
</span><a href="#local-6989586621679119939"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe (key, b, f key b)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679119940"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679119940"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">f key b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679119938"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679119940"><span class="hs-identifier hs-var">key</span></a></span></span><span>
</span><span id="line-46"></span><span>  </span><span id="isnull"><span class="annot"><a href="Control.Iterate.BaseTypes.html#isnull"><span class="hs-identifier hs-type">isnull</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679119660"><span id="local-6989586621679119661"><span class="annot"><a href="#local-6989586621679119638"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119660"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119661"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-47"></span><span>  </span><span id="local-6989586621679119942"><span class="annot"><a href="Control.Iterate.BaseTypes.html#isnull"><span class="hs-identifier hs-var hs-var">isnull</span></a></span><span> </span><span id="local-6989586621679119944"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679119944"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (k, v, f k v) -&gt; Bool
forall t. Collect t -&gt; Bool
</span><a href="Control.Iterate.Collect.html#isempty"><span class="hs-identifier hs-var">isempty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v, f k v)
forall a b. f a b -&gt; Collect (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679119944"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-48"></span><span>  </span><span id="lookup"><span class="annot"><a href="Control.Iterate.BaseTypes.html#lookup"><span class="hs-identifier hs-type">lookup</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679119665"><span id="local-6989586621679119666"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679119665"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119665"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119638"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119665"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119666"><span class="hs-identifier hs-type">rng</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679119666"><span class="hs-identifier hs-type">rng</span></a></span></span></span><span>
</span><span id="line-49"></span><span>  </span><span id="local-6989586621679119946"><span class="annot"><a href="Control.Iterate.BaseTypes.html#lookup"><span class="hs-identifier hs-var hs-var">lookup</span></a></span><span> </span><span id="local-6989586621679119952"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679119952"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679119953"><span class="annot"><span class="annottext">f key rng
</span><a href="#local-6989586621679119953"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">key -&gt; f key rng -&gt; Maybe (key, rng, f key rng)
forall k b. Ord k =&gt; k -&gt; f k b -&gt; Maybe (k, b, f k b)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Maybe (k, b, f k b)
</span><a href="Control.Iterate.BaseTypes.html#hasLub"><span class="hs-identifier hs-var">hasLub</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679119952"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f key rng
</span><a href="#local-6989586621679119953"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe (key, rng, f key rng)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679119954"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679119954"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679119955"><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679119955"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">f key rng
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679119952"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679119954"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">rng -&gt; Maybe rng
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679119955"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span></span><span>
</span><span id="line-50"></span><span>  </span><span id="element"><span class="annot"><a href="Control.Iterate.BaseTypes.html#element"><span class="hs-identifier hs-type">element</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679119670"><span id="local-6989586621679119671"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679119670"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119670"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119638"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119670"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119671"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-51"></span><span>  </span><span id="local-6989586621679119957"><span class="annot"><a href="Control.Iterate.BaseTypes.html#element"><span class="hs-identifier hs-var hs-var">element</span></a></span><span> </span><span id="local-6989586621679119961"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679119961"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679119962"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679119962"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Collect ()
</span><a href="Control.Iterate.Collect.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; Bool
forall key b. Ord key =&gt; key -&gt; f key b -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679119961"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679119962"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- ==================================================================================================</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | In order to build typed 'Exp' (which are a typed deep embedding) of map and set operations, we need to know</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- what kind of basic types can be used this way. Every Basic type has a few operations</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- for creating one from a list, for adding and removing key-value pairs, looking up a value given a key.</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- Instances of this algebra are functional in that every key has exactly one value associated with it.</span><span>
</span><span id="line-59"></span><span class="hs-keyword">class</span><span> </span><span id="Basic"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-var">Basic</span></a></span></span><span> </span><span id="local-6989586621679119676"><span class="annot"><a href="#local-6989586621679119676"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-comment">-- | in addpair the new value always prevails, to make a choice use 'addkv' which has a combining function that allows choice.</span><span>
</span><span id="line-61"></span><span>  </span><span id="addpair"><span class="annot"><a href="Control.Iterate.BaseTypes.html#addpair"><span class="hs-identifier hs-type">addpair</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679119674"><span id="local-6989586621679119675"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679119674"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119674"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119675"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119676"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119674"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119675"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119676"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119674"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119675"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-62"></span><span>  </span><span id="local-6989586621679119965"><span class="annot"><a href="Control.Iterate.BaseTypes.html#addpair"><span class="hs-identifier hs-var hs-var">addpair</span></a></span><span> </span><span id="local-6989586621679119969"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679119969"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679119970"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679119970"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679119971"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679119971"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
forall k v. Ord k =&gt; (k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
</span><a href="Control.Iterate.BaseTypes.html#addkv"><span class="hs-identifier hs-var">addkv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679119969"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679119970"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679119971"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679119973"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679119973"><span class="hs-identifier hs-var">_old</span></a></span></span><span> </span><span id="local-6989586621679119974"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679119974"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679119974"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-comment">-- | use (\ old new -&gt; old) if you want the v in (f k v) to prevail, and use (\ old new -&gt; new) if you want the v in (k,v) to prevail</span><span>
</span><span id="line-65"></span><span>  </span><span id="addkv"><span class="annot"><a href="Control.Iterate.BaseTypes.html#addkv"><span class="hs-identifier hs-type">addkv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679119680"><span id="local-6989586621679119681"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679119680"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119680"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679119681"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119676"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119680"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119681"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119681"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119681"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119681"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119676"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119680"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119681"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-comment">-- | remove the pair with key 'k', if it is there.</span><span>
</span><span id="line-68"></span><span>  </span><span id="removekey"><span class="annot"><a href="Control.Iterate.BaseTypes.html#removekey"><span class="hs-identifier hs-type">removekey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679119708"><span id="local-6989586621679119709"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679119708"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119708"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119676"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119708"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119709"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119676"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119708"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119709"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-comment">-- | the set of keys</span><span>
</span><span id="line-71"></span><span>  </span><span id="domain"><span class="annot"><a href="Control.Iterate.BaseTypes.html#domain"><span class="hs-identifier hs-type">domain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679119710"><span id="local-6989586621679119711"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679119710"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119676"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119710"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119711"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679119710"><span class="hs-identifier hs-type">k</span></a></span></span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-comment">-- | the set of values.</span><span>
</span><span id="line-74"></span><span>  </span><span id="range"><span class="annot"><a href="Control.Iterate.BaseTypes.html#range"><span class="hs-identifier hs-type">range</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679119712"><span id="local-6989586621679119713"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679119712"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119676"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119713"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119712"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679119712"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- ===============================================================================================</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="annot"><span class="hs-comment">-- $Deep embedding</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | BaseRep witnesses Basic types. I.e. those types that are instances of both Basic and Iter.</span><span>
</span><span id="line-81"></span><span class="hs-comment">--   Pattern matching against a constructor of type BaseRep, determines which base type. For example</span><span>
</span><span id="line-82"></span><span class="hs-comment">--   data Tag f k v = Tag (BaseRep f k v) (f k v)</span><span>
</span><span id="line-83"></span><span class="hs-comment">--   case Tag MapR x -&gt;  -- here we know x :: Map.Map k v</span><span>
</span><span id="line-84"></span><span class="hs-keyword">data</span><span> </span><span id="BaseRep"><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-var">BaseRep</span></a></span></span><span> </span><span id="local-6989586621679119978"><span class="annot"><a href="#local-6989586621679119978"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679119979"><span class="annot"><a href="#local-6989586621679119979"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679119980"><span class="annot"><a href="#local-6989586621679119980"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>  </span><span id="local-6989586621679119981"><span id="local-6989586621679119982"><span id="MapR"><span class="annot"><a href="Control.Iterate.BaseTypes.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679119981"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119982"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621679119984"><span id="SetR"><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119984"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-87"></span><span>  </span><span id="local-6989586621679119986"><span id="local-6989586621679119987"><span id="ListR"><span class="annot"><a href="Control.Iterate.BaseTypes.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119986"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119987"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679119989"><span id="local-6989586621679119990"><span id="SingleR"><span class="annot"><a href="Control.Iterate.BaseTypes.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119989"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119990"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679119688"><span id="local-6989586621679119689"><span id="local-6989586621679119690"><span id="local-6989586621679119993"><span id="local-6989586621679119998"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119688"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119689"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119690"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621679120001"><span class="annot"><span class="annottext">show :: BaseRep f k v -&gt; String
</span><a href="#local-6989586621679120001"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.BaseTypes.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Map&quot;</span></span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.BaseTypes.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Set&quot;</span></span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.BaseTypes.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;List&quot;</span></span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.BaseTypes.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Single&quot;</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- ==================================================================</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- Now for each Basic type we provide instances</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- ==================================================================</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- MapAndSetTypes</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- ========== Basic List ==============</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Maps stored as lists. Sorted [(key,value)] pairs, with no duplicate keys.</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- The constructor for List is hidden, since it requires some invariants. Use 'fromPairs' to build an initial List.</span><span>
</span><span id="line-106"></span><span class="hs-keyword">data</span><span> </span><span id="List"><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-var">List</span></a></span></span><span> </span><span id="local-6989586621679120013"><span class="annot"><a href="#local-6989586621679120013"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679120014"><span class="annot"><a href="#local-6989586621679120014"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679119717"><span id="local-6989586621679119718"><span id="UnSafeList"><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679119717"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119717"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679119718"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119717"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119718"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span id="local-6989586621679119695"><span id="local-6989586621679119696"><span class="annot"><a href="Control.Iterate.BaseTypes.html#unList"><span class="hs-identifier hs-type">unList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119695"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119696"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119695"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679119696"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-109"></span><span id="unList"><span class="annot"><span class="annottext">unList :: forall k v. List k v -&gt; [(k, v)]
</span><a href="Control.Iterate.BaseTypes.html#unList"><span class="hs-identifier hs-var hs-var">unList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679120018"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120018"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120018"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span id="local-6989586621679119699"><span id="local-6989586621679119700"><span id="local-6989586621679120020"><span id="local-6989586621679120022"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679119699"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679119700"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119699"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119700"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679119703"><span id="local-6989586621679119704"><span id="local-6989586621679120029"><span id="local-6989586621679120034"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679119703"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679119704"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119703"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119704"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621679120036"><span class="annot"><span class="annottext">show :: List k v -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679120042"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120042"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120042"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120044"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621679120055"><span class="annot"><span class="annottext">addkv :: forall k v.
Ord k =&gt;
(k, v) -&gt; List k v -&gt; (v -&gt; v -&gt; v) -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#addkv"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120056"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120056"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120057"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120057"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679120061"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120061"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679120062"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679120062"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679120063"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120061"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>      </span><span id="local-6989586621679120063"><span class="annot"><span class="annottext">insert :: [(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679120063"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120056"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120057"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-120"></span><span>      </span><span class="annot"><a href="#local-6989586621679120063"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679120064"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120064"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120065"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120065"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679120066"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120066"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120064"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120056"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-122"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120064"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120065"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679120063"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120066"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-123"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120056"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120057"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120064"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120065"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120066"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-124"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120064"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679120062"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120065"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120057"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120066"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679120070"><span class="annot"><span class="annottext">removekey :: forall k v. Ord k =&gt; k -&gt; List k v -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#removekey"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679120071"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120071"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679120075"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120075"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679120076"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120075"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-127"></span><span>      </span><span id="local-6989586621679120076"><span class="annot"><span class="annottext">remove :: [(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679120076"><span class="hs-identifier hs-var hs-var">remove</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span>      </span><span class="annot"><a href="#local-6989586621679120076"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679120077"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120077"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120078"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120078"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679120079"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120079"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120077"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120071"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120079"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120071"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120078"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679120076"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120079"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679120081"><span class="annot"><span class="annottext">domain :: forall k v. Ord k =&gt; List k v -&gt; Set k
</span><a href="Control.Iterate.BaseTypes.html#domain"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679120086"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120086"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; Set k -&gt; Set k) -&gt; Set k -&gt; [(k, v)] -&gt; Set k
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679120088"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120088"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120089"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120089"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679120090"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120090"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120088"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120090"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120086"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621679120094"><span class="annot"><span class="annottext">range :: forall v k. Ord v =&gt; List k v -&gt; Set v
</span><a href="Control.Iterate.BaseTypes.html#range"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679120098"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120098"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; Set v -&gt; Set v) -&gt; Set v -&gt; [(k, v)] -&gt; Set v
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679120099"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120099"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120100"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120100"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679120101"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679120101"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; Set v -&gt; Set v
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120100"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679120101"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set v
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120098"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span id="local-6989586621679119730"><span id="local-6989586621679119731"><span class="annot"><a href="Control.Iterate.BaseTypes.html#fromPairs"><span class="hs-identifier hs-type">fromPairs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679119730"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119731"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119731"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119731"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119730"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679119731"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119730"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119731"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-133"></span><span id="fromPairs"><span class="annot"><span class="annottext">fromPairs :: forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#fromPairs"><span class="hs-identifier hs-var hs-var">fromPairs</span></a></span></span><span> </span><span id="local-6989586621679120106"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679120106"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679120107"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120107"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679120106"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((k, v) -&gt; (k, v) -&gt; Ordering) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679120109"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679120109"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679120110"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679120110"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679120109"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679120110"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120107"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span id="local-6989586621679119734"><span id="local-6989586621679119735"><span class="annot"><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-type">normalize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679119734"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119735"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119735"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119735"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119734"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679119735"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119734"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679119735"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-136"></span><span id="normalize"><span class="annot"><span class="annottext">normalize :: forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var hs-var">normalize</span></a></span></span><span> </span><span id="local-6989586621679120117"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679120117"><span class="hs-identifier hs-var">_combine</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-137"></span><span class="annot"><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span id="local-6989586621679120118"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679120118"><span class="hs-identifier hs-var">_combine</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679120119"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120119"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120120"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120120"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120119"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120120"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-138"></span><span class="annot"><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span id="local-6989586621679120121"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679120121"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679120122"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120122"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120123"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120123"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120124"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120124"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120125"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120125"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679120126"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120126"><span class="hs-identifier hs-var">more</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120122"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120124"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679120121"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120122"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679120121"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120123"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120125"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120126"><span class="hs-identifier hs-var">more</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span class="annot"><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span id="local-6989586621679120127"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679120127"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120128"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679120128"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679120129"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120129"><span class="hs-identifier hs-var">pairs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679120128"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679120127"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120129"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120134"><span id="local-6989586621679120140"><span id="local-6989586621679120147"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- List is the only basic instance with non-linear nxt and lub. It also depends on</span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679120152"><span class="annot"><span class="annottext">nxt :: forall a b. List a b -&gt; Collect (a, b, List a b)
</span><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (a, b, List a b)
forall t. Collect t
</span><a href="Control.Iterate.Collect.html#none"><span class="hs-identifier hs-var">none</span></a></span><span> </span><span class="hs-comment">-- key-value pairs being stored in ascending order. For small Lists (10 or so elements) this is OK.</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679120156"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120156"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120157"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120157"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679120158"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679120158"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, b, List a b) -&gt; Collect (a, b, List a b)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120156"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120157"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; List a b
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679120158"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>  </span><span id="local-6989586621679120160"><span class="annot"><span class="annottext">lub :: forall k b. Ord k =&gt; k -&gt; List k b -&gt; Collect (k, b, List k b)
</span><a href="Control.Iterate.BaseTypes.html#lub"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679120161"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120161"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679120165"><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679120165"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((k, b) -&gt; Bool) -&gt; [(k, b)] -&gt; [(k, b)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679120167"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120167"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120168"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120168"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120167"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120161"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679120165"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Collect (k, b, List k b)
forall t. Collect t
</span><a href="Control.Iterate.Collect.html#none"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679120170"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120170"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120171"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120171"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679120172"><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679120172"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, List k b) -&gt; Collect (k, b, List k b)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120170"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120171"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(k, b)] -&gt; List k b
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679120172"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>  </span><span id="local-6989586621679120173"><span class="annot"><span class="annottext">isnull :: forall k v. List k v -&gt; Bool
</span><a href="Control.Iterate.BaseTypes.html#isnull"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679120176"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120176"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120176"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679120180"><span class="annot"><span class="annottext">lookup :: forall key rng. Ord key =&gt; key -&gt; List key rng -&gt; Maybe rng
</span><a href="Control.Iterate.BaseTypes.html#lookup"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679120181"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120181"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679120184"><span class="annot"><span class="annottext">[(key, rng)]
</span><a href="#local-6989586621679120184"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; [(key, rng)] -&gt; Maybe rng
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">List.lookup</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120181"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[(key, rng)]
</span><a href="#local-6989586621679120184"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679120186"><span class="annot"><span class="annottext">hasNxt :: forall a b. List a b -&gt; Maybe (a, b, List a b)
</span><a href="Control.Iterate.BaseTypes.html#hasNxt"><span class="hs-identifier hs-var hs-var hs-var hs-var">hasNxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (a, b, List a b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#hasNxt"><span class="hs-identifier hs-var">hasNxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679120190"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120190"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120191"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120191"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679120192"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679120192"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, b, List a b) -&gt; Maybe (a, b, List a b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120190"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120191"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; List a b
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679120192"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- ================ Basic Single ===============</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="annot"><span class="hs-comment">-- | Maps and sets with zero or a single pair. Iteration is trivial. Succeeds at most once.</span></span><span>
</span><span id="line-155"></span><span class="hs-keyword">data</span><span> </span><span id="Single"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-var">Single</span></a></span></span><span> </span><span id="local-6989586621679120193"><span class="annot"><a href="#local-6989586621679120193"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679120194"><span class="annot"><a href="#local-6989586621679120194"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>  </span><span id="local-6989586621679119765"><span id="local-6989586621679119766"><span id="Single"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-var">Single</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679119765"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119766"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119765"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119766"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621679119770"><span id="local-6989586621679119771"><span id="Fail"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119770"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119771"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-158"></span><span>  </span><span id="local-6989586621679119767"><span id="SetSingle"><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679119767"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119767"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span id="local-6989586621679119760"><span id="local-6989586621679119761"><span id="local-6989586621679120200"><span id="local-6989586621679120204"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679119760"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679119761"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119760"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119761"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- Since we can only store one key, we have to choose who wins</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- We use the combine function to decide. (\ old new -&gt; old) keeps</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- the orginal value. (\ old new -&gt; new) overwrites the stored value.</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- Something else like (\ old new -&gt; old+new) overwrites with a combination</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120208"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621679120218"><span class="annot"><span class="annottext">addkv :: forall k v.
Ord k =&gt;
(k, v) -&gt; Single k v -&gt; (v -&gt; v -&gt; v) -&gt; Single k v
</span><a href="Control.Iterate.BaseTypes.html#addkv"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120219"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120219"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120220"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120220"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679120221"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679120221"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679120222"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679120222"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679120221"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-170"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679120223"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120223"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679120224"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120224"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120223"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679120222"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120224"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120220"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679120226"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120226"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Single k ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120226"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-172"></span><span>      </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120219"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120220"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621679120230"><span class="annot"><span class="annottext">removekey :: forall k v. Ord k =&gt; k -&gt; Single k v -&gt; Single k v
</span><a href="Control.Iterate.BaseTypes.html#removekey"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679120231"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120231"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679120232"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120232"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679120233"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120233"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120231"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120232"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120232"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120233"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#removekey"><span class="hs-identifier hs-var">removekey</span></a></span><span> </span><span id="local-6989586621679120234"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120234"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679120237"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120237"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120234"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120237"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Single k ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120237"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#removekey"><span class="hs-identifier hs-var">removekey</span></a></span><span> </span><span id="local-6989586621679120238"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120238"><span class="hs-identifier hs-var">_key</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span id="local-6989586621679120240"><span class="annot"><span class="annottext">domain :: forall k v. Ord k =&gt; Single k v -&gt; Set k
</span><a href="Control.Iterate.BaseTypes.html#domain"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679120241"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120241"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679120242"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120242"><span class="hs-identifier hs-var">_b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120241"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#domain"><span class="hs-identifier hs-var">domain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679120245"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120245"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120245"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#domain"><span class="hs-identifier hs-var">domain</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679120247"><span class="annot"><span class="annottext">range :: forall v k. Ord v =&gt; Single k v -&gt; Set v
</span><a href="Control.Iterate.BaseTypes.html#range"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679120248"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120248"><span class="hs-identifier hs-var">_a</span></a></span></span><span> </span><span id="local-6989586621679120249"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120249"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; Set v
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120249"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#range"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679120251"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120251"><span class="hs-identifier hs-var">_a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; Set v
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#range"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set v
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120255"><span id="local-6989586621679120259"><span id="local-6989586621679120267"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621679120271"><span class="annot"><span class="annottext">nxt :: forall a b. Single a b -&gt; Collect (a, b, Single a b)
</span><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679120272"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120272"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679120273"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120273"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Single a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Single a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679120275"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120275"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679120276"><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120276"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120276"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120272"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120273"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Single a b
forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120275"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679120278"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120278"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Single a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Single a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679120279"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120279"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679120280"><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120280"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120280"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120278"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Single a b
forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120279"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">Single a b
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Single a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Single a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679120281"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120281"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679120282"><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120282"><span class="hs-identifier hs-var">_f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120281"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621679120284"><span class="annot"><span class="annottext">lub :: forall k b. Ord k =&gt; k -&gt; Single k b -&gt; Collect (k, b, Single k b)
</span><a href="Control.Iterate.BaseTypes.html#lub"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679120285"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120285"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679120286"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120286"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679120287"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120287"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Single k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Single k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679120289"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120289"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679120290"><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120290"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120286"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120285"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120290"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120286"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120287"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Single k b
forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120289"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120289"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span id="local-6989586621679120292"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120292"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679120294"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120294"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Single k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Single k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679120296"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120296"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679120297"><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120297"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120294"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120292"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120297"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120294"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Single k b
forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120296"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120296"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span id="local-6989586621679120298"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120298"><span class="hs-identifier hs-var">_key</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single k b
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Single k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Single k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679120299"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120299"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679120300"><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120300"><span class="hs-identifier hs-var">_f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120299"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>  </span><span id="local-6989586621679120304"><span class="annot"><span class="annottext">haskey :: forall key b. Ord key =&gt; key -&gt; Single key b -&gt; Bool
</span><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679120305"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120305"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679120308"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120308"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120305"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120308"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span id="local-6989586621679120309"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120309"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679120310"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120310"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679120311"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120311"><span class="hs-identifier hs-var">_b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120309"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120310"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span id="local-6989586621679120312"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120312"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single key b
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621679120313"><span class="annot"><span class="annottext">isnull :: forall k v. Single k v -&gt; Bool
</span><a href="Control.Iterate.BaseTypes.html#isnull"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#isnull"><span class="hs-identifier hs-var">isnull</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-196"></span><span>  </span><span id="local-6989586621679120317"><span class="annot"><span class="annottext">lookup :: forall key rng. Ord key =&gt; key -&gt; Single key rng -&gt; Maybe rng
</span><a href="Control.Iterate.BaseTypes.html#lookup"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679120318"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120318"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679120321"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120321"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120318"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120321"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">rng -&gt; Maybe rng
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span id="local-6989586621679120322"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120322"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679120323"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120323"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679120324"><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679120324"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120322"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120323"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">rng -&gt; Maybe rng
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679120324"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span id="local-6989586621679120325"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120325"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single key rng
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679119799"><span id="local-6989586621679119800"><span id="local-6989586621679120329"><span id="local-6989586621679120334"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679119799"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679119800"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119799"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119800"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>  </span><span id="local-6989586621679120338"><span class="annot"><span class="annottext">show :: Single k v -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679120339"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120339"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679120340"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120340"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(Single &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120339"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120340"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679120343"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120343"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(SetSingle &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120343"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Fail&quot;</span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- ================= Basic Set =====================</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-keyword">data</span><span> </span><span id="Sett"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span></span><span> </span><span id="local-6989586621679120344"><span class="annot"><a href="#local-6989586621679120344"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679120345"><span class="annot"><a href="#local-6989586621679120345"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>  </span><span id="local-6989586621679119804"><span id="Sett"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679119804"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119804"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621679120354"><span class="annot"><span class="annottext">addpair :: forall k v. Ord k =&gt; k -&gt; v -&gt; Sett k v -&gt; Sett k v
</span><a href="Control.Iterate.BaseTypes.html#addpair"><span class="hs-identifier hs-var hs-var hs-var hs-var">addpair</span></a></span></span><span> </span><span id="local-6989586621679120355"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120355"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679120356"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120356"><span class="hs-identifier hs-var">_unit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679120359"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120359"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120355"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120359"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>  </span><span id="local-6989586621679120361"><span class="annot"><span class="annottext">addkv :: forall k v.
Ord k =&gt;
(k, v) -&gt; Sett k v -&gt; (v -&gt; v -&gt; v) -&gt; Sett k v
</span><a href="Control.Iterate.BaseTypes.html#addkv"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120362"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120362"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120363"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120363"><span class="hs-identifier hs-var">_unit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679120366"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120366"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679120367"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679120367"><span class="hs-identifier hs-var">_comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120362"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120366"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- We can ignore comb since there is only one function at type: () -&gt; () -&gt; ()</span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621679120369"><span class="annot"><span class="annottext">removekey :: forall k v. Ord k =&gt; k -&gt; Sett k v -&gt; Sett k v
</span><a href="Control.Iterate.BaseTypes.html#removekey"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679120370"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120370"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679120373"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120373"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.delete</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120370"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120373"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>  </span><span id="local-6989586621679120376"><span class="annot"><span class="annottext">domain :: forall k v. Ord k =&gt; Sett k v -&gt; Set k
</span><a href="Control.Iterate.BaseTypes.html#domain"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679120378"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120378"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120378"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-215"></span><span>  </span><span id="local-6989586621679120380"><span class="annot"><span class="annottext">range :: forall v k. Ord v =&gt; Sett k v -&gt; Set v
</span><a href="Control.Iterate.BaseTypes.html#range"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679120382"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120382"><span class="hs-identifier hs-var">_xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; Set v
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679119814"><span id="local-6989586621679120385"><span id="local-6989586621679120390"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679119814"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119814"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621679120392"><span class="annot"><span class="annottext">show :: Sett key () -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679120396"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679120396"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set key -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679120396"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span id="local-6989586621679119816"><span id="local-6989586621679120398"><span id="local-6989586621679120400"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679119816"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119816"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120406"><span id="local-6989586621679120410"><span id="local-6989586621679120418"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-223"></span><span>  </span><span id="local-6989586621679120422"><span class="annot"><span class="annottext">nxt :: forall a b. Sett a b -&gt; Collect (a, b, Sett a b)
</span><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679120424"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679120424"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Sett a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Sett a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span>
</span><span id="line-225"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679120425"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120425"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679120426"><span class="annot"><span class="annottext">(a, b, Sett a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120426"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679120424"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120425"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120428"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120428"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120429"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679120429"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; (a, Set a)
forall a. Set a -&gt; (a, Set a)
</span><span class="hs-identifier hs-var">Set.deleteFindMin</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679120424"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(a, b, Sett a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120426"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120428"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Sett a ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679120429"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120425"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-226"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>  </span><span id="local-6989586621679120432"><span class="annot"><span class="annottext">lub :: forall k b. Ord k =&gt; k -&gt; Sett k b -&gt; Collect (k, b, Sett k b)
</span><a href="Control.Iterate.BaseTypes.html#lub"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679120433"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120433"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679120435"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120435"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Sett k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Sett k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span>
</span><span id="line-229"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679120437"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120437"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679120438"><span class="annot"><span class="annottext">(k, b, Sett k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120438"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-230"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120435"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-231"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120437"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-232"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; StrictTriple (Set k) Bool (Set k)
forall a. Ord a =&gt; a -&gt; Set a -&gt; StrictTriple (Set a) Bool (Set a)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.MapExtras.html#splitMemberSet"><span class="hs-identifier hs-var">splitMemberSet</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120433"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120435"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- NOTE in Log time, we skip over all those tuples in _left</span><span>
</span><span id="line-233"></span><span>              </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.MapExtras.html#StrictTriple"><span class="hs-identifier hs-type">StrictTriple</span></a></span><span> </span><span id="local-6989586621679120440"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120440"><span class="hs-identifier hs-var">_left</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span id="local-6989586621679120441"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120441"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, Sett k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120438"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120433"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120441"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120437"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-234"></span><span>              </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.MapExtras.html#StrictTriple"><span class="hs-identifier hs-type">StrictTriple</span></a></span><span> </span><span id="local-6989586621679120442"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120442"><span class="hs-identifier hs-var">_left</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span id="local-6989586621679120443"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120443"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-235"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120443"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-236"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120437"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-237"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120444"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120444"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120445"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120445"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; (k, Set k)
forall a. Set a -&gt; (a, Set a)
</span><span class="hs-identifier hs-var">Set.deleteFindMin</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120443"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(k, b, Sett k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120438"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120444"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120445"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120437"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>  </span><span id="local-6989586621679120447"><span class="annot"><span class="annottext">haskey :: forall key b. Ord key =&gt; key -&gt; Sett key b -&gt; Bool
</span><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679120448"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120448"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679120451"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679120451"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; Set key -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120448"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679120451"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621679120453"><span class="annot"><span class="annottext">isnull :: forall k v. Sett k v -&gt; Bool
</span><a href="Control.Iterate.BaseTypes.html#isnull"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679120455"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120455"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120455"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621679120457"><span class="annot"><span class="annottext">lookup :: forall key rng. Ord key =&gt; key -&gt; Sett key rng -&gt; Maybe rng
</span><a href="Control.Iterate.BaseTypes.html#lookup"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679120458"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120458"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679120461"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679120461"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key -&gt; Set key -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120458"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679120461"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">rng -&gt; Maybe rng
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- ============== Basic Map =========================</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120463"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-comment">-- Data.Map uses(\ new old -&gt; ...) while our convention is (\ old new -&gt; ...)</span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621679120474"><span class="annot"><span class="annottext">addkv :: forall k v. Ord k =&gt; (k, v) -&gt; Map k v -&gt; (v -&gt; v -&gt; v) -&gt; Map k v
</span><a href="Control.Iterate.BaseTypes.html#addkv"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679120475"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120475"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120476"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120476"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679120477"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679120477"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679120478"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679120478"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; k -&gt; v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insertWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679120478"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120475"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120476"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679120477"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621679120483"><span class="annot"><span class="annottext">removekey :: forall k v. Ord k =&gt; k -&gt; Map k v -&gt; Map k v
</span><a href="Control.Iterate.BaseTypes.html#removekey"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679120484"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120484"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679120485"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679120485"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Map k v
forall k v. Ord k =&gt; k -&gt; Map k v -&gt; Map k v
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120484"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679120485"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span id="local-6989586621679120488"><span class="annot"><span class="annottext">domain :: forall k v. Ord k =&gt; Map k v -&gt; Set k
</span><a href="Control.Iterate.BaseTypes.html#domain"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span id="local-6989586621679120489"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679120489"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679120489"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span id="local-6989586621679120493"><span class="annot"><span class="annottext">range :: forall v k. Ord v =&gt; Map k v -&gt; Set v
</span><a href="Control.Iterate.BaseTypes.html#range"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span id="local-6989586621679120494"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679120494"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Set v -&gt; Set v) -&gt; Set v -&gt; Map k v -&gt; Set v
forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><span class="hs-identifier hs-var">Map.foldrWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679120496"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120496"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679120497"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120497"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679120498"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679120498"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; Set v -&gt; Set v
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679120497"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679120498"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set v
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679120494"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- emptyc = Map.empty</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120502"><span id="local-6989586621679120506"><span id="local-6989586621679120514"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621679120518"><span class="annot"><span class="annottext">nxt :: forall a b. Map a b -&gt; Collect (a, b, Map a b)
</span><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span id="local-6989586621679120519"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679120519"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Map a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Map a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span>
</span><span id="line-257"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679120520"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120520"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679120521"><span class="annot"><span class="annottext">(a, b, Map a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120521"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-258"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map a b -&gt; Maybe ((a, b), Map a b)
forall k a. Map k a -&gt; Maybe ((k, a), Map k a)
</span><span class="hs-identifier hs-var">Map.minViewWithKey</span></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679120519"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-259"></span><span>            </span><span class="annot"><span class="annottext">Maybe ((a, b), Map a b)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120520"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-260"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679120523"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120523"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120524"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120524"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120525"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679120525"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, Map a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120521"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120523"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120524"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679120525"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120520"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-261"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621679120527"><span class="annot"><span class="annottext">lub :: forall k b. Ord k =&gt; k -&gt; Map k b -&gt; Collect (k, b, Map k b)
</span><a href="Control.Iterate.BaseTypes.html#lub"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679120528"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120528"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679120529"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679120529"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Map k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Map k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span>
</span><span id="line-264"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679120531"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120531"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679120532"><span class="annot"><span class="annottext">(k, b, Map k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120532"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-265"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k b -&gt; (Map k b, Maybe b, Map k b)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Maybe a, Map k a)
</span><span class="hs-identifier hs-var">Map.splitLookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120528"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679120529"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- NOTE in Log time, we skip over all those tuples in _left</span><span>
</span><span id="line-266"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679120534"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679120534"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679120535"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120535"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120536"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679120536"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, Map k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120532"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120528"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120535"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679120536"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120531"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-267"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679120537"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679120537"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120538"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679120538"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Map k b -&gt; Bool
forall k v. Map k v -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679120538"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120531"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-268"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679120540"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679120540"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120541"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679120541"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, Map k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679120532"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120542"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120543"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679120544"><span class="hs-identifier hs-var">m3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679120531"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-269"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-270"></span><span>                </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679120542"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679120542"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120543"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679120543"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120544"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679120544"><span class="hs-identifier hs-var">m3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k b -&gt; ((k, b), Map k b)
forall k a. Map k a -&gt; ((k, a), Map k a)
</span><span class="hs-identifier hs-var">Map.deleteFindMin</span></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679120541"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-271"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>  </span><span id="local-6989586621679120548"><span class="annot"><span class="annottext">haskey :: forall key b. Ord key =&gt; key -&gt; Map key b -&gt; Bool
</span><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679120549"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120549"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679120550"><span class="annot"><span class="annottext">Map key b
</span><a href="#local-6989586621679120550"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">key -&gt; Map key b -&gt; Maybe b
forall key rng. Ord key =&gt; key -&gt; Map key rng -&gt; Maybe rng
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679120549"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map key b
</span><a href="#local-6989586621679120550"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-273"></span><span>  </span><span id="local-6989586621679120552"><span class="annot"><span class="annottext">isnull :: forall k v. Map k v -&gt; Bool
</span><a href="Control.Iterate.BaseTypes.html#isnull"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Bool
forall k v. Map k v -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span>
</span><span id="line-274"></span><span>  </span><span id="local-6989586621679120555"><span class="annot"><span class="annottext">lookup :: forall key rng. Ord key =&gt; key -&gt; Map key rng -&gt; Maybe rng
</span><a href="Control.Iterate.BaseTypes.html#lookup"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; Map key rng -&gt; Maybe rng
forall key rng. Ord key =&gt; key -&gt; Map key rng -&gt; Maybe rng
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- ===========================================================================</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-- | Every iterable type type forms an isomorphism with some Base type. For most</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- Base types the isomorphism is the identity in both directions, but for some,</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- like List and Sett, the embeddings are not the trivial identities because the</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- concrete types are not binary type constructors. The Embed class also allows</span><span>
</span><span id="line-282"></span><span class="hs-comment">-- us to add 'newtypes' which encode some Base type to the system.</span><span>
</span><span id="line-283"></span><span class="hs-keyword">class</span><span> </span><span id="Embed"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-var">Embed</span></a></span></span><span> </span><span id="local-6989586621679119878"><span class="annot"><a href="#local-6989586621679119878"><span class="hs-identifier hs-type">concrete</span></a></span></span><span> </span><span id="local-6989586621679119879"><span class="annot"><a href="#local-6989586621679119879"><span class="hs-identifier hs-type">base</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679119878"><span class="hs-identifier hs-type">concrete</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119879"><span class="hs-identifier hs-type">base</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>  </span><span id="toBase"><span class="annot"><a href="Control.Iterate.BaseTypes.html#toBase"><span class="hs-identifier hs-type">toBase</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679119878"><span class="hs-identifier hs-type">concrete</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119879"><span class="hs-identifier hs-type">base</span></a></span><span>
</span><span id="line-285"></span><span>  </span><span id="fromBase"><span class="annot"><a href="Control.Iterate.BaseTypes.html#fromBase"><span class="hs-identifier hs-type">fromBase</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679119879"><span class="hs-identifier hs-type">base</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119878"><span class="hs-identifier hs-type">concrete</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679119880"><span id="local-6989586621679119881"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679119880"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119880"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679119881"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119880"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119881"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-288"></span><span>  </span><span id="local-6989586621679120565"><span class="annot"><span class="annottext">toBase :: [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#toBase"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679120566"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120566"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((k, v) -&gt; (k, v) -&gt; Ordering) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679120567"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679120567"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679120568"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679120568"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679120567"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679120568"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120566"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>  </span><span id="local-6989586621679120569"><span class="annot"><span class="annottext">fromBase :: List k v -&gt; [(k, v)]
</span><a href="Control.Iterate.BaseTypes.html#fromBase"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679120571"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120571"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679120571"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679119883"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679119883"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119883"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-292"></span><span>  </span><span id="local-6989586621679120575"><span class="annot"><span class="annottext">toBase :: Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#toBase"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679120576"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120576"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120576"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-293"></span><span>  </span><span id="local-6989586621679120577"><span class="annot"><span class="annottext">fromBase :: Sett k () -&gt; Set k
</span><a href="Control.Iterate.BaseTypes.html#fromBase"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679120579"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120579"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679120579"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679119886"><span id="local-6989586621679119887"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679119886"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119887"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679119886"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119887"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-296"></span><span>  </span><span id="local-6989586621679120583"><span class="annot"><span class="annottext">toBase :: Map k v -&gt; Map k v
</span><a href="Control.Iterate.BaseTypes.html#toBase"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679120584"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679120584"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679120584"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-297"></span><span>  </span><span id="local-6989586621679120585"><span class="annot"><span class="annottext">fromBase :: Map k v -&gt; Map k v
</span><a href="Control.Iterate.BaseTypes.html#fromBase"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679120586"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679120586"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679120586"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679119890"><span id="local-6989586621679119891"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119890"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119891"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119890"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119891"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>  </span><span id="local-6989586621679120590"><span class="annot"><span class="annottext">toBase :: Single k v -&gt; Single k v
</span><a href="Control.Iterate.BaseTypes.html#toBase"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679120591"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679120591"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679120591"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-301"></span><span>  </span><span id="local-6989586621679120592"><span class="annot"><span class="annottext">fromBase :: Single k v -&gt; Single k v
</span><a href="Control.Iterate.BaseTypes.html#fromBase"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679120593"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679120593"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679120593"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- Necessary when asking Boolean queries like: (&#8838;),(&#8712;),(&#8713;)</span><span>
</span><span id="line-304"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-305"></span><span>  </span><span id="local-6989586621679120597"><span class="annot"><span class="annottext">toBase :: Bool -&gt; Bool
</span><a href="Control.Iterate.BaseTypes.html#toBase"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679120598"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679120598"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679120598"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-306"></span><span>  </span><span id="local-6989586621679120599"><span class="annot"><span class="annottext">fromBase :: Bool -&gt; Bool
</span><a href="Control.Iterate.BaseTypes.html#fromBase"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679120600"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679120600"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679120600"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-307"></span></pre></body></html>