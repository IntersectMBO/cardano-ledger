<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE MonoLocalBinds #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Cardano.Ledger.Conway.SPORatifySpec</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#spec"><span class="hs-identifier">spec</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html"><span class="hs-identifier">Cardano.Ledger.Address</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#RewardAccount"><span class="hs-identifier">RewardAccount</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html"><span class="hs-identifier">Cardano.Ledger.BaseTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#StrictMaybe"><span class="hs-identifier">StrictMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html"><span class="hs-identifier">Cardano.Ledger.Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#CompactForm"><span class="hs-identifier">CompactForm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html"><span class="hs-identifier">Cardano.Ledger.Compactible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#Compactible"><span class="hs-identifier">Compactible</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.html"><span class="hs-identifier">Cardano.Ledger.Conway</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Era.html#hardforkConwayBootstrapPhase"><span class="hs-identifier">hardforkConwayBootstrapPhase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Core.html"><span class="hs-identifier">Cardano.Ledger.Conway.Core</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html"><span class="hs-identifier">Cardano.Ledger.Conway.Governance</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#GovAction"><span class="hs-identifier">GovAction</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#GovActionState"><span class="hs-identifier">GovActionState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyEnv"><span class="hs-identifier">RatifyEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyState"><span class="hs-identifier">RatifyState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#Vote"><span class="hs-identifier">Vote</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#ensProtVerL"><span class="hs-identifier">ensProtVerL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#gasAction"><span class="hs-identifier">gasAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#gasActionL"><span class="hs-identifier">gasActionL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#rsEnactStateL"><span class="hs-identifier">rsEnactStateL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#votingStakePoolThreshold"><span class="hs-identifier">votingStakePoolThreshold</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Rules.html"><span class="hs-identifier">Cardano.Ledger.Conway.Rules</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Rules.Ratify.html#spoAccepted"><span class="hs-identifier">spoAccepted</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Rules.Ratify.html#spoAcceptedRatio"><span class="hs-identifier">spoAcceptedRatio</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.html"><span class="hs-identifier">Cardano.Ledger.Conway.State</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html"><span class="hs-identifier">Cardano.Ledger.Credential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier">Credential</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html"><span class="hs-identifier">Cardano.Ledger.Val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C%2B%3E"><span class="hs-operator">(&lt;+&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator">(&lt;-&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/data-default-0.8.0.1-9291b190c5bc542cf17f99ce44e9365d143d76b9889465ad3d362701e6cc609e/share/doc/html/src/Data.Default.html"><span class="hs-identifier">Data.Default</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/data-default-0.8.0.1-9291b190c5bc542cf17f99ce44e9365d143d76b9889465ad3d362701e6cc609e/share/doc/html/src/Data.Default.Internal.html#def"><span class="hs-identifier">def</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.MapExtras.html"><span class="hs-identifier">Data.MapExtras</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.MapExtras.html#fromKeys"><span class="hs-identifier">fromKeys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ratio</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(%)</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html"><span class="hs-identifier">Lens.Micro</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Common.html"><span class="hs-identifier">Test.Cardano.Ledger.Common</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Conway.Era.html"><span class="hs-identifier">Test.Cardano.Ledger.Conway.Era</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#spec"><span class="hs-identifier hs-type">spec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621686851469"><span class="annot"><a href="#local-6989586621686851469"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Conway.Era.html#ConwayEraTest"><span class="hs-identifier hs-type">ConwayEraTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686851469"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-core-2.11.13-707e7990f927091784a53f26b416ab321bc8328c835764c4a4c0a3c59ebc02a5/share/doc/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-49"></span><span id="spec"><span class="annot"><span class="annottext">spec :: forall era. ConwayEraTest era =&gt; Spec
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#spec"><span class="hs-identifier hs-var hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Spec -&gt; Spec
forall a. HasCallStack =&gt; String -&gt; SpecWith a -&gt; SpecWith a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-core-2.11.13-707e7990f927091784a53f26b416ab321bc8328c835764c4a4c0a3c59ebc02a5/share/doc/html/src/Test.Hspec.Core.Spec.html#describe"><span class="hs-identifier hs-var">describe</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SPO Ratification&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Spec -&gt; Spec) -&gt; Spec -&gt; Spec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="annottext">forall era. ConwayEraTest era =&gt; Spec
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#acceptedRatioProp"><span class="hs-identifier hs-var">acceptedRatioProp</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686851469"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="annottext">forall era. ConwayEraTest era =&gt; Spec
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#noStakeProp"><span class="hs-identifier hs-var">noStakeProp</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686851469"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="annottext">forall era. ConwayEraTest era =&gt; Spec
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#allAbstainProp"><span class="hs-identifier hs-var">allAbstainProp</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686851469"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="annottext">forall era. ConwayEraTest era =&gt; Spec
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#noVotesProp"><span class="hs-identifier hs-var">noVotesProp</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686851469"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="annottext">forall era. ConwayEraTest era =&gt; Spec
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#allYesProp"><span class="hs-identifier hs-var">allYesProp</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686851469"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="annottext">forall era. ConwayEraTest era =&gt; Spec
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#noConfidenceProp"><span class="hs-identifier hs-var">noConfidenceProp</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686851469"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#acceptedRatioProp"><span class="hs-identifier hs-type">acceptedRatioProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621686851772"><span class="annot"><a href="#local-6989586621686851772"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Conway.Era.html#ConwayEraTest"><span class="hs-identifier hs-type">ConwayEraTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686851772"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-core-2.11.13-707e7990f927091784a53f26b416ab321bc8328c835764c4a4c0a3c59ebc02a5/share/doc/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-59"></span><span id="acceptedRatioProp"><span class="annot"><span class="annottext">acceptedRatioProp :: forall era. ConwayEraTest era =&gt; Spec
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#acceptedRatioProp"><span class="hs-identifier hs-var hs-var">acceptedRatioProp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><span class="annottext">forall prop.
(HasCallStack, Testable prop) =&gt;
String -&gt; prop -&gt; Spec
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-2.11.13-9c3b235a66c4833958c1e584ebb61c2df8b2ee0401136c2810995c1b6a4bd0c5/share/doc/html/src/Test.Hspec.QuickCheck.html#prop"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyEnv"><span class="hs-identifier hs-type">RatifyEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686851772"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyState"><span class="hs-identifier hs-type">RatifyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686851772"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#GovActionState"><span class="hs-identifier hs-type">GovActionState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686851772"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SPO vote count for arbitrary vote ratios&quot;</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="annottext">(((RatifyEnv era, RatifyState era, GovActionState era) -&gt; Property)
 -&gt; Spec)
-&gt; ((RatifyEnv era, RatifyState era, GovActionState era)
    -&gt; Property)
-&gt; Spec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621686851888"><span class="annot"><span class="annottext">RatifyEnv era
</span><a href="#local-6989586621686851888"><span class="hs-identifier hs-var">re</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686851889"><span class="annot"><span class="annottext">RatifyState era
</span><a href="#local-6989586621686851889"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686851890"><span class="annot"><span class="annottext">GovActionState era
</span><a href="#local-6989586621686851890"><span class="hs-identifier hs-var">gas</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Gen Ratios -&gt; (Ratios -&gt; Property) -&gt; Property
forall a prop.
(Show a, Testable prop) =&gt;
Gen a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="annot"><span class="annottext">Gen Ratios
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#genRatios"><span class="hs-identifier hs-var">genRatios</span></a></span><span> </span><span class="annot"><span class="annottext">((Ratios -&gt; Property) -&gt; Property)
-&gt; (Ratios -&gt; Property) -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621686851893"><span class="annot"><span class="annottext">Ratios
</span><a href="#local-6989586621686851893"><span class="hs-identifier hs-var">ratios</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-63"></span><span>      </span><span class="annot"><span class="annottext">Gen (TestData era) -&gt; (TestData era -&gt; Expectation) -&gt; Property
forall a prop.
(Show a, Testable prop) =&gt;
Gen a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span>
</span><span id="line-64"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Ratios -&gt; Gen (TestData era)
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#genTestData"><span class="hs-identifier hs-var">genTestData</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686851772"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">Ratios
</span><a href="#local-6989586621686851893"><span class="hs-identifier hs-var">ratios</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#TestData"><span class="hs-identifier hs-type">TestData</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621686851896"><span id="local-6989586621686851897"><span id="local-6989586621686851898"><span id="local-6989586621686851899"><span id="local-6989586621686851900"><span id="local-6989586621686851901"><span id="local-6989586621686851902"><span id="local-6989586621686851903"><span id="local-6989586621686851904"><span id="local-6989586621686851905"><span id="local-6989586621686851906"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
Map (KeyHash 'StakePool) Vote
Map (Credential 'Staking) DRep
PoolDistr
Coin
CompactForm Coin
distr :: PoolDistr
votes :: Map (KeyHash 'StakePool) Vote
totalStake :: CompactForm Coin
stakeYes :: Coin
stakeNo :: Coin
stakeAbstain :: Coin
stakeAlwaysAbstain :: Coin
stakeNoConfidence :: Coin
stakeNotVoted :: Coin
delegatees :: Map (Credential 'Staking) DRep
stakePools :: Map (KeyHash 'StakePool) StakePoolState
distr :: forall era. TestData era -&gt; PoolDistr
votes :: forall era. TestData era -&gt; Map (KeyHash 'StakePool) Vote
totalStake :: forall era. TestData era -&gt; CompactForm Coin
stakeYes :: forall era. TestData era -&gt; Coin
stakeNo :: forall era. TestData era -&gt; Coin
stakeAbstain :: forall era. TestData era -&gt; Coin
stakeAlwaysAbstain :: forall era. TestData era -&gt; Coin
stakeNoConfidence :: forall era. TestData era -&gt; Coin
stakeNotVoted :: forall era. TestData era -&gt; Coin
delegatees :: forall era. TestData era -&gt; Map (Credential 'Staking) DRep
stakePools :: forall era. TestData era -&gt; Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621686851896"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-66"></span><span>            </span><span class="hs-keyword">let</span><span>
</span><span id="line-67"></span><span>              </span><span id="local-6989586621686851918"><span class="annot"><span class="annottext">protVer :: ProtVer
</span><a href="#local-6989586621686851918"><span class="hs-identifier hs-var hs-var">protVer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RatifyState era
</span><a href="#local-6989586621686851889"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">RatifyState era
-&gt; Getting ProtVer (RatifyState era) ProtVer -&gt; ProtVer
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EnactState era -&gt; Const ProtVer (EnactState era))
-&gt; RatifyState era -&gt; Const ProtVer (RatifyState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EnactState era -&gt; f (EnactState era))
-&gt; RatifyState era -&gt; f (RatifyState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#rsEnactStateL"><span class="hs-identifier hs-var">rsEnactStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((EnactState era -&gt; Const ProtVer (EnactState era))
 -&gt; RatifyState era -&gt; Const ProtVer (RatifyState era))
-&gt; ((ProtVer -&gt; Const ProtVer ProtVer)
    -&gt; EnactState era -&gt; Const ProtVer (EnactState era))
-&gt; Getting ProtVer (RatifyState era) ProtVer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ProtVer -&gt; Const ProtVer ProtVer)
-&gt; EnactState era -&gt; Const ProtVer (EnactState era)
forall era. EraPParams era =&gt; Lens' (EnactState era) ProtVer
Lens' (EnactState era) ProtVer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#ensProtVerL"><span class="hs-identifier hs-var">ensProtVerL</span></a></span><span>
</span><span id="line-68"></span><span>              </span><span id="local-6989586621686851921"><span class="annot"><span class="annottext">actual :: Ratio Integer
</span><a href="#local-6989586621686851921"><span class="hs-identifier hs-var hs-var">actual</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-69"></span><span>                </span><span class="annot"><span class="annottext">forall era.
ConwayEraAccounts era =&gt;
RatifyEnv era -&gt; GovActionState era -&gt; ProtVer -&gt; Ratio Integer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Rules.Ratify.html#spoAcceptedRatio"><span class="hs-identifier hs-var">spoAcceptedRatio</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686851772"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-70"></span><span>                  </span><span class="annot"><span class="annottext">RatifyEnv era
</span><a href="#local-6989586621686851888"><span class="hs-identifier hs-var">re</span></a></span><span>
</span><span id="line-71"></span><span>                    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#reStakePoolDistr"><span class="hs-identifier hs-var">reStakePoolDistr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621686851896"><span class="hs-identifier hs-type">distr</span></a></span><span>
</span><span id="line-72"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#reAccounts"><span class="hs-identifier hs-var">reAccounts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#accountsFromDelegatees"><span class="hs-identifier hs-type">accountsFromDelegatees</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686851905"><span class="hs-identifier hs-type">delegatees</span></a></span><span>
</span><span id="line-73"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#reStakePools"><span class="hs-identifier hs-var">reStakePools</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621686851906"><span class="hs-identifier hs-type">stakePools</span></a></span><span>
</span><span id="line-74"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-75"></span><span>                  </span><span class="annot"><span class="annottext">GovActionState era
</span><a href="#local-6989586621686851890"><span class="hs-identifier hs-var">gas</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#gasStakePoolVotes"><span class="hs-identifier hs-var">gasStakePoolVotes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621686851897"><span class="hs-identifier hs-type">votes</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-76"></span><span>                  </span><span class="annot"><span class="annottext">ProtVer
</span><a href="#local-6989586621686851918"><span class="hs-identifier hs-var">protVer</span></a></span><span>
</span><span id="line-77"></span><span>              </span><span id="local-6989586621686851927"><span class="annot"><span class="annottext">expected :: Ratio Integer
</span><a href="#local-6989586621686851927"><span class="hs-identifier hs-var hs-var">expected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-78"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CompactForm Coin -&gt; Coin
forall a. Compactible a =&gt; CompactForm a -&gt; a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#fromCompact"><span class="hs-identifier hs-var">fromCompact</span></a></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621686851898"><span class="hs-identifier hs-var">totalStake</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621686851901"><span class="hs-identifier hs-var">stakeAbstain</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621686851902"><span class="hs-identifier hs-var">stakeAlwaysAbstain</span></a></span><span>
</span><span id="line-79"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-80"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GovActionState era
</span><a href="#local-6989586621686851890"><span class="hs-identifier hs-var">gas</span></a></span><span> </span><span class="annot"><span class="annottext">GovActionState era
-&gt; Getting (GovAction era) (GovActionState era) (GovAction era)
-&gt; GovAction era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (GovAction era) (GovActionState era) (GovAction era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(GovAction era -&gt; f (GovAction era))
-&gt; GovActionState era -&gt; f (GovActionState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#gasActionL"><span class="hs-identifier hs-var">gasActionL</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-81"></span><span>                    </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#HardForkInitiation"><span class="hs-identifier hs-type">HardForkInitiation</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (GovPurposeId 'HardForkPurpose)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProtVer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#unCoin"><span class="hs-identifier hs-var">unCoin</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621686851899"><span class="hs-identifier hs-var">stakeYes</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Ratio Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#unCoin"><span class="hs-identifier hs-var">unCoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompactForm Coin -&gt; Coin
forall a. Compactible a =&gt; CompactForm a -&gt; a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#fromCompact"><span class="hs-identifier hs-var">fromCompact</span></a></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621686851898"><span class="hs-identifier hs-var">totalStake</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621686851901"><span class="hs-identifier hs-var">stakeAbstain</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>                    </span><span id="local-6989586621686851931"><span class="annot"><span class="annottext">GovAction era
</span><a href="#local-6989586621686851931"><span class="hs-identifier hs-var">action</span></a></span></span><span>
</span><span id="line-83"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ProtVer -&gt; Bool
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Era.html#hardforkConwayBootstrapPhase"><span class="hs-identifier hs-var">hardforkConwayBootstrapPhase</span></a></span><span> </span><span class="annot"><span class="annottext">ProtVer
</span><a href="#local-6989586621686851918"><span class="hs-identifier hs-var">protVer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-84"></span><span>                          </span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#unCoin"><span class="hs-identifier hs-var">unCoin</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621686851899"><span class="hs-identifier hs-var">stakeYes</span></a></span><span>
</span><span id="line-85"></span><span>                            </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Ratio Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#unCoin"><span class="hs-identifier hs-var">unCoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompactForm Coin -&gt; Coin
forall a. Compactible a =&gt; CompactForm a -&gt; a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#fromCompact"><span class="hs-identifier hs-var">fromCompact</span></a></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621686851898"><span class="hs-identifier hs-var">totalStake</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621686851901"><span class="hs-identifier hs-var">stakeAbstain</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621686851902"><span class="hs-identifier hs-var">stakeAlwaysAbstain</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621686851903"><span class="hs-identifier hs-var">stakeNoConfidence</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#NoConfidence"><span class="hs-identifier hs-type">NoConfidence</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GovAction era
</span><a href="#local-6989586621686851931"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-87"></span><span>                          </span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#unCoin"><span class="hs-identifier hs-var">unCoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621686851899"><span class="hs-identifier hs-var">stakeYes</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621686851903"><span class="hs-identifier hs-var">stakeNoConfidence</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>                            </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Ratio Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#unCoin"><span class="hs-identifier hs-var">unCoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompactForm Coin -&gt; Coin
forall a. Compactible a =&gt; CompactForm a -&gt; a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#fromCompact"><span class="hs-identifier hs-var">fromCompact</span></a></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621686851898"><span class="hs-identifier hs-var">totalStake</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621686851901"><span class="hs-identifier hs-var">stakeAbstain</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621686851902"><span class="hs-identifier hs-var">stakeAlwaysAbstain</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-90"></span><span>                          </span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#unCoin"><span class="hs-identifier hs-var">unCoin</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621686851899"><span class="hs-identifier hs-var">stakeYes</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Ratio Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#unCoin"><span class="hs-identifier hs-var">unCoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompactForm Coin -&gt; Coin
forall a. Compactible a =&gt; CompactForm a -&gt; a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#fromCompact"><span class="hs-identifier hs-var">fromCompact</span></a></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621686851898"><span class="hs-identifier hs-var">totalStake</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621686851901"><span class="hs-identifier hs-var">stakeAbstain</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621686851902"><span class="hs-identifier hs-var">stakeAlwaysAbstain</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>            </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686851921"><span class="hs-identifier hs-var">actual</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer -&gt; Ratio Integer -&gt; Expectation
forall a. (HasCallStack, Show a, Eq a) =&gt; a -&gt; a -&gt; Expectation
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-expectations-0.8.4-803bfab44be1d57de46c2fd729766b4529923f957d0248f7f06e545b69067993/share/doc/html/src/Test.Hspec.Expectations.html#shouldBe"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686851927"><span class="hs-identifier hs-var">expected</span></a></span><span>
</span><span id="line-92"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#noStakeProp"><span class="hs-identifier hs-type">noStakeProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621686851934"><span class="annot"><a href="#local-6989586621686851934"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Conway.Era.html#ConwayEraTest"><span class="hs-identifier hs-type">ConwayEraTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686851934"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-core-2.11.13-707e7990f927091784a53f26b416ab321bc8328c835764c4a4c0a3c59ebc02a5/share/doc/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-95"></span><span id="noStakeProp"><span class="annot"><span class="annottext">noStakeProp :: forall era. ConwayEraTest era =&gt; Spec
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#noStakeProp"><span class="hs-identifier hs-var hs-var">noStakeProp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><span class="annottext">forall prop.
(HasCallStack, Testable prop) =&gt;
String -&gt; prop -&gt; Spec
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-2.11.13-9c3b235a66c4833958c1e584ebb61c2df8b2ee0401136c2810995c1b6a4bd0c5/share/doc/html/src/Test.Hspec.QuickCheck.html#prop"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyEnv"><span class="hs-identifier hs-type">RatifyEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686851934"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyState"><span class="hs-identifier hs-type">RatifyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686851934"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#GovActionState"><span class="hs-identifier hs-type">GovActionState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686851934"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;If there is no stake, accept iff threshold is zero&quot;</span></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621686851991"><span class="annot"><span class="annottext">RatifyEnv era
</span><a href="#local-6989586621686851991"><span class="hs-identifier hs-var">re</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686851992"><span class="annot"><span class="annottext">RatifyState era
</span><a href="#local-6989586621686851992"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686851993"><span class="annot"><span class="annottext">GovActionState era
</span><a href="#local-6989586621686851993"><span class="hs-identifier hs-var">gas</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-99"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621686851994"><span class="annot"><span class="annottext">re' :: RatifyEnv era
</span><a href="#local-6989586621686851994"><span class="hs-identifier hs-var hs-var">re'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RatifyEnv era
</span><a href="#local-6989586621686851991"><span class="hs-identifier hs-var">re</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#reStakePoolDistr"><span class="hs-identifier hs-var">reStakePoolDistr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#PoolDistr"><span class="hs-identifier hs-type">PoolDistr</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.empty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromJust</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#toCompact"><span class="hs-identifier hs-type">toCompact</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="annot"><span class="hs-number">100</span></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-100"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall era.
(ConwayEraPParams era, ConwayEraAccounts era) =&gt;
RatifyEnv era -&gt; RatifyState era -&gt; GovActionState era -&gt; Bool
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Rules.Ratify.html#spoAccepted"><span class="hs-identifier hs-var">spoAccepted</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686851934"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">RatifyEnv era
</span><a href="#local-6989586621686851994"><span class="hs-identifier hs-var">re'</span></a></span><span> </span><span class="annot"><span class="annottext">RatifyState era
</span><a href="#local-6989586621686851992"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">GovActionState era
</span><a href="#local-6989586621686851993"><span class="hs-identifier hs-var">gas</span></a></span><span>
</span><span id="line-101"></span><span>              </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Expectation
forall a. (HasCallStack, Show a, Eq a) =&gt; a -&gt; a -&gt; Expectation
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-expectations-0.8.4-803bfab44be1d57de46c2fd729766b4529923f957d0248f7f06e545b69067993/share/doc/html/src/Test.Hspec.Expectations.html#shouldBe"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era.
ConwayEraPParams era =&gt;
RatifyState era -&gt; GovAction era -&gt; StrictMaybe UnitInterval
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#votingStakePoolThreshold"><span class="hs-identifier hs-var">votingStakePoolThreshold</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686851934"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">RatifyState era
</span><a href="#local-6989586621686851992"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GovActionState era -&gt; GovAction era
forall era. GovActionState era -&gt; GovAction era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#gasAction"><span class="hs-identifier hs-var">gasAction</span></a></span><span> </span><span class="annot"><span class="annottext">GovActionState era
</span><a href="#local-6989586621686851993"><span class="hs-identifier hs-var">gas</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StrictMaybe UnitInterval -&gt; StrictMaybe UnitInterval -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">UnitInterval -&gt; StrictMaybe UnitInterval
forall a. a -&gt; StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">UnitInterval
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">minBound</span></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#allAbstainProp"><span class="hs-identifier hs-type">allAbstainProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621686852001"><span class="annot"><a href="#local-6989586621686852001"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Conway.Era.html#ConwayEraTest"><span class="hs-identifier hs-type">ConwayEraTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852001"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-core-2.11.13-707e7990f927091784a53f26b416ab321bc8328c835764c4a4c0a3c59ebc02a5/share/doc/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-105"></span><span id="allAbstainProp"><span class="annot"><span class="annottext">allAbstainProp :: forall era. ConwayEraTest era =&gt; Spec
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#allAbstainProp"><span class="hs-identifier hs-var hs-var">allAbstainProp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><span class="annottext">forall prop.
(HasCallStack, Testable prop) =&gt;
String -&gt; prop -&gt; Spec
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-2.11.13-9c3b235a66c4833958c1e584ebb61c2df8b2ee0401136c2810995c1b6a4bd0c5/share/doc/html/src/Test.Hspec.QuickCheck.html#prop"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyEnv"><span class="hs-identifier hs-type">RatifyEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852001"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyState"><span class="hs-identifier hs-type">RatifyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852001"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#GovActionState"><span class="hs-identifier hs-type">GovActionState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852001"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;If all votes are abstain, accepted ratio is zero&quot;</span></span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><span class="annottext">(((RatifyEnv era, RatifyState era, GovActionState era) -&gt; Property)
 -&gt; Spec)
-&gt; ((RatifyEnv era, RatifyState era, GovActionState era)
    -&gt; Property)
-&gt; Spec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621686852059"><span class="annot"><span class="annottext">RatifyEnv era
</span><a href="#local-6989586621686852059"><span class="hs-identifier hs-var">re</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852060"><span class="annot"><span class="annottext">RatifyState era
</span><a href="#local-6989586621686852060"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852061"><span class="annot"><span class="annottext">GovActionState era
</span><a href="#local-6989586621686852061"><span class="hs-identifier hs-var">gas</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Gen (TestData era) -&gt; (TestData era -&gt; Expectation) -&gt; Property
forall a prop.
(Show a, Testable prop) =&gt;
Gen a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span>
</span><span id="line-109"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall era. Ratios -&gt; Gen (TestData era)
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#genTestData"><span class="hs-identifier hs-var">genTestData</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686852001"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-110"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#Ratios"><span class="hs-identifier hs-type">Ratios</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">yes :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#yes"><span class="hs-identifier hs-var">yes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">no :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#no"><span class="hs-identifier hs-var">no</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">abstain :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#abstain"><span class="hs-identifier hs-var">abstain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Ratio Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alwaysAbstain :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#alwaysAbstain"><span class="hs-identifier hs-var">alwaysAbstain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Ratio Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">noConfidence :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#noConfidence"><span class="hs-identifier hs-var">noConfidence</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>      </span><span class="annot"><span class="annottext">((TestData era -&gt; Expectation) -&gt; Property)
-&gt; (TestData era -&gt; Expectation) -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#TestData"><span class="hs-identifier hs-type">TestData</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621686852068"><span id="local-6989586621686852069"><span id="local-6989586621686852070"><span id="local-6989586621686852071"><span id="local-6989586621686852072"><span id="local-6989586621686852073"><span id="local-6989586621686852074"><span id="local-6989586621686852075"><span id="local-6989586621686852076"><span id="local-6989586621686852077"><span id="local-6989586621686852078"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
Map (KeyHash 'StakePool) Vote
Map (Credential 'Staking) DRep
PoolDistr
Coin
CompactForm Coin
distr :: forall era. TestData era -&gt; PoolDistr
votes :: forall era. TestData era -&gt; Map (KeyHash 'StakePool) Vote
totalStake :: forall era. TestData era -&gt; CompactForm Coin
stakeYes :: forall era. TestData era -&gt; Coin
stakeNo :: forall era. TestData era -&gt; Coin
stakeAbstain :: forall era. TestData era -&gt; Coin
stakeAlwaysAbstain :: forall era. TestData era -&gt; Coin
stakeNoConfidence :: forall era. TestData era -&gt; Coin
stakeNotVoted :: forall era. TestData era -&gt; Coin
delegatees :: forall era. TestData era -&gt; Map (Credential 'Staking) DRep
stakePools :: forall era. TestData era -&gt; Map (KeyHash 'StakePool) StakePoolState
distr :: PoolDistr
votes :: Map (KeyHash 'StakePool) Vote
totalStake :: CompactForm Coin
stakeYes :: Coin
stakeNo :: Coin
stakeAbstain :: Coin
stakeAlwaysAbstain :: Coin
stakeNoConfidence :: Coin
stakeNotVoted :: Coin
delegatees :: Map (Credential 'Staking) DRep
stakePools :: Map (KeyHash 'StakePool) StakePoolState
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#distr"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><span class="annottext">forall era.
ConwayEraAccounts era =&gt;
RatifyEnv era -&gt; GovActionState era -&gt; ProtVer -&gt; Ratio Integer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Rules.Ratify.html#spoAcceptedRatio"><span class="hs-identifier hs-var">spoAcceptedRatio</span></a></span><span>
</span><span id="line-114"></span><span>          </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686852001"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-115"></span><span>          </span><span class="annot"><span class="annottext">RatifyEnv era
</span><a href="#local-6989586621686852059"><span class="hs-identifier hs-var">re</span></a></span><span>
</span><span id="line-116"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#reStakePoolDistr"><span class="hs-identifier hs-var">reStakePoolDistr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621686852068"><span class="hs-identifier hs-type">distr</span></a></span><span>
</span><span id="line-117"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#reAccounts"><span class="hs-identifier hs-var">reAccounts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#accountsFromDelegatees"><span class="hs-identifier hs-type">accountsFromDelegatees</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852077"><span class="hs-identifier hs-type">delegatees</span></a></span><span>
</span><span id="line-118"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#reStakePools"><span class="hs-identifier hs-var">reStakePools</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621686852078"><span class="hs-identifier hs-type">stakePools</span></a></span><span>
</span><span id="line-119"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-120"></span><span>          </span><span class="annot"><span class="annottext">GovActionState era
</span><a href="#local-6989586621686852061"><span class="hs-identifier hs-var">gas</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#gasStakePoolVotes"><span class="hs-identifier hs-var">gasStakePoolVotes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621686852069"><span class="hs-identifier hs-type">votes</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-121"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RatifyState era
</span><a href="#local-6989586621686852060"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">RatifyState era
-&gt; Getting ProtVer (RatifyState era) ProtVer -&gt; ProtVer
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EnactState era -&gt; Const ProtVer (EnactState era))
-&gt; RatifyState era -&gt; Const ProtVer (RatifyState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EnactState era -&gt; f (EnactState era))
-&gt; RatifyState era -&gt; f (RatifyState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#rsEnactStateL"><span class="hs-identifier hs-var">rsEnactStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((EnactState era -&gt; Const ProtVer (EnactState era))
 -&gt; RatifyState era -&gt; Const ProtVer (RatifyState era))
-&gt; ((ProtVer -&gt; Const ProtVer ProtVer)
    -&gt; EnactState era -&gt; Const ProtVer (EnactState era))
-&gt; Getting ProtVer (RatifyState era) ProtVer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ProtVer -&gt; Const ProtVer ProtVer)
-&gt; EnactState era -&gt; Const ProtVer (EnactState era)
forall era. EraPParams era =&gt; Lens' (EnactState era) ProtVer
Lens' (EnactState era) ProtVer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#ensProtVerL"><span class="hs-identifier hs-var">ensProtVerL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>          </span><span class="annot"><span class="annottext">Ratio Integer -&gt; Ratio Integer -&gt; Expectation
forall a. (HasCallStack, Show a, Eq a) =&gt; a -&gt; a -&gt; Expectation
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-expectations-0.8.4-803bfab44be1d57de46c2fd729766b4529923f957d0248f7f06e545b69067993/share/doc/html/src/Test.Hspec.Expectations.html#shouldBe"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#noVotesProp"><span class="hs-identifier hs-type">noVotesProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621686852079"><span class="annot"><a href="#local-6989586621686852079"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Conway.Era.html#ConwayEraTest"><span class="hs-identifier hs-type">ConwayEraTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852079"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-core-2.11.13-707e7990f927091784a53f26b416ab321bc8328c835764c4a4c0a3c59ebc02a5/share/doc/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-125"></span><span id="noVotesProp"><span class="annot"><span class="annottext">noVotesProp :: forall era. ConwayEraTest era =&gt; Spec
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#noVotesProp"><span class="hs-identifier hs-var hs-var">noVotesProp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><span class="annottext">forall prop.
(HasCallStack, Testable prop) =&gt;
String -&gt; prop -&gt; Spec
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-2.11.13-9c3b235a66c4833958c1e584ebb61c2df8b2ee0401136c2810995c1b6a4bd0c5/share/doc/html/src/Test.Hspec.QuickCheck.html#prop"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyEnv"><span class="hs-identifier hs-type">RatifyEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852079"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyState"><span class="hs-identifier hs-type">RatifyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852079"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#GovActionState"><span class="hs-identifier hs-type">GovActionState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852079"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;If there are no votes, accepted ratio is zero&quot;</span></span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><span class="annottext">(((RatifyEnv era, RatifyState era, GovActionState era) -&gt; Property)
 -&gt; Spec)
-&gt; ((RatifyEnv era, RatifyState era, GovActionState era)
    -&gt; Property)
-&gt; Spec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621686852132"><span class="annot"><span class="annottext">RatifyEnv era
</span><a href="#local-6989586621686852132"><span class="hs-identifier hs-var">re</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852133"><span class="annot"><span class="annottext">RatifyState era
</span><a href="#local-6989586621686852133"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852134"><span class="annot"><span class="annottext">GovActionState era
</span><a href="#local-6989586621686852134"><span class="hs-identifier hs-var">gas</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Gen (TestData era) -&gt; (TestData era -&gt; Expectation) -&gt; Property
forall a prop.
(Show a, Testable prop) =&gt;
Gen a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall era. Ratios -&gt; Gen (TestData era)
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#genTestData"><span class="hs-identifier hs-var">genTestData</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686852079"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-130"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#Ratios"><span class="hs-identifier hs-type">Ratios</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">yes :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#yes"><span class="hs-identifier hs-var">yes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">no :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#no"><span class="hs-identifier hs-var">no</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">abstain :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#abstain"><span class="hs-identifier hs-var">abstain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alwaysAbstain :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#alwaysAbstain"><span class="hs-identifier hs-var">alwaysAbstain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">noConfidence :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#noConfidence"><span class="hs-identifier hs-var">noConfidence</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>      </span><span class="annot"><span class="annottext">((TestData era -&gt; Expectation) -&gt; Property)
-&gt; (TestData era -&gt; Expectation) -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#TestData"><span class="hs-identifier hs-type">TestData</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621686852135"><span id="local-6989586621686852136"><span id="local-6989586621686852137"><span id="local-6989586621686852138"><span id="local-6989586621686852139"><span id="local-6989586621686852140"><span id="local-6989586621686852141"><span id="local-6989586621686852142"><span id="local-6989586621686852143"><span id="local-6989586621686852144"><span id="local-6989586621686852145"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
Map (KeyHash 'StakePool) Vote
Map (Credential 'Staking) DRep
PoolDistr
Coin
CompactForm Coin
distr :: forall era. TestData era -&gt; PoolDistr
votes :: forall era. TestData era -&gt; Map (KeyHash 'StakePool) Vote
totalStake :: forall era. TestData era -&gt; CompactForm Coin
stakeYes :: forall era. TestData era -&gt; Coin
stakeNo :: forall era. TestData era -&gt; Coin
stakeAbstain :: forall era. TestData era -&gt; Coin
stakeAlwaysAbstain :: forall era. TestData era -&gt; Coin
stakeNoConfidence :: forall era. TestData era -&gt; Coin
stakeNotVoted :: forall era. TestData era -&gt; Coin
delegatees :: forall era. TestData era -&gt; Map (Credential 'Staking) DRep
stakePools :: forall era. TestData era -&gt; Map (KeyHash 'StakePool) StakePoolState
distr :: PoolDistr
votes :: Map (KeyHash 'StakePool) Vote
totalStake :: CompactForm Coin
stakeYes :: Coin
stakeNo :: Coin
stakeAbstain :: Coin
stakeAlwaysAbstain :: Coin
stakeNoConfidence :: Coin
stakeNotVoted :: Coin
delegatees :: Map (Credential 'Staking) DRep
stakePools :: Map (KeyHash 'StakePool) StakePoolState
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#distr"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><span class="annottext">forall era.
ConwayEraAccounts era =&gt;
RatifyEnv era -&gt; GovActionState era -&gt; ProtVer -&gt; Ratio Integer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Rules.Ratify.html#spoAcceptedRatio"><span class="hs-identifier hs-var">spoAcceptedRatio</span></a></span><span>
</span><span id="line-134"></span><span>          </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686852079"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-135"></span><span>          </span><span class="annot"><span class="annottext">RatifyEnv era
</span><a href="#local-6989586621686852132"><span class="hs-identifier hs-var">re</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#reStakePoolDistr"><span class="hs-identifier hs-var">reStakePoolDistr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621686852135"><span class="hs-identifier hs-type">distr</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-136"></span><span>          </span><span class="annot"><span class="annottext">GovActionState era
</span><a href="#local-6989586621686852134"><span class="hs-identifier hs-var">gas</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#gasStakePoolVotes"><span class="hs-identifier hs-var">gasStakePoolVotes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621686852136"><span class="hs-identifier hs-type">votes</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-137"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RatifyState era
</span><a href="#local-6989586621686852133"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">RatifyState era
-&gt; Getting ProtVer (RatifyState era) ProtVer -&gt; ProtVer
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EnactState era -&gt; Const ProtVer (EnactState era))
-&gt; RatifyState era -&gt; Const ProtVer (RatifyState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EnactState era -&gt; f (EnactState era))
-&gt; RatifyState era -&gt; f (RatifyState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#rsEnactStateL"><span class="hs-identifier hs-var">rsEnactStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((EnactState era -&gt; Const ProtVer (EnactState era))
 -&gt; RatifyState era -&gt; Const ProtVer (RatifyState era))
-&gt; ((ProtVer -&gt; Const ProtVer ProtVer)
    -&gt; EnactState era -&gt; Const ProtVer (EnactState era))
-&gt; Getting ProtVer (RatifyState era) ProtVer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ProtVer -&gt; Const ProtVer ProtVer)
-&gt; EnactState era -&gt; Const ProtVer (EnactState era)
forall era. EraPParams era =&gt; Lens' (EnactState era) ProtVer
Lens' (EnactState era) ProtVer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#ensProtVerL"><span class="hs-identifier hs-var">ensProtVerL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>          </span><span class="annot"><span class="annottext">Ratio Integer -&gt; Ratio Integer -&gt; Expectation
forall a. (HasCallStack, Show a, Eq a) =&gt; a -&gt; a -&gt; Expectation
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-expectations-0.8.4-803bfab44be1d57de46c2fd729766b4529923f957d0248f7f06e545b69067993/share/doc/html/src/Test.Hspec.Expectations.html#shouldBe"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#allYesProp"><span class="hs-identifier hs-type">allYesProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621686852146"><span class="annot"><a href="#local-6989586621686852146"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Conway.Era.html#ConwayEraTest"><span class="hs-identifier hs-type">ConwayEraTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852146"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-core-2.11.13-707e7990f927091784a53f26b416ab321bc8328c835764c4a4c0a3c59ebc02a5/share/doc/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-141"></span><span id="allYesProp"><span class="annot"><span class="annottext">allYesProp :: forall era. ConwayEraTest era =&gt; Spec
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#allYesProp"><span class="hs-identifier hs-var hs-var">allYesProp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><span class="annottext">forall prop.
(HasCallStack, Testable prop) =&gt;
String -&gt; prop -&gt; Spec
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-2.11.13-9c3b235a66c4833958c1e584ebb61c2df8b2ee0401136c2810995c1b6a4bd0c5/share/doc/html/src/Test.Hspec.QuickCheck.html#prop"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyEnv"><span class="hs-identifier hs-type">RatifyEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852146"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyState"><span class="hs-identifier hs-type">RatifyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852146"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#GovActionState"><span class="hs-identifier hs-type">GovActionState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852146"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;If all vote yes, accepted ratio is 1 (unless there is no stake) &quot;</span></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621686852208"><span class="annot"><span class="annottext">RatifyEnv era
</span><a href="#local-6989586621686852208"><span class="hs-identifier hs-var">re</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852209"><span class="annot"><span class="annottext">RatifyState era
</span><a href="#local-6989586621686852209"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852210"><span class="annot"><span class="annottext">GovActionState era
</span><a href="#local-6989586621686852210"><span class="hs-identifier hs-var">gas</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><span class="annottext">Gen (TestData era) -&gt; (TestData era -&gt; Expectation) -&gt; Property
forall a prop.
(Show a, Testable prop) =&gt;
Gen a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span>
</span><span id="line-146"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall era. Ratios -&gt; Gen (TestData era)
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#genTestData"><span class="hs-identifier hs-var">genTestData</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686852146"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-147"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#Ratios"><span class="hs-identifier hs-type">Ratios</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">yes :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#yes"><span class="hs-identifier hs-var">yes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Ratio Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">no :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#no"><span class="hs-identifier hs-var">no</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">abstain :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#abstain"><span class="hs-identifier hs-var">abstain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alwaysAbstain :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#alwaysAbstain"><span class="hs-identifier hs-var">alwaysAbstain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">noConfidence :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#noConfidence"><span class="hs-identifier hs-var">noConfidence</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#TestData"><span class="hs-identifier hs-type">TestData</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621686852211"><span id="local-6989586621686852212"><span id="local-6989586621686852213"><span id="local-6989586621686852214"><span id="local-6989586621686852215"><span id="local-6989586621686852216"><span id="local-6989586621686852217"><span id="local-6989586621686852218"><span id="local-6989586621686852219"><span id="local-6989586621686852220"><span id="local-6989586621686852221"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
Map (KeyHash 'StakePool) Vote
Map (Credential 'Staking) DRep
PoolDistr
Coin
CompactForm Coin
distr :: forall era. TestData era -&gt; PoolDistr
votes :: forall era. TestData era -&gt; Map (KeyHash 'StakePool) Vote
totalStake :: forall era. TestData era -&gt; CompactForm Coin
stakeYes :: forall era. TestData era -&gt; Coin
stakeNo :: forall era. TestData era -&gt; Coin
stakeAbstain :: forall era. TestData era -&gt; Coin
stakeAlwaysAbstain :: forall era. TestData era -&gt; Coin
stakeNoConfidence :: forall era. TestData era -&gt; Coin
stakeNotVoted :: forall era. TestData era -&gt; Coin
delegatees :: forall era. TestData era -&gt; Map (Credential 'Staking) DRep
stakePools :: forall era. TestData era -&gt; Map (KeyHash 'StakePool) StakePoolState
distr :: PoolDistr
votes :: Map (KeyHash 'StakePool) Vote
totalStake :: CompactForm Coin
stakeYes :: Coin
stakeNo :: Coin
stakeAbstain :: Coin
stakeAlwaysAbstain :: Coin
stakeNoConfidence :: Coin
stakeNotVoted :: Coin
delegatees :: Map (Credential 'Staking) DRep
stakePools :: Map (KeyHash 'StakePool) StakePoolState
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#distr"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-150"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621686852222"><span class="annot"><span class="annottext">acceptedRatio :: Ratio Integer
</span><a href="#local-6989586621686852222"><span class="hs-identifier hs-var hs-var">acceptedRatio</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-151"></span><span>                    </span><span class="annot"><span class="annottext">forall era.
ConwayEraAccounts era =&gt;
RatifyEnv era -&gt; GovActionState era -&gt; ProtVer -&gt; Ratio Integer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Rules.Ratify.html#spoAcceptedRatio"><span class="hs-identifier hs-var">spoAcceptedRatio</span></a></span><span>
</span><span id="line-152"></span><span>                      </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686852146"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-153"></span><span>                      </span><span class="annot"><span class="annottext">RatifyEnv era
</span><a href="#local-6989586621686852208"><span class="hs-identifier hs-var">re</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#reStakePoolDistr"><span class="hs-identifier hs-var">reStakePoolDistr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621686852211"><span class="hs-identifier hs-type">distr</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-154"></span><span>                      </span><span class="annot"><span class="annottext">GovActionState era
</span><a href="#local-6989586621686852210"><span class="hs-identifier hs-var">gas</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#gasStakePoolVotes"><span class="hs-identifier hs-var">gasStakePoolVotes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621686852212"><span class="hs-identifier hs-type">votes</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-155"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RatifyState era
</span><a href="#local-6989586621686852209"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">RatifyState era
-&gt; Getting ProtVer (RatifyState era) ProtVer -&gt; ProtVer
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EnactState era -&gt; Const ProtVer (EnactState era))
-&gt; RatifyState era -&gt; Const ProtVer (RatifyState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EnactState era -&gt; f (EnactState era))
-&gt; RatifyState era -&gt; f (RatifyState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#rsEnactStateL"><span class="hs-identifier hs-var">rsEnactStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((EnactState era -&gt; Const ProtVer (EnactState era))
 -&gt; RatifyState era -&gt; Const ProtVer (RatifyState era))
-&gt; ((ProtVer -&gt; Const ProtVer ProtVer)
    -&gt; EnactState era -&gt; Const ProtVer (EnactState era))
-&gt; Getting ProtVer (RatifyState era) ProtVer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ProtVer -&gt; Const ProtVer ProtVer)
-&gt; EnactState era -&gt; Const ProtVer (EnactState era)
forall era. EraPParams era =&gt; Lens' (EnactState era) ProtVer
Lens' (EnactState era) ProtVer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#ensProtVerL"><span class="hs-identifier hs-var">ensProtVerL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CompactForm Coin -&gt; Coin
forall a. Compactible a =&gt; CompactForm a -&gt; a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#fromCompact"><span class="hs-identifier hs-var">fromCompact</span></a></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621686852213"><span class="hs-identifier hs-var">totalStake</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-157"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852222"><span class="hs-identifier hs-var">acceptedRatio</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer -&gt; Ratio Integer -&gt; Expectation
forall a. (HasCallStack, Show a, Eq a) =&gt; a -&gt; a -&gt; Expectation
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-expectations-0.8.4-803bfab44be1d57de46c2fd729766b4529923f957d0248f7f06e545b69067993/share/doc/html/src/Test.Hspec.Expectations.html#shouldBe"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-158"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852222"><span class="hs-identifier hs-var">acceptedRatio</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer -&gt; Ratio Integer -&gt; Expectation
forall a. (HasCallStack, Show a, Eq a) =&gt; a -&gt; a -&gt; Expectation
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-expectations-0.8.4-803bfab44be1d57de46c2fd729766b4529923f957d0248f7f06e545b69067993/share/doc/html/src/Test.Hspec.Expectations.html#shouldBe"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-159"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#noConfidenceProp"><span class="hs-identifier hs-type">noConfidenceProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621686852223"><span class="annot"><a href="#local-6989586621686852223"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Conway.Era.html#ConwayEraTest"><span class="hs-identifier hs-type">ConwayEraTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852223"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-core-2.11.13-707e7990f927091784a53f26b416ab321bc8328c835764c4a4c0a3c59ebc02a5/share/doc/html/src/Test.Hspec.Core.Spec.Monad.html#Spec"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-163"></span><span id="noConfidenceProp"><span class="annot"><span class="annottext">noConfidenceProp :: forall era. ConwayEraTest era =&gt; Spec
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#noConfidenceProp"><span class="hs-identifier hs-var hs-var">noConfidenceProp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><span class="annottext">forall prop.
(HasCallStack, Testable prop) =&gt;
String -&gt; prop -&gt; Spec
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-2.11.13-9c3b235a66c4833958c1e584ebb61c2df8b2ee0401136c2810995c1b6a4bd0c5/share/doc/html/src/Test.Hspec.QuickCheck.html#prop"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyEnv"><span class="hs-identifier hs-type">RatifyEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852223"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyState"><span class="hs-identifier hs-type">RatifyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852223"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#GovActionState"><span class="hs-identifier hs-type">GovActionState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686852223"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;If all votes are no confidence, accepted ratio is zero&quot;</span></span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><span class="annottext">(((RatifyEnv era, RatifyState era, GovActionState era) -&gt; Property)
 -&gt; Spec)
-&gt; ((RatifyEnv era, RatifyState era, GovActionState era)
    -&gt; Property)
-&gt; Spec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621686852278"><span class="annot"><span class="annottext">RatifyEnv era
</span><a href="#local-6989586621686852278"><span class="hs-identifier hs-var">re</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852279"><span class="annot"><span class="annottext">RatifyState era
</span><a href="#local-6989586621686852279"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852280"><span class="annot"><span class="annottext">GovActionState era
</span><a href="#local-6989586621686852280"><span class="hs-identifier hs-var">gas</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Gen (TestData era) -&gt; (TestData era -&gt; Expectation) -&gt; Property
forall a prop.
(Show a, Testable prop) =&gt;
Gen a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall era. Ratios -&gt; Gen (TestData era)
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#genTestData"><span class="hs-identifier hs-var">genTestData</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686852223"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-168"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#Ratios"><span class="hs-identifier hs-type">Ratios</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">yes :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#yes"><span class="hs-identifier hs-var">yes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">no :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#no"><span class="hs-identifier hs-var">no</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">abstain :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#abstain"><span class="hs-identifier hs-var">abstain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alwaysAbstain :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#alwaysAbstain"><span class="hs-identifier hs-var">alwaysAbstain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">noConfidence :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#noConfidence"><span class="hs-identifier hs-var">noConfidence</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Ratio Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>      </span><span class="annot"><span class="annottext">((TestData era -&gt; Expectation) -&gt; Property)
-&gt; (TestData era -&gt; Expectation) -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#TestData"><span class="hs-identifier hs-type">TestData</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621686852281"><span id="local-6989586621686852282"><span id="local-6989586621686852283"><span id="local-6989586621686852284"><span id="local-6989586621686852285"><span id="local-6989586621686852286"><span id="local-6989586621686852287"><span id="local-6989586621686852288"><span id="local-6989586621686852289"><span id="local-6989586621686852290"><span id="local-6989586621686852291"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
Map (KeyHash 'StakePool) Vote
Map (Credential 'Staking) DRep
PoolDistr
Coin
CompactForm Coin
distr :: forall era. TestData era -&gt; PoolDistr
votes :: forall era. TestData era -&gt; Map (KeyHash 'StakePool) Vote
totalStake :: forall era. TestData era -&gt; CompactForm Coin
stakeYes :: forall era. TestData era -&gt; Coin
stakeNo :: forall era. TestData era -&gt; Coin
stakeAbstain :: forall era. TestData era -&gt; Coin
stakeAlwaysAbstain :: forall era. TestData era -&gt; Coin
stakeNoConfidence :: forall era. TestData era -&gt; Coin
stakeNotVoted :: forall era. TestData era -&gt; Coin
delegatees :: forall era. TestData era -&gt; Map (Credential 'Staking) DRep
stakePools :: forall era. TestData era -&gt; Map (KeyHash 'StakePool) StakePoolState
distr :: PoolDistr
votes :: Map (KeyHash 'StakePool) Vote
totalStake :: CompactForm Coin
stakeYes :: Coin
stakeNo :: Coin
stakeAbstain :: Coin
stakeAlwaysAbstain :: Coin
stakeNoConfidence :: Coin
stakeNotVoted :: Coin
delegatees :: Map (Credential 'Staking) DRep
stakePools :: Map (KeyHash 'StakePool) StakePoolState
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#distr"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><span class="annottext">forall era.
ConwayEraAccounts era =&gt;
RatifyEnv era -&gt; GovActionState era -&gt; ProtVer -&gt; Ratio Integer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Rules.Ratify.html#spoAcceptedRatio"><span class="hs-identifier hs-var">spoAcceptedRatio</span></a></span><span>
</span><span id="line-172"></span><span>          </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621686852223"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-173"></span><span>          </span><span class="annot"><span class="annottext">RatifyEnv era
</span><a href="#local-6989586621686852278"><span class="hs-identifier hs-var">re</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#reStakePoolDistr"><span class="hs-identifier hs-var">reStakePoolDistr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621686852281"><span class="hs-identifier hs-type">distr</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-174"></span><span>          </span><span class="annot"><span class="annottext">GovActionState era
</span><a href="#local-6989586621686852280"><span class="hs-identifier hs-var">gas</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#gasStakePoolVotes"><span class="hs-identifier hs-var">gasStakePoolVotes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621686852282"><span class="hs-identifier hs-type">votes</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-175"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RatifyState era
</span><a href="#local-6989586621686852279"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">RatifyState era
-&gt; Getting ProtVer (RatifyState era) ProtVer -&gt; ProtVer
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EnactState era -&gt; Const ProtVer (EnactState era))
-&gt; RatifyState era -&gt; Const ProtVer (RatifyState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EnactState era -&gt; f (EnactState era))
-&gt; RatifyState era -&gt; f (RatifyState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#rsEnactStateL"><span class="hs-identifier hs-var">rsEnactStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((EnactState era -&gt; Const ProtVer (EnactState era))
 -&gt; RatifyState era -&gt; Const ProtVer (RatifyState era))
-&gt; ((ProtVer -&gt; Const ProtVer ProtVer)
    -&gt; EnactState era -&gt; Const ProtVer (EnactState era))
-&gt; Getting ProtVer (RatifyState era) ProtVer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ProtVer -&gt; Const ProtVer ProtVer)
-&gt; EnactState era -&gt; Const ProtVer (EnactState era)
forall era. EraPParams era =&gt; Lens' (EnactState era) ProtVer
Lens' (EnactState era) ProtVer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#ensProtVerL"><span class="hs-identifier hs-var">ensProtVerL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>          </span><span class="annot"><span class="annottext">Ratio Integer -&gt; Ratio Integer -&gt; Expectation
forall a. (HasCallStack, Show a, Eq a) =&gt; a -&gt; a -&gt; Expectation
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hspec-expectations-0.8.4-803bfab44be1d57de46c2fd729766b4529923f957d0248f7f06e545b69067993/share/doc/html/src/Test.Hspec.Expectations.html#shouldBe"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-keyword">data</span><span> </span><span id="TestData"><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#TestData"><span class="hs-identifier hs-var">TestData</span></a></span></span><span> </span><span id="local-6989586621686851564"><span class="annot"><a href="#local-6989586621686851564"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TestData"><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#TestData"><span class="hs-identifier hs-var">TestData</span></a></span></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="distr"><span class="annot"><span class="annottext">forall era. TestData era -&gt; PoolDistr
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#distr"><span class="hs-identifier hs-var hs-var">distr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#PoolDistr"><span class="hs-identifier hs-type">PoolDistr</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="votes"><span class="annot"><span class="annottext">forall era. TestData era -&gt; Map (KeyHash 'StakePool) Vote
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#votes"><span class="hs-identifier hs-var hs-var">votes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#Vote"><span class="hs-identifier hs-type">Vote</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="totalStake"><span class="annot"><span class="annottext">forall era. TestData era -&gt; CompactForm Coin
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#totalStake"><span class="hs-identifier hs-var hs-var">totalStake</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#CompactForm"><span class="hs-identifier hs-type">CompactForm</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="stakeYes"><span class="annot"><span class="annottext">forall era. TestData era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#stakeYes"><span class="hs-identifier hs-var hs-var">stakeYes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="stakeNo"><span class="annot"><span class="annottext">forall era. TestData era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#stakeNo"><span class="hs-identifier hs-var hs-var">stakeNo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="stakeAbstain"><span class="annot"><span class="annottext">forall era. TestData era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#stakeAbstain"><span class="hs-identifier hs-var hs-var">stakeAbstain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="stakeAlwaysAbstain"><span class="annot"><span class="annottext">forall era. TestData era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#stakeAlwaysAbstain"><span class="hs-identifier hs-var hs-var">stakeAlwaysAbstain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="stakeNoConfidence"><span class="annot"><span class="annottext">forall era. TestData era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#stakeNoConfidence"><span class="hs-identifier hs-var hs-var">stakeNoConfidence</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="stakeNotVoted"><span class="annot"><span class="annottext">forall era. TestData era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#stakeNotVoted"><span class="hs-identifier hs-var hs-var">stakeNotVoted</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="delegatees"><span class="annot"><span class="annottext">forall era. TestData era -&gt; Map (Credential 'Staking) DRep
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#delegatees"><span class="hs-identifier hs-var hs-var">delegatees</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#DRep"><span class="hs-identifier hs-type">DRep</span></a></span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="stakePools"><span class="annot"><span class="annottext">forall era. TestData era -&gt; Map (KeyHash 'StakePool) StakePoolState
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#stakePools"><span class="hs-identifier hs-var hs-var">stakePools</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#StakePoolState"><span class="hs-identifier hs-type">StakePoolState</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621686852293"><span id="local-6989586621686852317"><span id="local-6989586621686852320"><span class="annot"><span class="annottext">Int -&gt; TestData era -&gt; ShowS
[TestData era] -&gt; ShowS
TestData era -&gt; String
(Int -&gt; TestData era -&gt; ShowS)
-&gt; (TestData era -&gt; String)
-&gt; ([TestData era] -&gt; ShowS)
-&gt; Show (TestData era)
forall era. Int -&gt; TestData era -&gt; ShowS
forall era. [TestData era] -&gt; ShowS
forall era. TestData era -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall era. Int -&gt; TestData era -&gt; ShowS
showsPrec :: Int -&gt; TestData era -&gt; ShowS
$cshow :: forall era. TestData era -&gt; String
show :: TestData era -&gt; String
$cshowList :: forall era. [TestData era] -&gt; ShowS
showList :: [TestData era] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-keyword">data</span><span> </span><span id="Ratios"><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#Ratios"><span class="hs-identifier hs-var">Ratios</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Ratios"><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#Ratios"><span class="hs-identifier hs-var">Ratios</span></a></span></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="yes"><span class="annot"><span class="annottext">Ratios -&gt; Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#yes"><span class="hs-identifier hs-var hs-var">yes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="no"><span class="annot"><span class="annottext">Ratios -&gt; Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#no"><span class="hs-identifier hs-var hs-var">no</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="abstain"><span class="annot"><span class="annottext">Ratios -&gt; Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#abstain"><span class="hs-identifier hs-var hs-var">abstain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="alwaysAbstain"><span class="annot"><span class="annottext">Ratios -&gt; Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#alwaysAbstain"><span class="hs-identifier hs-var hs-var">alwaysAbstain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="noConfidence"><span class="annot"><span class="annottext">Ratios -&gt; Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#noConfidence"><span class="hs-identifier hs-var hs-var">noConfidence</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621686852329"><span id="local-6989586621686852338"><span id="local-6989586621686852341"><span class="annot"><span class="annottext">Int -&gt; Ratios -&gt; ShowS
[Ratios] -&gt; ShowS
Ratios -&gt; String
(Int -&gt; Ratios -&gt; ShowS)
-&gt; (Ratios -&gt; String) -&gt; ([Ratios] -&gt; ShowS) -&gt; Show Ratios
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Ratios -&gt; ShowS
showsPrec :: Int -&gt; Ratios -&gt; ShowS
$cshow :: Ratios -&gt; String
show :: Ratios -&gt; String
$cshowList :: [Ratios] -&gt; ShowS
showList :: [Ratios] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- Prepare the pool distribution, votes, map of pool parameters and map of reward account delegatees</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- according to the given ratios.</span><span>
</span><span id="line-204"></span><span id="local-6989586621686851553"><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#genTestData"><span class="hs-identifier hs-type">genTestData</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#Ratios"><span class="hs-identifier hs-type">Ratios</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#TestData"><span class="hs-identifier hs-type">TestData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686851553"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-207"></span><span id="genTestData"><span class="annot"><span class="annottext">genTestData :: forall era. Ratios -&gt; Gen (TestData era)
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#genTestData"><span class="hs-identifier hs-var hs-var">genTestData</span></a></span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#Ratios"><span class="hs-identifier hs-type">Ratios</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621686852405"><span class="annot"><span class="annottext">Ratio Integer
yes :: Ratios -&gt; Ratio Integer
yes :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#yes"><span class="hs-identifier hs-var hs-var">yes</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852406"><span class="annot"><span class="annottext">Ratio Integer
no :: Ratios -&gt; Ratio Integer
no :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#no"><span class="hs-identifier hs-var hs-var">no</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852407"><span class="annot"><span class="annottext">Ratio Integer
abstain :: Ratios -&gt; Ratio Integer
abstain :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#abstain"><span class="hs-identifier hs-var hs-var">abstain</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852408"><span class="annot"><span class="annottext">Ratio Integer
alwaysAbstain :: Ratios -&gt; Ratio Integer
alwaysAbstain :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#alwaysAbstain"><span class="hs-identifier hs-var hs-var">alwaysAbstain</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852409"><span class="annot"><span class="annottext">Ratio Integer
noConfidence :: Ratios -&gt; Ratio Integer
noConfidence :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#noConfidence"><span class="hs-identifier hs-var hs-var">noConfidence</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-208"></span><span>  </span><span id="local-6989586621686852410"><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852410"><span class="hs-identifier hs-var">pools</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (KeyHash 'StakePool) -&gt; Gen [KeyHash 'StakePool]
forall a. Gen a -&gt; Gen [a]
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#listOf"><span class="hs-identifier hs-var">listOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Arbitrary a =&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621686852413"><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852413"><span class="hs-identifier hs-var">poolsYes</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852414"><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852414"><span class="hs-identifier hs-var">poolsNo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852415"><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852415"><span class="hs-identifier hs-var">poolsAbstain</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852416"><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852416"><span class="hs-identifier hs-var">poolsAlwaysAbstain</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852417"><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852417"><span class="hs-identifier hs-var">poolsNoConfidence</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852418"><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852418"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-210"></span><span>        </span><span class="annot"><span class="annottext">Ratio Integer
-&gt; Ratio Integer
-&gt; Ratio Integer
-&gt; Ratio Integer
-&gt; Ratio Integer
-&gt; [KeyHash 'StakePool]
-&gt; ([KeyHash 'StakePool], [KeyHash 'StakePool],
    [KeyHash 'StakePool], [KeyHash 'StakePool], [KeyHash 'StakePool],
    [KeyHash 'StakePool])
forall a.
Ratio Integer
-&gt; Ratio Integer
-&gt; Ratio Integer
-&gt; Ratio Integer
-&gt; Ratio Integer
-&gt; [a]
-&gt; ([a], [a], [a], [a], [a], [a])
</span><a href="#local-6989586621686852419"><span class="hs-identifier hs-var">splitByPct</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852405"><span class="hs-identifier hs-var">yes</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852406"><span class="hs-identifier hs-var">no</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852407"><span class="hs-identifier hs-var">abstain</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852408"><span class="hs-identifier hs-var">alwaysAbstain</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852409"><span class="hs-identifier hs-var">noConfidence</span></a></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852410"><span class="hs-identifier hs-var">pools</span></a></span><span>
</span><span id="line-211"></span><span>      </span><span id="local-6989586621686852420"><span class="annot"><span class="annottext">totalStake :: Int
</span><a href="#local-6989586621686852420"><span class="hs-identifier hs-var hs-var">totalStake</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852410"><span class="hs-identifier hs-var">pools</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span id="local-6989586621686852422"><span class="annot"><span class="annottext">PoolDistr
</span><a href="#local-6989586621686852422"><span class="hs-identifier hs-var">distr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621686852423"><span class="annot"><span class="annottext">VRFVerKeyHash 'StakePoolVRF
</span><a href="#local-6989586621686852423"><span class="hs-identifier hs-var">vrf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (VRFVerKeyHash 'StakePoolVRF)
forall a. Arbitrary a =&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-215"></span><span>      </span><span id="local-6989586621686852424"><span class="annot"><span class="annottext">indivStake :: IndividualPoolStake
</span><a href="#local-6989586621686852424"><span class="hs-identifier hs-var hs-var">indivStake</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
-&gt; CompactForm Coin
-&gt; VRFVerKeyHash 'StakePoolVRF
-&gt; IndividualPoolStake
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#IndividualPoolStake"><span class="hs-identifier hs-var">IndividualPoolStake</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ratio Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Ratio Integer -&gt; Ratio Integer -&gt; Ratio Integer
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Ratio Integer
forall a. Real a =&gt; a -&gt; Ratio Integer
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621686852420"><span class="hs-identifier hs-var">totalStake</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; CompactForm Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#CompactCoin"><span class="hs-identifier hs-var">CompactCoin</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VRFVerKeyHash 'StakePoolVRF
</span><a href="#local-6989586621686852423"><span class="hs-identifier hs-var">vrf</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="annottext">PoolDistr -&gt; Gen PoolDistr
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PoolDistr -&gt; Gen PoolDistr) -&gt; PoolDistr -&gt; Gen PoolDistr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) IndividualPoolStake
-&gt; CompactForm Coin -&gt; PoolDistr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#PoolDistr"><span class="hs-identifier hs-var">PoolDistr</span></a></span><span>
</span><span id="line-218"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[([KeyHash 'StakePool], IndividualPoolStake)]
-&gt; Map (KeyHash 'StakePool) IndividualPoolStake
forall a. [([KeyHash 'StakePool], a)] -&gt; Map (KeyHash 'StakePool) a
</span><a href="#local-6989586621686852428"><span class="hs-identifier hs-var">unionAllFromLists</span></a></span><span>
</span><span id="line-219"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852413"><span class="hs-identifier hs-var">poolsYes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake
</span><a href="#local-6989586621686852424"><span class="hs-identifier hs-var">indivStake</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852414"><span class="hs-identifier hs-var">poolsNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake
</span><a href="#local-6989586621686852424"><span class="hs-identifier hs-var">indivStake</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852415"><span class="hs-identifier hs-var">poolsAbstain</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake
</span><a href="#local-6989586621686852424"><span class="hs-identifier hs-var">indivStake</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852416"><span class="hs-identifier hs-var">poolsAlwaysAbstain</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake
</span><a href="#local-6989586621686852424"><span class="hs-identifier hs-var">indivStake</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852417"><span class="hs-identifier hs-var">poolsNoConfidence</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake
</span><a href="#local-6989586621686852424"><span class="hs-identifier hs-var">indivStake</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; CompactForm Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#CompactCoin"><span class="hs-identifier hs-var">CompactCoin</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; CompactForm Coin) -&gt; Word64 -&gt; CompactForm Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621686852420"><span class="hs-identifier hs-var">totalStake</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span>  </span><span id="local-6989586621686852429"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621686852429"><span class="hs-identifier hs-var">poolStateAA</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
-&gt; Gen (Map (KeyHash 'StakePool) StakePoolState)
forall {f :: * -&gt; *} {k} {a}.
(Foldable f, Ord k, Arbitrary a) =&gt;
f k -&gt; Gen (Map k a)
</span><a href="#local-6989586621686852430"><span class="hs-identifier hs-var">genPoolState</span></a></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852416"><span class="hs-identifier hs-var">poolsAlwaysAbstain</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span id="local-6989586621686852431"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621686852431"><span class="hs-identifier hs-var">poolStateNC</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
-&gt; Gen (Map (KeyHash 'StakePool) StakePoolState)
forall {f :: * -&gt; *} {k} {a}.
(Foldable f, Ord k, Arbitrary a) =&gt;
f k -&gt; Gen (Map k a)
</span><a href="#local-6989586621686852430"><span class="hs-identifier hs-var">genPoolState</span></a></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852417"><span class="hs-identifier hs-var">poolsNoConfidence</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621686852432"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621686852432"><span class="hs-identifier hs-var">poolStateRest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
-&gt; Gen (Map (KeyHash 'StakePool) StakePoolState)
forall {f :: * -&gt; *} {k} {a}.
(Foldable f, Ord k, Arbitrary a) =&gt;
f k -&gt; Gen (Map k a)
</span><a href="#local-6989586621686852430"><span class="hs-identifier hs-var">genPoolState</span></a></span><span> </span><span class="annot"><span class="annottext">([KeyHash 'StakePool]
 -&gt; Gen (Map (KeyHash 'StakePool) StakePoolState))
-&gt; [KeyHash 'StakePool]
-&gt; Gen (Map (KeyHash 'StakePool) StakePoolState)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852413"><span class="hs-identifier hs-var">poolsYes</span></a></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
-&gt; [KeyHash 'StakePool] -&gt; [KeyHash 'StakePool]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852414"><span class="hs-identifier hs-var">poolsNo</span></a></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
-&gt; [KeyHash 'StakePool] -&gt; [KeyHash 'StakePool]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852415"><span class="hs-identifier hs-var">poolsAbstain</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621686852433"><span class="annot"><span class="annottext">delegateesAA :: Map (Credential 'Staking) DRep
</span><a href="#local-6989586621686852433"><span class="hs-identifier hs-var hs-var">delegateesAA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DRep
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (Credential 'Staking) DRep
</span><a href="#local-6989586621686852434"><span class="hs-identifier hs-var">mkDelegatees</span></a></span><span> </span><span class="annot"><span class="annottext">DRep
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#DRepAlwaysAbstain"><span class="hs-identifier hs-var">DRepAlwaysAbstain</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621686852429"><span class="hs-identifier hs-var">poolStateAA</span></a></span><span>
</span><span id="line-232"></span><span>      </span><span id="local-6989586621686852436"><span class="annot"><span class="annottext">delegateesNC :: Map (Credential 'Staking) DRep
</span><a href="#local-6989586621686852436"><span class="hs-identifier hs-var hs-var">delegateesNC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DRep
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (Credential 'Staking) DRep
</span><a href="#local-6989586621686852434"><span class="hs-identifier hs-var">mkDelegatees</span></a></span><span> </span><span class="annot"><span class="annottext">DRep
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#DRepAlwaysNoConfidence"><span class="hs-identifier hs-var">DRepAlwaysNoConfidence</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621686852431"><span class="hs-identifier hs-var">poolStateNC</span></a></span><span>
</span><span id="line-233"></span><span>      </span><span id="local-6989586621686852438"><span class="annot"><span class="annottext">votes :: Map (KeyHash 'StakePool) Vote
</span><a href="#local-6989586621686852438"><span class="hs-identifier hs-var hs-var">votes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[([KeyHash 'StakePool], Vote)] -&gt; Map (KeyHash 'StakePool) Vote
forall a. [([KeyHash 'StakePool], a)] -&gt; Map (KeyHash 'StakePool) a
</span><a href="#local-6989586621686852428"><span class="hs-identifier hs-var">unionAllFromLists</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852413"><span class="hs-identifier hs-var">poolsYes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vote
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#VoteYes"><span class="hs-identifier hs-var">VoteYes</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852414"><span class="hs-identifier hs-var">poolsNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vote
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#VoteNo"><span class="hs-identifier hs-var">VoteNo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852415"><span class="hs-identifier hs-var">poolsAbstain</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vote
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#Abstain"><span class="hs-identifier hs-var">Abstain</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="annottext">TestData era -&gt; Gen (TestData era)
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#TestData"><span class="hs-identifier hs-type">TestData</span></a></span><span>
</span><span id="line-237"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">PoolDistr
distr :: PoolDistr
distr :: PoolDistr
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#distr"><span class="hs-identifier hs-var hs-var">distr</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) Vote
votes :: Map (KeyHash 'StakePool) Vote
votes :: Map (KeyHash 'StakePool) Vote
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#votes"><span class="hs-identifier hs-var hs-var">votes</span></a></span><span>
</span><span id="line-239"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">totalStake :: CompactForm Coin
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#totalStake"><span class="hs-identifier hs-var">totalStake</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PoolDistr -&gt; CompactForm Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#pdTotalActiveStake"><span class="hs-identifier hs-var">pdTotalActiveStake</span></a></span><span> </span><span class="annot"><span class="annottext">PoolDistr
</span><a href="#local-6989586621686852422"><span class="hs-identifier hs-var">distr</span></a></span><span>
</span><span id="line-240"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stakeYes :: Coin
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#stakeYes"><span class="hs-identifier hs-var">stakeYes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Coin) -&gt; (Int -&gt; Integer) -&gt; Int -&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Coin) -&gt; Int -&gt; Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852413"><span class="hs-identifier hs-var">poolsYes</span></a></span><span>
</span><span id="line-241"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stakeNo :: Coin
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#stakeNo"><span class="hs-identifier hs-var">stakeNo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Coin) -&gt; (Int -&gt; Integer) -&gt; Int -&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Coin) -&gt; Int -&gt; Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852414"><span class="hs-identifier hs-var">poolsNo</span></a></span><span>
</span><span id="line-242"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stakeAbstain :: Coin
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#stakeAbstain"><span class="hs-identifier hs-var">stakeAbstain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Coin) -&gt; (Int -&gt; Integer) -&gt; Int -&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Coin) -&gt; Int -&gt; Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852415"><span class="hs-identifier hs-var">poolsAbstain</span></a></span><span>
</span><span id="line-243"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stakeAlwaysAbstain :: Coin
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#stakeAlwaysAbstain"><span class="hs-identifier hs-var">stakeAlwaysAbstain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Coin) -&gt; (Int -&gt; Integer) -&gt; Int -&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Coin) -&gt; Int -&gt; Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852416"><span class="hs-identifier hs-var">poolsAlwaysAbstain</span></a></span><span>
</span><span id="line-244"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stakeNoConfidence :: Coin
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#stakeNoConfidence"><span class="hs-identifier hs-var">stakeNoConfidence</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Coin) -&gt; (Int -&gt; Integer) -&gt; Int -&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Coin) -&gt; Int -&gt; Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852417"><span class="hs-identifier hs-var">poolsNoConfidence</span></a></span><span>
</span><span id="line-245"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stakeNotVoted :: Coin
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#stakeNotVoted"><span class="hs-identifier hs-var">stakeNotVoted</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Coin) -&gt; (Int -&gt; Integer) -&gt; Int -&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Coin) -&gt; Int -&gt; Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852418"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-246"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">delegatees :: Map (Credential 'Staking) DRep
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#delegatees"><span class="hs-identifier hs-var">delegatees</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) DRep
-&gt; Map (Credential 'Staking) DRep -&gt; Map (Credential 'Staking) DRep
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.union</span></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) DRep
</span><a href="#local-6989586621686852433"><span class="hs-identifier hs-var">delegateesAA</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) DRep
</span><a href="#local-6989586621686852436"><span class="hs-identifier hs-var">delegateesNC</span></a></span><span>
</span><span id="line-247"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stakePools :: Map (KeyHash 'StakePool) StakePoolState
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#stakePools"><span class="hs-identifier hs-var">stakePools</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Map (KeyHash 'StakePool) StakePoolState]
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
f (Map k a) -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.unions</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621686852432"><span class="hs-identifier hs-var">poolStateRest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621686852429"><span class="hs-identifier hs-var">poolStateAA</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621686852431"><span class="hs-identifier hs-var">poolStateNC</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-248"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-250"></span><span>    </span><span id="local-6989586621686851637"><span class="annot"><a href="#local-6989586621686852419"><span class="hs-identifier hs-type">splitByPct</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-251"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-252"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-254"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-255"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-256"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621686851637"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-257"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621686851637"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621686851637"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621686851637"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621686851637"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621686851637"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621686851637"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621686852419"><span class="annot"><span class="annottext">splitByPct :: forall a.
Ratio Integer
-&gt; Ratio Integer
-&gt; Ratio Integer
-&gt; Ratio Integer
-&gt; Ratio Integer
-&gt; [a]
-&gt; ([a], [a], [a], [a], [a], [a])
</span><a href="#local-6989586621686852419"><span class="hs-identifier hs-var hs-var">splitByPct</span></a></span></span><span> </span><span id="local-6989586621686852464"><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852464"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span id="local-6989586621686852465"><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852465"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span id="local-6989586621686852466"><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852466"><span class="hs-identifier hs-var">r3</span></a></span></span><span> </span><span id="local-6989586621686852467"><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852467"><span class="hs-identifier hs-var">r4</span></a></span></span><span> </span><span id="local-6989586621686852468"><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852468"><span class="hs-identifier hs-var">r5</span></a></span></span><span> </span><span id="local-6989586621686852469"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852469"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-259"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-260"></span><span>        </span><span id="local-6989586621686852470"><span class="annot"><span class="annottext">size :: Ratio Integer
</span><a href="#local-6989586621686852470"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Ratio Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Ratio Integer) -&gt; Int -&gt; Ratio Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852469"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-261"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621686852471"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852471"><span class="hs-identifier hs-var">rs1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852472"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852472"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ratio Integer -&gt; Int
forall b. Integral b =&gt; Ratio Integer -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">ceiling</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852464"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer -&gt; Ratio Integer -&gt; Ratio Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852470"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852469"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-262"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621686852476"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852476"><span class="hs-identifier hs-var">rs2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852477"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852477"><span class="hs-identifier hs-var">rest'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ratio Integer -&gt; Int
forall b. Integral b =&gt; Ratio Integer -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">ceiling</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852465"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer -&gt; Ratio Integer -&gt; Ratio Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852470"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852472"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-263"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621686852478"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852478"><span class="hs-identifier hs-var">rs3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852479"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852479"><span class="hs-identifier hs-var">rest''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ratio Integer -&gt; Int
forall b. Integral b =&gt; Ratio Integer -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">ceiling</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852466"><span class="hs-identifier hs-var">r3</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer -&gt; Ratio Integer -&gt; Ratio Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852470"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852477"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-264"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621686852480"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852480"><span class="hs-identifier hs-var">rs4</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852481"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852481"><span class="hs-identifier hs-var">rest'''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ratio Integer -&gt; Int
forall b. Integral b =&gt; Ratio Integer -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">ceiling</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852467"><span class="hs-identifier hs-var">r4</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer -&gt; Ratio Integer -&gt; Ratio Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852470"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852479"><span class="hs-identifier hs-var">rest''</span></a></span><span>
</span><span id="line-265"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621686852482"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852482"><span class="hs-identifier hs-var">rs5</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852483"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852483"><span class="hs-identifier hs-var">rest''''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ratio Integer -&gt; Int
forall b. Integral b =&gt; Ratio Integer -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">ceiling</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852468"><span class="hs-identifier hs-var">r5</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Integer -&gt; Ratio Integer -&gt; Ratio Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852470"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852481"><span class="hs-identifier hs-var">rest'''</span></a></span><span>
</span><span id="line-266"></span><span>       </span><span class="hs-keyword">in</span><span>
</span><span id="line-267"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852471"><span class="hs-identifier hs-var">rs1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852476"><span class="hs-identifier hs-var">rs2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852478"><span class="hs-identifier hs-var">rs3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852480"><span class="hs-identifier hs-var">rs4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852482"><span class="hs-identifier hs-var">rs5</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621686852483"><span class="hs-identifier hs-var">rest''''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621686852430"><span class="annot"><span class="annottext">genPoolState :: f k -&gt; Gen (Map k a)
</span><a href="#local-6989586621686852430"><span class="hs-identifier hs-var hs-var">genPoolState</span></a></span></span><span> </span><span id="local-6989586621686852496"><span class="annot"><span class="annottext">f k
</span><a href="#local-6989586621686852496"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k (Gen a) -&gt; Gen (Map k a)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; Map k (m a) -&gt; m (Map k a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">(Map k (Gen a) -&gt; Gen (Map k a)) -&gt; Map k (Gen a) -&gt; Gen (Map k a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(k -&gt; Gen a) -&gt; f k -&gt; Map k (Gen a)
forall (f :: * -&gt; *) k v.
(Foldable f, Ord k) =&gt;
(k -&gt; v) -&gt; f k -&gt; Map k v
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.MapExtras.html#fromKeys"><span class="hs-identifier hs-var">fromKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gen a -&gt; k -&gt; Gen a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Gen a
forall a. Arbitrary a =&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k
</span><a href="#local-6989586621686852496"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-comment">-- Given a delegatee and a map of stake pool params,</span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-comment">-- create a map of reward account delegatees.</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><a href="#local-6989586621686852434"><span class="hs-identifier hs-type">mkDelegatees</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-274"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#DRep"><span class="hs-identifier hs-type">DRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-275"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#StakePoolState"><span class="hs-identifier hs-type">StakePoolState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-276"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#DRep"><span class="hs-identifier hs-type">DRep</span></a></span><span>
</span><span id="line-277"></span><span>    </span><span id="local-6989586621686852434"><span class="annot"><span class="annottext">mkDelegatees :: DRep
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (Credential 'Staking) DRep
</span><a href="#local-6989586621686852434"><span class="hs-identifier hs-var hs-var">mkDelegatees</span></a></span></span><span> </span><span id="local-6989586621686852499"><span class="annot"><span class="annottext">DRep
</span><a href="#local-6989586621686852499"><span class="hs-identifier hs-var">drep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-278"></span><span>      </span><span class="annot"><span class="annottext">(Credential 'Staking -&gt; DRep)
-&gt; [Credential 'Staking] -&gt; Map (Credential 'Staking) DRep
forall (f :: * -&gt; *) k v.
(Foldable f, Ord k) =&gt;
(k -&gt; v) -&gt; f k -&gt; Map k v
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.MapExtras.html#fromKeys"><span class="hs-identifier hs-var">fromKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DRep -&gt; Credential 'Staking -&gt; DRep
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">DRep
</span><a href="#local-6989586621686852499"><span class="hs-identifier hs-var">drep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Credential 'Staking] -&gt; Map (Credential 'Staking) DRep)
-&gt; (Map (KeyHash 'StakePool) StakePoolState
    -&gt; [Credential 'Staking])
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (Credential 'Staking) DRep
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(StakePoolState -&gt; Credential 'Staking)
-&gt; [StakePoolState] -&gt; [Credential 'Staking]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RewardAccount -&gt; Credential 'Staking
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#raCredential"><span class="hs-identifier hs-var">raCredential</span></a></span><span> </span><span class="annot"><span class="annottext">(RewardAccount -&gt; Credential 'Staking)
-&gt; (StakePoolState -&gt; RewardAccount)
-&gt; StakePoolState
-&gt; Credential 'Staking
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StakePoolState -&gt; RewardAccount
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#spsRewardAccount"><span class="hs-identifier hs-var">spsRewardAccount</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([StakePoolState] -&gt; [Credential 'Staking])
-&gt; (Map (KeyHash 'StakePool) StakePoolState -&gt; [StakePoolState])
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; [Credential 'Staking]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState -&gt; [StakePoolState]
forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-comment">-- Create a map from each pool with the given value, where the key is the pool credential</span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-comment">-- and take the union of all these maps.</span><span>
</span><span id="line-282"></span><span>    </span><span id="local-6989586621686851644"><span class="annot"><a href="#local-6989586621686852428"><span class="hs-identifier hs-type">unionAllFromLists</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-283"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621686851644"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-284"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621686851644"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-285"></span><span>    </span><span id="local-6989586621686852428"><span class="annot"><span class="annottext">unionAllFromLists :: forall a. [([KeyHash 'StakePool], a)] -&gt; Map (KeyHash 'StakePool) a
</span><a href="#local-6989586621686852428"><span class="hs-identifier hs-var hs-var">unionAllFromLists</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([KeyHash 'StakePool], a) -&gt; Map (KeyHash 'StakePool) a)
-&gt; [([KeyHash 'StakePool], a)] -&gt; Map (KeyHash 'StakePool) a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621686852509"><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852509"><span class="hs-identifier hs-var">ks</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852510"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621686852510"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(KeyHash 'StakePool -&gt; a)
-&gt; [KeyHash 'StakePool] -&gt; Map (KeyHash 'StakePool) a
forall (f :: * -&gt; *) k v.
(Foldable f, Ord k) =&gt;
(k -&gt; v) -&gt; f k -&gt; Map k v
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.MapExtras.html#fromKeys"><span class="hs-identifier hs-var">fromKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; KeyHash 'StakePool -&gt; a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621686852510"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621686852509"><span class="hs-identifier hs-var">ks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#genRatios"><span class="hs-identifier hs-type">genRatios</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#Ratios"><span class="hs-identifier hs-type">Ratios</span></a></span><span>
</span><span id="line-288"></span><span id="genRatios"><span class="annot"><span class="annottext">genRatios :: Gen Ratios
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#genRatios"><span class="hs-identifier hs-var hs-var">genRatios</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621686852511"><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852511"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852512"><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852512"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852513"><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852513"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852514"><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852514"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621686852515"><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852515"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen
  (Ratio Integer, Ratio Integer, Ratio Integer, Ratio Integer,
   Ratio Integer)
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#genPctsOf100"><span class="hs-identifier hs-var">genPctsOf100</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><span class="annottext">Ratios -&gt; Gen Ratios
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Ratios -&gt; Gen Ratios) -&gt; Ratios -&gt; Gen Ratios
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#Ratios"><span class="hs-identifier hs-type">Ratios</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">yes :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#yes"><span class="hs-identifier hs-var">yes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852511"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">no :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#no"><span class="hs-identifier hs-var">no</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852512"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">abstain :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#abstain"><span class="hs-identifier hs-var">abstain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852513"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alwaysAbstain :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#alwaysAbstain"><span class="hs-identifier hs-var">alwaysAbstain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852514"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">noConfidence :: Ratio Integer
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#noConfidence"><span class="hs-identifier hs-var">noConfidence</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer
</span><a href="#local-6989586621686852515"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-comment">-- Generates rational values for voting ratios.</span><span>
</span><span id="line-293"></span><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#genPctsOf100"><span class="hs-identifier hs-type">genPctsOf100</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span id="genPctsOf100"><span class="annot"><span class="annottext">genPctsOf100 :: Gen
  (Ratio Integer, Ratio Integer, Ratio Integer, Ratio Integer,
   Ratio Integer)
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#genPctsOf100"><span class="hs-identifier hs-var hs-var">genPctsOf100</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-295"></span><span>  </span><span id="local-6989586621686852517"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852517"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; Gen Integer
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>  </span><span id="local-6989586621686852519"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852519"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; Gen Integer
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>  </span><span id="local-6989586621686852520"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852520"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; Gen Integer
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>  </span><span id="local-6989586621686852521"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852521"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; Gen Integer
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>  </span><span id="local-6989586621686852522"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852522"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; Gen Integer
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>  </span><span id="local-6989586621686852523"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852523"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; Gen Integer
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- stake that didn't participate</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621686852524"><span class="annot"><span class="annottext">s :: Integer
</span><a href="#local-6989586621686852524"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852517"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852519"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852520"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852521"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852522"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852523"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><span class="annottext">(Ratio Integer, Ratio Integer, Ratio Integer, Ratio Integer,
 Ratio Integer)
-&gt; Gen
     (Ratio Integer, Ratio Integer, Ratio Integer, Ratio Integer,
      Ratio Integer)
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852517"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Ratio Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852524"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852519"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Ratio Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852524"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852520"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Ratio Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852524"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852521"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Ratio Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852524"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852522"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Ratio Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621686852524"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span id="local-6989586621686851577"><span class="annot"><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#accountsFromDelegatees"><span class="hs-identifier hs-type">accountsFromDelegatees</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/l/testlib/doc/html/cardano-ledger-shelley/src/Test.Cardano.Ledger.Shelley.Era.html#ShelleyEraTest"><span class="hs-identifier hs-type">ShelleyEraTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686851577"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#DRep"><span class="hs-identifier hs-type">DRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#Accounts"><span class="hs-identifier hs-type">Accounts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621686851577"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-305"></span><span id="accountsFromDelegatees"><span class="annot"><span class="annottext">accountsFromDelegatees :: forall era.
ShelleyEraTest era =&gt;
Map (Credential 'Staking) DRep -&gt; Accounts era
</span><a href="Test.Cardano.Ledger.Conway.SPORatifySpec.html#accountsFromDelegatees"><span class="hs-identifier hs-var hs-var">accountsFromDelegatees</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><span class="annottext">(Credential 'Staking -&gt; DRep -&gt; Accounts era -&gt; Accounts era)
-&gt; Accounts era -&gt; Map (Credential 'Staking) DRep -&gt; Accounts era
forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><span class="hs-identifier hs-var">Map.foldrWithKey'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621686852539"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621686852539"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span id="local-6989586621686852540"><span class="annot"><span class="annottext">DRep
</span><a href="#local-6989586621686852540"><span class="hs-identifier hs-var">drep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
-&gt; Maybe Ptr
-&gt; CompactForm Coin
-&gt; Maybe (KeyHash 'StakePool)
-&gt; Maybe DRep
-&gt; Accounts era
-&gt; Accounts era
forall era.
(HasCallStack, EraTest era) =&gt;
Credential 'Staking
-&gt; Maybe Ptr
-&gt; CompactForm Coin
-&gt; Maybe (KeyHash 'StakePool)
-&gt; Maybe DRep
-&gt; Accounts era
-&gt; Accounts era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Era.html#registerTestAccount"><span class="hs-identifier hs-var">registerTestAccount</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621686852539"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Ptr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Maybe (KeyHash 'StakePool)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DRep -&gt; Maybe DRep
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">DRep
</span><a href="#local-6989586621686852540"><span class="hs-identifier hs-var">drep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Accounts era
forall a. Default a =&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/data-default-0.8.0.1-9291b190c5bc542cf17f99ce44e9365d143d76b9889465ad3d362701e6cc609e/share/doc/html/src/Data.Default.Internal.html#def"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-307"></span></pre></body></html>