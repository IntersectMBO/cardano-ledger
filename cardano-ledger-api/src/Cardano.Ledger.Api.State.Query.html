<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Ledger.Api.State.Query</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetFilteredDelegationsAndRewardAccounts@</span></span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryStakePoolDelegsAndRewards"><span class="hs-identifier">queryStakePoolDelegsAndRewards</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetGovState@</span></span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryGovState"><span class="hs-identifier">queryGovState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetConstitution@</span></span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryConstitution"><span class="hs-identifier">queryConstitution</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetConstitutionHash@</span></span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryConstitutionHash"><span class="hs-identifier">queryConstitutionHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetDRepState@</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryDRepState"><span class="hs-identifier">queryDRepState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetDRepDelegations@</span></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryDRepDelegations"><span class="hs-identifier">queryDRepDelegations</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetDRepStakeDistr@</span></span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryDRepStakeDistr"><span class="hs-identifier">queryDRepStakeDistr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetRegisteredDRepStakeDistr@</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryRegisteredDRepStakeDistr"><span class="hs-identifier">queryRegisteredDRepStakeDistr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetSPOStakeDistr@</span></span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#querySPOStakeDistr"><span class="hs-identifier">querySPOStakeDistr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetCommitteeState@</span></span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryCommitteeState"><span class="hs-identifier">queryCommitteeState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetCommitteeMembersState@</span></span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryCommitteeMembersState"><span class="hs-identifier">queryCommitteeMembersState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetChainAccountState@</span></span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryChainAccountState"><span class="hs-identifier">queryChainAccountState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#CommitteeMemberState"><span class="hs-identifier">CommitteeMemberState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#CommitteeMembersState"><span class="hs-identifier">CommitteeMembersState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#HotCredAuthStatus"><span class="hs-identifier">HotCredAuthStatus</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#MemberStatus"><span class="hs-identifier">MemberStatus</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#NextEpochChange"><span class="hs-identifier">NextEpochChange</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetCurrentPParams@</span></span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryCurrentPParams"><span class="hs-identifier">queryCurrentPParams</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetFuturePParams@</span></span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryFuturePParams"><span class="hs-identifier">queryFuturePParams</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetProposals@</span></span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryProposals"><span class="hs-identifier">queryProposals</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetRatifyState@</span></span><span>
</span><span id="line-64"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryRatifyState"><span class="hs-identifier">queryRatifyState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetStakePoolDefaultVote@</span></span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryStakePoolDefaultVote"><span class="hs-identifier">queryStakePoolDefaultVote</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#DefaultVote"><span class="hs-identifier">DefaultVote</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @GetPoolState@</span></span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryPoolParameters"><span class="hs-identifier">queryPoolParameters</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryPoolState"><span class="hs-identifier">queryPoolState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#QueryPoolStateResult"><span class="hs-identifier">QueryPoolStateResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#mkQueryPoolStateResult"><span class="hs-identifier">mkQueryPoolStateResult</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><span class="hs-comment">-- * For testing</span></span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#getNextEpochCommitteeMembers"><span class="hs-identifier">getNextEpochCommitteeMembers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html"><span class="hs-identifier">Cardano.Ledger.Api.State.Query.CommitteeMembersState</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#CommitteeMemberState"><span class="hs-identifier">CommitteeMemberState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#CommitteeMembersState"><span class="hs-identifier">CommitteeMembersState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#HotCredAuthStatus"><span class="hs-identifier">HotCredAuthStatus</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#MemberStatus"><span class="hs-identifier">MemberStatus</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#NextEpochChange"><span class="hs-identifier">NextEpochChange</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html"><span class="hs-identifier">Cardano.Ledger.BaseTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier">EpochNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#strictMaybeToMaybe"><span class="hs-identifier">strictMaybeToMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/doc/html/cardano-ledger-binary/src/Cardano.Ledger.Binary.html"><span class="hs-identifier">Cardano.Ledger.Binary</span></a></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html"><span class="hs-identifier">Cardano.Ledger.Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#CompactForm"><span class="hs-identifier">CompactForm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html"><span class="hs-identifier">Cardano.Ledger.Compactible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#fromCompact"><span class="hs-identifier">fromCompact</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html"><span class="hs-identifier">Cardano.Ledger.Conway.Governance</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#Committee"><span class="hs-identifier">Committee</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#committeeMembers"><span class="hs-identifier">committeeMembers</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#Constitution"><span class="hs-identifier">Constitution</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#constitutionAnchor"><span class="hs-identifier">constitutionAnchor</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#ConwayEraGov"><span class="hs-identifier">ConwayEraGov</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.DRepPulser.html#DRepPulser"><span class="hs-identifier">DRepPulser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.DRepPulser.html#DRepPulsingState"><span class="hs-identifier">DRepPulsingState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#DefaultVote"><span class="hs-identifier">DefaultVote</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#GovActionId"><span class="hs-identifier">GovActionId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#GovActionState"><span class="hs-identifier">GovActionState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.DRepPulser.html#PulsingSnapshot"><span class="hs-identifier">PulsingSnapshot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyState"><span class="hs-identifier">RatifyState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#committeeThresholdL"><span class="hs-identifier">committeeThresholdL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#defaultStakePoolVote"><span class="hs-identifier">defaultStakePoolVote</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#ensCommitteeL"><span class="hs-identifier">ensCommitteeL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.DRepPulser.html#finishDRepPulser"><span class="hs-identifier">finishDRepPulser</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Proposals.html#proposalsDeposits"><span class="hs-identifier">proposalsDeposits</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.DRepPulser.html#psDRepDistr"><span class="hs-identifier">psDRepDistr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.DRepPulser.html#psPoolDistr"><span class="hs-identifier">psPoolDistr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.DRepPulser.html#psProposalsL"><span class="hs-identifier">psProposalsL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#rsEnactStateL"><span class="hs-identifier">rsEnactStateL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Rules.html"><span class="hs-identifier">Cardano.Ledger.Conway.Rules</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Rules.Certs.html#updateDormantDRepExpiry"><span class="hs-identifier">updateDormantDRepExpiry</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.html"><span class="hs-identifier">Cardano.Ledger.Conway.State</span></a></span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html"><span class="hs-identifier">Cardano.Ledger.Core</span></a></span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html"><span class="hs-identifier">Cardano.Ledger.Credential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier">Credential</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html"><span class="hs-identifier">Cardano.Ledger.DRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#credToDRep"><span class="hs-identifier">credToDRep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#dRepToCred"><span class="hs-identifier">dRepToCred</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.html"><span class="hs-identifier">Cardano.Ledger.Shelley.LedgerState</span></a></span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">guard</span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldMap'</span></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Seq</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-125"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html"><span class="hs-identifier">Data.Sequence.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html#StrictSeq"><span class="hs-identifier">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html"><span class="hs-identifier">Lens.Micro</span></a></span><span>
</span><span id="line-129"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Extras.html"><span class="hs-identifier">Lens.Micro.Extras</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Extras.html#view"><span class="hs-identifier">view</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><span class="hs-comment">-- | Implementation for @GetFilteredDelegationsAndRewardAccounts@ query.</span></span><span>
</span><span id="line-132"></span><span id="local-6989586621679316407"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryStakePoolDelegsAndRewards"><span class="hs-identifier hs-type">queryStakePoolDelegsAndRewards</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-133"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#EraCertState"><span class="hs-identifier hs-type">EraCertState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316407"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316407"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-special">)</span></span><span>
</span><span id="line-139"></span><span id="queryStakePoolDelegsAndRewards"><span class="annot"><span class="annottext">queryStakePoolDelegsAndRewards :: forall era.
EraCertState era =&gt;
NewEpochState era
-&gt; Set (Credential 'Staking)
-&gt; (Map (Credential 'Staking) (KeyHash 'StakePool),
    Map (Credential 'Staking) Coin)
</span><a href="Cardano.Ledger.Api.State.Query.html#queryStakePoolDelegsAndRewards"><span class="hs-identifier hs-var hs-var">queryStakePoolDelegsAndRewards</span></a></span></span><span> </span><span id="local-6989586621679316822"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316822"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span id="local-6989586621679316823"><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621679316823"><span class="hs-identifier hs-var">creds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679316824"><span class="annot"><span class="annottext">accountsMap :: Map (Credential 'Staking) (AccountState era)
</span><a href="#local-6989586621679316824"><span class="hs-identifier hs-var hs-var">accountsMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316822"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting
     (Map (Credential 'Staking) (AccountState era))
     (NewEpochState era)
     (Map (Credential 'Staking) (AccountState era))
-&gt; Map (Credential 'Staking) (AccountState era)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era
 -&gt; Const
      (Map (Credential 'Staking) (AccountState era)) (EpochState era))
-&gt; NewEpochState era
-&gt; Const
     (Map (Credential 'Staking) (AccountState era)) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era
  -&gt; Const
       (Map (Credential 'Staking) (AccountState era)) (EpochState era))
 -&gt; NewEpochState era
 -&gt; Const
      (Map (Credential 'Staking) (AccountState era)) (NewEpochState era))
-&gt; ((Map (Credential 'Staking) (AccountState era)
     -&gt; Const
          (Map (Credential 'Staking) (AccountState era))
          (Map (Credential 'Staking) (AccountState era)))
    -&gt; EpochState era
    -&gt; Const
         (Map (Credential 'Staking) (AccountState era)) (EpochState era))
-&gt; Getting
     (Map (Credential 'Staking) (AccountState era))
     (NewEpochState era)
     (Map (Credential 'Staking) (AccountState era))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LedgerState era
 -&gt; Const
      (Map (Credential 'Staking) (AccountState era)) (LedgerState era))
-&gt; EpochState era
-&gt; Const
     (Map (Credential 'Staking) (AccountState era)) (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">esLStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LedgerState era
  -&gt; Const
       (Map (Credential 'Staking) (AccountState era)) (LedgerState era))
 -&gt; EpochState era
 -&gt; Const
      (Map (Credential 'Staking) (AccountState era)) (EpochState era))
-&gt; ((Map (Credential 'Staking) (AccountState era)
     -&gt; Const
          (Map (Credential 'Staking) (AccountState era))
          (Map (Credential 'Staking) (AccountState era)))
    -&gt; LedgerState era
    -&gt; Const
         (Map (Credential 'Staking) (AccountState era)) (LedgerState era))
-&gt; (Map (Credential 'Staking) (AccountState era)
    -&gt; Const
         (Map (Credential 'Staking) (AccountState era))
         (Map (Credential 'Staking) (AccountState era)))
-&gt; EpochState era
-&gt; Const
     (Map (Credential 'Staking) (AccountState era)) (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CertState era
 -&gt; Const
      (Map (Credential 'Staking) (AccountState era)) (CertState era))
-&gt; LedgerState era
-&gt; Const
     (Map (Credential 'Staking) (AccountState era)) (LedgerState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">lsCertStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CertState era
  -&gt; Const
       (Map (Credential 'Staking) (AccountState era)) (CertState era))
 -&gt; LedgerState era
 -&gt; Const
      (Map (Credential 'Staking) (AccountState era)) (LedgerState era))
-&gt; ((Map (Credential 'Staking) (AccountState era)
     -&gt; Const
          (Map (Credential 'Staking) (AccountState era))
          (Map (Credential 'Staking) (AccountState era)))
    -&gt; CertState era
    -&gt; Const
         (Map (Credential 'Staking) (AccountState era)) (CertState era))
-&gt; (Map (Credential 'Staking) (AccountState era)
    -&gt; Const
         (Map (Credential 'Staking) (AccountState era))
         (Map (Credential 'Staking) (AccountState era)))
-&gt; LedgerState era
-&gt; Const
     (Map (Credential 'Staking) (AccountState era)) (LedgerState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DState era
 -&gt; Const
      (Map (Credential 'Staking) (AccountState era)) (DState era))
-&gt; CertState era
-&gt; Const
     (Map (Credential 'Staking) (AccountState era)) (CertState era)
forall era. EraCertState era =&gt; Lens' (CertState era) (DState era)
Lens' (CertState era) (DState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#certDStateL"><span class="hs-identifier hs-var">certDStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((DState era
  -&gt; Const
       (Map (Credential 'Staking) (AccountState era)) (DState era))
 -&gt; CertState era
 -&gt; Const
      (Map (Credential 'Staking) (AccountState era)) (CertState era))
-&gt; ((Map (Credential 'Staking) (AccountState era)
     -&gt; Const
          (Map (Credential 'Staking) (AccountState era))
          (Map (Credential 'Staking) (AccountState era)))
    -&gt; DState era
    -&gt; Const
         (Map (Credential 'Staking) (AccountState era)) (DState era))
-&gt; (Map (Credential 'Staking) (AccountState era)
    -&gt; Const
         (Map (Credential 'Staking) (AccountState era))
         (Map (Credential 'Staking) (AccountState era)))
-&gt; CertState era
-&gt; Const
     (Map (Credential 'Staking) (AccountState era)) (CertState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Accounts era
 -&gt; Const
      (Map (Credential 'Staking) (AccountState era)) (Accounts era))
-&gt; DState era
-&gt; Const
     (Map (Credential 'Staking) (AccountState era)) (DState era)
forall era. Lens' (DState era) (Accounts era)
forall (t :: * -&gt; *) era.
CanSetAccounts t =&gt;
Lens' (t era) (Accounts era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#accountsL"><span class="hs-identifier hs-var">accountsL</span></a></span><span> </span><span class="annot"><span class="annottext">((Accounts era
  -&gt; Const
       (Map (Credential 'Staking) (AccountState era)) (Accounts era))
 -&gt; DState era
 -&gt; Const
      (Map (Credential 'Staking) (AccountState era)) (DState era))
-&gt; ((Map (Credential 'Staking) (AccountState era)
     -&gt; Const
          (Map (Credential 'Staking) (AccountState era))
          (Map (Credential 'Staking) (AccountState era)))
    -&gt; Accounts era
    -&gt; Const
         (Map (Credential 'Staking) (AccountState era)) (Accounts era))
-&gt; (Map (Credential 'Staking) (AccountState era)
    -&gt; Const
         (Map (Credential 'Staking) (AccountState era))
         (Map (Credential 'Staking) (AccountState era)))
-&gt; DState era
-&gt; Const
     (Map (Credential 'Staking) (AccountState era)) (DState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map (Credential 'Staking) (AccountState era)
 -&gt; Const
      (Map (Credential 'Staking) (AccountState era))
      (Map (Credential 'Staking) (AccountState era)))
-&gt; Accounts era
-&gt; Const
     (Map (Credential 'Staking) (AccountState era)) (Accounts era)
forall era.
EraAccounts era =&gt;
Lens' (Accounts era) (Map (Credential 'Staking) (AccountState era))
Lens' (Accounts era) (Map (Credential 'Staking) (AccountState era))
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#accountsMapL"><span class="hs-identifier hs-var">accountsMapL</span></a></span><span>
</span><span id="line-141"></span><span>      </span><span id="local-6989586621679316833"><span class="annot"><span class="annottext">accountsMapFiltered :: Map (Credential 'Staking) (AccountState era)
</span><a href="#local-6989586621679316833"><span class="hs-identifier hs-var hs-var">accountsMapFiltered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) (AccountState era)
</span><a href="#local-6989586621679316824"><span class="hs-identifier hs-var">accountsMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) (AccountState era)
-&gt; Set (Credential 'Staking)
-&gt; Map (Credential 'Staking) (AccountState era)
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-operator hs-var">`Map.restrictKeys`</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621679316823"><span class="hs-identifier hs-var">creds</span></a></span><span>
</span><span id="line-142"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(AccountState era -&gt; Maybe (KeyHash 'StakePool))
-&gt; Map (Credential 'Staking) (AccountState era)
-&gt; Map (Credential 'Staking) (KeyHash 'StakePool)
forall a b k. (a -&gt; Maybe b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AccountState era
-&gt; Getting
     (Maybe (KeyHash 'StakePool))
     (AccountState era)
     (Maybe (KeyHash 'StakePool))
-&gt; Maybe (KeyHash 'StakePool)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (Maybe (KeyHash 'StakePool))
  (AccountState era)
  (Maybe (KeyHash 'StakePool))
forall era.
EraAccounts era =&gt;
Lens' (AccountState era) (Maybe (KeyHash 'StakePool))
Lens' (AccountState era) (Maybe (KeyHash 'StakePool))
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#stakePoolDelegationAccountStateL"><span class="hs-identifier hs-var">stakePoolDelegationAccountStateL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) (AccountState era)
</span><a href="#local-6989586621679316833"><span class="hs-identifier hs-var">accountsMapFiltered</span></a></span><span>
</span><span id="line-143"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(AccountState era -&gt; Coin)
-&gt; Map (Credential 'Staking) (AccountState era)
-&gt; Map (Credential 'Staking) Coin
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompactForm Coin -&gt; Coin
forall a. Compactible a =&gt; CompactForm a -&gt; a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#fromCompact"><span class="hs-identifier hs-var">fromCompact</span></a></span><span> </span><span class="annot"><span class="annottext">(CompactForm Coin -&gt; Coin)
-&gt; (AccountState era -&gt; CompactForm Coin)
-&gt; AccountState era
-&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AccountState era
-&gt; Getting (CompactForm Coin) (AccountState era) (CompactForm Coin)
-&gt; CompactForm Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (CompactForm Coin) (AccountState era) (CompactForm Coin)
forall era.
EraAccounts era =&gt;
Lens' (AccountState era) (CompactForm Coin)
Lens' (AccountState era) (CompactForm Coin)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#balanceAccountStateL"><span class="hs-identifier hs-var">balanceAccountStateL</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) (AccountState era)
</span><a href="#local-6989586621679316833"><span class="hs-identifier hs-var">accountsMapFiltered</span></a></span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span id="local-6989586621679316458"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryConstitution"><span class="hs-identifier hs-type">queryConstitution</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#ConwayEraGov"><span class="hs-identifier hs-type">ConwayEraGov</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316458"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316458"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#Constitution"><span class="hs-identifier hs-type">Constitution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316458"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-147"></span><span id="queryConstitution"><span class="annot"><span class="annottext">queryConstitution :: forall era.
ConwayEraGov era =&gt;
NewEpochState era -&gt; Constitution era
</span><a href="Cardano.Ledger.Api.State.Query.html#queryConstitution"><span class="hs-identifier hs-var hs-var">queryConstitution</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GovState era
-&gt; Getting (Constitution era) (GovState era) (Constitution era)
-&gt; Constitution era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (Constitution era) (GovState era) (Constitution era)
forall era.
ConwayEraGov era =&gt;
Lens' (GovState era) (Constitution era)
Lens' (GovState era) (Constitution era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#constitutionGovStateL"><span class="hs-identifier hs-var">constitutionGovStateL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GovState era -&gt; Constitution era)
-&gt; (NewEpochState era -&gt; GovState era)
-&gt; NewEpochState era
-&gt; Constitution era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NewEpochState era -&gt; GovState era
forall era. NewEpochState era -&gt; GovState era
</span><a href="Cardano.Ledger.Api.State.Query.html#queryGovState"><span class="hs-identifier hs-var">queryGovState</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span id="local-6989586621679316465"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryConstitutionHash"><span class="hs-identifier hs-type">queryConstitutionHash</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#ConwayEraGov"><span class="hs-identifier hs-type">ConwayEraGov</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316465"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316465"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-152"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#SafeHash"><span class="hs-identifier hs-type">SafeHash</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#AnchorData"><span class="hs-identifier hs-type">AnchorData</span></a></span></span><span>
</span><span id="line-153"></span><span id="queryConstitutionHash"><span class="annot"><span class="annottext">queryConstitutionHash :: forall era.
ConwayEraGov era =&gt;
NewEpochState era -&gt; SafeHash AnchorData
</span><a href="Cardano.Ledger.Api.State.Query.html#queryConstitutionHash"><span class="hs-identifier hs-var hs-var">queryConstitutionHash</span></a></span></span><span> </span><span id="local-6989586621679316845"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316845"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><span class="annottext">Anchor -&gt; SafeHash AnchorData
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#anchorDataHash"><span class="hs-identifier hs-var">anchorDataHash</span></a></span><span> </span><span class="annot"><span class="annottext">(Anchor -&gt; SafeHash AnchorData)
-&gt; (Constitution era -&gt; Anchor)
-&gt; Constitution era
-&gt; SafeHash AnchorData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Constitution era -&gt; Anchor
forall era. Constitution era -&gt; Anchor
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#constitutionAnchor"><span class="hs-identifier hs-var">constitutionAnchor</span></a></span><span> </span><span class="annot"><span class="annottext">(Constitution era -&gt; SafeHash AnchorData)
-&gt; Constitution era -&gt; SafeHash AnchorData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NewEpochState era -&gt; Constitution era
forall era.
ConwayEraGov era =&gt;
NewEpochState era -&gt; Constitution era
</span><a href="Cardano.Ledger.Api.State.Query.html#queryConstitution"><span class="hs-identifier hs-var">queryConstitution</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316845"><span class="hs-identifier hs-var">nes</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><span class="hs-comment">-- | This query returns all of the state related to governance</span></span><span>
</span><span id="line-157"></span><span id="local-6989586621679316464"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryGovState"><span class="hs-identifier hs-type">queryGovState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316464"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Governance.html#GovState"><span class="hs-identifier hs-type">GovState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316464"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-158"></span><span id="queryGovState"><span class="annot"><span class="annottext">queryGovState :: forall era. NewEpochState era -&gt; GovState era
</span><a href="Cardano.Ledger.Api.State.Query.html#queryGovState"><span class="hs-identifier hs-var hs-var">queryGovState</span></a></span></span><span> </span><span id="local-6989586621679316849"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316849"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316849"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting (GovState era) (NewEpochState era) (GovState era)
-&gt; GovState era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era -&gt; Const (GovState era) (EpochState era))
-&gt; NewEpochState era -&gt; Const (GovState era) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEpochStateL"><span class="hs-identifier hs-var">nesEpochStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era -&gt; Const (GovState era) (EpochState era))
 -&gt; NewEpochState era -&gt; Const (GovState era) (NewEpochState era))
-&gt; ((GovState era -&gt; Const (GovState era) (GovState era))
    -&gt; EpochState era -&gt; Const (GovState era) (EpochState era))
-&gt; Getting (GovState era) (NewEpochState era) (GovState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(GovState era -&gt; Const (GovState era) (GovState era))
-&gt; EpochState era -&gt; Const (GovState era) (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(GovState era -&gt; f (GovState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#epochStateGovStateL"><span class="hs-identifier hs-var">epochStateGovStateL</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><span class="hs-comment">-- | Query DRep state.</span></span><span>
</span><span id="line-161"></span><span id="local-6989586621679316477"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryDRepState"><span class="hs-identifier hs-type">queryDRepState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.CertState.html#ConwayEraCertState"><span class="hs-identifier hs-type">ConwayEraCertState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316477"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316477"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-comment">-- | Specify a set of DRep credentials whose state should be returned. When this set is</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-comment">-- empty, states for all of the DReps will be returned.</span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#DRepRole"><span class="hs-identifier hs-type">DRepRole</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#DRepRole"><span class="hs-identifier hs-type">DRepRole</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#DRepState"><span class="hs-identifier hs-type">DRepState</span></a></span></span><span>
</span><span id="line-168"></span><span id="queryDRepState"><span class="annot"><span class="annottext">queryDRepState :: forall era.
ConwayEraCertState era =&gt;
NewEpochState era
-&gt; Set (Credential 'DRepRole)
-&gt; Map (Credential 'DRepRole) DRepState
</span><a href="Cardano.Ledger.Api.State.Query.html#queryDRepState"><span class="hs-identifier hs-var hs-var">queryDRepState</span></a></span></span><span> </span><span id="local-6989586621679316866"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316866"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span id="local-6989586621679316867"><span class="annot"><span class="annottext">Set (Credential 'DRepRole)
</span><a href="#local-6989586621679316867"><span class="hs-identifier hs-var">creds</span></a></span></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set (Credential 'DRepRole) -&gt; Bool
forall a. Set a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'DRepRole)
</span><a href="#local-6989586621679316867"><span class="hs-identifier hs-var">creds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VState era -&gt; VState era
</span><a href="#local-6989586621679316869"><span class="hs-identifier hs-var">updateDormantDRepExpiry'</span></a></span><span> </span><span class="annot"><span class="annottext">VState era
</span><a href="#local-6989586621679316870"><span class="hs-identifier hs-var">vState</span></a></span><span> </span><span class="annot"><span class="annottext">VState era
-&gt; Getting
     (Map (Credential 'DRepRole) DRepState)
     (VState era)
     (Map (Credential 'DRepRole) DRepState)
-&gt; Map (Credential 'DRepRole) DRepState
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map (Credential 'DRepRole) DRepState)
  (VState era)
  (Map (Credential 'DRepRole) DRepState)
forall era (f :: * -&gt; *).
Functor f =&gt;
(Map (Credential 'DRepRole) DRepState
 -&gt; f (Map (Credential 'DRepRole) DRepState))
-&gt; VState era -&gt; f (VState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.VState.html#vsDRepsL"><span class="hs-identifier hs-var">vsDRepsL</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VState era -&gt; VState era
</span><a href="#local-6989586621679316869"><span class="hs-identifier hs-var">updateDormantDRepExpiry'</span></a></span><span> </span><span class="annot"><span class="annottext">VState era
</span><a href="#local-6989586621679316872"><span class="hs-identifier hs-var">vStateFiltered</span></a></span><span> </span><span class="annot"><span class="annottext">VState era
-&gt; Getting
     (Map (Credential 'DRepRole) DRepState)
     (VState era)
     (Map (Credential 'DRepRole) DRepState)
-&gt; Map (Credential 'DRepRole) DRepState
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map (Credential 'DRepRole) DRepState)
  (VState era)
  (Map (Credential 'DRepRole) DRepState)
forall era (f :: * -&gt; *).
Functor f =&gt;
(Map (Credential 'DRepRole) DRepState
 -&gt; f (Map (Credential 'DRepRole) DRepState))
-&gt; VState era -&gt; f (VState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.VState.html#vsDRepsL"><span class="hs-identifier hs-var">vsDRepsL</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-172"></span><span>    </span><span id="local-6989586621679316872"><span class="annot"><span class="annottext">vStateFiltered :: VState era
</span><a href="#local-6989586621679316872"><span class="hs-identifier hs-var hs-var">vStateFiltered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VState era
</span><a href="#local-6989586621679316870"><span class="hs-identifier hs-var">vState</span></a></span><span> </span><span class="annot"><span class="annottext">VState era -&gt; (VState era -&gt; VState era) -&gt; VState era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Map (Credential 'DRepRole) DRepState
 -&gt; Identity (Map (Credential 'DRepRole) DRepState))
-&gt; VState era -&gt; Identity (VState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(Map (Credential 'DRepRole) DRepState
 -&gt; f (Map (Credential 'DRepRole) DRepState))
-&gt; VState era -&gt; f (VState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.VState.html#vsDRepsL"><span class="hs-identifier hs-var">vsDRepsL</span></a></span><span> </span><span class="annot"><span class="annottext">((Map (Credential 'DRepRole) DRepState
  -&gt; Identity (Map (Credential 'DRepRole) DRepState))
 -&gt; VState era -&gt; Identity (VState era))
-&gt; (Map (Credential 'DRepRole) DRepState
    -&gt; Map (Credential 'DRepRole) DRepState)
-&gt; VState era
-&gt; VState era
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%25~"><span class="hs-operator hs-var">%~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Credential 'DRepRole) DRepState
-&gt; Set (Credential 'DRepRole)
-&gt; Map (Credential 'DRepRole) DRepState
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-operator hs-var">`Map.restrictKeys`</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'DRepRole)
</span><a href="#local-6989586621679316867"><span class="hs-identifier hs-var">creds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>    </span><span id="local-6989586621679316870"><span class="annot"><span class="annottext">vState :: VState era
</span><a href="#local-6989586621679316870"><span class="hs-identifier hs-var hs-var">vState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316866"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting (VState era) (NewEpochState era) (VState era)
-&gt; VState era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era -&gt; Const (VState era) (EpochState era))
-&gt; NewEpochState era -&gt; Const (VState era) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era -&gt; Const (VState era) (EpochState era))
 -&gt; NewEpochState era -&gt; Const (VState era) (NewEpochState era))
-&gt; ((VState era -&gt; Const (VState era) (VState era))
    -&gt; EpochState era -&gt; Const (VState era) (EpochState era))
-&gt; Getting (VState era) (NewEpochState era) (VState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LedgerState era -&gt; Const (VState era) (LedgerState era))
-&gt; EpochState era -&gt; Const (VState era) (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">esLStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LedgerState era -&gt; Const (VState era) (LedgerState era))
 -&gt; EpochState era -&gt; Const (VState era) (EpochState era))
-&gt; ((VState era -&gt; Const (VState era) (VState era))
    -&gt; LedgerState era -&gt; Const (VState era) (LedgerState era))
-&gt; (VState era -&gt; Const (VState era) (VState era))
-&gt; EpochState era
-&gt; Const (VState era) (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CertState era -&gt; Const (VState era) (CertState era))
-&gt; LedgerState era -&gt; Const (VState era) (LedgerState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">lsCertStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CertState era -&gt; Const (VState era) (CertState era))
 -&gt; LedgerState era -&gt; Const (VState era) (LedgerState era))
-&gt; ((VState era -&gt; Const (VState era) (VState era))
    -&gt; CertState era -&gt; Const (VState era) (CertState era))
-&gt; (VState era -&gt; Const (VState era) (VState era))
-&gt; LedgerState era
-&gt; Const (VState era) (LedgerState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VState era -&gt; Const (VState era) (VState era))
-&gt; CertState era -&gt; Const (VState era) (CertState era)
forall era.
ConwayEraCertState era =&gt;
Lens' (CertState era) (VState era)
Lens' (CertState era) (VState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.CertState.html#certVStateL"><span class="hs-identifier hs-var">certVStateL</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span id="local-6989586621679316869"><span class="annot"><span class="annottext">updateDormantDRepExpiry' :: VState era -&gt; VState era
</span><a href="#local-6989586621679316869"><span class="hs-identifier hs-var hs-var">updateDormantDRepExpiry'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; VState era -&gt; VState era
forall era. EpochNo -&gt; VState era -&gt; VState era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Rules.Certs.html#updateDormantDRepExpiry"><span class="hs-identifier hs-var">updateDormantDRepExpiry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316866"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting EpochNo (NewEpochState era) EpochNo -&gt; EpochNo
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting EpochNo (NewEpochState era) EpochNo
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochNo -&gt; f EpochNo)
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesELL"><span class="hs-identifier hs-var">nesELL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- | Query the delegators delegated to each DRep, including</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- @AlwaysAbstain@ and @NoConfidence@.</span><span>
</span><span id="line-178"></span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryDRepDelegations"><span class="hs-identifier hs-type">queryDRepDelegations</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679316500"><span class="annot"><a href="#local-6989586621679316500"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-180"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.CertState.html#ConwayEraCertState"><span class="hs-identifier hs-type">ConwayEraCertState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316500"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316500"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-comment">-- | Specify a set of DReps whose state should be returned. When this set is</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-comment">-- empty, states for all of the DReps will be returned.</span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#DRep"><span class="hs-identifier hs-type">DRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#DRep"><span class="hs-identifier hs-type">DRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span id="queryDRepDelegations"><span class="annot"><span class="annottext">queryDRepDelegations :: forall era.
ConwayEraCertState era =&gt;
NewEpochState era
-&gt; Set DRep -&gt; Map DRep (Set (Credential 'Staking))
</span><a href="Cardano.Ledger.Api.State.Query.html#queryDRepDelegations"><span class="hs-identifier hs-var hs-var">queryDRepDelegations</span></a></span></span><span> </span><span id="local-6989586621679316908"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316908"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span id="local-6989586621679316909"><span class="annot"><span class="annottext">Set DRep
</span><a href="#local-6989586621679316909"><span class="hs-identifier hs-var">dreps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Set DRep -&gt; Maybe (Set (Credential 'DRepRole))
</span><a href="#local-6989586621679316910"><span class="hs-identifier hs-var">getDRepCreds</span></a></span><span> </span><span class="annot"><span class="annottext">Set DRep
</span><a href="#local-6989586621679316909"><span class="hs-identifier hs-var">dreps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679316911"><span class="annot"><span class="annottext">Set (Credential 'DRepRole)
</span><a href="#local-6989586621679316911"><span class="hs-identifier hs-var">creds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-189"></span><span>      </span><span class="annot"><span class="annottext">(DRepState -&gt; Set (Credential 'Staking))
-&gt; Map DRep DRepState -&gt; Map DRep (Set (Credential 'Staking))
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">DRepState -&gt; Set (Credential 'Staking)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#drepDelegs"><span class="hs-identifier hs-var">drepDelegs</span></a></span><span> </span><span class="annot"><span class="annottext">(Map DRep DRepState -&gt; Map DRep (Set (Credential 'Staking)))
-&gt; Map DRep DRepState -&gt; Map DRep (Set (Credential 'Staking))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><span class="annottext">(Credential 'DRepRole -&gt; DRep)
-&gt; Map (Credential 'DRepRole) DRepState -&gt; Map DRep DRepState
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">Map.mapKeys</span></span><span> </span><span class="annot"><span class="annottext">Credential 'DRepRole -&gt; DRep
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#credToDRep"><span class="hs-identifier hs-var">credToDRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">VState era
</span><a href="#local-6989586621679316914"><span class="hs-identifier hs-var">vState</span></a></span><span> </span><span class="annot"><span class="annottext">VState era
-&gt; Getting
     (Map (Credential 'DRepRole) DRepState)
     (VState era)
     (Map (Credential 'DRepRole) DRepState)
-&gt; Map (Credential 'DRepRole) DRepState
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map (Credential 'DRepRole) DRepState)
  (VState era)
  (Map (Credential 'DRepRole) DRepState)
forall era (f :: * -&gt; *).
Functor f =&gt;
(Map (Credential 'DRepRole) DRepState
 -&gt; f (Map (Credential 'DRepRole) DRepState))
-&gt; VState era -&gt; f (VState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.VState.html#vsDRepsL"><span class="hs-identifier hs-var">vsDRepsL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'DRepRole) DRepState
-&gt; Set (Credential 'DRepRole)
-&gt; Map (Credential 'DRepRole) DRepState
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-operator hs-var">`Map.restrictKeys`</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'DRepRole)
</span><a href="#local-6989586621679316911"><span class="hs-identifier hs-var">creds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Set (Credential 'DRepRole))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-192"></span><span>      </span><span class="hs-comment">-- Whenever predefined `AlwaysAbstain` or `AlwaysNoConfidence` are</span><span>
</span><span id="line-193"></span><span>      </span><span class="hs-comment">-- requested we are forced to iterate over all accounts and find those</span><span>
</span><span id="line-194"></span><span>      </span><span class="hs-comment">-- delegations.</span><span>
</span><span id="line-195"></span><span>      </span><span class="annot"><span class="annottext">(Map DRep (Set (Credential 'Staking))
 -&gt; Credential 'Staking
 -&gt; AccountState era
 -&gt; Map DRep (Set (Credential 'Staking)))
-&gt; Map DRep (Set (Credential 'Staking))
-&gt; Map (Credential 'Staking) (AccountState era)
-&gt; Map DRep (Set (Credential 'Staking))
forall a k b. (a -&gt; k -&gt; b -&gt; a) -&gt; a -&gt; Map k b -&gt; a
</span><span class="hs-identifier hs-var">Map.foldlWithKey'</span></span><span>
</span><span id="line-196"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679316916"><span class="annot"><span class="annottext">Map DRep (Set (Credential 'Staking))
</span><a href="#local-6989586621679316916"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679316917"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621679316917"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span id="local-6989586621679316918"><span class="annot"><span class="annottext">AccountState era
</span><a href="#local-6989586621679316918"><span class="hs-identifier hs-var">cas</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-197"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AccountState era
</span><a href="#local-6989586621679316918"><span class="hs-identifier hs-var">cas</span></a></span><span> </span><span class="annot"><span class="annottext">AccountState era
-&gt; Getting (Maybe DRep) (AccountState era) (Maybe DRep)
-&gt; Maybe DRep
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (Maybe DRep) (AccountState era) (Maybe DRep)
forall era.
ConwayEraAccounts era =&gt;
Lens' (AccountState era) (Maybe DRep)
Lens' (AccountState era) (Maybe DRep)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.Account.html#dRepDelegationAccountStateL"><span class="hs-identifier hs-var">dRepDelegationAccountStateL</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-198"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679316920"><span class="annot"><span class="annottext">DRep
</span><a href="#local-6989586621679316920"><span class="hs-identifier hs-var">drep</span></a></span></span><span>
</span><span id="line-199"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set DRep -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set DRep
</span><a href="#local-6989586621679316909"><span class="hs-identifier hs-var">dreps</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">DRep
</span><a href="#local-6989586621679316920"><span class="hs-identifier hs-var">drep</span></a></span><span> </span><span class="annot"><span class="annottext">DRep -&gt; Set DRep -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set DRep
</span><a href="#local-6989586621679316909"><span class="hs-identifier hs-var">dreps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-200"></span><span>                    </span><span class="annot"><span class="annottext">(Set (Credential 'Staking)
 -&gt; Set (Credential 'Staking) -&gt; Set (Credential 'Staking))
-&gt; DRep
-&gt; Set (Credential 'Staking)
-&gt; Map DRep (Set (Credential 'Staking))
-&gt; Map DRep (Set (Credential 'Staking))
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insertWith</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking)
-&gt; Set (Credential 'Staking) -&gt; Set (Credential 'Staking)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="annot"><span class="annottext">DRep
</span><a href="#local-6989586621679316920"><span class="hs-identifier hs-var">drep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Set (Credential 'Staking)
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621679316917"><span class="hs-identifier hs-var">cred</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map DRep (Set (Credential 'Staking))
</span><a href="#local-6989586621679316916"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-201"></span><span>              </span><span class="annot"><span class="annottext">Maybe DRep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-202"></span><span>                </span><span class="annot"><span class="annottext">Map DRep (Set (Credential 'Staking))
</span><a href="#local-6989586621679316916"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-203"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><span class="annottext">Map DRep (Set (Credential 'Staking))
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DState era
</span><a href="#local-6989586621679316927"><span class="hs-identifier hs-var">dState</span></a></span><span> </span><span class="annot"><span class="annottext">DState era
-&gt; Getting
     (Map (Credential 'Staking) (AccountState era))
     (DState era)
     (Map (Credential 'Staking) (AccountState era))
-&gt; Map (Credential 'Staking) (AccountState era)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(Accounts era
 -&gt; Const
      (Map (Credential 'Staking) (AccountState era)) (Accounts era))
-&gt; DState era
-&gt; Const
     (Map (Credential 'Staking) (AccountState era)) (DState era)
forall era. Lens' (DState era) (Accounts era)
forall (t :: * -&gt; *) era.
CanSetAccounts t =&gt;
Lens' (t era) (Accounts era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#accountsL"><span class="hs-identifier hs-var">accountsL</span></a></span><span> </span><span class="annot"><span class="annottext">((Accounts era
  -&gt; Const
       (Map (Credential 'Staking) (AccountState era)) (Accounts era))
 -&gt; DState era
 -&gt; Const
      (Map (Credential 'Staking) (AccountState era)) (DState era))
-&gt; ((Map (Credential 'Staking) (AccountState era)
     -&gt; Const
          (Map (Credential 'Staking) (AccountState era))
          (Map (Credential 'Staking) (AccountState era)))
    -&gt; Accounts era
    -&gt; Const
         (Map (Credential 'Staking) (AccountState era)) (Accounts era))
-&gt; Getting
     (Map (Credential 'Staking) (AccountState era))
     (DState era)
     (Map (Credential 'Staking) (AccountState era))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map (Credential 'Staking) (AccountState era)
 -&gt; Const
      (Map (Credential 'Staking) (AccountState era))
      (Map (Credential 'Staking) (AccountState era)))
-&gt; Accounts era
-&gt; Const
     (Map (Credential 'Staking) (AccountState era)) (Accounts era)
forall era.
EraAccounts era =&gt;
Lens' (Accounts era) (Map (Credential 'Staking) (AccountState era))
Lens' (Accounts era) (Map (Credential 'Staking) (AccountState era))
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#accountsMapL"><span class="hs-identifier hs-var">accountsMapL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621679316927"><span class="annot"><span class="annottext">dState :: DState era
</span><a href="#local-6989586621679316927"><span class="hs-identifier hs-var hs-var">dState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316908"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting (DState era) (NewEpochState era) (DState era)
-&gt; DState era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era -&gt; Const (DState era) (EpochState era))
-&gt; NewEpochState era -&gt; Const (DState era) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era -&gt; Const (DState era) (EpochState era))
 -&gt; NewEpochState era -&gt; Const (DState era) (NewEpochState era))
-&gt; ((DState era -&gt; Const (DState era) (DState era))
    -&gt; EpochState era -&gt; Const (DState era) (EpochState era))
-&gt; Getting (DState era) (NewEpochState era) (DState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LedgerState era -&gt; Const (DState era) (LedgerState era))
-&gt; EpochState era -&gt; Const (DState era) (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">esLStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LedgerState era -&gt; Const (DState era) (LedgerState era))
 -&gt; EpochState era -&gt; Const (DState era) (EpochState era))
-&gt; ((DState era -&gt; Const (DState era) (DState era))
    -&gt; LedgerState era -&gt; Const (DState era) (LedgerState era))
-&gt; (DState era -&gt; Const (DState era) (DState era))
-&gt; EpochState era
-&gt; Const (DState era) (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CertState era -&gt; Const (DState era) (CertState era))
-&gt; LedgerState era -&gt; Const (DState era) (LedgerState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">lsCertStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CertState era -&gt; Const (DState era) (CertState era))
 -&gt; LedgerState era -&gt; Const (DState era) (LedgerState era))
-&gt; ((DState era -&gt; Const (DState era) (DState era))
    -&gt; CertState era -&gt; Const (DState era) (CertState era))
-&gt; (DState era -&gt; Const (DState era) (DState era))
-&gt; LedgerState era
-&gt; Const (DState era) (LedgerState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DState era -&gt; Const (DState era) (DState era))
-&gt; CertState era -&gt; Const (DState era) (CertState era)
forall era. EraCertState era =&gt; Lens' (CertState era) (DState era)
Lens' (CertState era) (DState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#certDStateL"><span class="hs-identifier hs-var">certDStateL</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span id="local-6989586621679316914"><span class="annot"><span class="annottext">vState :: VState era
</span><a href="#local-6989586621679316914"><span class="hs-identifier hs-var hs-var">vState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316908"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting (VState era) (NewEpochState era) (VState era)
-&gt; VState era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era -&gt; Const (VState era) (EpochState era))
-&gt; NewEpochState era -&gt; Const (VState era) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era -&gt; Const (VState era) (EpochState era))
 -&gt; NewEpochState era -&gt; Const (VState era) (NewEpochState era))
-&gt; ((VState era -&gt; Const (VState era) (VState era))
    -&gt; EpochState era -&gt; Const (VState era) (EpochState era))
-&gt; Getting (VState era) (NewEpochState era) (VState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LedgerState era -&gt; Const (VState era) (LedgerState era))
-&gt; EpochState era -&gt; Const (VState era) (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">esLStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LedgerState era -&gt; Const (VState era) (LedgerState era))
 -&gt; EpochState era -&gt; Const (VState era) (EpochState era))
-&gt; ((VState era -&gt; Const (VState era) (VState era))
    -&gt; LedgerState era -&gt; Const (VState era) (LedgerState era))
-&gt; (VState era -&gt; Const (VState era) (VState era))
-&gt; EpochState era
-&gt; Const (VState era) (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CertState era -&gt; Const (VState era) (CertState era))
-&gt; LedgerState era -&gt; Const (VState era) (LedgerState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">lsCertStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CertState era -&gt; Const (VState era) (CertState era))
 -&gt; LedgerState era -&gt; Const (VState era) (LedgerState era))
-&gt; ((VState era -&gt; Const (VState era) (VState era))
    -&gt; CertState era -&gt; Const (VState era) (CertState era))
-&gt; (VState era -&gt; Const (VState era) (VState era))
-&gt; LedgerState era
-&gt; Const (VState era) (LedgerState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VState era -&gt; Const (VState era) (VState era))
-&gt; CertState era -&gt; Const (VState era) (CertState era)
forall era.
ConwayEraCertState era =&gt;
Lens' (CertState era) (VState era)
Lens' (CertState era) (VState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.CertState.html#certVStateL"><span class="hs-identifier hs-var">certVStateL</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-comment">-- Find all credentials for requested DReps, but only when we don't care</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-comment">-- about predefined DReps</span><span>
</span><span id="line-211"></span><span>    </span><span id="local-6989586621679316910"><span class="annot"><span class="annottext">getDRepCreds :: Set DRep -&gt; Maybe (Set (Credential 'DRepRole))
</span><a href="#local-6989586621679316910"><span class="hs-identifier hs-var hs-var">getDRepCreds</span></a></span></span><span> </span><span id="local-6989586621679316939"><span class="annot"><span class="annottext">Set DRep
</span><a href="#local-6989586621679316939"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-212"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe ()) -&gt; Bool -&gt; Maybe ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set DRep -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set DRep
</span><a href="#local-6989586621679316939"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-213"></span><span>      </span><span class="annot"><span class="annottext">[Credential 'DRepRole] -&gt; Set (Credential 'DRepRole)
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Credential 'DRepRole] -&gt; Set (Credential 'DRepRole))
-&gt; Maybe [Credential 'DRepRole]
-&gt; Maybe (Set (Credential 'DRepRole))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(DRep -&gt; Maybe (Credential 'DRepRole))
-&gt; [DRep] -&gt; Maybe [Credential 'DRepRole]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">DRep -&gt; Maybe (Credential 'DRepRole)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#dRepToCred"><span class="hs-identifier hs-var">dRepToCred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set DRep -&gt; [DRep]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.elems</span></span><span> </span><span class="annot"><span class="annottext">Set DRep
</span><a href="#local-6989586621679316939"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">-- | Query DRep stake distribution. Note that this can be an expensive query because there</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- is a chance that current distribution has not been fully computed yet.</span><span>
</span><span id="line-217"></span><span id="local-6989586621679316530"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryDRepStakeDistr"><span class="hs-identifier hs-type">queryDRepStakeDistr</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#ConwayEraGov"><span class="hs-identifier hs-type">ConwayEraGov</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316530"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316530"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-comment">-- | Specify DRep Ids whose stake distribution should be returned. When this set is</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-comment">-- empty, distributions for all of the DReps will be returned.</span><span>
</span><span id="line-222"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#DRep"><span class="hs-identifier hs-type">DRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#DRep"><span class="hs-identifier hs-type">DRep</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span></span><span>
</span><span id="line-224"></span><span id="queryDRepStakeDistr"><span class="annot"><span class="annottext">queryDRepStakeDistr :: forall era.
ConwayEraGov era =&gt;
NewEpochState era -&gt; Set DRep -&gt; Map DRep Coin
</span><a href="Cardano.Ledger.Api.State.Query.html#queryDRepStakeDistr"><span class="hs-identifier hs-var hs-var">queryDRepStakeDistr</span></a></span></span><span> </span><span id="local-6989586621679316951"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316951"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span id="local-6989586621679316952"><span class="annot"><span class="annottext">Set DRep
</span><a href="#local-6989586621679316952"><span class="hs-identifier hs-var">creds</span></a></span></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set DRep -&gt; Bool
forall a. Set a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Set DRep
</span><a href="#local-6989586621679316952"><span class="hs-identifier hs-var">creds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CompactForm Coin -&gt; Coin)
-&gt; Map DRep (CompactForm Coin) -&gt; Map DRep Coin
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin -&gt; Coin
forall a. Compactible a =&gt; CompactForm a -&gt; a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#fromCompact"><span class="hs-identifier hs-var">fromCompact</span></a></span><span> </span><span class="annot"><span class="annottext">Map DRep (CompactForm Coin)
</span><a href="#local-6989586621679316953"><span class="hs-identifier hs-var">distr</span></a></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CompactForm Coin -&gt; Coin)
-&gt; Map DRep (CompactForm Coin) -&gt; Map DRep Coin
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin -&gt; Coin
forall a. Compactible a =&gt; CompactForm a -&gt; a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#fromCompact"><span class="hs-identifier hs-var">fromCompact</span></a></span><span> </span><span class="annot"><span class="annottext">(Map DRep (CompactForm Coin) -&gt; Map DRep Coin)
-&gt; Map DRep (CompactForm Coin) -&gt; Map DRep Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map DRep (CompactForm Coin)
</span><a href="#local-6989586621679316953"><span class="hs-identifier hs-var">distr</span></a></span><span> </span><span class="annot"><span class="annottext">Map DRep (CompactForm Coin)
-&gt; Set DRep -&gt; Map DRep (CompactForm Coin)
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-operator hs-var">`Map.restrictKeys`</span></span><span> </span><span class="annot"><span class="annottext">Set DRep
</span><a href="#local-6989586621679316952"><span class="hs-identifier hs-var">creds</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621679316953"><span class="annot"><span class="annottext">distr :: Map DRep (CompactForm Coin)
</span><a href="#local-6989586621679316953"><span class="hs-identifier hs-var hs-var">distr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PulsingSnapshot era -&gt; Map DRep (CompactForm Coin)
forall era. PulsingSnapshot era -&gt; Map DRep (CompactForm Coin)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.DRepPulser.html#psDRepDistr"><span class="hs-identifier hs-var">psDRepDistr</span></a></span><span> </span><span class="annot"><span class="annottext">(PulsingSnapshot era -&gt; Map DRep (CompactForm Coin))
-&gt; ((PulsingSnapshot era, RatifyState era) -&gt; PulsingSnapshot era)
-&gt; (PulsingSnapshot era, RatifyState era)
-&gt; Map DRep (CompactForm Coin)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PulsingSnapshot era, RatifyState era) -&gt; PulsingSnapshot era
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((PulsingSnapshot era, RatifyState era)
 -&gt; Map DRep (CompactForm Coin))
-&gt; (PulsingSnapshot era, RatifyState era)
-&gt; Map DRep (CompactForm Coin)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NewEpochState era -&gt; (PulsingSnapshot era, RatifyState era)
forall era.
ConwayEraGov era =&gt;
NewEpochState era -&gt; (PulsingSnapshot era, RatifyState era)
</span><a href="Cardano.Ledger.Api.State.Query.html#finishedPulserState"><span class="hs-identifier hs-var">finishedPulserState</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316951"><span class="hs-identifier hs-var">nes</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | Query the stake distribution of the registered DReps. This does not</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- include the @AlwaysAbstain@ and @NoConfidence@ DReps.</span><span>
</span><span id="line-232"></span><span id="local-6989586621679316538"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryRegisteredDRepStakeDistr"><span class="hs-identifier hs-type">queryRegisteredDRepStakeDistr</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#ConwayEraGov"><span class="hs-identifier hs-type">ConwayEraGov</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316538"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.CertState.html#ConwayEraCertState"><span class="hs-identifier hs-type">ConwayEraCertState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316538"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316538"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-comment">-- | Specify DRep Ids whose stake distribution should be returned. When this set is</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-comment">-- empty, distributions for all of the registered DReps will be returned.</span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#DRepRole"><span class="hs-identifier hs-type">DRepRole</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#DRepRole"><span class="hs-identifier hs-type">DRepRole</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span></span><span>
</span><span id="line-239"></span><span id="queryRegisteredDRepStakeDistr"><span class="annot"><span class="annottext">queryRegisteredDRepStakeDistr :: forall era.
(ConwayEraGov era, ConwayEraCertState era) =&gt;
NewEpochState era
-&gt; Set (Credential 'DRepRole) -&gt; Map (Credential 'DRepRole) Coin
</span><a href="Cardano.Ledger.Api.State.Query.html#queryRegisteredDRepStakeDistr"><span class="hs-identifier hs-var hs-var">queryRegisteredDRepStakeDistr</span></a></span></span><span> </span><span id="local-6989586621679316991"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316991"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span id="local-6989586621679316992"><span class="annot"><span class="annottext">Set (Credential 'DRepRole)
</span><a href="#local-6989586621679316992"><span class="hs-identifier hs-var">creds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><span class="annottext">(Map (Credential 'DRepRole) Coin
 -&gt; Credential 'DRepRole
 -&gt; DRepState
 -&gt; Map (Credential 'DRepRole) Coin)
-&gt; Map (Credential 'DRepRole) Coin
-&gt; Map (Credential 'DRepRole) DRepState
-&gt; Map (Credential 'DRepRole) Coin
forall a k b. (a -&gt; k -&gt; b -&gt; a) -&gt; a -&gt; Map k b -&gt; a
</span><span class="hs-identifier hs-var">Map.foldlWithKey'</span></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'DRepRole) Coin
-&gt; Credential 'DRepRole
-&gt; DRepState
-&gt; Map (Credential 'DRepRole) Coin
</span><a href="#local-6989586621679316993"><span class="hs-identifier hs-var">computeDistr</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'DRepRole) Coin
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'DRepRole) DRepState
</span><a href="#local-6989586621679316994"><span class="hs-identifier hs-var">selectedDReps</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-242"></span><span>    </span><span id="local-6989586621679316994"><span class="annot"><span class="annottext">selectedDReps :: Map (Credential 'DRepRole) DRepState
</span><a href="#local-6989586621679316994"><span class="hs-identifier hs-var hs-var">selectedDReps</span></a></span></span><span>
</span><span id="line-243"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set (Credential 'DRepRole) -&gt; Bool
forall a. Set a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'DRepRole)
</span><a href="#local-6989586621679316992"><span class="hs-identifier hs-var">creds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'DRepRole) DRepState
</span><a href="#local-6989586621679316995"><span class="hs-identifier hs-var">registeredDReps</span></a></span><span>
</span><span id="line-244"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'DRepRole) DRepState
</span><a href="#local-6989586621679316995"><span class="hs-identifier hs-var">registeredDReps</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'DRepRole) DRepState
-&gt; Set (Credential 'DRepRole)
-&gt; Map (Credential 'DRepRole) DRepState
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-operator hs-var">`Map.restrictKeys`</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'DRepRole)
</span><a href="#local-6989586621679316992"><span class="hs-identifier hs-var">creds</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span id="local-6989586621679316995"><span class="annot"><span class="annottext">registeredDReps :: Map (Credential 'DRepRole) DRepState
</span><a href="#local-6989586621679316995"><span class="hs-identifier hs-var hs-var">registeredDReps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316991"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting
     (Map (Credential 'DRepRole) DRepState)
     (NewEpochState era)
     (Map (Credential 'DRepRole) DRepState)
-&gt; Map (Credential 'DRepRole) DRepState
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era
 -&gt; Const (Map (Credential 'DRepRole) DRepState) (EpochState era))
-&gt; NewEpochState era
-&gt; Const (Map (Credential 'DRepRole) DRepState) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era
  -&gt; Const (Map (Credential 'DRepRole) DRepState) (EpochState era))
 -&gt; NewEpochState era
 -&gt; Const
      (Map (Credential 'DRepRole) DRepState) (NewEpochState era))
-&gt; ((Map (Credential 'DRepRole) DRepState
     -&gt; Const
          (Map (Credential 'DRepRole) DRepState)
          (Map (Credential 'DRepRole) DRepState))
    -&gt; EpochState era
    -&gt; Const (Map (Credential 'DRepRole) DRepState) (EpochState era))
-&gt; Getting
     (Map (Credential 'DRepRole) DRepState)
     (NewEpochState era)
     (Map (Credential 'DRepRole) DRepState)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LedgerState era
 -&gt; Const (Map (Credential 'DRepRole) DRepState) (LedgerState era))
-&gt; EpochState era
-&gt; Const (Map (Credential 'DRepRole) DRepState) (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">esLStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LedgerState era
  -&gt; Const (Map (Credential 'DRepRole) DRepState) (LedgerState era))
 -&gt; EpochState era
 -&gt; Const (Map (Credential 'DRepRole) DRepState) (EpochState era))
-&gt; ((Map (Credential 'DRepRole) DRepState
     -&gt; Const
          (Map (Credential 'DRepRole) DRepState)
          (Map (Credential 'DRepRole) DRepState))
    -&gt; LedgerState era
    -&gt; Const (Map (Credential 'DRepRole) DRepState) (LedgerState era))
-&gt; (Map (Credential 'DRepRole) DRepState
    -&gt; Const
         (Map (Credential 'DRepRole) DRepState)
         (Map (Credential 'DRepRole) DRepState))
-&gt; EpochState era
-&gt; Const (Map (Credential 'DRepRole) DRepState) (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CertState era
 -&gt; Const (Map (Credential 'DRepRole) DRepState) (CertState era))
-&gt; LedgerState era
-&gt; Const (Map (Credential 'DRepRole) DRepState) (LedgerState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">lsCertStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CertState era
  -&gt; Const (Map (Credential 'DRepRole) DRepState) (CertState era))
 -&gt; LedgerState era
 -&gt; Const (Map (Credential 'DRepRole) DRepState) (LedgerState era))
-&gt; ((Map (Credential 'DRepRole) DRepState
     -&gt; Const
          (Map (Credential 'DRepRole) DRepState)
          (Map (Credential 'DRepRole) DRepState))
    -&gt; CertState era
    -&gt; Const (Map (Credential 'DRepRole) DRepState) (CertState era))
-&gt; (Map (Credential 'DRepRole) DRepState
    -&gt; Const
         (Map (Credential 'DRepRole) DRepState)
         (Map (Credential 'DRepRole) DRepState))
-&gt; LedgerState era
-&gt; Const (Map (Credential 'DRepRole) DRepState) (LedgerState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VState era
 -&gt; Const (Map (Credential 'DRepRole) DRepState) (VState era))
-&gt; CertState era
-&gt; Const (Map (Credential 'DRepRole) DRepState) (CertState era)
forall era.
ConwayEraCertState era =&gt;
Lens' (CertState era) (VState era)
Lens' (CertState era) (VState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.CertState.html#certVStateL"><span class="hs-identifier hs-var">certVStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((VState era
  -&gt; Const (Map (Credential 'DRepRole) DRepState) (VState era))
 -&gt; CertState era
 -&gt; Const (Map (Credential 'DRepRole) DRepState) (CertState era))
-&gt; ((Map (Credential 'DRepRole) DRepState
     -&gt; Const
          (Map (Credential 'DRepRole) DRepState)
          (Map (Credential 'DRepRole) DRepState))
    -&gt; VState era
    -&gt; Const (Map (Credential 'DRepRole) DRepState) (VState era))
-&gt; (Map (Credential 'DRepRole) DRepState
    -&gt; Const
         (Map (Credential 'DRepRole) DRepState)
         (Map (Credential 'DRepRole) DRepState))
-&gt; CertState era
-&gt; Const (Map (Credential 'DRepRole) DRepState) (CertState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map (Credential 'DRepRole) DRepState
 -&gt; Const
      (Map (Credential 'DRepRole) DRepState)
      (Map (Credential 'DRepRole) DRepState))
-&gt; VState era
-&gt; Const (Map (Credential 'DRepRole) DRepState) (VState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(Map (Credential 'DRepRole) DRepState
 -&gt; f (Map (Credential 'DRepRole) DRepState))
-&gt; VState era -&gt; f (VState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.VState.html#vsDRepsL"><span class="hs-identifier hs-var">vsDRepsL</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span id="local-6989586621679316993"><span class="annot"><span class="annottext">computeDistr :: Map (Credential 'DRepRole) Coin
-&gt; Credential 'DRepRole
-&gt; DRepState
-&gt; Map (Credential 'DRepRole) Coin
</span><a href="#local-6989586621679316993"><span class="hs-identifier hs-var hs-var">computeDistr</span></a></span></span><span> </span><span id="local-6989586621679316996"><span class="annot"><span class="annottext">Map (Credential 'DRepRole) Coin
</span><a href="#local-6989586621679316996"><span class="hs-identifier hs-var">distrAcc</span></a></span></span><span> </span><span id="local-6989586621679316997"><span class="annot"><span class="annottext">Credential 'DRepRole
</span><a href="#local-6989586621679316997"><span class="hs-identifier hs-var">dRepCred</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#DRepState"><span class="hs-identifier hs-type">DRepState</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679316999"><span id="local-6989586621679317000"><span id="local-6989586621679317001"><span id="local-6989586621679317002"><span class="annot"><span class="annottext">Set (Credential 'Staking)
StrictMaybe Anchor
EpochNo
CompactForm Coin
drepDelegs :: DRepState -&gt; Set (Credential 'Staking)
drepExpiry :: EpochNo
drepAnchor :: StrictMaybe Anchor
drepDeposit :: CompactForm Coin
drepDelegs :: Set (Credential 'Staking)
drepExpiry :: DRepState -&gt; EpochNo
drepAnchor :: DRepState -&gt; StrictMaybe Anchor
drepDeposit :: DRepState -&gt; CompactForm Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.DRep.html#drepDelegs"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-247"></span><span>      </span><span class="annot"><span class="annottext">Credential 'DRepRole
-&gt; Coin
-&gt; Map (Credential 'DRepRole) Coin
-&gt; Map (Credential 'DRepRole) Coin
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Credential 'DRepRole
</span><a href="#local-6989586621679316997"><span class="hs-identifier hs-var">dRepCred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (Credential 'Staking) -&gt; Coin
</span><a href="#local-6989586621679317007"><span class="hs-identifier hs-var">totalDelegations</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621679317002"><span class="hs-identifier hs-var">drepDelegs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'DRepRole) Coin
</span><a href="#local-6989586621679316996"><span class="hs-identifier hs-var">distrAcc</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621679317007"><span class="annot"><span class="annottext">totalDelegations :: Set (Credential 'Staking) -&gt; Coin
</span><a href="#local-6989586621679317007"><span class="hs-identifier hs-var hs-var">totalDelegations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>      </span><span class="annot"><span class="annottext">CompactForm Coin -&gt; Coin
forall a. Compactible a =&gt; CompactForm a -&gt; a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#fromCompact"><span class="hs-identifier hs-var">fromCompact</span></a></span><span> </span><span class="annot"><span class="annottext">(CompactForm Coin -&gt; Coin)
-&gt; (Set (Credential 'Staking) -&gt; CompactForm Coin)
-&gt; Set (Credential 'Staking)
-&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Credential 'Staking -&gt; CompactForm Coin)
-&gt; Set (Credential 'Staking) -&gt; CompactForm Coin
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Set a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; CompactForm Coin
</span><a href="#local-6989586621679317009"><span class="hs-identifier hs-var">stakeAndDeposits</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span id="local-6989586621679317010"><span class="annot"><span class="annottext">instantStake :: Map (Credential 'Staking) (CompactForm Coin)
</span><a href="#local-6989586621679317010"><span class="hs-identifier hs-var hs-var">instantStake</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316991"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting
     (Map (Credential 'Staking) (CompactForm Coin))
     (NewEpochState era)
     (Map (Credential 'Staking) (CompactForm Coin))
-&gt; Map (Credential 'Staking) (CompactForm Coin)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(InstantStake era
 -&gt; Const
      (Map (Credential 'Staking) (CompactForm Coin)) (InstantStake era))
-&gt; NewEpochState era
-&gt; Const
     (Map (Credential 'Staking) (CompactForm Coin)) (NewEpochState era)
forall era. Lens' (NewEpochState era) (InstantStake era)
forall (t :: * -&gt; *) era.
CanSetInstantStake t =&gt;
Lens' (t era) (InstantStake era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Stake.html#instantStakeL"><span class="hs-identifier hs-var">instantStakeL</span></a></span><span> </span><span class="annot"><span class="annottext">((InstantStake era
  -&gt; Const
       (Map (Credential 'Staking) (CompactForm Coin)) (InstantStake era))
 -&gt; NewEpochState era
 -&gt; Const
      (Map (Credential 'Staking) (CompactForm Coin)) (NewEpochState era))
-&gt; ((Map (Credential 'Staking) (CompactForm Coin)
     -&gt; Const
          (Map (Credential 'Staking) (CompactForm Coin))
          (Map (Credential 'Staking) (CompactForm Coin)))
    -&gt; InstantStake era
    -&gt; Const
         (Map (Credential 'Staking) (CompactForm Coin)) (InstantStake era))
-&gt; Getting
     (Map (Credential 'Staking) (CompactForm Coin))
     (NewEpochState era)
     (Map (Credential 'Staking) (CompactForm Coin))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map (Credential 'Staking) (CompactForm Coin)
 -&gt; Const
      (Map (Credential 'Staking) (CompactForm Coin))
      (Map (Credential 'Staking) (CompactForm Coin)))
-&gt; InstantStake era
-&gt; Const
     (Map (Credential 'Staking) (CompactForm Coin)) (InstantStake era)
forall era.
EraStake era =&gt;
Lens'
  (InstantStake era) (Map (Credential 'Staking) (CompactForm Coin))
Lens'
  (InstantStake era) (Map (Credential 'Staking) (CompactForm Coin))
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Stake.html#instantStakeCredentialsL"><span class="hs-identifier hs-var">instantStakeCredentialsL</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span id="local-6989586621679317013"><span class="annot"><span class="annottext">proposalDeposits :: Map (Credential 'Staking) (CompactForm Coin)
</span><a href="#local-6989586621679317013"><span class="hs-identifier hs-var hs-var">proposalDeposits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proposals era -&gt; Map (Credential 'Staking) (CompactForm Coin)
forall era.
Proposals era -&gt; Map (Credential 'Staking) (CompactForm Coin)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Proposals.html#proposalsDeposits"><span class="hs-identifier hs-var">proposalsDeposits</span></a></span><span> </span><span class="annot"><span class="annottext">(Proposals era -&gt; Map (Credential 'Staking) (CompactForm Coin))
-&gt; Proposals era -&gt; Map (Credential 'Staking) (CompactForm Coin)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679316991"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting (Proposals era) (NewEpochState era) (Proposals era)
-&gt; Proposals era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(GovState era -&gt; Const (Proposals era) (GovState era))
-&gt; NewEpochState era -&gt; Const (Proposals era) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(GovState era -&gt; f (GovState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#newEpochStateGovStateL"><span class="hs-identifier hs-var">newEpochStateGovStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((GovState era -&gt; Const (Proposals era) (GovState era))
 -&gt; NewEpochState era -&gt; Const (Proposals era) (NewEpochState era))
-&gt; ((Proposals era -&gt; Const (Proposals era) (Proposals era))
    -&gt; GovState era -&gt; Const (Proposals era) (GovState era))
-&gt; Getting (Proposals era) (NewEpochState era) (Proposals era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Proposals era -&gt; Const (Proposals era) (Proposals era))
-&gt; GovState era -&gt; Const (Proposals era) (GovState era)
forall era.
ConwayEraGov era =&gt;
Lens' (GovState era) (Proposals era)
Lens' (GovState era) (Proposals era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#proposalsGovStateL"><span class="hs-identifier hs-var">proposalsGovStateL</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621679317009"><span class="annot"><span class="annottext">stakeAndDeposits :: Credential 'Staking -&gt; CompactForm Coin
</span><a href="#local-6989586621679317009"><span class="hs-identifier hs-var hs-var">stakeAndDeposits</span></a></span></span><span> </span><span id="local-6989586621679317016"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621679317016"><span class="hs-identifier hs-var">stakeCred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><span class="annottext">CompactForm Coin -&gt; Maybe (CompactForm Coin) -&gt; CompactForm Coin
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; CompactForm Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#CompactCoin"><span class="hs-identifier hs-var">CompactCoin</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (CompactForm Coin) -&gt; CompactForm Coin)
-&gt; Maybe (CompactForm Coin) -&gt; CompactForm Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-254"></span><span>        </span><span class="annot"><span class="annottext">Credential 'Staking
-&gt; Map (Credential 'Staking) (CompactForm Coin)
-&gt; Maybe (CompactForm Coin)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621679317016"><span class="hs-identifier hs-var">stakeCred</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) (CompactForm Coin)
</span><a href="#local-6989586621679317010"><span class="hs-identifier hs-var">instantStake</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (CompactForm Coin)
-&gt; Maybe (CompactForm Coin) -&gt; Maybe (CompactForm Coin)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
-&gt; Map (Credential 'Staking) (CompactForm Coin)
-&gt; Maybe (CompactForm Coin)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621679317016"><span class="hs-identifier hs-var">stakeCred</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) (CompactForm Coin)
</span><a href="#local-6989586621679317013"><span class="hs-identifier hs-var">proposalDeposits</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="annot"><span class="hs-comment">-- | Query pool stake distribution.</span></span><span>
</span><span id="line-257"></span><span id="local-6989586621679316562"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#querySPOStakeDistr"><span class="hs-identifier hs-type">querySPOStakeDistr</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#ConwayEraGov"><span class="hs-identifier hs-type">ConwayEraGov</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316562"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316562"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-comment">-- | Specify pool key hashes whose stake distribution should be returned. When this set is</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-comment">-- empty, distributions for all of the pools will be returned.</span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span></span><span>
</span><span id="line-264"></span><span id="querySPOStakeDistr"><span class="annot"><span class="annottext">querySPOStakeDistr :: forall era.
ConwayEraGov era =&gt;
NewEpochState era
-&gt; Set (KeyHash 'StakePool) -&gt; Map (KeyHash 'StakePool) Coin
</span><a href="Cardano.Ledger.Api.State.Query.html#querySPOStakeDistr"><span class="hs-identifier hs-var hs-var">querySPOStakeDistr</span></a></span></span><span> </span><span id="local-6989586621679317026"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317026"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span id="local-6989586621679317027"><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
</span><a href="#local-6989586621679317027"><span class="hs-identifier hs-var">keys</span></a></span></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool) -&gt; Bool
forall a. Set a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
</span><a href="#local-6989586621679317027"><span class="hs-identifier hs-var">keys</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CompactForm Coin -&gt; Coin)
-&gt; Map (KeyHash 'StakePool) (CompactForm Coin)
-&gt; Map (KeyHash 'StakePool) Coin
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin -&gt; Coin
forall a. Compactible a =&gt; CompactForm a -&gt; a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#fromCompact"><span class="hs-identifier hs-var">fromCompact</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) (CompactForm Coin)
</span><a href="#local-6989586621679317028"><span class="hs-identifier hs-var">distr</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CompactForm Coin -&gt; Coin)
-&gt; Map (KeyHash 'StakePool) (CompactForm Coin)
-&gt; Map (KeyHash 'StakePool) Coin
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin -&gt; Coin
forall a. Compactible a =&gt; CompactForm a -&gt; a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#fromCompact"><span class="hs-identifier hs-var">fromCompact</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) (CompactForm Coin)
 -&gt; Map (KeyHash 'StakePool) Coin)
-&gt; Map (KeyHash 'StakePool) (CompactForm Coin)
-&gt; Map (KeyHash 'StakePool) Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) (CompactForm Coin)
</span><a href="#local-6989586621679317028"><span class="hs-identifier hs-var">distr</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) (CompactForm Coin)
-&gt; Set (KeyHash 'StakePool)
-&gt; Map (KeyHash 'StakePool) (CompactForm Coin)
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-operator hs-var">`Map.restrictKeys`</span></span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
</span><a href="#local-6989586621679317027"><span class="hs-identifier hs-var">keys</span></a></span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621679317028"><span class="annot"><span class="annottext">distr :: Map (KeyHash 'StakePool) (CompactForm Coin)
</span><a href="#local-6989586621679317028"><span class="hs-identifier hs-var hs-var">distr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PulsingSnapshot era -&gt; Map (KeyHash 'StakePool) (CompactForm Coin)
forall era.
PulsingSnapshot era -&gt; Map (KeyHash 'StakePool) (CompactForm Coin)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.DRepPulser.html#psPoolDistr"><span class="hs-identifier hs-var">psPoolDistr</span></a></span><span> </span><span class="annot"><span class="annottext">(PulsingSnapshot era
 -&gt; Map (KeyHash 'StakePool) (CompactForm Coin))
-&gt; ((PulsingSnapshot era, RatifyState era) -&gt; PulsingSnapshot era)
-&gt; (PulsingSnapshot era, RatifyState era)
-&gt; Map (KeyHash 'StakePool) (CompactForm Coin)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PulsingSnapshot era, RatifyState era) -&gt; PulsingSnapshot era
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((PulsingSnapshot era, RatifyState era)
 -&gt; Map (KeyHash 'StakePool) (CompactForm Coin))
-&gt; (PulsingSnapshot era, RatifyState era)
-&gt; Map (KeyHash 'StakePool) (CompactForm Coin)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NewEpochState era -&gt; (PulsingSnapshot era, RatifyState era)
forall era.
ConwayEraGov era =&gt;
NewEpochState era -&gt; (PulsingSnapshot era, RatifyState era)
</span><a href="Cardano.Ledger.Api.State.Query.html#finishedPulserState"><span class="hs-identifier hs-var">finishedPulserState</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317026"><span class="hs-identifier hs-var">nes</span></a></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="annot"><span class="hs-comment">-- | Query committee members</span></span><span>
</span><span id="line-271"></span><span id="local-6989586621679316566"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryCommitteeState"><span class="hs-identifier hs-type">queryCommitteeState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.CertState.html#ConwayEraCertState"><span class="hs-identifier hs-type">ConwayEraCertState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316566"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316566"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#CommitteeState"><span class="hs-identifier hs-type">CommitteeState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316566"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-272"></span><span id="queryCommitteeState"><span class="annot"><span class="annottext">queryCommitteeState :: forall era.
ConwayEraCertState era =&gt;
NewEpochState era -&gt; CommitteeState era
</span><a href="Cardano.Ledger.Api.State.Query.html#queryCommitteeState"><span class="hs-identifier hs-var hs-var">queryCommitteeState</span></a></span></span><span> </span><span id="local-6989586621679317036"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317036"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317036"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting
     (CommitteeState era) (NewEpochState era) (CommitteeState era)
-&gt; CommitteeState era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era -&gt; Const (CommitteeState era) (EpochState era))
-&gt; NewEpochState era
-&gt; Const (CommitteeState era) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era -&gt; Const (CommitteeState era) (EpochState era))
 -&gt; NewEpochState era
 -&gt; Const (CommitteeState era) (NewEpochState era))
-&gt; ((CommitteeState era
     -&gt; Const (CommitteeState era) (CommitteeState era))
    -&gt; EpochState era -&gt; Const (CommitteeState era) (EpochState era))
-&gt; Getting
     (CommitteeState era) (NewEpochState era) (CommitteeState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LedgerState era -&gt; Const (CommitteeState era) (LedgerState era))
-&gt; EpochState era -&gt; Const (CommitteeState era) (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">esLStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LedgerState era -&gt; Const (CommitteeState era) (LedgerState era))
 -&gt; EpochState era -&gt; Const (CommitteeState era) (EpochState era))
-&gt; ((CommitteeState era
     -&gt; Const (CommitteeState era) (CommitteeState era))
    -&gt; LedgerState era -&gt; Const (CommitteeState era) (LedgerState era))
-&gt; (CommitteeState era
    -&gt; Const (CommitteeState era) (CommitteeState era))
-&gt; EpochState era
-&gt; Const (CommitteeState era) (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CertState era -&gt; Const (CommitteeState era) (CertState era))
-&gt; LedgerState era -&gt; Const (CommitteeState era) (LedgerState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">lsCertStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CertState era -&gt; Const (CommitteeState era) (CertState era))
 -&gt; LedgerState era -&gt; Const (CommitteeState era) (LedgerState era))
-&gt; ((CommitteeState era
     -&gt; Const (CommitteeState era) (CommitteeState era))
    -&gt; CertState era -&gt; Const (CommitteeState era) (CertState era))
-&gt; (CommitteeState era
    -&gt; Const (CommitteeState era) (CommitteeState era))
-&gt; LedgerState era
-&gt; Const (CommitteeState era) (LedgerState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VState era -&gt; Const (CommitteeState era) (VState era))
-&gt; CertState era -&gt; Const (CommitteeState era) (CertState era)
forall era.
ConwayEraCertState era =&gt;
Lens' (CertState era) (VState era)
Lens' (CertState era) (VState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.CertState.html#certVStateL"><span class="hs-identifier hs-var">certVStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((VState era -&gt; Const (CommitteeState era) (VState era))
 -&gt; CertState era -&gt; Const (CommitteeState era) (CertState era))
-&gt; ((CommitteeState era
     -&gt; Const (CommitteeState era) (CommitteeState era))
    -&gt; VState era -&gt; Const (CommitteeState era) (VState era))
-&gt; (CommitteeState era
    -&gt; Const (CommitteeState era) (CommitteeState era))
-&gt; CertState era
-&gt; Const (CommitteeState era) (CertState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CommitteeState era
 -&gt; Const (CommitteeState era) (CommitteeState era))
-&gt; VState era -&gt; Const (CommitteeState era) (VState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CommitteeState era -&gt; f (CommitteeState era))
-&gt; VState era -&gt; f (VState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.VState.html#vsCommitteeStateL"><span class="hs-identifier hs-var">vsCommitteeStateL</span></a></span><span>
</span><span id="line-273"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">queryCommitteeState</span><span> </span><span class="hs-pragma">&quot;In favor of `queryCommitteeMembersState`&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | Query committee members. Whenever the system is in No Confidence mode this query will</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- return `Nothing`.</span><span>
</span><span id="line-277"></span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryCommitteeMembersState"><span class="hs-identifier hs-type">queryCommitteeMembersState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679316571"><span class="annot"><a href="#local-6989586621679316571"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#ConwayEraGov"><span class="hs-identifier hs-type">ConwayEraGov</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316571"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.CertState.html#ConwayEraCertState"><span class="hs-identifier hs-type">ConwayEraCertState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316571"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-280"></span><span>  </span><span class="annot"><span class="hs-comment">-- | filter by cold credentials (don't filter when empty)</span></span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#ColdCommitteeRole"><span class="hs-identifier hs-type">ColdCommitteeRole</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-282"></span><span>  </span><span class="annot"><span class="hs-comment">-- | filter by hot credentials (don't filter when empty)</span></span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#HotCommitteeRole"><span class="hs-identifier hs-type">HotCommitteeRole</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-comment">-- | filter by status (don't filter when empty)</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-comment">-- (useful, for discovering, for example, only active members)</span><span>
</span><span id="line-286"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#MemberStatus"><span class="hs-identifier hs-type">MemberStatus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-287"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316571"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-288"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#CommitteeMembersState"><span class="hs-identifier hs-type">CommitteeMembersState</span></a></span><span>
</span><span id="line-289"></span><span id="queryCommitteeMembersState"><span class="annot"><span class="annottext">queryCommitteeMembersState :: forall era.
(ConwayEraGov era, ConwayEraCertState era) =&gt;
Set (Credential 'ColdCommitteeRole)
-&gt; Set (Credential 'HotCommitteeRole)
-&gt; Set MemberStatus
-&gt; NewEpochState era
-&gt; CommitteeMembersState
</span><a href="Cardano.Ledger.Api.State.Query.html#queryCommitteeMembersState"><span class="hs-identifier hs-var hs-var">queryCommitteeMembersState</span></a></span></span><span> </span><span id="local-6989586621679317082"><span class="annot"><span class="annottext">Set (Credential 'ColdCommitteeRole)
</span><a href="#local-6989586621679317082"><span class="hs-identifier hs-var">coldCredsFilter</span></a></span></span><span> </span><span id="local-6989586621679317083"><span class="annot"><span class="annottext">Set (Credential 'HotCommitteeRole)
</span><a href="#local-6989586621679317083"><span class="hs-identifier hs-var">hotCredsFilter</span></a></span></span><span> </span><span id="local-6989586621679317084"><span class="annot"><span class="annottext">Set MemberStatus
</span><a href="#local-6989586621679317084"><span class="hs-identifier hs-var">statusFilter</span></a></span></span><span> </span><span id="local-6989586621679317085"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317085"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621679317086"><span class="annot"><span class="annottext">committee :: StrictMaybe (Committee era)
</span><a href="#local-6989586621679317086"><span class="hs-identifier hs-var hs-var">committee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era -&gt; GovState era
forall era. NewEpochState era -&gt; GovState era
</span><a href="Cardano.Ledger.Api.State.Query.html#queryGovState"><span class="hs-identifier hs-var">queryGovState</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317085"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">GovState era
-&gt; Getting
     (StrictMaybe (Committee era))
     (GovState era)
     (StrictMaybe (Committee era))
-&gt; StrictMaybe (Committee era)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (StrictMaybe (Committee era))
  (GovState era)
  (StrictMaybe (Committee era))
forall era.
ConwayEraGov era =&gt;
Lens' (GovState era) (StrictMaybe (Committee era))
Lens' (GovState era) (StrictMaybe (Committee era))
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#committeeGovStateL"><span class="hs-identifier hs-var">committeeGovStateL</span></a></span><span>
</span><span id="line-292"></span><span>    </span><span id="local-6989586621679317088"><span class="annot"><span class="annottext">comMembers :: Map (Credential 'ColdCommitteeRole) EpochNo
</span><a href="#local-6989586621679317088"><span class="hs-identifier hs-var hs-var">comMembers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Committee era -&gt; Map (Credential 'ColdCommitteeRole) EpochNo)
-&gt; StrictMaybe (Committee era)
-&gt; Map (Credential 'ColdCommitteeRole) EpochNo
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; StrictMaybe a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap'</span></span><span> </span><span class="annot"><span class="annottext">Committee era -&gt; Map (Credential 'ColdCommitteeRole) EpochNo
forall era.
Committee era -&gt; Map (Credential 'ColdCommitteeRole) EpochNo
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#committeeMembers"><span class="hs-identifier hs-var">committeeMembers</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Committee era)
</span><a href="#local-6989586621679317086"><span class="hs-identifier hs-var">committee</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621679317089"><span class="annot"><span class="annottext">nextComMembers :: Map (Credential 'ColdCommitteeRole) EpochNo
</span><a href="#local-6989586621679317089"><span class="hs-identifier hs-var hs-var">nextComMembers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era -&gt; Map (Credential 'ColdCommitteeRole) EpochNo
forall era.
ConwayEraGov era =&gt;
NewEpochState era -&gt; Map (Credential 'ColdCommitteeRole) EpochNo
</span><a href="Cardano.Ledger.Api.State.Query.html#getNextEpochCommitteeMembers"><span class="hs-identifier hs-var">getNextEpochCommitteeMembers</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317085"><span class="hs-identifier hs-var">nes</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span id="local-6989586621679317090"><span class="annot"><span class="annottext">comStateMembers :: Map (Credential 'ColdCommitteeRole) CommitteeAuthorization
</span><a href="#local-6989586621679317090"><span class="hs-identifier hs-var hs-var">comStateMembers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-295"></span><span>      </span><span class="annot"><span class="annottext">CommitteeState era
-&gt; Map (Credential 'ColdCommitteeRole) CommitteeAuthorization
forall era.
CommitteeState era
-&gt; Map (Credential 'ColdCommitteeRole) CommitteeAuthorization
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#csCommitteeCreds"><span class="hs-identifier hs-var">csCommitteeCreds</span></a></span><span> </span><span class="annot"><span class="annottext">(CommitteeState era
 -&gt; Map (Credential 'ColdCommitteeRole) CommitteeAuthorization)
-&gt; CommitteeState era
-&gt; Map (Credential 'ColdCommitteeRole) CommitteeAuthorization
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-296"></span><span>        </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317085"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting
     (CommitteeState era) (NewEpochState era) (CommitteeState era)
-&gt; CommitteeState era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era -&gt; Const (CommitteeState era) (EpochState era))
-&gt; NewEpochState era
-&gt; Const (CommitteeState era) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEpochStateL"><span class="hs-identifier hs-var">nesEpochStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era -&gt; Const (CommitteeState era) (EpochState era))
 -&gt; NewEpochState era
 -&gt; Const (CommitteeState era) (NewEpochState era))
-&gt; ((CommitteeState era
     -&gt; Const (CommitteeState era) (CommitteeState era))
    -&gt; EpochState era -&gt; Const (CommitteeState era) (EpochState era))
-&gt; Getting
     (CommitteeState era) (NewEpochState era) (CommitteeState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LedgerState era -&gt; Const (CommitteeState era) (LedgerState era))
-&gt; EpochState era -&gt; Const (CommitteeState era) (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">esLStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LedgerState era -&gt; Const (CommitteeState era) (LedgerState era))
 -&gt; EpochState era -&gt; Const (CommitteeState era) (EpochState era))
-&gt; ((CommitteeState era
     -&gt; Const (CommitteeState era) (CommitteeState era))
    -&gt; LedgerState era -&gt; Const (CommitteeState era) (LedgerState era))
-&gt; (CommitteeState era
    -&gt; Const (CommitteeState era) (CommitteeState era))
-&gt; EpochState era
-&gt; Const (CommitteeState era) (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CertState era -&gt; Const (CommitteeState era) (CertState era))
-&gt; LedgerState era -&gt; Const (CommitteeState era) (LedgerState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">lsCertStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CertState era -&gt; Const (CommitteeState era) (CertState era))
 -&gt; LedgerState era -&gt; Const (CommitteeState era) (LedgerState era))
-&gt; ((CommitteeState era
     -&gt; Const (CommitteeState era) (CommitteeState era))
    -&gt; CertState era -&gt; Const (CommitteeState era) (CertState era))
-&gt; (CommitteeState era
    -&gt; Const (CommitteeState era) (CommitteeState era))
-&gt; LedgerState era
-&gt; Const (CommitteeState era) (LedgerState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VState era -&gt; Const (CommitteeState era) (VState era))
-&gt; CertState era -&gt; Const (CommitteeState era) (CertState era)
forall era.
ConwayEraCertState era =&gt;
Lens' (CertState era) (VState era)
Lens' (CertState era) (VState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.CertState.html#certVStateL"><span class="hs-identifier hs-var">certVStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((VState era -&gt; Const (CommitteeState era) (VState era))
 -&gt; CertState era -&gt; Const (CommitteeState era) (CertState era))
-&gt; ((CommitteeState era
     -&gt; Const (CommitteeState era) (CommitteeState era))
    -&gt; VState era -&gt; Const (CommitteeState era) (VState era))
-&gt; (CommitteeState era
    -&gt; Const (CommitteeState era) (CommitteeState era))
-&gt; CertState era
-&gt; Const (CommitteeState era) (CertState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CommitteeState era
 -&gt; Const (CommitteeState era) (CommitteeState era))
-&gt; VState era -&gt; Const (CommitteeState era) (VState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CommitteeState era -&gt; f (CommitteeState era))
-&gt; VState era -&gt; f (VState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.VState.html#vsCommitteeStateL"><span class="hs-identifier hs-var">vsCommitteeStateL</span></a></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span>    </span><span id="local-6989586621679317092"><span class="annot"><span class="annottext">withFilteredColdCreds :: Set (Credential 'ColdCommitteeRole)
-&gt; Set (Credential 'ColdCommitteeRole)
</span><a href="#local-6989586621679317092"><span class="hs-identifier hs-var hs-var">withFilteredColdCreds</span></a></span></span><span> </span><span id="local-6989586621679317093"><span class="annot"><span class="annottext">Set (Credential 'ColdCommitteeRole)
</span><a href="#local-6989586621679317093"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set (Credential 'ColdCommitteeRole) -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'ColdCommitteeRole)
</span><a href="#local-6989586621679317082"><span class="hs-identifier hs-var">coldCredsFilter</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (Credential 'ColdCommitteeRole)
</span><a href="#local-6989586621679317093"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-300"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (Credential 'ColdCommitteeRole)
</span><a href="#local-6989586621679317093"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'ColdCommitteeRole)
-&gt; Set (Credential 'ColdCommitteeRole)
-&gt; Set (Credential 'ColdCommitteeRole)
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`Set.intersection`</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'ColdCommitteeRole)
</span><a href="#local-6989586621679317082"><span class="hs-identifier hs-var">coldCredsFilter</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>    </span><span id="local-6989586621679317095"><span class="annot"><span class="annottext">relevantColdKeys :: Set (Credential 'ColdCommitteeRole)
</span><a href="#local-6989586621679317095"><span class="hs-identifier hs-var hs-var">relevantColdKeys</span></a></span></span><span>
</span><span id="line-303"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set MemberStatus -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set MemberStatus
</span><a href="#local-6989586621679317084"><span class="hs-identifier hs-var">statusFilter</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">MemberStatus -&gt; Set MemberStatus -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">MemberStatus
</span><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#Unrecognized"><span class="hs-identifier hs-var">Unrecognized</span></a></span><span> </span><span class="annot"><span class="annottext">Set MemberStatus
</span><a href="#local-6989586621679317084"><span class="hs-identifier hs-var">statusFilter</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-304"></span><span>          </span><span class="annot"><span class="annottext">Set (Credential 'ColdCommitteeRole)
-&gt; Set (Credential 'ColdCommitteeRole)
</span><a href="#local-6989586621679317092"><span class="hs-identifier hs-var">withFilteredColdCreds</span></a></span><span> </span><span class="annot"><span class="annottext">(Set (Credential 'ColdCommitteeRole)
 -&gt; Set (Credential 'ColdCommitteeRole))
-&gt; Set (Credential 'ColdCommitteeRole)
-&gt; Set (Credential 'ColdCommitteeRole)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-305"></span><span>            </span><span class="annot"><span class="annottext">[Set (Credential 'ColdCommitteeRole)]
-&gt; Set (Credential 'ColdCommitteeRole)
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">Set.unions</span></span><span>
</span><span id="line-306"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'ColdCommitteeRole) EpochNo
-&gt; Set (Credential 'ColdCommitteeRole)
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'ColdCommitteeRole) EpochNo
</span><a href="#local-6989586621679317088"><span class="hs-identifier hs-var">comMembers</span></a></span><span>
</span><span id="line-307"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'ColdCommitteeRole) CommitteeAuthorization
-&gt; Set (Credential 'ColdCommitteeRole)
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'ColdCommitteeRole) CommitteeAuthorization
</span><a href="#local-6989586621679317090"><span class="hs-identifier hs-var">comStateMembers</span></a></span><span>
</span><span id="line-308"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'ColdCommitteeRole) EpochNo
-&gt; Set (Credential 'ColdCommitteeRole)
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'ColdCommitteeRole) EpochNo
</span><a href="#local-6989586621679317089"><span class="hs-identifier hs-var">nextComMembers</span></a></span><span>
</span><span id="line-309"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-310"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (Credential 'ColdCommitteeRole)
-&gt; Set (Credential 'ColdCommitteeRole)
</span><a href="#local-6989586621679317092"><span class="hs-identifier hs-var">withFilteredColdCreds</span></a></span><span> </span><span class="annot"><span class="annottext">(Set (Credential 'ColdCommitteeRole)
 -&gt; Set (Credential 'ColdCommitteeRole))
-&gt; Set (Credential 'ColdCommitteeRole)
-&gt; Set (Credential 'ColdCommitteeRole)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'ColdCommitteeRole) EpochNo
-&gt; Set (Credential 'ColdCommitteeRole)
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'ColdCommitteeRole) EpochNo
</span><a href="#local-6989586621679317088"><span class="hs-identifier hs-var">comMembers</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span>    </span><span id="local-6989586621679317099"><span class="annot"><span class="annottext">relevantHotKeys :: Set (Credential 'ColdCommitteeRole)
</span><a href="#local-6989586621679317099"><span class="hs-identifier hs-var hs-var">relevantHotKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-313"></span><span>      </span><span class="annot"><span class="annottext">[Credential 'ColdCommitteeRole]
-&gt; Set (Credential 'ColdCommitteeRole)
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span>
</span><span id="line-314"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Credential 'ColdCommitteeRole
</span><a href="#local-6989586621679317100"><span class="hs-identifier hs-var">ck</span></a></span><span>
</span><span id="line-315"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679317100"><span class="annot"><span class="annottext">Credential 'ColdCommitteeRole
</span><a href="#local-6989586621679317100"><span class="hs-identifier hs-var">ck</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#CommitteeHotCredential"><span class="hs-identifier hs-type">CommitteeHotCredential</span></a></span><span> </span><span id="local-6989586621679317102"><span class="annot"><span class="annottext">Credential 'HotCommitteeRole
</span><a href="#local-6989586621679317102"><span class="hs-identifier hs-var">hk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'ColdCommitteeRole) CommitteeAuthorization
-&gt; [(Credential 'ColdCommitteeRole, CommitteeAuthorization)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'ColdCommitteeRole) CommitteeAuthorization
</span><a href="#local-6989586621679317090"><span class="hs-identifier hs-var">comStateMembers</span></a></span><span>
</span><span id="line-316"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Credential 'HotCommitteeRole
</span><a href="#local-6989586621679317102"><span class="hs-identifier hs-var">hk</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'HotCommitteeRole
-&gt; Set (Credential 'HotCommitteeRole) -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'HotCommitteeRole)
</span><a href="#local-6989586621679317083"><span class="hs-identifier hs-var">hotCredsFilter</span></a></span><span>
</span><span id="line-317"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span>    </span><span id="local-6989586621679317104"><span class="annot"><span class="annottext">relevant :: Set (Credential 'ColdCommitteeRole)
</span><a href="#local-6989586621679317104"><span class="hs-identifier hs-var hs-var">relevant</span></a></span></span><span>
</span><span id="line-320"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set (Credential 'HotCommitteeRole) -&gt; Bool
forall a. Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.null</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'HotCommitteeRole)
</span><a href="#local-6989586621679317083"><span class="hs-identifier hs-var">hotCredsFilter</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (Credential 'ColdCommitteeRole)
</span><a href="#local-6989586621679317095"><span class="hs-identifier hs-var">relevantColdKeys</span></a></span><span>
</span><span id="line-321"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (Credential 'ColdCommitteeRole)
</span><a href="#local-6989586621679317095"><span class="hs-identifier hs-var">relevantColdKeys</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'ColdCommitteeRole)
-&gt; Set (Credential 'ColdCommitteeRole)
-&gt; Set (Credential 'ColdCommitteeRole)
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`Set.intersection`</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'ColdCommitteeRole)
</span><a href="#local-6989586621679317099"><span class="hs-identifier hs-var">relevantHotKeys</span></a></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span>    </span><span id="local-6989586621679317105"><span class="annot"><span class="annottext">cms :: Map (Credential 'ColdCommitteeRole) CommitteeMemberState
</span><a href="#local-6989586621679317105"><span class="hs-identifier hs-var hs-var">cms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe CommitteeMemberState -&gt; Maybe CommitteeMemberState)
-&gt; Map (Credential 'ColdCommitteeRole) (Maybe CommitteeMemberState)
-&gt; Map (Credential 'ColdCommitteeRole) CommitteeMemberState
forall a b k. (a -&gt; Maybe b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">Maybe CommitteeMemberState -&gt; Maybe CommitteeMemberState
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Map (Credential 'ColdCommitteeRole) (Maybe CommitteeMemberState)
 -&gt; Map (Credential 'ColdCommitteeRole) CommitteeMemberState)
-&gt; Map (Credential 'ColdCommitteeRole) (Maybe CommitteeMemberState)
-&gt; Map (Credential 'ColdCommitteeRole) CommitteeMemberState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Credential 'ColdCommitteeRole -&gt; Maybe CommitteeMemberState)
-&gt; Set (Credential 'ColdCommitteeRole)
-&gt; Map (Credential 'ColdCommitteeRole) (Maybe CommitteeMemberState)
forall k a. (k -&gt; a) -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromSet</span></span><span> </span><span class="annot"><span class="annottext">Credential 'ColdCommitteeRole -&gt; Maybe CommitteeMemberState
</span><a href="#local-6989586621679317108"><span class="hs-identifier hs-var">mkMaybeMemberState</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'ColdCommitteeRole)
</span><a href="#local-6989586621679317104"><span class="hs-identifier hs-var">relevant</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621679317109"><span class="annot"><span class="annottext">currentEpoch :: EpochNo
</span><a href="#local-6989586621679317109"><span class="hs-identifier hs-var hs-var">currentEpoch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317085"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting EpochNo (NewEpochState era) EpochNo -&gt; EpochNo
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting EpochNo (NewEpochState era) EpochNo
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochNo -&gt; f EpochNo)
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesELL"><span class="hs-identifier hs-var">nesELL</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><a href="#local-6989586621679317108"><span class="hs-identifier hs-type">mkMaybeMemberState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-327"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#ColdCommitteeRole"><span class="hs-identifier hs-type">ColdCommitteeRole</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-328"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#CommitteeMemberState"><span class="hs-identifier hs-type">CommitteeMemberState</span></a></span><span>
</span><span id="line-329"></span><span>    </span><span id="local-6989586621679317108"><span class="annot"><span class="annottext">mkMaybeMemberState :: Credential 'ColdCommitteeRole -&gt; Maybe CommitteeMemberState
</span><a href="#local-6989586621679317108"><span class="hs-identifier hs-var hs-var">mkMaybeMemberState</span></a></span></span><span> </span><span id="local-6989586621679317110"><span class="annot"><span class="annottext">Credential 'ColdCommitteeRole
</span><a href="#local-6989586621679317110"><span class="hs-identifier hs-var">coldCred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-330"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679317111"><span class="annot"><span class="annottext">mbExpiry :: Maybe EpochNo
</span><a href="#local-6989586621679317111"><span class="hs-identifier hs-var hs-var">mbExpiry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential 'ColdCommitteeRole
-&gt; Map (Credential 'ColdCommitteeRole) EpochNo -&gt; Maybe EpochNo
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Credential 'ColdCommitteeRole
</span><a href="#local-6989586621679317110"><span class="hs-identifier hs-var">coldCred</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'ColdCommitteeRole) EpochNo
</span><a href="#local-6989586621679317088"><span class="hs-identifier hs-var">comMembers</span></a></span><span>
</span><span id="line-331"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679317112"><span class="annot"><span class="annottext">status :: MemberStatus
</span><a href="#local-6989586621679317112"><span class="hs-identifier hs-var hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe EpochNo
</span><a href="#local-6989586621679317111"><span class="hs-identifier hs-var">mbExpiry</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-332"></span><span>            </span><span class="annot"><span class="annottext">Maybe EpochNo
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MemberStatus
</span><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#Unrecognized"><span class="hs-identifier hs-var">Unrecognized</span></a></span><span>
</span><span id="line-333"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679317113"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679317113"><span class="hs-identifier hs-var">expiry</span></a></span></span><span>
</span><span id="line-334"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679317109"><span class="hs-identifier hs-var">currentEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; EpochNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679317113"><span class="hs-identifier hs-var">expiry</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MemberStatus
</span><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#Expired"><span class="hs-identifier hs-var">Expired</span></a></span><span>
</span><span id="line-335"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MemberStatus
</span><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#Active"><span class="hs-identifier hs-var">Active</span></a></span><span>
</span><span id="line-336"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set MemberStatus -&gt; Bool
forall a. Set a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Set MemberStatus
</span><a href="#local-6989586621679317084"><span class="hs-identifier hs-var">statusFilter</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">MemberStatus
</span><a href="#local-6989586621679317112"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">MemberStatus -&gt; Set MemberStatus -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set MemberStatus
</span><a href="#local-6989586621679317084"><span class="hs-identifier hs-var">statusFilter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679317117"><span class="annot"><span class="annottext">hkStatus :: HotCredAuthStatus
</span><a href="#local-6989586621679317117"><span class="hs-identifier hs-var hs-var">hkStatus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-338"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Credential 'ColdCommitteeRole
-&gt; Map (Credential 'ColdCommitteeRole) CommitteeAuthorization
-&gt; Maybe CommitteeAuthorization
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Credential 'ColdCommitteeRole
</span><a href="#local-6989586621679317110"><span class="hs-identifier hs-var">coldCred</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'ColdCommitteeRole) CommitteeAuthorization
</span><a href="#local-6989586621679317090"><span class="hs-identifier hs-var">comStateMembers</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-339"></span><span>              </span><span class="annot"><span class="annottext">Maybe CommitteeAuthorization
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HotCredAuthStatus
</span><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#MemberNotAuthorized"><span class="hs-identifier hs-var">MemberNotAuthorized</span></a></span><span>
</span><span id="line-340"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#CommitteeMemberResigned"><span class="hs-identifier hs-type">CommitteeMemberResigned</span></a></span><span> </span><span id="local-6989586621679317120"><span class="annot"><span class="annottext">StrictMaybe Anchor
</span><a href="#local-6989586621679317120"><span class="hs-identifier hs-var">anchor</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Anchor -&gt; HotCredAuthStatus
</span><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#MemberResigned"><span class="hs-identifier hs-var">MemberResigned</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictMaybe Anchor -&gt; Maybe Anchor
forall a. StrictMaybe a -&gt; Maybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#strictMaybeToMaybe"><span class="hs-identifier hs-var">strictMaybeToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Anchor
</span><a href="#local-6989586621679317120"><span class="hs-identifier hs-var">anchor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#CommitteeHotCredential"><span class="hs-identifier hs-type">CommitteeHotCredential</span></a></span><span> </span><span id="local-6989586621679317122"><span class="annot"><span class="annottext">Credential 'HotCommitteeRole
</span><a href="#local-6989586621679317122"><span class="hs-identifier hs-var">hk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Credential 'HotCommitteeRole -&gt; HotCredAuthStatus
</span><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#MemberAuthorized"><span class="hs-identifier hs-var">MemberAuthorized</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'HotCommitteeRole
</span><a href="#local-6989586621679317122"><span class="hs-identifier hs-var">hk</span></a></span><span>
</span><span id="line-342"></span><span>      </span><span class="annot"><span class="annottext">CommitteeMemberState -&gt; Maybe CommitteeMemberState
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CommitteeMemberState -&gt; Maybe CommitteeMemberState)
-&gt; CommitteeMemberState -&gt; Maybe CommitteeMemberState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HotCredAuthStatus
-&gt; MemberStatus
-&gt; Maybe EpochNo
-&gt; NextEpochChange
-&gt; CommitteeMemberState
</span><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#CommitteeMemberState"><span class="hs-identifier hs-var">CommitteeMemberState</span></a></span><span> </span><span class="annot"><span class="annottext">HotCredAuthStatus
</span><a href="#local-6989586621679317117"><span class="hs-identifier hs-var">hkStatus</span></a></span><span> </span><span class="annot"><span class="annottext">MemberStatus
</span><a href="#local-6989586621679317112"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe EpochNo
</span><a href="#local-6989586621679317111"><span class="hs-identifier hs-var">mbExpiry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential 'ColdCommitteeRole -&gt; NextEpochChange
</span><a href="#local-6989586621679317125"><span class="hs-identifier hs-var">nextEpochChange</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'ColdCommitteeRole
</span><a href="#local-6989586621679317110"><span class="hs-identifier hs-var">coldCred</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span>    </span><span class="annot"><a href="#local-6989586621679317125"><span class="hs-identifier hs-type">nextEpochChange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#ColdCommitteeRole"><span class="hs-identifier hs-type">ColdCommitteeRole</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#NextEpochChange"><span class="hs-identifier hs-type">NextEpochChange</span></a></span><span>
</span><span id="line-345"></span><span>    </span><span id="local-6989586621679317125"><span class="annot"><span class="annottext">nextEpochChange :: Credential 'ColdCommitteeRole -&gt; NextEpochChange
</span><a href="#local-6989586621679317125"><span class="hs-identifier hs-var hs-var">nextEpochChange</span></a></span></span><span> </span><span id="local-6989586621679317126"><span class="annot"><span class="annottext">Credential 'ColdCommitteeRole
</span><a href="#local-6989586621679317126"><span class="hs-identifier hs-var">ck</span></a></span></span><span>
</span><span id="line-346"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679317127"><span class="hs-identifier hs-var">inCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679317129"><span class="hs-identifier hs-var">inNext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NextEpochChange
</span><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#ToBeEnacted"><span class="hs-identifier hs-var">ToBeEnacted</span></a></span><span>
</span><span id="line-347"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679317129"><span class="hs-identifier hs-var">inNext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NextEpochChange
</span><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#ToBeRemoved"><span class="hs-identifier hs-var">ToBeRemoved</span></a></span><span>
</span><span id="line-348"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679317132"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679317132"><span class="hs-identifier hs-var">curTerm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe EpochNo
</span><a href="#local-6989586621679317133"><span class="hs-identifier hs-var">lookupCurrent</span></a></span><span>
</span><span id="line-349"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679317134"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679317134"><span class="hs-identifier hs-var">nextTerm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe EpochNo
</span><a href="#local-6989586621679317135"><span class="hs-identifier hs-var">lookupNext</span></a></span><span>
</span><span id="line-350"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679317132"><span class="hs-identifier hs-var">curTerm</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; EpochNo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679317134"><span class="hs-identifier hs-var">nextTerm</span></a></span><span>
</span><span id="line-351"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- if the term is adjusted such that it expires in the next epoch,</span><span>
</span><span id="line-352"></span><span>        </span><span class="hs-comment">-- we set it to ToBeExpired instead of TermAdjusted</span><span>
</span><span id="line-353"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679317137"><span class="hs-identifier hs-var">expiringNext</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-354"></span><span>          </span><span class="annot"><span class="annottext">EpochNo -&gt; NextEpochChange
</span><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#TermAdjusted"><span class="hs-identifier hs-var">TermAdjusted</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679317134"><span class="hs-identifier hs-var">nextTerm</span></a></span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679317139"><span class="hs-identifier hs-var">expiringCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679317137"><span class="hs-identifier hs-var">expiringNext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NextEpochChange
</span><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#ToBeExpired"><span class="hs-identifier hs-var">ToBeExpired</span></a></span><span>
</span><span id="line-356"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NextEpochChange
</span><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#NoChangeExpected"><span class="hs-identifier hs-var">NoChangeExpected</span></a></span><span>
</span><span id="line-357"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-358"></span><span>        </span><span id="local-6989586621679317133"><span class="annot"><span class="annottext">lookupCurrent :: Maybe EpochNo
</span><a href="#local-6989586621679317133"><span class="hs-identifier hs-var hs-var">lookupCurrent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential 'ColdCommitteeRole
-&gt; Map (Credential 'ColdCommitteeRole) EpochNo -&gt; Maybe EpochNo
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Credential 'ColdCommitteeRole
</span><a href="#local-6989586621679317126"><span class="hs-identifier hs-var">ck</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'ColdCommitteeRole) EpochNo
</span><a href="#local-6989586621679317088"><span class="hs-identifier hs-var">comMembers</span></a></span><span>
</span><span id="line-359"></span><span>        </span><span id="local-6989586621679317135"><span class="annot"><span class="annottext">lookupNext :: Maybe EpochNo
</span><a href="#local-6989586621679317135"><span class="hs-identifier hs-var hs-var">lookupNext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential 'ColdCommitteeRole
-&gt; Map (Credential 'ColdCommitteeRole) EpochNo -&gt; Maybe EpochNo
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Credential 'ColdCommitteeRole
</span><a href="#local-6989586621679317126"><span class="hs-identifier hs-var">ck</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'ColdCommitteeRole) EpochNo
</span><a href="#local-6989586621679317089"><span class="hs-identifier hs-var">nextComMembers</span></a></span><span>
</span><span id="line-360"></span><span>        </span><span id="local-6989586621679317127"><span class="annot"><span class="annottext">inCurrent :: Bool
</span><a href="#local-6989586621679317127"><span class="hs-identifier hs-var hs-var">inCurrent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe EpochNo -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe EpochNo
</span><a href="#local-6989586621679317133"><span class="hs-identifier hs-var">lookupCurrent</span></a></span><span>
</span><span id="line-361"></span><span>        </span><span id="local-6989586621679317129"><span class="annot"><span class="annottext">inNext :: Bool
</span><a href="#local-6989586621679317129"><span class="hs-identifier hs-var hs-var">inNext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe EpochNo -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe EpochNo
</span><a href="#local-6989586621679317135"><span class="hs-identifier hs-var">lookupNext</span></a></span><span>
</span><span id="line-362"></span><span>        </span><span id="local-6989586621679317139"><span class="annot"><span class="annottext">expiringCurrent :: Bool
</span><a href="#local-6989586621679317139"><span class="hs-identifier hs-var hs-var">expiringCurrent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe EpochNo
</span><a href="#local-6989586621679317133"><span class="hs-identifier hs-var">lookupCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe EpochNo -&gt; Maybe EpochNo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; Maybe EpochNo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679317109"><span class="hs-identifier hs-var">currentEpoch</span></a></span><span>
</span><span id="line-363"></span><span>        </span><span id="local-6989586621679317137"><span class="annot"><span class="annottext">expiringNext :: Bool
</span><a href="#local-6989586621679317137"><span class="hs-identifier hs-var hs-var">expiringNext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe EpochNo
</span><a href="#local-6989586621679317135"><span class="hs-identifier hs-var">lookupNext</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe EpochNo -&gt; Maybe EpochNo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; Maybe EpochNo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679317109"><span class="hs-identifier hs-var">currentEpoch</span></a></span><span>
</span><span id="line-364"></span><span>   </span><span class="hs-keyword">in</span><span>
</span><span id="line-365"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#CommitteeMembersState"><span class="hs-identifier hs-type">CommitteeMembersState</span></a></span><span>
</span><span id="line-366"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">csCommittee :: Map (Credential 'ColdCommitteeRole) CommitteeMemberState
</span><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#csCommittee"><span class="hs-identifier hs-var">csCommittee</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'ColdCommitteeRole) CommitteeMemberState
</span><a href="#local-6989586621679317105"><span class="hs-identifier hs-var">cms</span></a></span><span>
</span><span id="line-367"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">csThreshold :: Maybe UnitInterval
</span><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#csThreshold"><span class="hs-identifier hs-var">csThreshold</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictMaybe UnitInterval -&gt; Maybe UnitInterval
forall a. StrictMaybe a -&gt; Maybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#strictMaybeToMaybe"><span class="hs-identifier hs-var">strictMaybeToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">(StrictMaybe UnitInterval -&gt; Maybe UnitInterval)
-&gt; StrictMaybe UnitInterval -&gt; Maybe UnitInterval
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Committee era
-&gt; Getting UnitInterval (Committee era) UnitInterval
-&gt; UnitInterval
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting UnitInterval (Committee era) UnitInterval
forall era (f :: * -&gt; *).
Functor f =&gt;
(UnitInterval -&gt; f UnitInterval)
-&gt; Committee era -&gt; f (Committee era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#committeeThresholdL"><span class="hs-identifier hs-var">committeeThresholdL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Committee era -&gt; UnitInterval)
-&gt; StrictMaybe (Committee era) -&gt; StrictMaybe UnitInterval
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Committee era)
</span><a href="#local-6989586621679317086"><span class="hs-identifier hs-var">committee</span></a></span><span>
</span><span id="line-368"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">csEpochNo :: EpochNo
</span><a href="Cardano.Ledger.Api.State.Query.CommitteeMembersState.html#csEpochNo"><span class="hs-identifier hs-var">csEpochNo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679317109"><span class="hs-identifier hs-var">currentEpoch</span></a></span><span>
</span><span id="line-369"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span id="local-6989586621679316607"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryChainAccountState"><span class="hs-identifier hs-type">queryChainAccountState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316607"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-373"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.ChainAccount.html#ChainAccountState"><span class="hs-identifier hs-type">ChainAccountState</span></a></span></span><span>
</span><span id="line-374"></span><span id="queryChainAccountState"><span class="annot"><span class="annottext">queryChainAccountState :: forall era. NewEpochState era -&gt; ChainAccountState
</span><a href="Cardano.Ledger.Api.State.Query.html#queryChainAccountState"><span class="hs-identifier hs-var hs-var">queryChainAccountState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting ChainAccountState (NewEpochState era) ChainAccountState
-&gt; NewEpochState era -&gt; ChainAccountState
forall a s. Getting a s a -&gt; s -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Extras.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting ChainAccountState (NewEpochState era) ChainAccountState
forall era. Lens' (NewEpochState era) ChainAccountState
forall (t :: * -&gt; *) era.
CanSetChainAccountState t =&gt;
Lens' (t era) ChainAccountState
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.ChainAccount.html#chainAccountStateL"><span class="hs-identifier hs-var">chainAccountStateL</span></a></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span id="local-6989586621679316584"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#getNextEpochCommitteeMembers"><span class="hs-identifier hs-type">getNextEpochCommitteeMembers</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-377"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#ConwayEraGov"><span class="hs-identifier hs-type">ConwayEraGov</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316584"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-378"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316584"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-379"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#ColdCommitteeRole"><span class="hs-identifier hs-type">ColdCommitteeRole</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-type">EpochNo</span></a></span></span><span>
</span><span id="line-380"></span><span id="getNextEpochCommitteeMembers"><span class="annot"><span class="annottext">getNextEpochCommitteeMembers :: forall era.
ConwayEraGov era =&gt;
NewEpochState era -&gt; Map (Credential 'ColdCommitteeRole) EpochNo
</span><a href="Cardano.Ledger.Api.State.Query.html#getNextEpochCommitteeMembers"><span class="hs-identifier hs-var hs-var">getNextEpochCommitteeMembers</span></a></span></span><span> </span><span id="local-6989586621679317157"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317157"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679317158"><span class="annot"><span class="annottext">ratifyState :: RatifyState era
</span><a href="#local-6989586621679317158"><span class="hs-identifier hs-var hs-var">ratifyState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era -&gt; RatifyState era
forall era.
ConwayEraGov era =&gt;
NewEpochState era -&gt; RatifyState era
</span><a href="Cardano.Ledger.Api.State.Query.html#queryRatifyState"><span class="hs-identifier hs-var">queryRatifyState</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317157"><span class="hs-identifier hs-var">nes</span></a></span><span>
</span><span id="line-382"></span><span>      </span><span id="local-6989586621679317159"><span class="annot"><span class="annottext">committee :: StrictMaybe (Committee era)
</span><a href="#local-6989586621679317159"><span class="hs-identifier hs-var hs-var">committee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RatifyState era
</span><a href="#local-6989586621679317158"><span class="hs-identifier hs-var">ratifyState</span></a></span><span> </span><span class="annot"><span class="annottext">RatifyState era
-&gt; Getting
     (StrictMaybe (Committee era))
     (RatifyState era)
     (StrictMaybe (Committee era))
-&gt; StrictMaybe (Committee era)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EnactState era
 -&gt; Const (StrictMaybe (Committee era)) (EnactState era))
-&gt; RatifyState era
-&gt; Const (StrictMaybe (Committee era)) (RatifyState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EnactState era -&gt; f (EnactState era))
-&gt; RatifyState era -&gt; f (RatifyState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#rsEnactStateL"><span class="hs-identifier hs-var">rsEnactStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((EnactState era
  -&gt; Const (StrictMaybe (Committee era)) (EnactState era))
 -&gt; RatifyState era
 -&gt; Const (StrictMaybe (Committee era)) (RatifyState era))
-&gt; ((StrictMaybe (Committee era)
     -&gt; Const
          (StrictMaybe (Committee era)) (StrictMaybe (Committee era)))
    -&gt; EnactState era
    -&gt; Const (StrictMaybe (Committee era)) (EnactState era))
-&gt; Getting
     (StrictMaybe (Committee era))
     (RatifyState era)
     (StrictMaybe (Committee era))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(StrictMaybe (Committee era)
 -&gt; Const
      (StrictMaybe (Committee era)) (StrictMaybe (Committee era)))
-&gt; EnactState era
-&gt; Const (StrictMaybe (Committee era)) (EnactState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(StrictMaybe (Committee era) -&gt; f (StrictMaybe (Committee era)))
-&gt; EnactState era -&gt; f (EnactState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#ensCommitteeL"><span class="hs-identifier hs-var">ensCommitteeL</span></a></span><span>
</span><span id="line-383"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Committee era -&gt; Map (Credential 'ColdCommitteeRole) EpochNo)
-&gt; StrictMaybe (Committee era)
-&gt; Map (Credential 'ColdCommitteeRole) EpochNo
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; StrictMaybe a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap'</span></span><span> </span><span class="annot"><span class="annottext">Committee era -&gt; Map (Credential 'ColdCommitteeRole) EpochNo
forall era.
Committee era -&gt; Map (Credential 'ColdCommitteeRole) EpochNo
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#committeeMembers"><span class="hs-identifier hs-var">committeeMembers</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Committee era)
</span><a href="#local-6989586621679317159"><span class="hs-identifier hs-var">committee</span></a></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="hs-comment">-- | This is a simple lookup into the state for the values of current protocol</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- parameters. These values can change on the epoch boundary. Use `queryFuturePParams` to</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- see if we are aware of any upcoming changes.</span><span>
</span><span id="line-388"></span><span id="local-6989586621679316622"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryCurrentPParams"><span class="hs-identifier hs-type">queryCurrentPParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Governance.html#EraGov"><span class="hs-identifier hs-type">EraGov</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316622"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316622"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316622"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-389"></span><span id="queryCurrentPParams"><span class="annot"><span class="annottext">queryCurrentPParams :: forall era. EraGov era =&gt; NewEpochState era -&gt; PParams era
</span><a href="Cardano.Ledger.Api.State.Query.html#queryCurrentPParams"><span class="hs-identifier hs-var hs-var">queryCurrentPParams</span></a></span></span><span> </span><span id="local-6989586621679317163"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317163"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era -&gt; GovState era
forall era. NewEpochState era -&gt; GovState era
</span><a href="Cardano.Ledger.Api.State.Query.html#queryGovState"><span class="hs-identifier hs-var">queryGovState</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317163"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">GovState era
-&gt; Getting (PParams era) (GovState era) (PParams era)
-&gt; PParams era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (PParams era) (GovState era) (PParams era)
forall era. EraGov era =&gt; Lens' (GovState era) (PParams era)
Lens' (GovState era) (PParams era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Governance.html#curPParamsGovStateL"><span class="hs-identifier hs-var">curPParamsGovStateL</span></a></span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="hs-comment">-- | This query will return values for protocol parameters that are likely to be adopted</span><span>
</span><span id="line-392"></span><span class="hs-comment">-- at the next epoch boundary. It is only when we passed 2 stability windows before the</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- end of the epoch that users can rely on this query to produce stable results.</span><span>
</span><span id="line-394"></span><span id="local-6989586621679316627"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryFuturePParams"><span class="hs-identifier hs-type">queryFuturePParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Governance.html#EraGov"><span class="hs-identifier hs-type">EraGov</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316627"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316627"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316627"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-395"></span><span id="queryFuturePParams"><span class="annot"><span class="annottext">queryFuturePParams :: forall era. EraGov era =&gt; NewEpochState era -&gt; Maybe (PParams era)
</span><a href="Cardano.Ledger.Api.State.Query.html#queryFuturePParams"><span class="hs-identifier hs-var hs-var">queryFuturePParams</span></a></span></span><span> </span><span id="local-6989586621679317168"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317168"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NewEpochState era -&gt; GovState era
forall era. NewEpochState era -&gt; GovState era
</span><a href="Cardano.Ledger.Api.State.Query.html#queryGovState"><span class="hs-identifier hs-var">queryGovState</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317168"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">GovState era
-&gt; Getting (FuturePParams era) (GovState era) (FuturePParams era)
-&gt; FuturePParams era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (FuturePParams era) (GovState era) (FuturePParams era)
forall era. EraGov era =&gt; Lens' (GovState era) (FuturePParams era)
Lens' (GovState era) (FuturePParams era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Governance.html#futurePParamsGovStateL"><span class="hs-identifier hs-var">futurePParamsGovStateL</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-397"></span><span>    </span><span class="annot"><span class="annottext">FuturePParams era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Governance.html#NoPParamsUpdate"><span class="hs-identifier hs-var">NoPParamsUpdate</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (PParams era)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-398"></span><span>    </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Governance.html#PotentialPParamsUpdate"><span class="hs-identifier hs-type">PotentialPParamsUpdate</span></a></span><span> </span><span id="local-6989586621679317172"><span class="annot"><span class="annottext">Maybe (PParams era)
</span><a href="#local-6989586621679317172"><span class="hs-identifier hs-var">mpp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (PParams era)
</span><a href="#local-6989586621679317172"><span class="hs-identifier hs-var">mpp</span></a></span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Governance.html#DefinitePParamsUpdate"><span class="hs-identifier hs-type">DefinitePParamsUpdate</span></a></span><span> </span><span id="local-6989586621679317174"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679317174"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; Maybe (PParams era)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679317174"><span class="hs-identifier hs-var">pp</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="annot"><span class="hs-comment">-- | Query proposals that are considered for ratification.</span></span><span>
</span><span id="line-402"></span><span id="local-6989586621679316631"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryProposals"><span class="hs-identifier hs-type">queryProposals</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-403"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#ConwayEraGov"><span class="hs-identifier hs-type">ConwayEraGov</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316631"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-404"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316631"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-comment">-- | Specify a set of Governance Action IDs to filter the proposals. When this set is</span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-comment">-- empty, all the proposals considered for ratification will be returned.</span><span>
</span><span id="line-407"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#GovActionId"><span class="hs-identifier hs-type">GovActionId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-408"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#GovActionState"><span class="hs-identifier hs-type">GovActionState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316631"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-409"></span><span id="queryProposals"><span class="annot"><span class="annottext">queryProposals :: forall era.
ConwayEraGov era =&gt;
NewEpochState era -&gt; Set GovActionId -&gt; Seq (GovActionState era)
</span><a href="Cardano.Ledger.Api.State.Query.html#queryProposals"><span class="hs-identifier hs-var hs-var">queryProposals</span></a></span></span><span> </span><span id="local-6989586621679317183"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317183"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span id="local-6989586621679317184"><span class="annot"><span class="annottext">Set GovActionId
</span><a href="#local-6989586621679317184"><span class="hs-identifier hs-var">gids</span></a></span></span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Set GovActionId -&gt; Bool
forall a. Set a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Set GovActionId
</span><a href="#local-6989586621679317184"><span class="hs-identifier hs-var">gids</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (GovActionState era)
</span><a href="#local-6989586621679317185"><span class="hs-identifier hs-var">proposals</span></a></span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-comment">-- TODO: Add `filter` to `cardano-strict-containers`</span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-413"></span><span>      </span><span class="annot"><span class="annottext">(GovActionState era -&gt; Bool)
-&gt; Seq (GovActionState era) -&gt; Seq (GovActionState era)
forall a. (a -&gt; Bool) -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Procedures.html#GovActionState"><span class="hs-identifier hs-type">GovActionState</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679317188"><span id="local-6989586621679317189"><span id="local-6989586621679317190"><span id="local-6989586621679317191"><span id="local-6989586621679317192"><span id="local-6989586621679317193"><span id="local-6989586621679317194"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) Vote
Map (Credential 'DRepRole) Vote
Map (Credential 'HotCommitteeRole) Vote
ProposalProcedure era
GovActionId
EpochNo
gasId :: GovActionId
gasCommitteeVotes :: Map (Credential 'HotCommitteeRole) Vote
gasDRepVotes :: Map (Credential 'DRepRole) Vote
gasStakePoolVotes :: Map (KeyHash 'StakePool) Vote
gasProposalProcedure :: ProposalProcedure era
gasProposedIn :: EpochNo
gasExpiresAfter :: EpochNo
gasId :: forall era. GovActionState era -&gt; GovActionId
gasCommitteeVotes :: forall era.
GovActionState era -&gt; Map (Credential 'HotCommitteeRole) Vote
gasDRepVotes :: forall era. GovActionState era -&gt; Map (Credential 'DRepRole) Vote
gasStakePoolVotes :: forall era. GovActionState era -&gt; Map (KeyHash 'StakePool) Vote
gasProposalProcedure :: forall era. GovActionState era -&gt; ProposalProcedure era
gasProposedIn :: forall era. GovActionState era -&gt; EpochNo
gasExpiresAfter :: forall era. GovActionState era -&gt; EpochNo
</span><a href="#local-6989586621679317188"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GovActionId
</span><a href="#local-6989586621679317188"><span class="hs-identifier hs-var">gasId</span></a></span><span> </span><span class="annot"><span class="annottext">GovActionId -&gt; Set GovActionId -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set GovActionId
</span><a href="#local-6989586621679317184"><span class="hs-identifier hs-var">gids</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq (GovActionState era)
</span><a href="#local-6989586621679317185"><span class="hs-identifier hs-var">proposals</span></a></span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-415"></span><span>    </span><span id="local-6989586621679317185"><span class="annot"><span class="annottext">proposals :: Seq (GovActionState era)
</span><a href="#local-6989586621679317185"><span class="hs-identifier hs-var hs-var">proposals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictSeq (GovActionState era) -&gt; Seq (GovActionState era)
forall a. StrictSeq a -&gt; Seq a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html#fromStrict"><span class="hs-identifier hs-var">fromStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(StrictSeq (GovActionState era) -&gt; Seq (GovActionState era))
-&gt; StrictSeq (GovActionState era) -&gt; Seq (GovActionState era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317183"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting
     (DRepPulsingState era) (NewEpochState era) (DRepPulsingState era)
-&gt; DRepPulsingState era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(GovState era -&gt; Const (DRepPulsingState era) (GovState era))
-&gt; NewEpochState era
-&gt; Const (DRepPulsingState era) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(GovState era -&gt; f (GovState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#newEpochStateGovStateL"><span class="hs-identifier hs-var">newEpochStateGovStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((GovState era -&gt; Const (DRepPulsingState era) (GovState era))
 -&gt; NewEpochState era
 -&gt; Const (DRepPulsingState era) (NewEpochState era))
-&gt; ((DRepPulsingState era
     -&gt; Const (DRepPulsingState era) (DRepPulsingState era))
    -&gt; GovState era -&gt; Const (DRepPulsingState era) (GovState era))
-&gt; Getting
     (DRepPulsingState era) (NewEpochState era) (DRepPulsingState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DRepPulsingState era
 -&gt; Const (DRepPulsingState era) (DRepPulsingState era))
-&gt; GovState era -&gt; Const (DRepPulsingState era) (GovState era)
forall era.
ConwayEraGov era =&gt;
Lens' (GovState era) (DRepPulsingState era)
Lens' (GovState era) (DRepPulsingState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#drepPulsingStateGovStateL"><span class="hs-identifier hs-var">drepPulsingStateGovStateL</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-416"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.DRepPulser.html#DRComplete"><span class="hs-identifier hs-type">DRComplete</span></a></span><span> </span><span id="local-6989586621679317205"><span class="annot"><span class="annottext">PulsingSnapshot era
</span><a href="#local-6989586621679317205"><span class="hs-identifier hs-var">snap</span></a></span></span><span> </span><span id="local-6989586621679317206"><span class="annot"><span class="annottext">RatifyState era
</span><a href="#local-6989586621679317206"><span class="hs-identifier hs-var">_rs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PulsingSnapshot era
</span><a href="#local-6989586621679317205"><span class="hs-identifier hs-var">snap</span></a></span><span> </span><span class="annot"><span class="annottext">PulsingSnapshot era
-&gt; Getting
     (StrictSeq (GovActionState era))
     (PulsingSnapshot era)
     (StrictSeq (GovActionState era))
-&gt; StrictSeq (GovActionState era)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (StrictSeq (GovActionState era))
  (PulsingSnapshot era)
  (StrictSeq (GovActionState era))
forall era (f :: * -&gt; *).
Functor f =&gt;
(StrictSeq (GovActionState era)
 -&gt; f (StrictSeq (GovActionState era)))
-&gt; PulsingSnapshot era -&gt; f (PulsingSnapshot era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.DRepPulser.html#psProposalsL"><span class="hs-identifier hs-var">psProposalsL</span></a></span><span>
</span><span id="line-417"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.DRepPulser.html#DRPulsing"><span class="hs-identifier hs-type">DRPulsing</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.DRepPulser.html#DRepPulser"><span class="hs-identifier hs-type">DRepPulser</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679317212"><span id="local-6989586621679317213"><span id="local-6989586621679317214"><span id="local-6989586621679317215"><span id="local-6989586621679317216"><span id="local-6989586621679317217"><span id="local-6989586621679317218"><span id="local-6989586621679317219"><span id="local-6989586621679317220"><span id="local-6989586621679317221"><span id="local-6989586621679317222"><span id="local-6989586621679317223"><span id="local-6989586621679317224"><span id="local-6989586621679317225"><span class="annot"><span class="annottext">Int
Map (KeyHash 'StakePool) StakePoolState
Map DRep (CompactForm Coin)
Map (Credential 'Staking) (CompactForm Coin)
Map (Credential 'DRepRole) DRepState
Accounts era
PoolDistr
CommitteeState era
InstantStake era
StrictSeq (GovActionState era)
EnactState era
EpochNo
Globals
dpPulseSize :: Int
dpAccounts :: Accounts era
dpIndex :: Int
dpInstantStake :: InstantStake era
dpStakePoolDistr :: PoolDistr
dpDRepDistr :: Map DRep (CompactForm Coin)
dpDRepState :: Map (Credential 'DRepRole) DRepState
dpCurrentEpoch :: EpochNo
dpCommitteeState :: CommitteeState era
dpEnactState :: EnactState era
dpProposals :: StrictSeq (GovActionState era)
dpProposalDeposits :: Map (Credential 'Staking) (CompactForm Coin)
dpGlobals :: Globals
dpStakePools :: Map (KeyHash 'StakePool) StakePoolState
dpPulseSize :: forall era ans (m :: * -&gt; *). DRepPulser era m ans -&gt; Int
dpAccounts :: forall era ans (m :: * -&gt; *). DRepPulser era m ans -&gt; Accounts era
dpIndex :: forall era ans (m :: * -&gt; *). DRepPulser era m ans -&gt; Int
dpInstantStake :: forall era ans (m :: * -&gt; *).
DRepPulser era m ans -&gt; InstantStake era
dpStakePoolDistr :: forall era ans (m :: * -&gt; *). DRepPulser era m ans -&gt; PoolDistr
dpDRepDistr :: forall era ans (m :: * -&gt; *).
DRepPulser era m ans -&gt; Map DRep (CompactForm Coin)
dpDRepState :: forall era ans (m :: * -&gt; *).
DRepPulser era m ans -&gt; Map (Credential 'DRepRole) DRepState
dpCurrentEpoch :: forall era ans (m :: * -&gt; *). DRepPulser era m ans -&gt; EpochNo
dpCommitteeState :: forall era ans (m :: * -&gt; *).
DRepPulser era m ans -&gt; CommitteeState era
dpEnactState :: forall era ans (m :: * -&gt; *).
DRepPulser era m ans -&gt; EnactState era
dpProposals :: forall era ans (m :: * -&gt; *).
DRepPulser era m ans -&gt; StrictSeq (GovActionState era)
dpProposalDeposits :: forall era ans (m :: * -&gt; *).
DRepPulser era m ans
-&gt; Map (Credential 'Staking) (CompactForm Coin)
dpGlobals :: forall era ans (m :: * -&gt; *). DRepPulser era m ans -&gt; Globals
dpStakePools :: forall era ans (m :: * -&gt; *).
DRepPulser era m ans -&gt; Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621679317212"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StrictSeq (GovActionState era)
</span><a href="#local-6989586621679317222"><span class="hs-identifier hs-var">dpProposals</span></a></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="annot"><span class="hs-comment">-- | Query ratification state.</span></span><span>
</span><span id="line-420"></span><span id="local-6989586621679316616"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryRatifyState"><span class="hs-identifier hs-type">queryRatifyState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#ConwayEraGov"><span class="hs-identifier hs-type">ConwayEraGov</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316616"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316616"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyState"><span class="hs-identifier hs-type">RatifyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316616"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-421"></span><span id="queryRatifyState"><span class="annot"><span class="annottext">queryRatifyState :: forall era.
ConwayEraGov era =&gt;
NewEpochState era -&gt; RatifyState era
</span><a href="Cardano.Ledger.Api.State.Query.html#queryRatifyState"><span class="hs-identifier hs-var hs-var">queryRatifyState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PulsingSnapshot era, RatifyState era) -&gt; RatifyState era
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((PulsingSnapshot era, RatifyState era) -&gt; RatifyState era)
-&gt; (NewEpochState era -&gt; (PulsingSnapshot era, RatifyState era))
-&gt; NewEpochState era
-&gt; RatifyState era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NewEpochState era -&gt; (PulsingSnapshot era, RatifyState era)
forall era.
ConwayEraGov era =&gt;
NewEpochState era -&gt; (PulsingSnapshot era, RatifyState era)
</span><a href="Cardano.Ledger.Api.State.Query.html#finishedPulserState"><span class="hs-identifier hs-var">finishedPulserState</span></a></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span id="local-6989586621679316537"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#finishedPulserState"><span class="hs-identifier hs-type">finishedPulserState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-424"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#ConwayEraGov"><span class="hs-identifier hs-type">ConwayEraGov</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316537"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-425"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316537"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.DRepPulser.html#PulsingSnapshot"><span class="hs-identifier hs-type">PulsingSnapshot</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316537"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.Internal.html#RatifyState"><span class="hs-identifier hs-type">RatifyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316537"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-427"></span><span id="finishedPulserState"><span class="annot"><span class="annottext">finishedPulserState :: forall era.
ConwayEraGov era =&gt;
NewEpochState era -&gt; (PulsingSnapshot era, RatifyState era)
</span><a href="Cardano.Ledger.Api.State.Query.html#finishedPulserState"><span class="hs-identifier hs-var hs-var">finishedPulserState</span></a></span></span><span> </span><span id="local-6989586621679317252"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317252"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DRepPulsingState era -&gt; (PulsingSnapshot era, RatifyState era)
forall era.
(EraStake era, ConwayEraAccounts era) =&gt;
DRepPulsingState era -&gt; (PulsingSnapshot era, RatifyState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.DRepPulser.html#finishDRepPulser"><span class="hs-identifier hs-var">finishDRepPulser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317252"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting
     (DRepPulsingState era) (NewEpochState era) (DRepPulsingState era)
-&gt; DRepPulsingState era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(GovState era -&gt; Const (DRepPulsingState era) (GovState era))
-&gt; NewEpochState era
-&gt; Const (DRepPulsingState era) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(GovState era -&gt; f (GovState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#newEpochStateGovStateL"><span class="hs-identifier hs-var">newEpochStateGovStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((GovState era -&gt; Const (DRepPulsingState era) (GovState era))
 -&gt; NewEpochState era
 -&gt; Const (DRepPulsingState era) (NewEpochState era))
-&gt; ((DRepPulsingState era
     -&gt; Const (DRepPulsingState era) (DRepPulsingState era))
    -&gt; GovState era -&gt; Const (DRepPulsingState era) (GovState era))
-&gt; Getting
     (DRepPulsingState era) (NewEpochState era) (DRepPulsingState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DRepPulsingState era
 -&gt; Const (DRepPulsingState era) (DRepPulsingState era))
-&gt; GovState era -&gt; Const (DRepPulsingState era) (GovState era)
forall era.
ConwayEraGov era =&gt;
Lens' (GovState era) (DRepPulsingState era)
Lens' (GovState era) (DRepPulsingState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#drepPulsingStateGovStateL"><span class="hs-identifier hs-var">drepPulsingStateGovStateL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="hs-comment">-- | Query a stake pool's reward account delegatee which determines the pool's default vote</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- in absence of an explicit vote. Note that this is different from the delegatee determined</span><span>
</span><span id="line-431"></span><span class="hs-comment">-- by the credential of the stake pool itself.</span><span>
</span><span id="line-432"></span><span id="local-6989586621679316699"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryStakePoolDefaultVote"><span class="hs-identifier hs-type">queryStakePoolDefaultVote</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#EraCertState"><span class="hs-identifier hs-type">EraCertState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316699"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.State.Account.html#ConwayEraAccounts"><span class="hs-identifier hs-type">ConwayEraAccounts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316699"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-434"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316699"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-435"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Specify the key hash of the pool whose default vote should be returned.</span></span><span>
</span><span id="line-436"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-437"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#DefaultVote"><span class="hs-identifier hs-type">DefaultVote</span></a></span></span><span>
</span><span id="line-438"></span><span id="queryStakePoolDefaultVote"><span class="annot"><span class="annottext">queryStakePoolDefaultVote :: forall era.
(EraCertState era, ConwayEraAccounts era) =&gt;
NewEpochState era -&gt; KeyHash 'StakePool -&gt; DefaultVote
</span><a href="Cardano.Ledger.Api.State.Query.html#queryStakePoolDefaultVote"><span class="hs-identifier hs-var hs-var">queryStakePoolDefaultVote</span></a></span></span><span> </span><span id="local-6989586621679317266"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317266"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span id="local-6989586621679317267"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621679317267"><span class="hs-identifier hs-var">poolId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-439"></span><span>  </span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Accounts era
-&gt; DefaultVote
forall era.
ConwayEraAccounts era =&gt;
KeyHash 'StakePool
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Accounts era
-&gt; DefaultVote
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Governance.html#defaultStakePoolVote"><span class="hs-identifier hs-var">defaultStakePoolVote</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621679317267"><span class="hs-identifier hs-var">poolId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317266"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting
     (Map (KeyHash 'StakePool) StakePoolState)
     (NewEpochState era)
     (Map (KeyHash 'StakePool) StakePoolState)
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState) (EpochState era))
-&gt; NewEpochState era
-&gt; Const
     (Map (KeyHash 'StakePool) StakePoolState) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era
  -&gt; Const
       (Map (KeyHash 'StakePool) StakePoolState) (EpochState era))
 -&gt; NewEpochState era
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState) (NewEpochState era))
-&gt; ((Map (KeyHash 'StakePool) StakePoolState
     -&gt; Const
          (Map (KeyHash 'StakePool) StakePoolState)
          (Map (KeyHash 'StakePool) StakePoolState))
    -&gt; EpochState era
    -&gt; Const
         (Map (KeyHash 'StakePool) StakePoolState) (EpochState era))
-&gt; Getting
     (Map (KeyHash 'StakePool) StakePoolState)
     (NewEpochState era)
     (Map (KeyHash 'StakePool) StakePoolState)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) StakePoolState
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState)
      (Map (KeyHash 'StakePool) StakePoolState))
-&gt; EpochState era
-&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (EpochState era)
forall era.
EraCertState era =&gt;
Lens' (EpochState era) (Map (KeyHash 'StakePool) StakePoolState)
Lens' (EpochState era) (Map (KeyHash 'StakePool) StakePoolState)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#epochStateStakePoolsL"><span class="hs-identifier hs-var">epochStateStakePoolsL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Accounts era -&gt; DefaultVote) -&gt; Accounts era -&gt; DefaultVote
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-440"></span><span>    </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317266"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting (Accounts era) (NewEpochState era) (Accounts era)
-&gt; Accounts era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era -&gt; Const (Accounts era) (EpochState era))
-&gt; NewEpochState era -&gt; Const (Accounts era) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era -&gt; Const (Accounts era) (EpochState era))
 -&gt; NewEpochState era -&gt; Const (Accounts era) (NewEpochState era))
-&gt; ((Accounts era -&gt; Const (Accounts era) (Accounts era))
    -&gt; EpochState era -&gt; Const (Accounts era) (EpochState era))
-&gt; Getting (Accounts era) (NewEpochState era) (Accounts era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LedgerState era -&gt; Const (Accounts era) (LedgerState era))
-&gt; EpochState era -&gt; Const (Accounts era) (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">esLStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LedgerState era -&gt; Const (Accounts era) (LedgerState era))
 -&gt; EpochState era -&gt; Const (Accounts era) (EpochState era))
-&gt; ((Accounts era -&gt; Const (Accounts era) (Accounts era))
    -&gt; LedgerState era -&gt; Const (Accounts era) (LedgerState era))
-&gt; (Accounts era -&gt; Const (Accounts era) (Accounts era))
-&gt; EpochState era
-&gt; Const (Accounts era) (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CertState era -&gt; Const (Accounts era) (CertState era))
-&gt; LedgerState era -&gt; Const (Accounts era) (LedgerState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">lsCertStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CertState era -&gt; Const (Accounts era) (CertState era))
 -&gt; LedgerState era -&gt; Const (Accounts era) (LedgerState era))
-&gt; ((Accounts era -&gt; Const (Accounts era) (Accounts era))
    -&gt; CertState era -&gt; Const (Accounts era) (CertState era))
-&gt; (Accounts era -&gt; Const (Accounts era) (Accounts era))
-&gt; LedgerState era
-&gt; Const (Accounts era) (LedgerState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DState era -&gt; Const (Accounts era) (DState era))
-&gt; CertState era -&gt; Const (Accounts era) (CertState era)
forall era. EraCertState era =&gt; Lens' (CertState era) (DState era)
Lens' (CertState era) (DState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#certDStateL"><span class="hs-identifier hs-var">certDStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((DState era -&gt; Const (Accounts era) (DState era))
 -&gt; CertState era -&gt; Const (Accounts era) (CertState era))
-&gt; ((Accounts era -&gt; Const (Accounts era) (Accounts era))
    -&gt; DState era -&gt; Const (Accounts era) (DState era))
-&gt; (Accounts era -&gt; Const (Accounts era) (Accounts era))
-&gt; CertState era
-&gt; Const (Accounts era) (CertState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Accounts era -&gt; Const (Accounts era) (Accounts era))
-&gt; DState era -&gt; Const (Accounts era) (DState era)
forall era. Lens' (DState era) (Accounts era)
forall (t :: * -&gt; *) era.
CanSetAccounts t =&gt;
Lens' (t era) (Accounts era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#accountsL"><span class="hs-identifier hs-var">accountsL</span></a></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span class="hs-comment">-- | Used only for the `queryPoolState` query. This resembles the older way of</span><span>
</span><span id="line-443"></span><span class="hs-comment">-- representing StakePoolState in Ledger.</span><span>
</span><span id="line-444"></span><span class="hs-keyword">data</span><span> </span><span id="QueryPoolStateResult"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#QueryPoolStateResult"><span class="hs-identifier hs-var">QueryPoolStateResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="QueryPoolStateResult"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#QueryPoolStateResult"><span class="hs-identifier hs-var">QueryPoolStateResult</span></a></span></span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="qpsrStakePoolParams"><span class="annot"><span class="annottext">QueryPoolStateResult -&gt; Map (KeyHash 'StakePool) PoolParams
</span><a href="Cardano.Ledger.Api.State.Query.html#qpsrStakePoolParams"><span class="hs-identifier hs-var hs-var">qpsrStakePoolParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#PoolParams"><span class="hs-identifier hs-type">PoolParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="qpsrFutureStakePoolParams"><span class="annot"><span class="annottext">QueryPoolStateResult -&gt; Map (KeyHash 'StakePool) PoolParams
</span><a href="Cardano.Ledger.Api.State.Query.html#qpsrFutureStakePoolParams"><span class="hs-identifier hs-var hs-var">qpsrFutureStakePoolParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#PoolParams"><span class="hs-identifier hs-type">PoolParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="qpsrRetiring"><span class="annot"><span class="annottext">QueryPoolStateResult -&gt; Map (KeyHash 'StakePool) EpochNo
</span><a href="Cardano.Ledger.Api.State.Query.html#qpsrRetiring"><span class="hs-identifier hs-var hs-var">qpsrRetiring</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-type">EpochNo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="qpsrDeposits"><span class="annot"><span class="annottext">QueryPoolStateResult -&gt; Map (KeyHash 'StakePool) Coin
</span><a href="Cardano.Ledger.Api.State.Query.html#qpsrDeposits"><span class="hs-identifier hs-var hs-var">qpsrDeposits</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679317275"><span id="local-6989586621679317288"><span id="local-6989586621679317292"><span class="annot"><span class="annottext">Int -&gt; QueryPoolStateResult -&gt; ShowS
[QueryPoolStateResult] -&gt; ShowS
QueryPoolStateResult -&gt; String
(Int -&gt; QueryPoolStateResult -&gt; ShowS)
-&gt; (QueryPoolStateResult -&gt; String)
-&gt; ([QueryPoolStateResult] -&gt; ShowS)
-&gt; Show QueryPoolStateResult
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; QueryPoolStateResult -&gt; ShowS
showsPrec :: Int -&gt; QueryPoolStateResult -&gt; ShowS
$cshow :: QueryPoolStateResult -&gt; String
show :: QueryPoolStateResult -&gt; String
$cshowList :: [QueryPoolStateResult] -&gt; ShowS
showList :: [QueryPoolStateResult] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679317300"><span id="local-6989586621679317311"><span class="annot"><span class="annottext">QueryPoolStateResult -&gt; QueryPoolStateResult -&gt; Bool
(QueryPoolStateResult -&gt; QueryPoolStateResult -&gt; Bool)
-&gt; (QueryPoolStateResult -&gt; QueryPoolStateResult -&gt; Bool)
-&gt; Eq QueryPoolStateResult
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: QueryPoolStateResult -&gt; QueryPoolStateResult -&gt; Bool
== :: QueryPoolStateResult -&gt; QueryPoolStateResult -&gt; Bool
$c/= :: QueryPoolStateResult -&gt; QueryPoolStateResult -&gt; Bool
/= :: QueryPoolStateResult -&gt; QueryPoolStateResult -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679317322"><span id="local-6989586621679317326"><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/doc/html/cardano-ledger-binary/src/Cardano.Ledger.Binary.Encoding.EncCBOR.html#EncCBOR"><span class="hs-identifier hs-type">EncCBOR</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#QueryPoolStateResult"><span class="hs-identifier hs-type">QueryPoolStateResult</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-453"></span><span>  </span><span id="local-6989586621679317349"><span class="annot"><span class="annottext">encCBOR :: QueryPoolStateResult -&gt; Encoding
</span><a href="#local-6989586621679317349"><span class="hs-identifier hs-var hs-var hs-var hs-var">encCBOR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#QueryPoolStateResult"><span class="hs-identifier hs-type">QueryPoolStateResult</span></a></span><span> </span><span id="local-6989586621679317351"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) PoolParams
</span><a href="#local-6989586621679317351"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679317352"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) PoolParams
</span><a href="#local-6989586621679317352"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679317353"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) EpochNo
</span><a href="#local-6989586621679317353"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679317354"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) Coin
</span><a href="#local-6989586621679317354"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-454"></span><span>    </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/doc/html/cardano-ledger-binary/src/Cardano.Ledger.Binary.Encoding.Encoder.html#encodeListLen"><span class="hs-identifier hs-var">encodeListLen</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) PoolParams -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/doc/html/cardano-ledger-binary/src/Cardano.Ledger.Binary.Encoding.EncCBOR.html#encCBOR"><span class="hs-identifier hs-var">encCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) PoolParams
</span><a href="#local-6989586621679317351"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) PoolParams -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/doc/html/cardano-ledger-binary/src/Cardano.Ledger.Binary.Encoding.EncCBOR.html#encCBOR"><span class="hs-identifier hs-var">encCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) PoolParams
</span><a href="#local-6989586621679317352"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) EpochNo -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/doc/html/cardano-ledger-binary/src/Cardano.Ledger.Binary.Encoding.EncCBOR.html#encCBOR"><span class="hs-identifier hs-var">encCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) EpochNo
</span><a href="#local-6989586621679317353"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) Coin -&gt; Encoding
forall a. EncCBOR a =&gt; a -&gt; Encoding
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/doc/html/cardano-ledger-binary/src/Cardano.Ledger.Binary.Encoding.EncCBOR.html#encCBOR"><span class="hs-identifier hs-var">encCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) Coin
</span><a href="#local-6989586621679317354"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679317360"><span id="local-6989586621679317364"><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/doc/html/cardano-ledger-binary/src/Cardano.Ledger.Binary.Decoding.DecCBOR.html#DecCBOR"><span class="hs-identifier hs-type">DecCBOR</span></a></span><span> </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#QueryPoolStateResult"><span class="hs-identifier hs-type">QueryPoolStateResult</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-457"></span><span>  </span><span id="local-6989586621679317393"><span class="annot"><span class="annottext">decCBOR :: forall s. Decoder s QueryPoolStateResult
</span><a href="#local-6989586621679317393"><span class="hs-identifier hs-var hs-var hs-var hs-var">decCBOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; (QueryPoolStateResult -&gt; Int)
-&gt; Decoder s QueryPoolStateResult
-&gt; Decoder s QueryPoolStateResult
forall a s. Text -&gt; (a -&gt; Int) -&gt; Decoder s a -&gt; Decoder s a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/doc/html/cardano-ledger-binary/src/Cardano.Ledger.Binary.Decoding.Decoder.html#decodeRecordNamed"><span class="hs-identifier hs-var">decodeRecordNamed</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;QueryPoolStateResult&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; QueryPoolStateResult -&gt; Int
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Decoder s QueryPoolStateResult -&gt; Decoder s QueryPoolStateResult)
-&gt; Decoder s QueryPoolStateResult -&gt; Decoder s QueryPoolStateResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-458"></span><span>    </span><span id="local-6989586621679317397"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) PoolParams
</span><a href="#local-6989586621679317397"><span class="hs-identifier hs-var">qpsrStakePoolParams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (Map (KeyHash 'StakePool) PoolParams)
forall s. Decoder s (Map (KeyHash 'StakePool) PoolParams)
forall a s. DecCBOR a =&gt; Decoder s a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/doc/html/cardano-ledger-binary/src/Cardano.Ledger.Binary.Decoding.DecCBOR.html#decCBOR"><span class="hs-identifier hs-var">decCBOR</span></a></span><span>
</span><span id="line-459"></span><span>    </span><span id="local-6989586621679317398"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) PoolParams
</span><a href="#local-6989586621679317398"><span class="hs-identifier hs-var">qpsrFutureStakePoolParams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (Map (KeyHash 'StakePool) PoolParams)
forall s. Decoder s (Map (KeyHash 'StakePool) PoolParams)
forall a s. DecCBOR a =&gt; Decoder s a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/doc/html/cardano-ledger-binary/src/Cardano.Ledger.Binary.Decoding.DecCBOR.html#decCBOR"><span class="hs-identifier hs-var">decCBOR</span></a></span><span>
</span><span id="line-460"></span><span>    </span><span id="local-6989586621679317399"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) EpochNo
</span><a href="#local-6989586621679317399"><span class="hs-identifier hs-var">qpsrRetiring</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (Map (KeyHash 'StakePool) EpochNo)
forall s. Decoder s (Map (KeyHash 'StakePool) EpochNo)
forall a s. DecCBOR a =&gt; Decoder s a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/doc/html/cardano-ledger-binary/src/Cardano.Ledger.Binary.Decoding.DecCBOR.html#decCBOR"><span class="hs-identifier hs-var">decCBOR</span></a></span><span>
</span><span id="line-461"></span><span>    </span><span id="local-6989586621679317400"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) Coin
</span><a href="#local-6989586621679317400"><span class="hs-identifier hs-var">qpsrDeposits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (Map (KeyHash 'StakePool) Coin)
forall s. Decoder s (Map (KeyHash 'StakePool) Coin)
forall a s. DecCBOR a =&gt; Decoder s a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/doc/html/cardano-ledger-binary/src/Cardano.Ledger.Binary.Decoding.DecCBOR.html#decCBOR"><span class="hs-identifier hs-var">decCBOR</span></a></span><span>
</span><span id="line-462"></span><span>    </span><span class="annot"><span class="annottext">QueryPoolStateResult -&gt; Decoder s QueryPoolStateResult
forall a. a -&gt; Decoder s a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-463"></span><span>      </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#QueryPoolStateResult"><span class="hs-identifier hs-type">QueryPoolStateResult</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) PoolParams
qpsrStakePoolParams :: Map (KeyHash 'StakePool) PoolParams
qpsrStakePoolParams :: Map (KeyHash 'StakePool) PoolParams
</span><a href="Cardano.Ledger.Api.State.Query.html#qpsrStakePoolParams"><span class="hs-identifier hs-var hs-var">qpsrStakePoolParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) PoolParams
qpsrFutureStakePoolParams :: Map (KeyHash 'StakePool) PoolParams
qpsrFutureStakePoolParams :: Map (KeyHash 'StakePool) PoolParams
</span><a href="Cardano.Ledger.Api.State.Query.html#qpsrFutureStakePoolParams"><span class="hs-identifier hs-var hs-var">qpsrFutureStakePoolParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) EpochNo
qpsrRetiring :: Map (KeyHash 'StakePool) EpochNo
qpsrRetiring :: Map (KeyHash 'StakePool) EpochNo
</span><a href="Cardano.Ledger.Api.State.Query.html#qpsrRetiring"><span class="hs-identifier hs-var hs-var">qpsrRetiring</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) Coin
qpsrDeposits :: Map (KeyHash 'StakePool) Coin
qpsrDeposits :: Map (KeyHash 'StakePool) Coin
</span><a href="Cardano.Ledger.Api.State.Query.html#qpsrDeposits"><span class="hs-identifier hs-var hs-var">qpsrDeposits</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span id="local-6989586621679316739"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#mkQueryPoolStateResult"><span class="hs-identifier hs-type">mkQueryPoolStateResult</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679316738"><span class="annot"><a href="#local-6989586621679316738"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679316738"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679316738"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-467"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#PState"><span class="hs-identifier hs-type">PState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316739"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-468"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#QueryPoolStateResult"><span class="hs-identifier hs-type">QueryPoolStateResult</span></a></span></span><span>
</span><span id="line-469"></span><span id="mkQueryPoolStateResult"><span class="annot"><span class="annottext">mkQueryPoolStateResult :: forall era.
(forall x.
 Map (KeyHash 'StakePool) x -&gt; Map (KeyHash 'StakePool) x)
-&gt; PState era -&gt; QueryPoolStateResult
</span><a href="Cardano.Ledger.Api.State.Query.html#mkQueryPoolStateResult"><span class="hs-identifier hs-var hs-var">mkQueryPoolStateResult</span></a></span></span><span> </span><span id="local-6989586621679317402"><span class="annot"><span class="annottext">forall x. Map (KeyHash 'StakePool) x -&gt; Map (KeyHash 'StakePool) x
</span><a href="#local-6989586621679317402"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679317403"><span class="annot"><span class="annottext">PState era
</span><a href="#local-6989586621679317403"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-470"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#QueryPoolStateResult"><span class="hs-identifier hs-type">QueryPoolStateResult</span></a></span><span>
</span><span id="line-471"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">qpsrStakePoolParams :: Map (KeyHash 'StakePool) PoolParams
</span><a href="Cardano.Ledger.Api.State.Query.html#qpsrStakePoolParams"><span class="hs-identifier hs-var">qpsrStakePoolParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(KeyHash 'StakePool -&gt; StakePoolState -&gt; PoolParams)
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) PoolParams
forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.mapWithKey</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; StakePoolState -&gt; PoolParams
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#stakePoolStateToPoolParams"><span class="hs-identifier hs-var">stakePoolStateToPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621679317406"><span class="hs-identifier hs-var">restrictedStakePools</span></a></span><span>
</span><span id="line-472"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">qpsrFutureStakePoolParams :: Map (KeyHash 'StakePool) PoolParams
</span><a href="Cardano.Ledger.Api.State.Query.html#qpsrFutureStakePoolParams"><span class="hs-identifier hs-var">qpsrFutureStakePoolParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(KeyHash 'StakePool -&gt; StakePoolState -&gt; PoolParams)
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) PoolParams
forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.mapWithKey</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; StakePoolState -&gt; PoolParams
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#stakePoolStateToPoolParams"><span class="hs-identifier hs-var">stakePoolStateToPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621679317406"><span class="hs-identifier hs-var">restrictedStakePools</span></a></span><span>
</span><span id="line-473"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">qpsrRetiring :: Map (KeyHash 'StakePool) EpochNo
</span><a href="Cardano.Ledger.Api.State.Query.html#qpsrRetiring"><span class="hs-identifier hs-var">qpsrRetiring</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) EpochNo
-&gt; Map (KeyHash 'StakePool) EpochNo
forall x. Map (KeyHash 'StakePool) x -&gt; Map (KeyHash 'StakePool) x
</span><a href="#local-6989586621679317402"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) EpochNo
 -&gt; Map (KeyHash 'StakePool) EpochNo)
-&gt; Map (KeyHash 'StakePool) EpochNo
-&gt; Map (KeyHash 'StakePool) EpochNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PState era -&gt; Map (KeyHash 'StakePool) EpochNo
forall era. PState era -&gt; Map (KeyHash 'StakePool) EpochNo
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#psRetiring"><span class="hs-identifier hs-var">psRetiring</span></a></span><span> </span><span class="annot"><span class="annottext">PState era
</span><a href="#local-6989586621679317403"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-474"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">qpsrDeposits :: Map (KeyHash 'StakePool) Coin
</span><a href="Cardano.Ledger.Api.State.Query.html#qpsrDeposits"><span class="hs-identifier hs-var">qpsrDeposits</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StakePoolState -&gt; Coin)
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) Coin
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompactForm Coin -&gt; Coin
forall a. Compactible a =&gt; CompactForm a -&gt; a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#fromCompact"><span class="hs-identifier hs-var">fromCompact</span></a></span><span> </span><span class="annot"><span class="annottext">(CompactForm Coin -&gt; Coin)
-&gt; (StakePoolState -&gt; CompactForm Coin) -&gt; StakePoolState -&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StakePoolState -&gt; CompactForm Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#spsDeposit"><span class="hs-identifier hs-var">spsDeposit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621679317406"><span class="hs-identifier hs-var">restrictedStakePools</span></a></span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-477"></span><span>    </span><span id="local-6989586621679317406"><span class="annot"><span class="annottext">restrictedStakePools :: Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621679317406"><span class="hs-identifier hs-var hs-var">restrictedStakePools</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall x. Map (KeyHash 'StakePool) x -&gt; Map (KeyHash 'StakePool) x
</span><a href="#local-6989586621679317402"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) StakePoolState
 -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PState era -&gt; Map (KeyHash 'StakePool) StakePoolState
forall era. PState era -&gt; Map (KeyHash 'StakePool) StakePoolState
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#psStakePools"><span class="hs-identifier hs-var">psStakePools</span></a></span><span> </span><span class="annot"><span class="annottext">PState era
</span><a href="#local-6989586621679317403"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span class="hs-comment">-- | Query the QueryPoolStateResult. This is slightly different from the internal</span><span>
</span><span id="line-480"></span><span class="hs-comment">-- representation used by Ledger and is intended to resemble how the internal</span><span>
</span><span id="line-481"></span><span class="hs-comment">-- representation used to be.</span><span>
</span><span id="line-482"></span><span id="local-6989586621679316747"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryPoolState"><span class="hs-identifier hs-type">queryPoolState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-483"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#EraCertState"><span class="hs-identifier hs-type">EraCertState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316747"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316747"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#QueryPoolStateResult"><span class="hs-identifier hs-type">QueryPoolStateResult</span></a></span></span><span>
</span><span id="line-484"></span><span id="queryPoolState"><span class="annot"><span class="annottext">queryPoolState :: forall era.
EraCertState era =&gt;
NewEpochState era
-&gt; Maybe (Set (KeyHash 'StakePool)) -&gt; QueryPoolStateResult
</span><a href="Cardano.Ledger.Api.State.Query.html#queryPoolState"><span class="hs-identifier hs-var hs-var">queryPoolState</span></a></span></span><span> </span><span id="local-6989586621679317416"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317416"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span id="local-6989586621679317417"><span class="annot"><span class="annottext">Maybe (Set (KeyHash 'StakePool))
</span><a href="#local-6989586621679317417"><span class="hs-identifier hs-var">mPoolKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-485"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679317418"><span class="annot"><span class="annottext">pstate :: PState era
</span><a href="#local-6989586621679317418"><span class="hs-identifier hs-var hs-var">pstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317416"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting (PState era) (NewEpochState era) (PState era)
-&gt; PState era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era -&gt; Const (PState era) (EpochState era))
-&gt; NewEpochState era -&gt; Const (PState era) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era -&gt; Const (PState era) (EpochState era))
 -&gt; NewEpochState era -&gt; Const (PState era) (NewEpochState era))
-&gt; ((PState era -&gt; Const (PState era) (PState era))
    -&gt; EpochState era -&gt; Const (PState era) (EpochState era))
-&gt; Getting (PState era) (NewEpochState era) (PState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LedgerState era -&gt; Const (PState era) (LedgerState era))
-&gt; EpochState era -&gt; Const (PState era) (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">esLStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LedgerState era -&gt; Const (PState era) (LedgerState era))
 -&gt; EpochState era -&gt; Const (PState era) (EpochState era))
-&gt; ((PState era -&gt; Const (PState era) (PState era))
    -&gt; LedgerState era -&gt; Const (PState era) (LedgerState era))
-&gt; (PState era -&gt; Const (PState era) (PState era))
-&gt; EpochState era
-&gt; Const (PState era) (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CertState era -&gt; Const (PState era) (CertState era))
-&gt; LedgerState era -&gt; Const (PState era) (LedgerState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">lsCertStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CertState era -&gt; Const (PState era) (CertState era))
 -&gt; LedgerState era -&gt; Const (PState era) (LedgerState era))
-&gt; ((PState era -&gt; Const (PState era) (PState era))
    -&gt; CertState era -&gt; Const (PState era) (CertState era))
-&gt; (PState era -&gt; Const (PState era) (PState era))
-&gt; LedgerState era
-&gt; Const (PState era) (LedgerState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PState era -&gt; Const (PState era) (PState era))
-&gt; CertState era -&gt; Const (PState era) (CertState era)
forall era. EraCertState era =&gt; Lens' (CertState era) (PState era)
Lens' (CertState era) (PState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#certPStateL"><span class="hs-identifier hs-var">certPStateL</span></a></span><span>
</span><span id="line-486"></span><span>      </span><span class="annot"><a href="#local-6989586621679317420"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679317421"><span class="annot"><a href="#local-6989586621679317421"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679317421"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679317421"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-487"></span><span>      </span><span id="local-6989586621679317420"><span class="annot"><span class="annottext">f :: forall x. Map (KeyHash 'StakePool) x -&gt; Map (KeyHash 'StakePool) x
</span><a href="#local-6989586621679317420"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Set (KeyHash 'StakePool))
</span><a href="#local-6989586621679317417"><span class="hs-identifier hs-var">mPoolKeys</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-488"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Set (KeyHash 'StakePool))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) x -&gt; Map (KeyHash 'StakePool) x
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-489"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679317423"><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
</span><a href="#local-6989586621679317423"><span class="hs-identifier hs-var">keys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) x
-&gt; Set (KeyHash 'StakePool) -&gt; Map (KeyHash 'StakePool) x
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-operator hs-var">`Map.restrictKeys`</span></span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
</span><a href="#local-6989586621679317423"><span class="hs-identifier hs-var">keys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(forall x.
 Map (KeyHash 'StakePool) x -&gt; Map (KeyHash 'StakePool) x)
-&gt; PState era -&gt; QueryPoolStateResult
forall era.
(forall x.
 Map (KeyHash 'StakePool) x -&gt; Map (KeyHash 'StakePool) x)
-&gt; PState era -&gt; QueryPoolStateResult
</span><a href="Cardano.Ledger.Api.State.Query.html#mkQueryPoolStateResult"><span class="hs-identifier hs-var">mkQueryPoolStateResult</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) x -&gt; Map (KeyHash 'StakePool) x
forall x. Map (KeyHash 'StakePool) x -&gt; Map (KeyHash 'StakePool) x
</span><a href="#local-6989586621679317420"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PState era
</span><a href="#local-6989586621679317418"><span class="hs-identifier hs-var">pstate</span></a></span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="annot"><span class="hs-comment">-- | Query the current PoolParams.</span></span><span>
</span><span id="line-493"></span><span id="local-6989586621679316751"><span class="annot"><a href="Cardano.Ledger.Api.State.Query.html#queryPoolParameters"><span class="hs-identifier hs-type">queryPoolParameters</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-494"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#EraCertState"><span class="hs-identifier hs-type">EraCertState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316751"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-495"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679316751"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#PoolParams"><span class="hs-identifier hs-type">PoolParams</span></a></span></span><span>
</span><span id="line-496"></span><span id="queryPoolParameters"><span class="annot"><span class="annottext">queryPoolParameters :: forall era.
EraCertState era =&gt;
NewEpochState era
-&gt; Set (KeyHash 'StakePool) -&gt; Map (KeyHash 'StakePool) PoolParams
</span><a href="Cardano.Ledger.Api.State.Query.html#queryPoolParameters"><span class="hs-identifier hs-var hs-var">queryPoolParameters</span></a></span></span><span> </span><span id="local-6989586621679317432"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317432"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span id="local-6989586621679317433"><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
</span><a href="#local-6989586621679317433"><span class="hs-identifier hs-var">poolKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679317434"><span class="annot"><span class="annottext">pools :: Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621679317434"><span class="hs-identifier hs-var hs-var">pools</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679317432"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting
     (Map (KeyHash 'StakePool) StakePoolState)
     (NewEpochState era)
     (Map (KeyHash 'StakePool) StakePoolState)
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState) (EpochState era))
-&gt; NewEpochState era
-&gt; Const
     (Map (KeyHash 'StakePool) StakePoolState) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era
  -&gt; Const
       (Map (KeyHash 'StakePool) StakePoolState) (EpochState era))
 -&gt; NewEpochState era
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState) (NewEpochState era))
-&gt; ((Map (KeyHash 'StakePool) StakePoolState
     -&gt; Const
          (Map (KeyHash 'StakePool) StakePoolState)
          (Map (KeyHash 'StakePool) StakePoolState))
    -&gt; EpochState era
    -&gt; Const
         (Map (KeyHash 'StakePool) StakePoolState) (EpochState era))
-&gt; Getting
     (Map (KeyHash 'StakePool) StakePoolState)
     (NewEpochState era)
     (Map (KeyHash 'StakePool) StakePoolState)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LedgerState era
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era))
-&gt; EpochState era
-&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">esLStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LedgerState era
  -&gt; Const
       (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era))
 -&gt; EpochState era
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState) (EpochState era))
-&gt; ((Map (KeyHash 'StakePool) StakePoolState
     -&gt; Const
          (Map (KeyHash 'StakePool) StakePoolState)
          (Map (KeyHash 'StakePool) StakePoolState))
    -&gt; LedgerState era
    -&gt; Const
         (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era))
-&gt; (Map (KeyHash 'StakePool) StakePoolState
    -&gt; Const
         (Map (KeyHash 'StakePool) StakePoolState)
         (Map (KeyHash 'StakePool) StakePoolState))
-&gt; EpochState era
-&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CertState era
 -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era))
-&gt; LedgerState era
-&gt; Const
     (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">lsCertStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CertState era
  -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era))
 -&gt; LedgerState era
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era))
-&gt; ((Map (KeyHash 'StakePool) StakePoolState
     -&gt; Const
          (Map (KeyHash 'StakePool) StakePoolState)
          (Map (KeyHash 'StakePool) StakePoolState))
    -&gt; CertState era
    -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era))
-&gt; (Map (KeyHash 'StakePool) StakePoolState
    -&gt; Const
         (Map (KeyHash 'StakePool) StakePoolState)
         (Map (KeyHash 'StakePool) StakePoolState))
-&gt; LedgerState era
-&gt; Const
     (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PState era
 -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (PState era))
-&gt; CertState era
-&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era)
forall era. EraCertState era =&gt; Lens' (CertState era) (PState era)
Lens' (CertState era) (PState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#certPStateL"><span class="hs-identifier hs-var">certPStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((PState era
  -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (PState era))
 -&gt; CertState era
 -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era))
-&gt; ((Map (KeyHash 'StakePool) StakePoolState
     -&gt; Const
          (Map (KeyHash 'StakePool) StakePoolState)
          (Map (KeyHash 'StakePool) StakePoolState))
    -&gt; PState era
    -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (PState era))
-&gt; (Map (KeyHash 'StakePool) StakePoolState
    -&gt; Const
         (Map (KeyHash 'StakePool) StakePoolState)
         (Map (KeyHash 'StakePool) StakePoolState))
-&gt; CertState era
-&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) StakePoolState
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState)
      (Map (KeyHash 'StakePool) StakePoolState))
-&gt; PState era
-&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (PState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(Map (KeyHash 'StakePool) StakePoolState
 -&gt; f (Map (KeyHash 'StakePool) StakePoolState))
-&gt; PState era -&gt; f (PState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#psStakePoolsL"><span class="hs-identifier hs-var">psStakePoolsL</span></a></span><span>
</span><span id="line-498"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(KeyHash 'StakePool -&gt; StakePoolState -&gt; PoolParams)
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) PoolParams
forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.mapWithKey</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; StakePoolState -&gt; PoolParams
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#stakePoolStateToPoolParams"><span class="hs-identifier hs-var">stakePoolStateToPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) StakePoolState
 -&gt; Map (KeyHash 'StakePool) PoolParams)
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) PoolParams
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
-&gt; Set (KeyHash 'StakePool)
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.restrictKeys</span></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621679317434"><span class="hs-identifier hs-var">pools</span></a></span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
</span><a href="#local-6989586621679317433"><span class="hs-identifier hs-var">poolKeys</span></a></span><span>
</span><span id="line-499"></span></pre></body></html>