<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE UndecidableSuperClasses #-}</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-comment">-- | Strategy for Generic Tests</span><span>
</span><span id="line-21"></span><span class="hs-comment">--   Make the GenState include a Mode of the NewEpochState, modify</span><span>
</span><span id="line-22"></span><span class="hs-comment">--   the ModelNewEpochState to reflect what we generated.</span><span>
</span><span id="line-23"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Cardano.Ledger.Generic.GenState</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier">EraGenericGen</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier">GenEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier">GenRS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier">GenSize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#defaultGenSize"><span class="hs-identifier">defaultGenSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier">PlutusPurposeTag</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#plutusPurposeTags"><span class="hs-identifier">plutusPurposeTags</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier">elementsT</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- TODO move to a utilities module</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier">frequencyT</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- TODO move to a utilities module</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#positiveSingleDigitInt"><span class="hs-identifier">positiveSingleDigitInt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#nonNegativeSingleDigitInt"><span class="hs-identifier">nonNegativeSingleDigitInt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genSetElem"><span class="hs-identifier">genSetElem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElem"><span class="hs-identifier">genMapElem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElemWhere"><span class="hs-identifier">genMapElemWhere</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewardVal"><span class="hs-identifier">genRewardVal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier">genPositiveVal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenState"><span class="hs-identifier">genGenState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenEnv"><span class="hs-identifier">genGenEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genValidityInterval"><span class="hs-identifier">genValidityInterval</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getBlocksizeMax"><span class="hs-identifier">getBlocksizeMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getCertificateMax"><span class="hs-identifier">getCertificateMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getOldUtxoPercent"><span class="hs-identifier">getOldUtxoPercent</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getRefInputsMax"><span class="hs-identifier">getRefInputsMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getReserves"><span class="hs-identifier">getReserves</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlot"><span class="hs-identifier">getSlot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlotDelta"><span class="hs-identifier">getSlotDelta</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSpendInputsMax"><span class="hs-identifier">getSpendInputsMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getTreasury"><span class="hs-identifier">getTreasury</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoChoicesMax"><span class="hs-identifier">getUtxoChoicesMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoElem"><span class="hs-identifier">getUtxoElem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoTest"><span class="hs-identifier">getUtxoTest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getCollInputsMax"><span class="hs-identifier">getCollInputsMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getNewPoolTest"><span class="hs-identifier">getNewPoolTest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#initialLedgerState"><span class="hs-identifier">initialLedgerState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier">modifyModel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#runGenRS"><span class="hs-identifier">runGenRS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#small"><span class="hs-identifier">small</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genDatumWithHash"><span class="hs-identifier">genDatumWithHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier">genKeyHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier">genScript</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshKeyHash"><span class="hs-identifier">genFreshKeyHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genCredential"><span class="hs-identifier">genCredential</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredential"><span class="hs-identifier">genFreshCredential</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshRegCred"><span class="hs-identifier">genFreshRegCred</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPool"><span class="hs-identifier">genPool</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPoolParams"><span class="hs-identifier">genPoolParams</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewards"><span class="hs-identifier">genRewards</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genNewPool"><span class="hs-identifier">genNewPool</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genRetirementHash"><span class="hs-identifier">genRetirementHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier">initStableFields</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialUtxo"><span class="hs-identifier">modifyGenStateInitialUtxo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialAccounts"><span class="hs-identifier">modifyGenStateInitialAccounts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelCount"><span class="hs-identifier">modifyModelCount</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelIndex"><span class="hs-identifier">modifyModelIndex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelUTxO"><span class="hs-identifier">modifyModelUTxO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelMutFee"><span class="hs-identifier">modifyModelMutFee</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html"><span class="hs-identifier">Cardano.Ledger.Address</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#RewardAccount"><span class="hs-identifier">RewardAccount</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html"><span class="hs-identifier">Cardano.Ledger.Allegra.Scripts</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#AllegraEraScript"><span class="hs-identifier">AllegraEraScript</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#Timelock"><span class="hs-identifier">Timelock</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#ValidityInterval"><span class="hs-identifier">ValidityInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#RequireTimeExpire"><span class="hs-identifier">RequireTimeExpire</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#RequireTimeStart"><span class="hs-identifier">RequireTimeStart</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Plutus.Context.html"><span class="hs-identifier">Cardano.Ledger.Alonzo.Plutus.Context</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Plutus.Context.html#EraPlutusContext"><span class="hs-identifier">EraPlutusContext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Scripts.html"><span class="hs-identifier">Cardano.Ledger.Alonzo.Scripts</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Script"><span class="hs-identifier">Script</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html"><span class="hs-identifier">Cardano.Ledger.Alonzo.Tx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#IsValid"><span class="hs-identifier">IsValid</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxBody.html#ScriptIntegrityHash"><span class="hs-identifier">ScriptIntegrityHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxWits.html"><span class="hs-identifier">Cardano.Ledger.Alonzo.TxWits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxWits.html#Redeemers"><span class="hs-identifier">Redeemers</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html"><span class="hs-identifier">Cardano.Ledger.BaseTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#Network"><span class="hs-identifier">Network</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#Testnet"><span class="hs-identifier">Testnet</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#inject"><span class="hs-identifier">inject</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html"><span class="hs-identifier">Cardano.Ledger.Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#compactCoinOrError"><span class="hs-identifier">compactCoinOrError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html"><span class="hs-identifier">Cardano.Ledger.Credential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier">Credential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#KeyHashObj"><span class="hs-identifier">KeyHashObj</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#ScriptHashObj"><span class="hs-identifier">ScriptHashObj</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#StakeCredential"><span class="hs-identifier">StakeCredential</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.html"><span class="hs-identifier">Cardano.Ledger.Keys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#coerceKeyRole"><span class="hs-identifier">coerceKeyRole</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.html"><span class="hs-identifier">Cardano.Ledger.Plutus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Language.html#Language"><span class="hs-identifier">Language</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html"><span class="hs-identifier">Cardano.Ledger.Plutus.Data</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#Data"><span class="hs-identifier">Data</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#hashData"><span class="hs-identifier">hashData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Core.html"><span class="hs-identifier">Cardano.Ledger.Shelley.Core</span></a></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.html"><span class="hs-identifier">Cardano.Ledger.Shelley.LedgerState</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#LedgerState"><span class="hs-identifier">LedgerState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.IncrementalStake.html#smartUTxOState"><span class="hs-identifier">smartUTxOState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#totalObligation"><span class="hs-identifier">totalObligation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#utxosGovStateL"><span class="hs-identifier">utxosGovStateL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html"><span class="hs-identifier">Cardano.Ledger.Shelley.Scripts</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#MultiSig"><span class="hs-identifier">MultiSig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#ShelleyEraScript"><span class="hs-identifier">ShelleyEraScript</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireAllOf"><span class="hs-identifier">RequireAllOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireAnyOf"><span class="hs-identifier">RequireAnyOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireMOf"><span class="hs-identifier">RequireMOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireSignature"><span class="hs-identifier">RequireSignature</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.html"><span class="hs-identifier">Cardano.Ledger.State</span></a></span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html"><span class="hs-identifier">Cardano.Ledger.TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxId"><span class="hs-identifier">TxId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html"><span class="hs-identifier">Cardano.Ledger.Val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#Val"><span class="hs-identifier">Val</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html"><span class="hs-identifier">Cardano.Slotting.Slot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier">SlotNo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">join</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">replicateM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">zipWithM_</span></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadTrans</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.RWS.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">RWST</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">gets</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">modify</span></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/data-default-0.8.0.1-9291b190c5bc542cf17f99ce44e9365d143d76b9889465ad3d362701e6cc609e/share/doc/html/src/Data.Default.html"><span class="hs-identifier">Data.Default</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/data-default-0.8.0.1-9291b190c5bc542cf17f99ce44e9365d143d76b9889465ad3d362701e6cc609e/share/doc/html/src/Data.Default.Internal.html#Default"><span class="hs-identifier">Default</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/data-default-0.8.0.1-9291b190c5bc542cf17f99ce44e9365d143d76b9889465ad3d362701e6cc609e/share/doc/html/src/Data.Default.Internal.html#def"><span class="hs-identifier">def</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-126"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html"><span class="hs-identifier">Data.Maybe.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#StrictMaybe"><span class="hs-identifier">StrictMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier">SJust</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier">SNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html"><span class="hs-identifier">Data.Sequence.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-129"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.html"><span class="hs-identifier">Data.TreeDiff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Expr.html#Expr"><span class="hs-identifier">Expr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Class.html#ToExpr"><span class="hs-identifier">ToExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Class.html#toExpr"><span class="hs-identifier">toExpr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Word</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word64</span></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html"><span class="hs-identifier">Lens.Micro</span></a></span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.Natural</span></span><span>
</span><span id="line-136"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/l/testlib/doc/html/cardano-ledger-allegra/src/Test.Cardano.Ledger.Allegra.TreeDiff.html"><span class="hs-identifier">Test.Cardano.Ledger.Allegra.TreeDiff</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/l/testlib/doc/html/cardano-ledger-alonzo/src/Test.Cardano.Ledger.Alonzo.TreeDiff.html"><span class="hs-identifier">Test.Cardano.Ledger.Alonzo.TreeDiff</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Core.KeyPair.html"><span class="hs-identifier">Test.Cardano.Ledger.Core.KeyPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Core.KeyPair.html#KeyPair"><span class="hs-identifier">KeyPair</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Era.html"><span class="hs-identifier">Test.Cardano.Ledger.Era</span></a></span><span>
</span><span id="line-140"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html"><span class="hs-identifier">Test.Cardano.Ledger.Examples.STSTestUtils</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#EraModel"><span class="hs-identifier">EraModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier">PlutusPurposeTag</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Functions</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#alwaysFalse"><span class="hs-identifier">alwaysFalse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#alwaysTrue"><span class="hs-identifier">alwaysTrue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-144"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.ModelState</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-146"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#ModelNewEpochState"><span class="hs-identifier">ModelNewEpochState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#genDelegsZero"><span class="hs-identifier">genDelegsZero</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#instantaneousRewardsZero"><span class="hs-identifier">instantaneousRewardsZero</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-149"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mNewEpochStateZero"><span class="hs-identifier">mNewEpochStateZero</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-150"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Proof</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#lift"><span class="hs-identifier">lift</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/l/testlib/doc/html/cardano-ledger-shelley/src/Test.Cardano.Ledger.Shelley.Era.html"><span class="hs-identifier">Test.Cardano.Ledger.Shelley.Era</span></a></span><span>
</span><span id="line-153"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tasty-quickcheck-0.11.1-a6e9951148459b597606684bef39d5db052b5c7504d645a5ed13f64b535ff547/share/doc/html/src/Test.Tasty.QuickCheck.html"><span class="hs-identifier">Test.Tasty.QuickCheck</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier">Gen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Modifiers.html#Positive"><span class="hs-identifier">Positive</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-156"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier">arbitrary</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-157"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier">choose</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#elements"><span class="hs-identifier">elements</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#frequency"><span class="hs-identifier">frequency</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-160"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Era.html#EraTest"><span class="hs-identifier hs-type">EraTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#EraModel"><span class="hs-identifier hs-type">EraModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="EraGenericGen"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-var">EraGenericGen</span></a></span></span><span> </span><span id="local-6989586621682716992"><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>  </span><span id="setValidity"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#setValidity"><span class="hs-identifier hs-type">setValidity</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#ValidityInterval"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>  </span><span id="setReferenceInputs"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#setReferenceInputs"><span class="hs-identifier hs-type">setReferenceInputs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span>  </span><span id="setCollateralInputs"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#setCollateralInputs"><span class="hs-identifier hs-type">setCollateralInputs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span>  </span><span id="setTotalCollateral"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#setTotalCollateral"><span class="hs-identifier hs-type">setTotalCollateral</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#StrictMaybe"><span class="hs-identifier hs-type">StrictMaybe</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span>  </span><span id="setCollateralReturn"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#setCollateralReturn"><span class="hs-identifier hs-type">setCollateralReturn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#StrictMaybe"><span class="hs-identifier hs-type">StrictMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>  </span><span id="addRedeemers"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#addRedeemers"><span class="hs-identifier hs-type">addRedeemers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxWits.html#Redeemers"><span class="hs-identifier hs-type">Redeemers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>  </span><span id="setScriptIntegrityHash"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#setScriptIntegrityHash"><span class="hs-identifier hs-type">setScriptIntegrityHash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#StrictMaybe"><span class="hs-identifier hs-type">StrictMaybe</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxBody.html#ScriptIntegrityHash"><span class="hs-identifier hs-type">ScriptIntegrityHash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>  </span><span id="setNetworkIdTxBody"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#setNetworkIdTxBody"><span class="hs-identifier hs-type">setNetworkIdTxBody</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#StrictMaybe"><span class="hs-identifier hs-type">StrictMaybe</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span>  </span><span id="genExUnits"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genExUnits"><span class="hs-identifier hs-type">genExUnits</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.ExUnits.html#ExUnits"><span class="hs-identifier hs-type">ExUnits</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>  </span><span id="genPParams"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPParams"><span class="hs-identifier hs-type">genPParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-comment">-- Era generic &quot;lenses&quot; for testing</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>  </span><span id="ppMaxCollateralInputsT"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#ppMaxCollateralInputsT"><span class="hs-identifier hs-type">ppMaxCollateralInputsT</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>  </span><span id="ppCollateralPercentageT"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#ppCollateralPercentageT"><span class="hs-identifier hs-type">ppCollateralPercentageT</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>  </span><span id="ppCostModelsT"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#ppCostModelsT"><span class="hs-identifier hs-type">ppCostModelsT</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.CostModels.html#CostModels"><span class="hs-identifier hs-type">CostModels</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span>  </span><span id="ppMaxTxExUnitsT"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#ppMaxTxExUnitsT"><span class="hs-identifier hs-type">ppMaxTxExUnitsT</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.ExUnits.html#ExUnits"><span class="hs-identifier hs-type">ExUnits</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>  </span><span id="ppMaxBlockExUnitsT"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#ppMaxBlockExUnitsT"><span class="hs-identifier hs-type">ppMaxBlockExUnitsT</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.ExUnits.html#ExUnits"><span class="hs-identifier hs-type">ExUnits</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span>  </span><span id="ppMaxValSizeT"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#ppMaxValSizeT"><span class="hs-identifier hs-type">ppMaxValSizeT</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-comment">-- Utils</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span>  </span><span id="mkScriptIntegrityHash"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#mkScriptIntegrityHash"><span class="hs-identifier hs-type">mkScriptIntegrityHash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Language.html#Language"><span class="hs-identifier hs-type">Language</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682716992"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#StrictMaybe"><span class="hs-identifier hs-type">StrictMaybe</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxBody.html#ScriptIntegrityHash"><span class="hs-identifier hs-type">ScriptIntegrityHash</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- =================================================</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="annot"><span class="hs-comment">-- | Constants that determine how big a GenState is generated.</span></span><span>
</span><span id="line-204"></span><span class="hs-keyword">data</span><span> </span><span id="GenSize"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-var">GenSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GenSize"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-var">GenSize</span></a></span></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="treasury"><span class="annot"><span class="annottext">GenSize -&gt; Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#treasury"><span class="hs-identifier hs-var hs-var">treasury</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="reserves"><span class="annot"><span class="annottext">GenSize -&gt; Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#reserves"><span class="hs-identifier hs-var hs-var">reserves</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="startSlot"><span class="annot"><span class="annottext">GenSize -&gt; Word64
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#startSlot"><span class="hs-identifier hs-var hs-var">startSlot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="slotDelta"><span class="annot"><span class="annottext">GenSize -&gt; (Word64, Word64)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#slotDelta"><span class="hs-identifier hs-var hs-var">slotDelta</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="blocksizeMax"><span class="annot"><span class="annottext">GenSize -&gt; Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#blocksizeMax"><span class="hs-identifier hs-var hs-var">blocksizeMax</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="collInputsMax"><span class="annot"><span class="annottext">GenSize -&gt; Natural
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#collInputsMax"><span class="hs-identifier hs-var hs-var">collInputsMax</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="spendInputsMax"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#spendInputsMax"><span class="hs-identifier hs-var hs-var">spendInputsMax</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="refInputsMax"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#refInputsMax"><span class="hs-identifier hs-var hs-var">refInputsMax</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="utxoChoicesMax"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#utxoChoicesMax"><span class="hs-identifier hs-var hs-var">utxoChoicesMax</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="certificateMax"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#certificateMax"><span class="hs-identifier hs-var hs-var">certificateMax</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="withdrawalMax"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#withdrawalMax"><span class="hs-identifier hs-var hs-var">withdrawalMax</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="oldUtxoPercent"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#oldUtxoPercent"><span class="hs-identifier hs-var hs-var">oldUtxoPercent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- between 0-100, 10 means pick an old UTxO 10% of the time</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="maxStablePools"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#maxStablePools"><span class="hs-identifier hs-var hs-var">maxStablePools</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="invalidScriptFreq"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#invalidScriptFreq"><span class="hs-identifier hs-var hs-var">invalidScriptFreq</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- percentage</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="regCertFreq"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#regCertFreq"><span class="hs-identifier hs-var hs-var">regCertFreq</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="delegCertFreq"><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#delegCertFreq"><span class="hs-identifier hs-var hs-var">delegCertFreq</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682717849"><span id="local-6989586621682717874"><span id="local-6989586621682717878"><span class="annot"><span class="annottext">Int -&gt; GenSize -&gt; ShowS
[GenSize] -&gt; ShowS
GenSize -&gt; String
(Int -&gt; GenSize -&gt; ShowS)
-&gt; (GenSize -&gt; String) -&gt; ([GenSize] -&gt; ShowS) -&gt; Show GenSize
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; GenSize -&gt; ShowS
showsPrec :: Int -&gt; GenSize -&gt; ShowS
$cshow :: GenSize -&gt; String
show :: GenSize -&gt; String
$cshowList :: [GenSize] -&gt; ShowS
showList :: [GenSize] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682717882"><span id="local-6989586621682717884"><span class="annot"><span class="annottext">(forall x. GenSize -&gt; Rep GenSize x)
-&gt; (forall x. Rep GenSize x -&gt; GenSize) -&gt; Generic GenSize
forall x. Rep GenSize x -&gt; GenSize
forall x. GenSize -&gt; Rep GenSize x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. GenSize -&gt; Rep GenSize x
from :: forall x. GenSize -&gt; Rep GenSize x
$cto :: forall x. Rep GenSize x -&gt; GenSize
to :: forall x. Rep GenSize x -&gt; GenSize
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682717888"><span id="local-6989586621682717895"><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Class.html#ToExpr"><span class="hs-identifier hs-type">ToExpr</span></a></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span></span></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#defaultGenSize"><span class="hs-identifier hs-type">defaultGenSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span>
</span><span id="line-227"></span><span id="defaultGenSize"><span class="annot"><span class="annottext">defaultGenSize :: GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#defaultGenSize"><span class="hs-identifier hs-var hs-var">defaultGenSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-228"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">treasury :: Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#treasury"><span class="hs-identifier hs-var">treasury</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1000000</span></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reserves :: Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#reserves"><span class="hs-identifier hs-var">reserves</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1000000</span></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">startSlot :: Word64
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#startSlot"><span class="hs-identifier hs-var">startSlot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slotDelta :: (Word64, Word64)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#slotDelta"><span class="hs-identifier hs-var">slotDelta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">blocksizeMax :: Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#blocksizeMax"><span class="hs-identifier hs-var">blocksizeMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">collInputsMax :: Natural
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#collInputsMax"><span class="hs-identifier hs-var">collInputsMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">5</span></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oldUtxoPercent :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#oldUtxoPercent"><span class="hs-identifier hs-var">oldUtxoPercent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">15</span></span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">spendInputsMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#spendInputsMax"><span class="hs-identifier hs-var">spendInputsMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">refInputsMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#refInputsMax"><span class="hs-identifier hs-var">refInputsMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">utxoChoicesMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#utxoChoicesMax"><span class="hs-identifier hs-var">utxoChoicesMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">30</span></span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">certificateMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#certificateMax"><span class="hs-identifier hs-var">certificateMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withdrawalMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#withdrawalMax"><span class="hs-identifier hs-var">withdrawalMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">maxStablePools :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#maxStablePools"><span class="hs-identifier hs-var">maxStablePools</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">invalidScriptFreq :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#invalidScriptFreq"><span class="hs-identifier hs-var">invalidScriptFreq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">regCertFreq :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#regCertFreq"><span class="hs-identifier hs-var">regCertFreq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">75</span></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">delegCertFreq :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#delegCertFreq"><span class="hs-identifier hs-var">delegCertFreq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">50</span></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-keyword">data</span><span> </span><span id="GenEnv"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-var">GenEnv</span></a></span></span><span> </span><span id="local-6989586621682717043"><span class="annot"><a href="#local-6989586621682717043"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GenEnv"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-var">GenEnv</span></a></span></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="gePParams"><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var hs-var">gePParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717043"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="geSize"><span class="annot"><span class="annottext">forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var hs-var">geSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682718034"><span id="local-6989586621682718036"><span class="annot"><span class="annottext">(forall x. GenEnv era -&gt; Rep (GenEnv era) x)
-&gt; (forall x. Rep (GenEnv era) x -&gt; GenEnv era)
-&gt; Generic (GenEnv era)
forall x. Rep (GenEnv era) x -&gt; GenEnv era
forall x. GenEnv era -&gt; Rep (GenEnv era) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall era x. Rep (GenEnv era) x -&gt; GenEnv era
forall era x. GenEnv era -&gt; Rep (GenEnv era) x
$cfrom :: forall era x. GenEnv era -&gt; Rep (GenEnv era) x
from :: forall x. GenEnv era -&gt; Rep (GenEnv era) x
$cto :: forall era x. Rep (GenEnv era) x -&gt; GenEnv era
to :: forall x. Rep (GenEnv era) x -&gt; GenEnv era
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-keyword">data</span><span> </span><span id="GenState"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-var">GenState</span></a></span></span><span> </span><span id="local-6989586621682717050"><span class="annot"><a href="#local-6989586621682717050"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GenState"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-var">GenState</span></a></span></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="gsValidityInterval"><span class="annot"><span class="annottext">forall era. GenState era -&gt; ValidityInterval
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsValidityInterval"><span class="hs-identifier hs-var hs-var">gsValidityInterval</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#ValidityInterval"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsKeys"><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (KeyHash 'Witness) (KeyPair 'Witness)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsKeys"><span class="hs-identifier hs-var hs-var">gsKeys</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Witness"><span class="hs-identifier hs-type">Witness</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Core.KeyPair.html#KeyPair"><span class="hs-identifier hs-type">KeyPair</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Witness"><span class="hs-identifier hs-type">Witness</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsScripts"><span class="annot"><span class="annottext">forall era. GenState era -&gt; Map ScriptHash (Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsScripts"><span class="hs-identifier hs-var hs-var">gsScripts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Script"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717050"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsPlutusScripts"><span class="annot"><span class="annottext">forall era.
GenState era
-&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsPlutusScripts"><span class="hs-identifier hs-var hs-var">gsPlutusScripts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#IsValid"><span class="hs-identifier hs-type">IsValid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Script"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717050"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsDatums"><span class="annot"><span class="annottext">forall era. GenState era -&gt; Map DataHash (Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsDatums"><span class="hs-identifier hs-var hs-var">gsDatums</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#DataHash"><span class="hs-identifier hs-type">DataHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717050"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsVI"><span class="annot"><span class="annottext">forall era. GenState era -&gt; Map ValidityInterval (Set ScriptHash)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsVI"><span class="hs-identifier hs-var hs-var">gsVI</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#ValidityInterval"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsModel"><span class="annot"><span class="annottext">forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var hs-var">gsModel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#ModelNewEpochState"><span class="hs-identifier hs-type">ModelNewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717050"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsInitialUtxo"><span class="annot"><span class="annottext">forall era. GenState era -&gt; Map TxIn (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialUtxo"><span class="hs-identifier hs-var hs-var">gsInitialUtxo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717050"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsInitialAccounts"><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (Credential 'Staking) (AccountState era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialAccounts"><span class="hs-identifier hs-var hs-var">gsInitialAccounts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#AccountState"><span class="hs-identifier hs-type">AccountState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717050"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsInitialPoolParams"><span class="annot"><span class="annottext">forall era. GenState era -&gt; Map (KeyHash 'StakePool) PoolParams
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolParams"><span class="hs-identifier hs-var hs-var">gsInitialPoolParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#PoolParams"><span class="hs-identifier hs-type">PoolParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsInitialPoolDistr"><span class="annot"><span class="annottext">forall era.
GenState era -&gt; Map (KeyHash 'StakePool) IndividualPoolStake
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolDistr"><span class="hs-identifier hs-var hs-var">gsInitialPoolDistr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-265"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#IndividualPoolStake"><span class="hs-identifier hs-type">IndividualPoolStake</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Stable fields are stable from initialization to the end of the generation process</span><span>
</span><span id="line-267"></span><span>    </span><span id="gsStablePools"><span class="annot"><span class="annottext">forall era. GenState era -&gt; Set (KeyHash 'StakePool)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStablePools"><span class="hs-identifier hs-var hs-var">gsStablePools</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsStableDelegators"><span class="annot"><span class="annottext">forall era. GenState era -&gt; Set (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStableDelegators"><span class="hs-identifier hs-var hs-var">gsStableDelegators</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#StakeCredential"><span class="hs-identifier hs-type">StakeCredential</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsAvoidCred"><span class="annot"><span class="annottext">forall era. GenState era -&gt; Set (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidCred"><span class="hs-identifier hs-var hs-var">gsAvoidCred</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsAvoidKey"><span class="annot"><span class="annottext">forall era. GenState era -&gt; Set (KeyHash 'StakePool)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidKey"><span class="hs-identifier hs-var hs-var">gsAvoidKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsGenEnv"><span class="annot"><span class="annottext">forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var hs-var">gsGenEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717050"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="gsSeedIdx"><span class="annot"><span class="annottext">forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsSeedIdx"><span class="hs-identifier hs-var hs-var">gsSeedIdx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682718057"><span id="local-6989586621682718059"><span class="annot"><span class="annottext">(forall x. GenState era -&gt; Rep (GenState era) x)
-&gt; (forall x. Rep (GenState era) x -&gt; GenState era)
-&gt; Generic (GenState era)
forall x. Rep (GenState era) x -&gt; GenState era
forall x. GenState era -&gt; Rep (GenState era) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall era x. Rep (GenState era) x -&gt; GenState era
forall era x. GenState era -&gt; Rep (GenState era) x
$cfrom :: forall era x. GenState era -&gt; Rep (GenState era) x
from :: forall x. GenState era -&gt; Rep (GenState era) x
$cto :: forall era x. Rep (GenState era) x -&gt; GenState era
to :: forall x. Rep (GenState era) x -&gt; GenState era
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682717097"><span id="local-6989586621682718063"><span id="local-6989586621682718070"><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Era.html#EraTest"><span class="hs-identifier hs-type">EraTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717097"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Class.html#ToExpr"><span class="hs-identifier hs-type">ToExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717097"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span id="local-6989586621682717098"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#emptyGenState"><span class="hs-identifier hs-type">emptyGenState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717098"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717098"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717098"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-279"></span><span id="emptyGenState"><span class="annot"><span class="annottext">emptyGenState :: forall era. Reflect era =&gt; GenEnv era -&gt; GenState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#emptyGenState"><span class="hs-identifier hs-var hs-var">emptyGenState</span></a></span></span><span> </span><span id="local-6989586621682718130"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621682718130"><span class="hs-identifier hs-var">genv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-280"></span><span>  </span><span class="annot"><span class="annottext">ValidityInterval
-&gt; Map (KeyHash 'Witness) (KeyPair 'Witness)
-&gt; Map ScriptHash (Script era)
-&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
-&gt; Map DataHash (Data era)
-&gt; Map ValidityInterval (Set ScriptHash)
-&gt; ModelNewEpochState era
-&gt; Map TxIn (TxOut era)
-&gt; Map (Credential 'Staking) (AccountState era)
-&gt; Map (KeyHash 'StakePool) PoolParams
-&gt; Map (KeyHash 'StakePool) IndividualPoolStake
-&gt; Set (KeyHash 'StakePool)
-&gt; Set (Credential 'Staking)
-&gt; Set (Credential 'Staking)
-&gt; Set (KeyHash 'StakePool)
-&gt; GenEnv era
-&gt; Int
-&gt; GenState era
forall era.
ValidityInterval
-&gt; Map (KeyHash 'Witness) (KeyPair 'Witness)
-&gt; Map ScriptHash (Script era)
-&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
-&gt; Map DataHash (Data era)
-&gt; Map ValidityInterval (Set ScriptHash)
-&gt; ModelNewEpochState era
-&gt; Map TxIn (TxOut era)
-&gt; Map (Credential 'Staking) (AccountState era)
-&gt; Map (KeyHash 'StakePool) PoolParams
-&gt; Map (KeyHash 'StakePool) IndividualPoolStake
-&gt; Set (KeyHash 'StakePool)
-&gt; Set (Credential 'Staking)
-&gt; Set (Credential 'Staking)
-&gt; Set (KeyHash 'StakePool)
-&gt; GenEnv era
-&gt; Int
-&gt; GenState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-var">GenState</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictMaybe SlotNo -&gt; StrictMaybe SlotNo -&gt; ValidityInterval
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#ValidityInterval"><span class="hs-identifier hs-var">ValidityInterval</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo
forall a. StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo
forall a. StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><span class="annottext">Map (KeyHash 'Witness) (KeyPair 'Witness)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><span class="annottext">Map ScriptHash (Script era)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><span class="annottext">Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><span class="annottext">Map DataHash (Data era)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><span class="annottext">Map ValidityInterval (Set ScriptHash)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelNewEpochState era
forall era.
(EraPParams era, EraAccounts era) =&gt;
ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mNewEpochStateZero"><span class="hs-identifier hs-var">mNewEpochStateZero</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPParams"><span class="hs-identifier hs-var">mPParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718130"><span class="hs-identifier hs-type">genv</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><span class="annottext">Map (Credential 'Staking) (AccountState era)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-290"></span><span>    </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) PoolParams
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-291"></span><span>    </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) IndividualPoolStake
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-292"></span><span>    </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><span class="annottext">Set (Credential 'Staking)
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><span class="annottext">Set (Credential 'Staking)
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621682718130"><span class="hs-identifier hs-var">genv</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-298"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#emptyGenState"><span class="hs-pragma hs-type">emptyGenState</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#small"><span class="hs-identifier hs-type">small</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span>
</span><span id="line-301"></span><span id="small"><span class="annot"><span class="annottext">small :: GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#small"><span class="hs-identifier hs-var hs-var">small</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">treasury :: Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#treasury"><span class="hs-identifier hs-var">treasury</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1000000</span></span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reserves :: Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#reserves"><span class="hs-identifier hs-var">reserves</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1000000</span></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">startSlot :: Word64
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#startSlot"><span class="hs-identifier hs-var">startSlot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slotDelta :: (Word64, Word64)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#slotDelta"><span class="hs-identifier hs-var">slotDelta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">blocksizeMax :: Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#blocksizeMax"><span class="hs-identifier hs-var">blocksizeMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">collInputsMax :: Natural
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#collInputsMax"><span class="hs-identifier hs-var">collInputsMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oldUtxoPercent :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#oldUtxoPercent"><span class="hs-identifier hs-var">oldUtxoPercent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">spendInputsMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#spendInputsMax"><span class="hs-identifier hs-var">spendInputsMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">refInputsMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#refInputsMax"><span class="hs-identifier hs-var">refInputsMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">utxoChoicesMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#utxoChoicesMax"><span class="hs-identifier hs-var">utxoChoicesMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">certificateMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#certificateMax"><span class="hs-identifier hs-var">certificateMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withdrawalMax :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#withdrawalMax"><span class="hs-identifier hs-var">withdrawalMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">maxStablePools :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#maxStablePools"><span class="hs-identifier hs-var">maxStablePools</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">invalidScriptFreq :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#invalidScriptFreq"><span class="hs-identifier hs-var">invalidScriptFreq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">regCertFreq :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#regCertFreq"><span class="hs-identifier hs-var">regCertFreq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">75</span></span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">delegCertFreq :: Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#delegCertFreq"><span class="hs-identifier hs-var">delegCertFreq</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">50</span></span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span id="local-6989586621682717122"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#plutusPurposeTags"><span class="hs-identifier hs-type">plutusPurposeTags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717122"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-322"></span><span id="plutusPurposeTags"><span class="annot"><span class="annottext">plutusPurposeTags :: forall era. Proof era -&gt; [PlutusPurposeTag]
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#plutusPurposeTags"><span class="hs-identifier hs-var hs-var">plutusPurposeTags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-type">Shelley</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-type">Allegra</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-325"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-type">Mary</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-type">Alonzo</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-type">Babbage</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-328"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-type">Conway</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Proposing"><span class="hs-identifier hs-var">Proposing</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="hs-comment">-- =====================================================================</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- Accessing information</span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span id="local-6989586621682717132"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlot"><span class="hs-identifier hs-type">getSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717132"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span></span><span>
</span><span id="line-334"></span><span id="getSlot"><span class="annot"><span class="annottext">getSlot :: forall era. GenState era -&gt; SlotNo
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlot"><span class="hs-identifier hs-var hs-var">getSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; SlotNo)
-&gt; (GenState era -&gt; Word64) -&gt; GenState era -&gt; SlotNo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Word64
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#startSlot"><span class="hs-identifier hs-var">startSlot</span></a></span><span> </span><span class="annot"><span class="annottext">(GenSize -&gt; Word64)
-&gt; (GenState era -&gt; GenSize) -&gt; GenState era -&gt; Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; GenSize
forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; GenSize)
-&gt; (GenState era -&gt; GenEnv era) -&gt; GenState era -&gt; GenSize
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; GenEnv era
forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span id="local-6989586621682717137"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlotDelta"><span class="hs-identifier hs-type">getSlotDelta</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717137"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-337"></span><span id="getSlotDelta"><span class="annot"><span class="annottext">getSlotDelta :: forall era. GenState era -&gt; (Word64, Word64)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlotDelta"><span class="hs-identifier hs-var hs-var">getSlotDelta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; (Word64, Word64)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#slotDelta"><span class="hs-identifier hs-var">slotDelta</span></a></span><span> </span><span class="annot"><span class="annottext">(GenSize -&gt; (Word64, Word64))
-&gt; (GenState era -&gt; GenSize) -&gt; GenState era -&gt; (Word64, Word64)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; GenSize
forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; GenSize)
-&gt; (GenState era -&gt; GenEnv era) -&gt; GenState era -&gt; GenSize
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; GenEnv era
forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span id="local-6989586621682717139"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getBlocksizeMax"><span class="hs-identifier hs-type">getBlocksizeMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717139"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span></span><span>
</span><span id="line-340"></span><span id="getBlocksizeMax"><span class="annot"><span class="annottext">getBlocksizeMax :: forall era. GenState era -&gt; Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getBlocksizeMax"><span class="hs-identifier hs-var hs-var">getBlocksizeMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#blocksizeMax"><span class="hs-identifier hs-var">blocksizeMax</span></a></span><span> </span><span class="annot"><span class="annottext">(GenSize -&gt; Integer)
-&gt; (GenState era -&gt; GenSize) -&gt; GenState era -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; GenSize
forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; GenSize)
-&gt; (GenState era -&gt; GenEnv era) -&gt; GenState era -&gt; GenSize
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; GenEnv era
forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span id="local-6989586621682718156"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSpendInputsMax"><span class="hs-identifier hs-type">getSpendInputsMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718156"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-343"></span><span id="getSpendInputsMax"><span class="annot"><span class="annottext">getSpendInputsMax :: forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getSpendInputsMax"><span class="hs-identifier hs-var hs-var">getSpendInputsMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#spendInputsMax"><span class="hs-identifier hs-var">spendInputsMax</span></a></span><span> </span><span class="annot"><span class="annottext">(GenSize -&gt; Int)
-&gt; (GenState era -&gt; GenSize) -&gt; GenState era -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; GenSize
forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; GenSize)
-&gt; (GenState era -&gt; GenEnv era) -&gt; GenState era -&gt; GenSize
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; GenEnv era
forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span id="local-6989586621682718157"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getRefInputsMax"><span class="hs-identifier hs-type">getRefInputsMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718157"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-346"></span><span id="getRefInputsMax"><span class="annot"><span class="annottext">getRefInputsMax :: forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getRefInputsMax"><span class="hs-identifier hs-var hs-var">getRefInputsMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#refInputsMax"><span class="hs-identifier hs-var">refInputsMax</span></a></span><span> </span><span class="annot"><span class="annottext">(GenSize -&gt; Int)
-&gt; (GenState era -&gt; GenSize) -&gt; GenState era -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; GenSize
forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; GenSize)
-&gt; (GenState era -&gt; GenEnv era) -&gt; GenState era -&gt; GenSize
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; GenEnv era
forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span id="local-6989586621682718158"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getCertificateMax"><span class="hs-identifier hs-type">getCertificateMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718158"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-349"></span><span id="getCertificateMax"><span class="annot"><span class="annottext">getCertificateMax :: forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getCertificateMax"><span class="hs-identifier hs-var hs-var">getCertificateMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#certificateMax"><span class="hs-identifier hs-var">certificateMax</span></a></span><span> </span><span class="annot"><span class="annottext">(GenSize -&gt; Int)
-&gt; (GenState era -&gt; GenSize) -&gt; GenState era -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; GenSize
forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; GenSize)
-&gt; (GenState era -&gt; GenEnv era) -&gt; GenState era -&gt; GenSize
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; GenEnv era
forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span id="local-6989586621682718159"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoChoicesMax"><span class="hs-identifier hs-type">getUtxoChoicesMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718159"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-352"></span><span id="getUtxoChoicesMax"><span class="annot"><span class="annottext">getUtxoChoicesMax :: forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoChoicesMax"><span class="hs-identifier hs-var hs-var">getUtxoChoicesMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#utxoChoicesMax"><span class="hs-identifier hs-var">utxoChoicesMax</span></a></span><span> </span><span class="annot"><span class="annottext">(GenSize -&gt; Int)
-&gt; (GenState era -&gt; GenSize) -&gt; GenState era -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; GenSize
forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; GenSize)
-&gt; (GenState era -&gt; GenEnv era) -&gt; GenState era -&gt; GenSize
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; GenEnv era
forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span id="local-6989586621682717145"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getCollInputsMax"><span class="hs-identifier hs-type">getCollInputsMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717145"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span></span><span>
</span><span id="line-355"></span><span id="getCollInputsMax"><span class="annot"><span class="annottext">getCollInputsMax :: forall era. GenState era -&gt; Natural
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getCollInputsMax"><span class="hs-identifier hs-var hs-var">getCollInputsMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Natural
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#collInputsMax"><span class="hs-identifier hs-var">collInputsMax</span></a></span><span> </span><span class="annot"><span class="annottext">(GenSize -&gt; Natural)
-&gt; (GenState era -&gt; GenSize) -&gt; GenState era -&gt; Natural
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; GenSize
forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; GenSize)
-&gt; (GenState era -&gt; GenEnv era) -&gt; GenState era -&gt; GenSize
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; GenEnv era
forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span id="local-6989586621682718160"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getOldUtxoPercent"><span class="hs-identifier hs-type">getOldUtxoPercent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718160"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-358"></span><span id="getOldUtxoPercent"><span class="annot"><span class="annottext">getOldUtxoPercent :: forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getOldUtxoPercent"><span class="hs-identifier hs-var hs-var">getOldUtxoPercent</span></a></span></span><span> </span><span id="local-6989586621682718165"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718165"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#oldUtxoPercent"><span class="hs-identifier hs-var">oldUtxoPercent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenEnv era -&gt; GenSize
forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenState era -&gt; GenEnv era
forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718165"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span id="local-6989586621682717149"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getTreasury"><span class="hs-identifier hs-type">getTreasury</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717149"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span></span><span>
</span><span id="line-361"></span><span id="getTreasury"><span class="annot"><span class="annottext">getTreasury :: forall era. GenState era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getTreasury"><span class="hs-identifier hs-var hs-var">getTreasury</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Coin)
-&gt; (GenState era -&gt; Integer) -&gt; GenState era -&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#treasury"><span class="hs-identifier hs-var">treasury</span></a></span><span> </span><span class="annot"><span class="annottext">(GenSize -&gt; Integer)
-&gt; (GenState era -&gt; GenSize) -&gt; GenState era -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; GenSize
forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; GenSize)
-&gt; (GenState era -&gt; GenEnv era) -&gt; GenState era -&gt; GenSize
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; GenEnv era
forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span id="local-6989586621682718169"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getReserves"><span class="hs-identifier hs-type">getReserves</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718169"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span></span><span>
</span><span id="line-364"></span><span id="getReserves"><span class="annot"><span class="annottext">getReserves :: forall era. GenState era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getReserves"><span class="hs-identifier hs-var hs-var">getReserves</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Coin)
-&gt; (GenState era -&gt; Integer) -&gt; GenState era -&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#reserves"><span class="hs-identifier hs-var">reserves</span></a></span><span> </span><span class="annot"><span class="annottext">(GenSize -&gt; Integer)
-&gt; (GenState era -&gt; GenSize) -&gt; GenState era -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; GenSize
forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; GenSize)
-&gt; (GenState era -&gt; GenEnv era) -&gt; GenState era -&gt; GenSize
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; GenEnv era
forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">-- ========================================================</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- Modifying fields of the GenState as side effects in GenRS</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span id="local-6989586621682717153"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#setVi"><span class="hs-identifier hs-type">setVi</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717153"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#ValidityInterval"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717153"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-370"></span><span id="setVi"><span class="annot"><span class="annottext">setVi :: forall era. GenState era -&gt; ValidityInterval -&gt; GenState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#setVi"><span class="hs-identifier hs-var hs-var">setVi</span></a></span></span><span> </span><span id="local-6989586621682718171"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718171"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span id="local-6989586621682718172"><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621682718172"><span class="hs-identifier hs-var">vi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718171"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsValidityInterval"><span class="hs-identifier hs-var">gsValidityInterval</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718172"><span class="hs-identifier hs-type">vi</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-371"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#setVi"><span class="hs-pragma hs-type">setVi</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span id="local-6989586621682717155"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateKeys"><span class="hs-identifier hs-type">modifyGenStateKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Witness"><span class="hs-identifier hs-type">Witness</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Core.KeyPair.html#KeyPair"><span class="hs-identifier hs-type">KeyPair</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Witness"><span class="hs-identifier hs-type">Witness</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-375"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Witness"><span class="hs-identifier hs-type">Witness</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Core.KeyPair.html#KeyPair"><span class="hs-identifier hs-type">KeyPair</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Witness"><span class="hs-identifier hs-type">Witness</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-377"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717155"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-378"></span><span id="modifyGenStateKeys"><span class="annot"><span class="annottext">modifyGenStateKeys :: forall era.
(Map (KeyHash 'Witness) (KeyPair 'Witness)
 -&gt; Map (KeyHash 'Witness) (KeyPair 'Witness))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateKeys"><span class="hs-identifier hs-var hs-var">modifyGenStateKeys</span></a></span></span><span> </span><span id="local-6989586621682718177"><span class="annot"><span class="annottext">Map (KeyHash 'Witness) (KeyPair 'Witness)
-&gt; Map (KeyHash 'Witness) (KeyPair 'Witness)
</span><a href="#local-6989586621682718177"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718178"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718178"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718178"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsKeys"><span class="hs-identifier hs-var">gsKeys</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718177"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsKeys"><span class="hs-identifier hs-var">gsKeys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718178"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span id="local-6989586621682717163"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateDatums"><span class="hs-identifier hs-type">modifyGenStateDatums</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#DataHash"><span class="hs-identifier hs-type">DataHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717163"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#DataHash"><span class="hs-identifier hs-type">DataHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717163"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-382"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717163"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-383"></span><span id="modifyGenStateDatums"><span class="annot"><span class="annottext">modifyGenStateDatums :: forall era.
(Map DataHash (Data era) -&gt; Map DataHash (Data era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateDatums"><span class="hs-identifier hs-var hs-var">modifyGenStateDatums</span></a></span></span><span> </span><span id="local-6989586621682718182"><span class="annot"><span class="annottext">Map DataHash (Data era) -&gt; Map DataHash (Data era)
</span><a href="#local-6989586621682718182"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718183"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718183"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718183"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsDatums"><span class="hs-identifier hs-var">gsDatums</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718182"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsDatums"><span class="hs-identifier hs-var">gsDatums</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718183"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span id="local-6989586621682717165"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateVI"><span class="hs-identifier hs-type">modifyGenStateVI</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#ValidityInterval"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-387"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#ValidityInterval"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-389"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717165"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-390"></span><span id="modifyGenStateVI"><span class="annot"><span class="annottext">modifyGenStateVI :: forall era.
(Map ValidityInterval (Set ScriptHash)
 -&gt; Map ValidityInterval (Set ScriptHash))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateVI"><span class="hs-identifier hs-var hs-var">modifyGenStateVI</span></a></span></span><span> </span><span id="local-6989586621682718187"><span class="annot"><span class="annottext">Map ValidityInterval (Set ScriptHash)
-&gt; Map ValidityInterval (Set ScriptHash)
</span><a href="#local-6989586621682718187"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718188"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718188"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718188"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsVI"><span class="hs-identifier hs-var">gsVI</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718187"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsVI"><span class="hs-identifier hs-var">gsVI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718188"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span id="local-6989586621682717167"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialAccounts"><span class="hs-identifier hs-type">modifyGenStateInitialAccounts</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#AccountState"><span class="hs-identifier hs-type">AccountState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717167"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-394"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#AccountState"><span class="hs-identifier hs-type">AccountState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717167"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717167"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-397"></span><span id="modifyGenStateInitialAccounts"><span class="annot"><span class="annottext">modifyGenStateInitialAccounts :: forall era.
(Map (Credential 'Staking) (AccountState era)
 -&gt; Map (Credential 'Staking) (AccountState era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialAccounts"><span class="hs-identifier hs-var hs-var">modifyGenStateInitialAccounts</span></a></span></span><span> </span><span id="local-6989586621682718191"><span class="annot"><span class="annottext">Map (Credential 'Staking) (AccountState era)
-&gt; Map (Credential 'Staking) (AccountState era)
</span><a href="#local-6989586621682718191"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((GenState era -&gt; GenState era)
 -&gt; RWST (GenEnv era) () (GenState era) Gen ())
-&gt; (GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682718192"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718192"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718192"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialAccounts"><span class="hs-identifier hs-var">gsInitialAccounts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718191"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialAccounts"><span class="hs-identifier hs-var">gsInitialAccounts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718192"><span class="hs-identifier hs-type">st</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span id="local-6989586621682717172"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialUtxo"><span class="hs-identifier hs-type">modifyGenStateInitialUtxo</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717172"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717172"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-403"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717172"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-404"></span><span id="modifyGenStateInitialUtxo"><span class="annot"><span class="annottext">modifyGenStateInitialUtxo :: forall era.
(Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialUtxo"><span class="hs-identifier hs-var hs-var">modifyGenStateInitialUtxo</span></a></span></span><span> </span><span id="local-6989586621682718195"><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)
</span><a href="#local-6989586621682718195"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((GenState era -&gt; GenState era)
 -&gt; RWST (GenEnv era) () (GenState era) Gen ())
-&gt; (GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682718196"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718196"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718196"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialUtxo"><span class="hs-identifier hs-var">gsInitialUtxo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718195"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialUtxo"><span class="hs-identifier hs-var">gsInitialUtxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718196"><span class="hs-identifier hs-type">st</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span id="local-6989586621682717174"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateAvoidCred"><span class="hs-identifier hs-type">modifyGenStateAvoidCred</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-408"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-410"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717174"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-411"></span><span id="modifyGenStateAvoidCred"><span class="annot"><span class="annottext">modifyGenStateAvoidCred :: forall era.
(Set (Credential 'Staking) -&gt; Set (Credential 'Staking))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateAvoidCred"><span class="hs-identifier hs-var hs-var">modifyGenStateAvoidCred</span></a></span></span><span> </span><span id="local-6989586621682718200"><span class="annot"><span class="annottext">Set (Credential 'Staking) -&gt; Set (Credential 'Staking)
</span><a href="#local-6989586621682718200"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718201"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718201"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718201"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidCred"><span class="hs-identifier hs-var">gsAvoidCred</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718200"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidCred"><span class="hs-identifier hs-var">gsAvoidCred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718201"><span class="hs-identifier hs-type">st</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span id="local-6989586621682717176"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateAvoidKey"><span class="hs-identifier hs-type">modifyGenStateAvoidKey</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-415"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717176"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-416"></span><span id="modifyGenStateAvoidKey"><span class="annot"><span class="annottext">modifyGenStateAvoidKey :: forall era.
(Set (KeyHash 'StakePool) -&gt; Set (KeyHash 'StakePool))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateAvoidKey"><span class="hs-identifier hs-var hs-var">modifyGenStateAvoidKey</span></a></span></span><span> </span><span id="local-6989586621682718205"><span class="annot"><span class="annottext">Set (KeyHash 'StakePool) -&gt; Set (KeyHash 'StakePool)
</span><a href="#local-6989586621682718205"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718206"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718206"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718206"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidKey"><span class="hs-identifier hs-var">gsAvoidKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718205"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidKey"><span class="hs-identifier hs-var">gsAvoidKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718206"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span id="local-6989586621682718207"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateStablePools"><span class="hs-identifier hs-type">modifyGenStateStablePools</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-419"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-420"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718207"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-421"></span><span id="modifyGenStateStablePools"><span class="annot"><span class="annottext">modifyGenStateStablePools :: forall era.
(Set (KeyHash 'StakePool) -&gt; Set (KeyHash 'StakePool))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateStablePools"><span class="hs-identifier hs-var hs-var">modifyGenStateStablePools</span></a></span></span><span> </span><span id="local-6989586621682718211"><span class="annot"><span class="annottext">Set (KeyHash 'StakePool) -&gt; Set (KeyHash 'StakePool)
</span><a href="#local-6989586621682718211"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718212"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718212"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718212"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStablePools"><span class="hs-identifier hs-var">gsStablePools</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718211"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStablePools"><span class="hs-identifier hs-var">gsStablePools</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718212"><span class="hs-identifier hs-type">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span id="local-6989586621682717179"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolParams"><span class="hs-identifier hs-type">modifyGenStateInitialPoolParams</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#PoolParams"><span class="hs-identifier hs-type">PoolParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-425"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#PoolParams"><span class="hs-identifier hs-type">PoolParams</span></a></span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-427"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717179"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-428"></span><span id="modifyGenStateInitialPoolParams"><span class="annot"><span class="annottext">modifyGenStateInitialPoolParams :: forall era.
(Map (KeyHash 'StakePool) PoolParams
 -&gt; Map (KeyHash 'StakePool) PoolParams)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolParams"><span class="hs-identifier hs-var hs-var">modifyGenStateInitialPoolParams</span></a></span></span><span> </span><span id="local-6989586621682718216"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) PoolParams
-&gt; Map (KeyHash 'StakePool) PoolParams
</span><a href="#local-6989586621682718216"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718217"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718217"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718217"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolParams"><span class="hs-identifier hs-var">gsInitialPoolParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718216"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolParams"><span class="hs-identifier hs-var">gsInitialPoolParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718217"><span class="hs-identifier hs-type">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span id="local-6989586621682717181"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolDistr"><span class="hs-identifier hs-type">modifyGenStateInitialPoolDistr</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-431"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#IndividualPoolStake"><span class="hs-identifier hs-type">IndividualPoolStake</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-432"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#IndividualPoolStake"><span class="hs-identifier hs-type">IndividualPoolStake</span></a></span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-434"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717181"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-435"></span><span id="modifyGenStateInitialPoolDistr"><span class="annot"><span class="annottext">modifyGenStateInitialPoolDistr :: forall era.
(Map (KeyHash 'StakePool) IndividualPoolStake
 -&gt; Map (KeyHash 'StakePool) IndividualPoolStake)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolDistr"><span class="hs-identifier hs-var hs-var">modifyGenStateInitialPoolDistr</span></a></span></span><span> </span><span id="local-6989586621682718221"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) IndividualPoolStake
-&gt; Map (KeyHash 'StakePool) IndividualPoolStake
</span><a href="#local-6989586621682718221"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718222"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718222"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718222"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolDistr"><span class="hs-identifier hs-var">gsInitialPoolDistr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718221"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolDistr"><span class="hs-identifier hs-var">gsInitialPoolDistr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718222"><span class="hs-identifier hs-type">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span id="local-6989586621682718223"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateStableDelegators"><span class="hs-identifier hs-type">modifyGenStateStableDelegators</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-438"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#StakeCredential"><span class="hs-identifier hs-type">StakeCredential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#StakeCredential"><span class="hs-identifier hs-type">StakeCredential</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-439"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718223"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-440"></span><span id="modifyGenStateStableDelegators"><span class="annot"><span class="annottext">modifyGenStateStableDelegators :: forall era.
(Set (Credential 'Staking) -&gt; Set (Credential 'Staking))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateStableDelegators"><span class="hs-identifier hs-var hs-var">modifyGenStateStableDelegators</span></a></span></span><span> </span><span id="local-6989586621682718227"><span class="annot"><span class="annottext">Set (Credential 'Staking) -&gt; Set (Credential 'Staking)
</span><a href="#local-6989586621682718227"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718228"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718228"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718228"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStableDelegators"><span class="hs-identifier hs-var">gsStableDelegators</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718227"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStableDelegators"><span class="hs-identifier hs-var">gsStableDelegators</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718228"><span class="hs-identifier hs-type">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span id="local-6989586621682717184"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateScripts"><span class="hs-identifier hs-type">modifyGenStateScripts</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-443"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Script"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717184"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-444"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Script"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717184"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-446"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717184"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-447"></span><span id="modifyGenStateScripts"><span class="annot"><span class="annottext">modifyGenStateScripts :: forall era.
(Map ScriptHash (Script era) -&gt; Map ScriptHash (Script era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateScripts"><span class="hs-identifier hs-var hs-var">modifyGenStateScripts</span></a></span></span><span> </span><span id="local-6989586621682718232"><span class="annot"><span class="annottext">Map ScriptHash (Script era) -&gt; Map ScriptHash (Script era)
</span><a href="#local-6989586621682718232"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-448"></span><span>  </span><span class="annot"><span class="annottext">(GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((GenState era -&gt; GenState era)
 -&gt; RWST (GenEnv era) () (GenState era) Gen ())
-&gt; (GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682718233"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718233"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718233"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsScripts"><span class="hs-identifier hs-var">gsScripts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718232"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsScripts"><span class="hs-identifier hs-var">gsScripts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718233"><span class="hs-identifier hs-type">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span id="local-6989586621682717186"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyPlutusScripts"><span class="hs-identifier hs-type">modifyPlutusScripts</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#IsValid"><span class="hs-identifier hs-type">IsValid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Script"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717186"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-452"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#IsValid"><span class="hs-identifier hs-type">IsValid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Script"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717186"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-454"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717186"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-455"></span><span id="modifyPlutusScripts"><span class="annot"><span class="annottext">modifyPlutusScripts :: forall era.
(Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
 -&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyPlutusScripts"><span class="hs-identifier hs-var hs-var">modifyPlutusScripts</span></a></span></span><span> </span><span id="local-6989586621682718237"><span class="annot"><span class="annottext">Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
-&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
</span><a href="#local-6989586621682718237"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718238"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718238"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718238"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsPlutusScripts"><span class="hs-identifier hs-var">gsPlutusScripts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718237"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsPlutusScripts"><span class="hs-identifier hs-var">gsPlutusScripts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718238"><span class="hs-identifier hs-type">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="hs-comment">-- ===================================================</span><span>
</span><span id="line-458"></span><span class="hs-comment">-- functions that modify individual fields of ModelState</span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span id="local-6989586621682717188"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-type">modifyModel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#ModelNewEpochState"><span class="hs-identifier hs-type">ModelNewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717188"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#ModelNewEpochState"><span class="hs-identifier hs-type">ModelNewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717188"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717188"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-461"></span><span id="modifyModel"><span class="annot"><span class="annottext">modifyModel :: forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var hs-var">modifyModel</span></a></span></span><span> </span><span id="local-6989586621682718241"><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; ModelNewEpochState era
</span><a href="#local-6989586621682718241"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718242"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718242"><span class="hs-identifier hs-var">gstate</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718242"><span class="hs-identifier hs-var">gstate</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718241"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718242"><span class="hs-identifier hs-type">gstate</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span id="local-6989586621682717190"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelAccounts"><span class="hs-identifier hs-type">modifyModelAccounts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#Accounts"><span class="hs-identifier hs-type">Accounts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717190"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#Accounts"><span class="hs-identifier hs-type">Accounts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717190"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717190"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-464"></span><span id="modifyModelAccounts"><span class="annot"><span class="annottext">modifyModelAccounts :: forall era. (Accounts era -&gt; Accounts era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelAccounts"><span class="hs-identifier hs-var hs-var">modifyModelAccounts</span></a></span></span><span> </span><span id="local-6989586621682718244"><span class="annot"><span class="annottext">Accounts era -&gt; Accounts era
</span><a href="#local-6989586621682718244"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718245"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682718245"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682718245"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mAccounts"><span class="hs-identifier hs-var">mAccounts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718244"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mAccounts"><span class="hs-identifier hs-var">mAccounts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718245"><span class="hs-identifier hs-type">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span id="local-6989586621682717194"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelDeposited"><span class="hs-identifier hs-type">modifyModelDeposited</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717194"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-467"></span><span id="modifyModelDeposited"><span class="annot"><span class="annottext">modifyModelDeposited :: forall era. (Coin -&gt; Coin) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelDeposited"><span class="hs-identifier hs-var hs-var">modifyModelDeposited</span></a></span></span><span> </span><span id="local-6989586621682718248"><span class="annot"><span class="annottext">Coin -&gt; Coin
</span><a href="#local-6989586621682718248"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718249"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682718249"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682718249"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mDeposited"><span class="hs-identifier hs-var">mDeposited</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718248"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mDeposited"><span class="hs-identifier hs-var">mDeposited</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718249"><span class="hs-identifier hs-type">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span id="local-6989586621682717198"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelStakePools"><span class="hs-identifier hs-type">modifyModelStakePools</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-470"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#StakePoolState"><span class="hs-identifier hs-type">StakePoolState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-471"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#StakePoolState"><span class="hs-identifier hs-type">StakePoolState</span></a></span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-473"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717198"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-474"></span><span id="modifyModelStakePools"><span class="annot"><span class="annottext">modifyModelStakePools :: forall era.
(Map (KeyHash 'StakePool) StakePoolState
 -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelStakePools"><span class="hs-identifier hs-var hs-var">modifyModelStakePools</span></a></span></span><span> </span><span id="local-6989586621682718252"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621682718252"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718253"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682718253"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682718253"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mStakePools"><span class="hs-identifier hs-var">mStakePools</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718252"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mStakePools"><span class="hs-identifier hs-var">mStakePools</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718253"><span class="hs-identifier hs-type">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span id="local-6989586621682718255"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelPoolDistr"><span class="hs-identifier hs-type">modifyModelPoolDistr</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#IndividualPoolStake"><span class="hs-identifier hs-type">IndividualPoolStake</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-478"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#IndividualPoolStake"><span class="hs-identifier hs-type">IndividualPoolStake</span></a></span><span>
</span><span id="line-479"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-480"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718255"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-481"></span><span id="modifyModelPoolDistr"><span class="annot"><span class="annottext">modifyModelPoolDistr :: forall era.
(Map (KeyHash 'StakePool) IndividualPoolStake
 -&gt; Map (KeyHash 'StakePool) IndividualPoolStake)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelPoolDistr"><span class="hs-identifier hs-var hs-var">modifyModelPoolDistr</span></a></span></span><span> </span><span id="local-6989586621682718257"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) IndividualPoolStake
-&gt; Map (KeyHash 'StakePool) IndividualPoolStake
</span><a href="#local-6989586621682718257"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718258"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682718258"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682718258"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPoolDistr"><span class="hs-identifier hs-var">mPoolDistr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718257"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPoolDistr"><span class="hs-identifier hs-var">mPoolDistr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718258"><span class="hs-identifier hs-type">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span id="local-6989586621682717203"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelCount"><span class="hs-identifier hs-type">modifyModelCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717203"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-484"></span><span id="modifyModelCount"><span class="annot"><span class="annottext">modifyModelCount :: forall era. (Int -&gt; Int) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelCount"><span class="hs-identifier hs-var hs-var">modifyModelCount</span></a></span></span><span> </span><span id="local-6989586621682718260"><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621682718260"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718261"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682718261"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682718261"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mCount"><span class="hs-identifier hs-var">mCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718260"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mCount"><span class="hs-identifier hs-var">mCount</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718261"><span class="hs-identifier hs-type">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span id="local-6989586621682717207"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelIndex"><span class="hs-identifier hs-type">modifyModelIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-487"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxId"><span class="hs-identifier hs-type">TxId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxId"><span class="hs-identifier hs-type">TxId</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-488"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717207"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-489"></span><span id="modifyModelIndex"><span class="annot"><span class="annottext">modifyModelIndex :: forall era. (Map Int TxId -&gt; Map Int TxId) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelIndex"><span class="hs-identifier hs-var hs-var">modifyModelIndex</span></a></span></span><span> </span><span id="local-6989586621682718263"><span class="annot"><span class="annottext">Map Int TxId -&gt; Map Int TxId
</span><a href="#local-6989586621682718263"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718264"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682718264"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682718264"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mIndex"><span class="hs-identifier hs-var">mIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718263"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mIndex"><span class="hs-identifier hs-var">mIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718264"><span class="hs-identifier hs-type">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span id="local-6989586621682718266"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelUTxO"><span class="hs-identifier hs-type">modifyModelUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-492"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718266"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718266"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-493"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718266"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-494"></span><span id="modifyModelUTxO"><span class="annot"><span class="annottext">modifyModelUTxO :: forall era.
(Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelUTxO"><span class="hs-identifier hs-var hs-var">modifyModelUTxO</span></a></span></span><span> </span><span id="local-6989586621682718267"><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)
</span><a href="#local-6989586621682718267"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718268"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682718268"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682718268"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mUTxO"><span class="hs-identifier hs-var">mUTxO</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718267"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mUTxO"><span class="hs-identifier hs-var">mUTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718268"><span class="hs-identifier hs-type">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span id="local-6989586621682718270"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelMutFee"><span class="hs-identifier hs-type">modifyModelMutFee</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718270"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718270"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-500"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718270"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-501"></span><span id="modifyModelMutFee"><span class="annot"><span class="annottext">modifyModelMutFee :: forall era.
(Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelMutFee"><span class="hs-identifier hs-var hs-var">modifyModelMutFee</span></a></span></span><span> </span><span id="local-6989586621682718271"><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)
</span><a href="#local-6989586621682718271"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682718272"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682718272"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682718272"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mMutFee"><span class="hs-identifier hs-var">mMutFee</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682718271"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#mMutFee"><span class="hs-identifier hs-var">mMutFee</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718272"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span class="hs-comment">-- ==============================================================</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- The Monad</span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span class="hs-keyword">type</span><span> </span><span id="GenRS"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-var">GenRS</span></a></span></span><span> </span><span id="local-6989586621682718274"><span class="annot"><a href="#local-6989586621682718274"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RWST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718274"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718274"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span id="local-6989586621682717213"><span id="local-6989586621682717214"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElem"><span class="hs-identifier hs-type">genMapElem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621682717213"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717214"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682717213"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682717214"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-509"></span><span id="genMapElem"><span class="annot"><span class="annottext">genMapElem :: forall k a. Map k a -&gt; Gen (Maybe (k, a))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElem"><span class="hs-identifier hs-var hs-var">genMapElem</span></a></span></span><span> </span><span id="local-6989586621682718286"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621682718286"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682718287"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (k, a) -&gt; Gen (Maybe (k, a))
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (k, a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-511"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-512"></span><span>      </span><span id="local-6989586621682718288"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682718288"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682718287"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>      </span><span class="annot"><span class="annottext">Maybe (k, a) -&gt; Gen (Maybe (k, a))
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (k, a) -&gt; Gen (Maybe (k, a)))
-&gt; Maybe (k, a) -&gt; Gen (Maybe (k, a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(k, a) -&gt; Maybe (k, a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((k, a) -&gt; Maybe (k, a)) -&gt; (k, a) -&gt; Maybe (k, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Map k a -&gt; (k, a)
forall k a. Int -&gt; Map k a -&gt; (k, a)
</span><span class="hs-identifier hs-var">Map.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682718288"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621682718286"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-515"></span><span>    </span><span id="local-6989586621682718287"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621682718287"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Int
forall k a. Map k a -&gt; Int
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621682718286"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span id="local-6989586621682717226"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genSetElem"><span class="hs-identifier hs-type">genSetElem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="#local-6989586621682717226"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682717226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-518"></span><span id="genSetElem"><span class="annot"><span class="annottext">genSetElem :: forall a. Set a -&gt; Gen (Maybe a)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genSetElem"><span class="hs-identifier hs-var hs-var">genSetElem</span></a></span></span><span> </span><span id="local-6989586621682718300"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621682718300"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682718301"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Gen (Maybe a)
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-521"></span><span>      </span><span id="local-6989586621682718302"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682718302"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682718301"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>      </span><span class="annot"><span class="annottext">Maybe a -&gt; Gen (Maybe a)
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; Gen (Maybe a)) -&gt; Maybe a -&gt; Gen (Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; a -&gt; Maybe a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Set a -&gt; a
forall a. Int -&gt; Set a -&gt; a
</span><span class="hs-identifier hs-var">Set.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682718302"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621682718300"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-523"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-524"></span><span>    </span><span id="local-6989586621682718301"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621682718301"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Int
forall a. Set a -&gt; Int
</span><span class="hs-identifier hs-var">Set.size</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621682718300"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-525"></span><span>
</span><span id="line-526"></span><span class="annot"><span class="hs-comment">-- | Use up to 'tries' attempts to choose a random (k,a) pair from 'm', that meets predicate 'p'</span></span><span>
</span><span id="line-527"></span><span id="local-6989586621682717230"><span id="local-6989586621682717231"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElemWhere"><span class="hs-identifier hs-type">genMapElemWhere</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621682717230"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717231"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682717230"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682717231"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682717230"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682717231"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-528"></span><span id="genMapElemWhere"><span class="annot"><span class="annottext">genMapElemWhere :: forall k a.
Map k a -&gt; Int -&gt; (k -&gt; a -&gt; Bool) -&gt; Gen (Maybe (k, a))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElemWhere"><span class="hs-identifier hs-var hs-var">genMapElemWhere</span></a></span></span><span> </span><span id="local-6989586621682718319"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621682718319"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682718320"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682718320"><span class="hs-identifier hs-var">tries</span></a></span></span><span> </span><span id="local-6989586621682718321"><span class="annot"><span class="annottext">k -&gt; a -&gt; Bool
</span><a href="#local-6989586621682718321"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682718320"><span class="hs-identifier hs-var">tries</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (k, a) -&gt; Gen (Maybe (k, a))
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (k, a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-530"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682718323"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (k, a) -&gt; Gen (Maybe (k, a))
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (k, a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-531"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-532"></span><span>      </span><span id="local-6989586621682718324"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682718324"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682718323"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682718325"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621682718325"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682718326"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682718326"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Map k a -&gt; (k, a)
forall k a. Int -&gt; Map k a -&gt; (k, a)
</span><span class="hs-identifier hs-var">Map.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682718324"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621682718319"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-534"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k -&gt; a -&gt; Bool
</span><a href="#local-6989586621682718321"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621682718325"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682718326"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-535"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (k, a) -&gt; Gen (Maybe (k, a))
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (k, a) -&gt; Gen (Maybe (k, a)))
-&gt; Maybe (k, a) -&gt; Gen (Maybe (k, a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(k, a) -&gt; Maybe (k, a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((k, a) -&gt; Maybe (k, a)) -&gt; (k, a) -&gt; Maybe (k, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621682718325"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682718326"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Int -&gt; (k -&gt; a -&gt; Bool) -&gt; Gen (Maybe (k, a))
forall k a.
Map k a -&gt; Int -&gt; (k -&gt; a -&gt; Bool) -&gt; Gen (Maybe (k, a))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElemWhere"><span class="hs-identifier hs-var">genMapElemWhere</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621682718319"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682718320"><span class="hs-identifier hs-var">tries</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k -&gt; a -&gt; Bool
</span><a href="#local-6989586621682718321"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-537"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-538"></span><span>    </span><span id="local-6989586621682718323"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621682718323"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k a -&gt; Int
forall k a. Map k a -&gt; Int
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621682718319"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span id="local-6989586621682717234"><span id="local-6989586621682717236"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-type">elementsT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682717234"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="annot"><a href="#local-6989586621682717234"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682717234"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717236"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682717234"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717236"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-541"></span><span id="elementsT"><span class="annot"><span class="annottext">elementsT :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var hs-var">elementsT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t Gen (t Gen b) -&gt; t Gen b
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">(t Gen (t Gen b) -&gt; t Gen b)
-&gt; ([t Gen b] -&gt; t Gen (t Gen b)) -&gt; [t Gen b] -&gt; t Gen b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Gen (t Gen b) -&gt; t Gen (t Gen b)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen (t Gen b) -&gt; t Gen (t Gen b))
-&gt; ([t Gen b] -&gt; Gen (t Gen b)) -&gt; [t Gen b] -&gt; t Gen (t Gen b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[t Gen b] -&gt; Gen (t Gen b)
forall a. HasCallStack =&gt; [a] -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#elements"><span class="hs-identifier hs-var">elements</span></a></span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span id="local-6989586621682717245"><span id="local-6989586621682717246"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-type">frequencyT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682717245"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="annot"><a href="#local-6989586621682717245"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682717245"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717246"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682717245"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717246"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-544"></span><span id="frequencyT"><span class="annot"><span class="annottext">frequencyT :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var hs-var">frequencyT</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; t Gen b
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;frequencyT called with empty list&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span> </span><span id="local-6989586621682718347"><span class="annot"><span class="annottext">[(Int, t Gen b)]
</span><a href="#local-6989586621682718347"><span class="hs-identifier hs-var">choices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t Gen (t Gen b) -&gt; t Gen b
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">(t Gen (t Gen b) -&gt; t Gen b)
-&gt; ([(Int, t Gen b)] -&gt; t Gen (t Gen b))
-&gt; [(Int, t Gen b)]
-&gt; t Gen b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Gen (t Gen b) -&gt; t Gen (t Gen b)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen (t Gen b) -&gt; t Gen (t Gen b))
-&gt; ([(Int, t Gen b)] -&gt; Gen (t Gen b))
-&gt; [(Int, t Gen b)]
-&gt; t Gen (t Gen b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Int, Gen (t Gen b))] -&gt; Gen (t Gen b)
forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#frequency"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="annot"><span class="annottext">([(Int, Gen (t Gen b))] -&gt; Gen (t Gen b))
-&gt; ([(Int, t Gen b)] -&gt; [(Int, Gen (t Gen b))])
-&gt; [(Int, t Gen b)]
-&gt; Gen (t Gen b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Int, t Gen b) -&gt; (Int, Gen (t Gen b)))
-&gt; [(Int, t Gen b)] -&gt; [(Int, Gen (t Gen b))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t Gen b -&gt; Gen (t Gen b)
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(t Gen b -&gt; Gen (t Gen b))
-&gt; (Int, t Gen b) -&gt; (Int, Gen (t Gen b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, t Gen b)] -&gt; t Gen b) -&gt; [(Int, t Gen b)] -&gt; t Gen b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Int, t Gen b)]
</span><a href="#local-6989586621682718347"><span class="hs-identifier hs-var">choices</span></a></span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span class="hs-comment">-- | Gen a positive single digit Int, on a skewed distribution that</span><span>
</span><span id="line-548"></span><span class="hs-comment">--   favors 2,3,4,5 but occasionally gets others</span><span>
</span><span id="line-549"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#positiveSingleDigitInt"><span class="hs-identifier hs-type">positiveSingleDigitInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-550"></span><span id="positiveSingleDigitInt"><span class="annot"><span class="annottext">positiveSingleDigitInt :: Gen Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#positiveSingleDigitInt"><span class="hs-identifier hs-var hs-var">positiveSingleDigitInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-551"></span><span>  </span><span class="annot"><span class="annottext">[(Int, Gen Int)] -&gt; Gen Int
forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#frequency"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, Int) -&gt; (Int, Gen Int)) -&gt; [(Int, Int)] -&gt; [(Int, Gen Int)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; (Int, Gen Int)
forall {f :: * -&gt; *} {a} {a}. Applicative f =&gt; (a, a) -&gt; (a, f a)
</span><a href="#local-6989586621682718349"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-553"></span><span>    </span><span id="local-6989586621682718349"><span class="annot"><span class="annottext">f :: (a, a) -&gt; (a, f a)
</span><a href="#local-6989586621682718349"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682718355"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682718355"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682718356"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682718356"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682718355"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; f a
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682718356"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span class="hs-comment">-- | Gen a non-negative single digit Int, on a skewed distribution that</span><span>
</span><span id="line-556"></span><span class="hs-comment">--   favors 2,3,4,5 but occasionally gets others</span><span>
</span><span id="line-557"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#nonNegativeSingleDigitInt"><span class="hs-identifier hs-type">nonNegativeSingleDigitInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-558"></span><span id="nonNegativeSingleDigitInt"><span class="annot"><span class="annottext">nonNegativeSingleDigitInt :: Gen Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#nonNegativeSingleDigitInt"><span class="hs-identifier hs-var hs-var">nonNegativeSingleDigitInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-559"></span><span>  </span><span class="annot"><span class="annottext">[(Int, Gen Int)] -&gt; Gen Int
forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#frequency"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, Int) -&gt; (Int, Gen Int)) -&gt; [(Int, Int)] -&gt; [(Int, Gen Int)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; (Int, Gen Int)
forall {f :: * -&gt; *} {a} {a}. Applicative f =&gt; (a, a) -&gt; (a, f a)
</span><a href="#local-6989586621682718357"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-561"></span><span>    </span><span id="local-6989586621682718357"><span class="annot"><span class="annottext">f :: (a, a) -&gt; (a, f a)
</span><a href="#local-6989586621682718357"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682718362"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682718362"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682718363"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682718363"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682718362"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; f a
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682718363"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>
</span><span id="line-563"></span><span class="annot"><span class="hs-comment">-- | Generate a non-zero value</span></span><span>
</span><span id="line-564"></span><span id="local-6989586621682717264"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier hs-type">genPositiveVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717264"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717264"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-565"></span><span id="genPositiveVal"><span class="annot"><span class="annottext">genPositiveVal :: forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier hs-var hs-var">genPositiveVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; v
forall t s. Inject t s =&gt; t -&gt; s
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; v) -&gt; (Positive Integer -&gt; Coin) -&gt; Positive Integer -&gt; v
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Coin)
-&gt; (Positive Integer -&gt; Integer) -&gt; Positive Integer -&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Positive Integer -&gt; Integer
forall a. Positive a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Modifiers.html#getPositive"><span class="hs-identifier hs-var">getPositive</span></a></span><span> </span><span class="annot"><span class="annottext">(Positive Integer -&gt; v) -&gt; Gen (Positive Integer) -&gt; Gen v
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Gen (Positive Integer)
forall a. Arbitrary a =&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="hs-comment">-- | Generate a value (which is occaisionally 0) useful in generating Rewards, where we need a</span><span>
</span><span id="line-568"></span><span class="hs-comment">--   few 0's, because we cannot generate a DeReg certificates, without a 0 Reg value.</span><span>
</span><span id="line-569"></span><span class="hs-comment">--   Also used when generating the CollReturn, where an occasional 0 would be nice</span><span>
</span><span id="line-570"></span><span id="local-6989586621682718378"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewardVal"><span class="hs-identifier hs-type">genRewardVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718378"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682718378"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-571"></span><span id="genRewardVal"><span class="annot"><span class="annottext">genRewardVal :: forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewardVal"><span class="hs-identifier hs-var hs-var">genRewardVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int, Gen v)] -&gt; Gen v
forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#frequency"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v -&gt; Gen v
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">v
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">97</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Gen v
forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier hs-var">genPositiveVal</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span class="hs-comment">-- | Pick a UTxO element where we can use it in a new Tx. Most of the time we generate new</span><span>
</span><span id="line-574"></span><span class="hs-comment">--   elements for each Tx, but once in a while we choose an existing one. We must be carefull</span><span>
</span><span id="line-575"></span><span class="hs-comment">--   that that the Pay credential of the TxOut can run in the curent ValidityInterval</span><span>
</span><span id="line-576"></span><span class="hs-comment">--   A crude but simple way is to insist Pay credential is either Key locked, or locked</span><span>
</span><span id="line-577"></span><span class="hs-comment">--   with Plutus or MultiSig scripts, and return False for any Timelock scripts.</span><span>
</span><span id="line-578"></span><span id="local-6989586621682717281"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoElem"><span class="hs-identifier hs-type">getUtxoElem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#EraModel"><span class="hs-identifier hs-type">EraModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717281"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717281"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717281"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-579"></span><span id="getUtxoElem"><span class="annot"><span class="annottext">getUtxoElem :: forall era. EraModel era =&gt; GenRS era (Maybe (TxIn, TxOut era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoElem"><span class="hs-identifier hs-var hs-var">getUtxoElem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-580"></span><span>  </span><span id="local-6989586621682718404"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682718404"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Map TxIn (TxOut era))
-&gt; RWST (GenEnv era) () (GenState era) Gen (Map TxIn (TxOut era))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; Map TxIn (TxOut era)
forall era. ModelNewEpochState era -&gt; Map TxIn (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mUTxO"><span class="hs-identifier hs-var">mUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; Map TxIn (TxOut era))
-&gt; (GenState era -&gt; ModelNewEpochState era)
-&gt; GenState era
-&gt; Map TxIn (TxOut era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; ModelNewEpochState era
forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span>  </span><span id="local-6989586621682718405"><span class="annot"><span class="annottext">Map ScriptHash (Script era)
</span><a href="#local-6989586621682718405"><span class="hs-identifier hs-var">scriptmap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Map ScriptHash (Script era))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Map ScriptHash (Script era))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Map ScriptHash (Script era)
forall era. GenState era -&gt; Map ScriptHash (Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsScripts"><span class="hs-identifier hs-var">gsScripts</span></a></span><span>
</span><span id="line-582"></span><span>  </span><span class="annot"><span class="annottext">Gen (Maybe (TxIn, TxOut era))
-&gt; GenRS era (Maybe (TxIn, TxOut era))
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen (Maybe (TxIn, TxOut era))
 -&gt; GenRS era (Maybe (TxIn, TxOut era)))
-&gt; Gen (Maybe (TxIn, TxOut era))
-&gt; GenRS era (Maybe (TxIn, TxOut era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
-&gt; Int
-&gt; (TxIn -&gt; TxOut era -&gt; Bool)
-&gt; Gen (Maybe (TxIn, TxOut era))
forall k a.
Map k a -&gt; Int -&gt; (k -&gt; a -&gt; Bool) -&gt; Gen (Maybe (k, a))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElemWhere"><span class="hs-identifier hs-var">genMapElemWhere</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682718404"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">TxIn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map ScriptHash (Script era) -&gt; TxOut era -&gt; Bool
forall era.
EraModel era =&gt;
Map ScriptHash (Script era) -&gt; TxOut era -&gt; Bool
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#validTxOut"><span class="hs-identifier hs-var">validTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Map ScriptHash (Script era)
</span><a href="#local-6989586621682718405"><span class="hs-identifier hs-var">scriptmap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span id="local-6989586621682717296"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoTest"><span class="hs-identifier hs-type">getUtxoTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717296"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-585"></span><span id="getUtxoTest"><span class="annot"><span class="annottext">getUtxoTest :: forall era. GenRS era (TxIn -&gt; Bool)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoTest"><span class="hs-identifier hs-var hs-var">getUtxoTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-586"></span><span>  </span><span id="local-6989586621682718415"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682718415"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Map TxIn (TxOut era))
-&gt; RWST (GenEnv era) () (GenState era) Gen (Map TxIn (TxOut era))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; Map TxIn (TxOut era)
forall era. ModelNewEpochState era -&gt; Map TxIn (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mUTxO"><span class="hs-identifier hs-var">mUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; Map TxIn (TxOut era))
-&gt; (GenState era -&gt; ModelNewEpochState era)
-&gt; GenState era
-&gt; Map TxIn (TxOut era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; ModelNewEpochState era
forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>  </span><span class="annot"><span class="annottext">(TxIn -&gt; Bool) -&gt; GenRS era (TxIn -&gt; Bool)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn -&gt; Map TxIn (TxOut era) -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-operator hs-var">`Map.member`</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682718415"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="hs-comment">-- | To compute deposits we need a function that tells if the KeyHash is a new Pool</span><span>
</span><span id="line-590"></span><span class="hs-comment">--   Compute this function before we do any generation, since such generation</span><span>
</span><span id="line-591"></span><span class="hs-comment">--   may actually add to the mPoolParams, and then the added thing won't appear new.</span><span>
</span><span id="line-592"></span><span id="local-6989586621682717304"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getNewPoolTest"><span class="hs-identifier hs-type">getNewPoolTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717304"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-593"></span><span id="getNewPoolTest"><span class="annot"><span class="annottext">getNewPoolTest :: forall era. GenRS era (KeyHash 'StakePool -&gt; Bool)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getNewPoolTest"><span class="hs-identifier hs-var hs-var">getNewPoolTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-594"></span><span>  </span><span id="local-6989586621682718423"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621682718423"><span class="hs-identifier hs-var">stakePools</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map (KeyHash 'StakePool) StakePoolState)
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; Map (KeyHash 'StakePool) StakePoolState
forall era.
ModelNewEpochState era -&gt; Map (KeyHash 'StakePool) StakePoolState
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mStakePools"><span class="hs-identifier hs-var">mStakePools</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; (GenState era -&gt; ModelNewEpochState era)
-&gt; GenState era
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; ModelNewEpochState era
forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>  </span><span class="annot"><span class="annottext">(KeyHash 'StakePool -&gt; Bool)
-&gt; GenRS era (KeyHash 'StakePool -&gt; Bool)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; Map (KeyHash 'StakePool) StakePoolState -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-operator hs-var">`Map.member`</span></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621682718423"><span class="hs-identifier hs-var">stakePools</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span class="hs-comment">-- ========================================================================</span><span>
</span><span id="line-598"></span><span class="hs-comment">-- Tools to get started in the Monad</span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span id="local-6989586621682717306"><span id="local-6989586621682717307"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#runGenRS"><span class="hs-identifier hs-type">runGenRS</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-601"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717306"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-602"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-603"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717306"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717307"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-604"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682717307"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717306"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-605"></span><span id="runGenRS"><span class="annot"><span class="annottext">runGenRS :: forall era a.
EraGenericGen era =&gt;
GenSize -&gt; GenRS era a -&gt; Gen (a, GenState era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#runGenRS"><span class="hs-identifier hs-var hs-var">runGenRS</span></a></span></span><span> </span><span id="local-6989586621682718431"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682718431"><span class="hs-identifier hs-var">gsize</span></a></span></span><span> </span><span id="local-6989586621682718432"><span class="annot"><span class="annottext">GenRS era a
</span><a href="#local-6989586621682718432"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-606"></span><span>  </span><span id="local-6989586621682718433"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621682718433"><span class="hs-identifier hs-var">genenv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Gen (GenEnv era)
forall era. EraGenericGen era =&gt; GenSize -&gt; Gen (GenEnv era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenEnv"><span class="hs-identifier hs-var">genGenEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682718431"><span class="hs-identifier hs-var">gsize</span></a></span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682718434"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682718434"><span class="hs-identifier hs-var">ans</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682718435"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718435"><span class="hs-identifier hs-var">state</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era a
-&gt; GenEnv era -&gt; GenState era -&gt; Gen (a, GenState era, ())
forall r w s (m :: * -&gt; *) a.
RWST r w s m a -&gt; r -&gt; s -&gt; m (a, s, w)
</span><span class="hs-identifier hs-var">runRWST</span></span><span> </span><span class="annot"><span class="annottext">GenRS era a
</span><a href="#local-6989586621682718432"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621682718433"><span class="hs-identifier hs-var">genenv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenEnv era -&gt; GenState era
forall era. Reflect era =&gt; GenEnv era -&gt; GenState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#emptyGenState"><span class="hs-identifier hs-var">emptyGenState</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621682718433"><span class="hs-identifier hs-var">genenv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>  </span><span class="annot"><span class="annottext">(a, GenState era) -&gt; Gen (a, GenState era)
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682718434"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718435"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span>
</span><span id="line-610"></span><span class="annot"><span class="hs-comment">-- | Generate a random, well-formed, GenEnv</span></span><span>
</span><span id="line-611"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenEnv"><span class="hs-identifier hs-type">genGenEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682717310"><span class="annot"><a href="#local-6989586621682717310"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717310"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717310"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span id="genGenEnv"><span class="annot"><span class="annottext">genGenEnv :: forall era. EraGenericGen era =&gt; GenSize -&gt; Gen (GenEnv era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenEnv"><span class="hs-identifier hs-var hs-var">genGenEnv</span></a></span></span><span> </span><span id="local-6989586621682718441"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682718441"><span class="hs-identifier hs-var">gsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-613"></span><span>  </span><span id="local-6989586621682718442"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682718442"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Gen (PParams era)
forall era. EraGenericGen era =&gt; GenSize -&gt; Gen (PParams era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPParams"><span class="hs-identifier hs-var">genPParams</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682718441"><span class="hs-identifier hs-var">gsize</span></a></span><span>
</span><span id="line-614"></span><span>  </span><span class="annot"><span class="annottext">GenEnv era -&gt; Gen (GenEnv era)
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-615"></span><span>    </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span>
</span><span id="line-616"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">geSize :: GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682718441"><span class="hs-identifier hs-var">gsize</span></a></span><span>
</span><span id="line-617"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">gePParams :: PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682718442"><span class="hs-identifier hs-var">pp</span></a></span><span>
</span><span id="line-618"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span id="local-6989586621682717317"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenState"><span class="hs-identifier hs-type">genGenState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-621"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717317"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-622"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-623"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717317"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-624"></span><span id="genGenState"><span class="annot"><span class="annottext">genGenState :: forall era. EraGenericGen era =&gt; GenSize -&gt; Gen (GenState era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenState"><span class="hs-identifier hs-var hs-var">genGenState</span></a></span></span><span> </span><span id="local-6989586621682718467"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682718467"><span class="hs-identifier hs-var">gsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-625"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682718468"><span class="annot"><span class="annottext">slotNo :: Word64
</span><a href="#local-6989586621682718468"><span class="hs-identifier hs-var hs-var">slotNo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Word64
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#startSlot"><span class="hs-identifier hs-var">startSlot</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682718467"><span class="hs-identifier hs-var">gsize</span></a></span><span>
</span><span id="line-626"></span><span>  </span><span id="local-6989586621682718469"><span class="annot"><span class="annottext">StrictMaybe Word64
</span><a href="#local-6989586621682718469"><span class="hs-identifier hs-var">minSlotNo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Int, Gen (StrictMaybe Word64))] -&gt; Gen (StrictMaybe Word64)
forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#frequency"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StrictMaybe Word64 -&gt; Gen (StrictMaybe Word64)
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Word64
forall a. StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; StrictMaybe Word64
forall a. a -&gt; StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; StrictMaybe Word64)
-&gt; Gen Word64 -&gt; Gen (StrictMaybe Word64)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Gen Word64
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">minBound</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682718468"><span class="hs-identifier hs-var">slotNo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-627"></span><span>  </span><span id="local-6989586621682718471"><span class="annot"><span class="annottext">StrictMaybe Word64
</span><a href="#local-6989586621682718471"><span class="hs-identifier hs-var">maxSlotNo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Int, Gen (StrictMaybe Word64))] -&gt; Gen (StrictMaybe Word64)
forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#frequency"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StrictMaybe Word64 -&gt; Gen (StrictMaybe Word64)
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Word64
forall a. StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; StrictMaybe Word64
forall a. a -&gt; StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; StrictMaybe Word64)
-&gt; Gen Word64 -&gt; Gen (StrictMaybe Word64)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Gen Word64
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682718468"><span class="hs-identifier hs-var">slotNo</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-628"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682718474"><span class="annot"><span class="annottext">vi :: ValidityInterval
</span><a href="#local-6989586621682718474"><span class="hs-identifier hs-var hs-var">vi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo -&gt; StrictMaybe SlotNo -&gt; ValidityInterval
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#ValidityInterval"><span class="hs-identifier hs-var">ValidityInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; SlotNo) -&gt; StrictMaybe Word64 -&gt; StrictMaybe SlotNo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Word64
</span><a href="#local-6989586621682718469"><span class="hs-identifier hs-var">minSlotNo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; SlotNo) -&gt; StrictMaybe Word64 -&gt; StrictMaybe SlotNo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Word64
</span><a href="#local-6989586621682718471"><span class="hs-identifier hs-var">maxSlotNo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>  </span><span id="local-6989586621682718475"><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621682718475"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Gen (GenEnv era)
forall era. EraGenericGen era =&gt; GenSize -&gt; Gen (GenEnv era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genGenEnv"><span class="hs-identifier hs-var">genGenEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682718467"><span class="hs-identifier hs-var">gsize</span></a></span><span>
</span><span id="line-630"></span><span>  </span><span class="annot"><span class="annottext">GenState era -&gt; Gen (GenState era)
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenState era -&gt; ValidityInterval -&gt; GenState era
forall era. GenState era -&gt; ValidityInterval -&gt; GenState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#setVi"><span class="hs-identifier hs-var">setVi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenEnv era -&gt; GenState era
forall era. Reflect era =&gt; GenEnv era -&gt; GenState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#emptyGenState"><span class="hs-identifier hs-var">emptyGenState</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era
</span><a href="#local-6989586621682718475"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621682718474"><span class="hs-identifier hs-var">vi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>
</span><span id="line-632"></span><span class="hs-comment">-- | Generate a transaction body validity interval which is close in proximity</span><span>
</span><span id="line-633"></span><span class="hs-comment">--  (less than a stability window) from the current slot.</span><span>
</span><span id="line-634"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genValidityInterval"><span class="hs-identifier hs-type">genValidityInterval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#ValidityInterval"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span>
</span><span id="line-635"></span><span id="genValidityInterval"><span class="annot"><span class="annottext">genValidityInterval :: SlotNo -&gt; Gen ValidityInterval
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genValidityInterval"><span class="hs-identifier hs-var hs-var">genValidityInterval</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span id="local-6989586621682718476"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682718476"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682718478"><span class="annot"><span class="annottext">stabilityWindow :: Word64
</span><a href="#local-6989586621682718478"><span class="hs-identifier hs-var hs-var">stabilityWindow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">29</span></span><span> </span><span class="hs-comment">-- &lt; 3k/f many slots, where 10k is the epoch length</span><span>
</span><span id="line-637"></span><span>  </span><span id="local-6989586621682718479"><span class="annot"><span class="annottext">StrictMaybe Word64
</span><a href="#local-6989586621682718479"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Int, Gen (StrictMaybe Word64))] -&gt; Gen (StrictMaybe Word64)
forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#frequency"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StrictMaybe Word64 -&gt; Gen (StrictMaybe Word64)
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Word64
forall a. StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; StrictMaybe Word64
forall a. a -&gt; StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; StrictMaybe Word64)
-&gt; Gen Word64 -&gt; Gen (StrictMaybe Word64)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Gen Word64
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">minBound</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682718476"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-638"></span><span>  </span><span id="local-6989586621682718480"><span class="annot"><span class="annottext">StrictMaybe Word64
</span><a href="#local-6989586621682718480"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Int, Gen (StrictMaybe Word64))] -&gt; Gen (StrictMaybe Word64)
forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#frequency"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StrictMaybe Word64 -&gt; Gen (StrictMaybe Word64)
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Word64
forall a. StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; StrictMaybe Word64
forall a. a -&gt; StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; StrictMaybe Word64)
-&gt; Gen Word64 -&gt; Gen (StrictMaybe Word64)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Gen Word64
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682718476"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682718476"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682718478"><span class="hs-identifier hs-var">stabilityWindow</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-639"></span><span>  </span><span class="annot"><span class="annottext">ValidityInterval -&gt; Gen ValidityInterval
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ValidityInterval -&gt; Gen ValidityInterval)
-&gt; ValidityInterval -&gt; Gen ValidityInterval
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo -&gt; StrictMaybe SlotNo -&gt; ValidityInterval
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#ValidityInterval"><span class="hs-identifier hs-var">ValidityInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; SlotNo) -&gt; StrictMaybe Word64 -&gt; StrictMaybe SlotNo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Word64
</span><a href="#local-6989586621682718479"><span class="hs-identifier hs-var">start</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; SlotNo) -&gt; StrictMaybe Word64 -&gt; StrictMaybe SlotNo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Word64
</span><a href="#local-6989586621682718480"><span class="hs-identifier hs-var">end</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span class="hs-comment">-- =================================================================</span><span>
</span><span id="line-642"></span><span>
</span><span id="line-643"></span><span id="local-6989586621682717320"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#pcGenState"><span class="hs-identifier hs-type">pcGenState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/l/testlib/doc/html/cardano-ledger-shelley/src/Test.Cardano.Ledger.Shelley.Era.html#ShelleyEraTest"><span class="hs-identifier hs-type">ShelleyEraTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717320"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717320"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span></span><span>
</span><span id="line-644"></span><span id="pcGenState"><span class="annot"><span class="annottext">pcGenState :: forall era. ShelleyEraTest era =&gt; GenState era -&gt; Expr
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#pcGenState"><span class="hs-identifier hs-var hs-var">pcGenState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Expr
forall a. ToExpr a =&gt; a -&gt; Expr
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Class.html#toExpr"><span class="hs-identifier hs-var">toExpr</span></a></span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682717323"><span id="local-6989586621682718487"><span id="local-6989586621682718493"><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/l/testlib/doc/html/cardano-ledger-shelley/src/Test.Cardano.Ledger.Shelley.Era.html#ShelleyEraTest"><span class="hs-identifier hs-type">ShelleyEraTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717323"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Class.html#ToExpr"><span class="hs-identifier hs-type">ToExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717323"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682717336"><span id="local-6989586621682718675"><span id="local-6989586621682718680"><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717336"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/l/testlib/doc/html/cardano-ledger-shelley/src/Test.Cardano.Ledger.Shelley.Era.html#ShelleyEraTest"><span class="hs-identifier hs-type">ShelleyEraTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717336"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717336"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-649"></span><span>  </span><span id="local-6989586621682718685"><span class="annot"><span class="annottext">show :: GenState era -&gt; String
</span><a href="#local-6989586621682718685"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span id="local-6989586621682718687"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718687"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenState era -&gt; Expr
forall era. ShelleyEraTest era =&gt; GenState era -&gt; Expr
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#pcGenState"><span class="hs-identifier hs-var">pcGenState</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718687"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-650"></span><span>
</span><span id="line-651"></span><span class="hs-comment">-- =====================================================================</span><span>
</span><span id="line-652"></span><span class="hs-comment">-- Build an Initial LedgerState for a Trace from a GenState, after</span><span>
</span><span id="line-653"></span><span class="hs-comment">-- generating a coherent Trace (a sequence of Transactions that can</span><span>
</span><span id="line-654"></span><span class="hs-comment">-- logically be applied one after another)</span><span>
</span><span id="line-655"></span><span>
</span><span id="line-656"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#initialLedgerState"><span class="hs-identifier hs-type">initialLedgerState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682717337"><span class="annot"><a href="#local-6989586621682717337"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717337"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717337"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#LedgerState"><span class="hs-identifier hs-type">LedgerState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717337"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-657"></span><span id="initialLedgerState"><span class="annot"><span class="annottext">initialLedgerState :: forall era. Reflect era =&gt; GenState era -&gt; LedgerState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initialLedgerState"><span class="hs-identifier hs-var hs-var">initialLedgerState</span></a></span></span><span> </span><span id="local-6989586621682718717"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718717"><span class="hs-identifier hs-var">gstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTxOState era -&gt; CertState era -&gt; LedgerState era
forall era. UTxOState era -&gt; CertState era -&gt; LedgerState era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#LedgerState"><span class="hs-identifier hs-var">LedgerState</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOState era
</span><a href="#local-6989586621682718719"><span class="hs-identifier hs-var">utxostate</span></a></span><span> </span><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621682718720"><span class="hs-identifier hs-var">dpstate</span></a></span><span>
</span><span id="line-658"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-659"></span><span>    </span><span id="local-6989586621682718719"><span class="annot"><span class="annottext">utxostate :: UTxOState era
</span><a href="#local-6989586621682718719"><span class="hs-identifier hs-var hs-var">utxostate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era
-&gt; UTxO era
-&gt; Coin
-&gt; Coin
-&gt; GovState era
-&gt; Coin
-&gt; UTxOState era
forall era.
EraStake era =&gt;
PParams era
-&gt; UTxO era
-&gt; Coin
-&gt; Coin
-&gt; GovState era
-&gt; Coin
-&gt; UTxOState era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.IncrementalStake.html#smartUTxOState"><span class="hs-identifier hs-var">smartUTxOState</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682718721"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; UTxO era
forall era. Map TxIn (TxOut era) -&gt; UTxO era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenState era -&gt; Map TxIn (TxOut era)
forall era. GenState era -&gt; Map TxIn (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialUtxo"><span class="hs-identifier hs-var">gsInitialUtxo</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718717"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682718723"><span class="hs-identifier hs-var">deposited</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GovState era
forall era. EraGov era =&gt; GovState era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Governance.html#emptyGovState"><span class="hs-identifier hs-var">emptyGovState</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-660"></span><span>    </span><span id="local-6989586621682718720"><span class="annot"><span class="annottext">dpstate :: CertState era
</span><a href="#local-6989586621682718720"><span class="hs-identifier hs-var hs-var">dpstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-661"></span><span>      </span><span class="annot"><span class="annottext">CertState era
forall a. Default a =&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/data-default-0.8.0.1-9291b190c5bc542cf17f99ce44e9365d143d76b9889465ad3d362701e6cc609e/share/doc/html/src/Data.Default.Internal.html#def"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-662"></span><span>        </span><span class="annot"><span class="annottext">CertState era -&gt; (CertState era -&gt; CertState era) -&gt; CertState era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(PState era -&gt; Identity (PState era))
-&gt; CertState era -&gt; Identity (CertState era)
forall era. EraCertState era =&gt; Lens' (CertState era) (PState era)
Lens' (CertState era) (PState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#certPStateL"><span class="hs-identifier hs-var">certPStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((PState era -&gt; Identity (PState era))
 -&gt; CertState era -&gt; Identity (CertState era))
-&gt; PState era -&gt; CertState era -&gt; CertState era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">PState era
</span><a href="#local-6989586621682718728"><span class="hs-identifier hs-var">pstate</span></a></span><span>
</span><span id="line-663"></span><span>        </span><span class="annot"><span class="annottext">CertState era -&gt; (CertState era -&gt; CertState era) -&gt; CertState era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(DState era -&gt; Identity (DState era))
-&gt; CertState era -&gt; Identity (CertState era)
forall era. EraCertState era =&gt; Lens' (CertState era) (DState era)
Lens' (CertState era) (DState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#certDStateL"><span class="hs-identifier hs-var">certDStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((DState era -&gt; Identity (DState era))
 -&gt; CertState era -&gt; Identity (CertState era))
-&gt; DState era -&gt; CertState era -&gt; CertState era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">DState era
</span><a href="#local-6989586621682718730"><span class="hs-identifier hs-var">dstate</span></a></span><span>
</span><span id="line-664"></span><span>    </span><span id="local-6989586621682718730"><span class="annot"><span class="annottext">dstate :: DState era
</span><a href="#local-6989586621682718730"><span class="hs-identifier hs-var hs-var">dstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-665"></span><span>      </span><span class="annot"><span class="annottext">Accounts era
-&gt; Map FutureGenDeleg GenDelegPair
-&gt; GenDelegs
-&gt; InstantaneousRewards
-&gt; DState era
forall era.
Accounts era
-&gt; Map FutureGenDeleg GenDelegPair
-&gt; GenDelegs
-&gt; InstantaneousRewards
-&gt; DState era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#DState"><span class="hs-identifier hs-var">DState</span></a></span><span>
</span><span id="line-666"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Credential 'Staking) (AccountState era) -&gt; Accounts era
forall era.
EraTest era =&gt;
Map (Credential 'Staking) (AccountState era) -&gt; Accounts era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Era.html#accountsFromAccountsMap"><span class="hs-identifier hs-var">accountsFromAccountsMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenState era -&gt; Map (Credential 'Staking) (AccountState era)
forall era.
GenState era -&gt; Map (Credential 'Staking) (AccountState era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialAccounts"><span class="hs-identifier hs-var">gsInitialAccounts</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718717"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>        </span><span class="annot"><span class="annottext">Map FutureGenDeleg GenDelegPair
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-668"></span><span>        </span><span class="annot"><span class="annottext">GenDelegs
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#genDelegsZero"><span class="hs-identifier hs-var">genDelegsZero</span></a></span><span>
</span><span id="line-669"></span><span>        </span><span class="annot"><span class="annottext">InstantaneousRewards
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#instantaneousRewardsZero"><span class="hs-identifier hs-var">instantaneousRewardsZero</span></a></span><span>
</span><span id="line-670"></span><span>    </span><span id="local-6989586621682718728"><span class="annot"><span class="annottext">pstate :: PState era
</span><a href="#local-6989586621682718728"><span class="hs-identifier hs-var hs-var">pstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-671"></span><span>      </span><span class="annot"><span class="annottext">Map (VRFVerKeyHash 'StakePoolVRF) (NonZero Word64)
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) EpochNo
-&gt; PState era
forall era.
Map (VRFVerKeyHash 'StakePoolVRF) (NonZero Word64)
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) EpochNo
-&gt; PState era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#PState"><span class="hs-identifier hs-var">PState</span></a></span><span>
</span><span id="line-672"></span><span>        </span><span class="annot"><span class="annottext">Map (VRFVerKeyHash 'StakePoolVRF) (NonZero Word64)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-673"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompactForm Coin -&gt; PoolParams -&gt; StakePoolState
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#mkStakePoolState"><span class="hs-identifier hs-var">mkStakePoolState</span></a></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621682718735"><span class="hs-identifier hs-var">poolDeposit</span></a></span><span> </span><span class="annot"><span class="annottext">(PoolParams -&gt; StakePoolState)
-&gt; Map (KeyHash 'StakePool) PoolParams
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) PoolParams
</span><a href="#local-6989586621682718736"><span class="hs-identifier hs-var">pools</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span>        </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-675"></span><span>        </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) EpochNo
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-676"></span><span>    </span><span class="hs-comment">-- In a wellformed LedgerState the deposited equals the obligation</span><span>
</span><span id="line-677"></span><span>    </span><span id="local-6989586621682718723"><span class="annot"><span class="annottext">deposited :: Coin
</span><a href="#local-6989586621682718723"><span class="hs-identifier hs-var hs-var">deposited</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertState era -&gt; GovState era -&gt; Coin
forall era.
(EraGov era, EraCertState era) =&gt;
CertState era -&gt; GovState era -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#totalObligation"><span class="hs-identifier hs-var">totalObligation</span></a></span><span> </span><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621682718720"><span class="hs-identifier hs-var">dpstate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxOState era
</span><a href="#local-6989586621682718719"><span class="hs-identifier hs-var">utxostate</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOState era
-&gt; Getting (GovState era) (UTxOState era) (GovState era)
-&gt; GovState era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (GovState era) (UTxOState era) (GovState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(GovState era -&gt; f (GovState era))
-&gt; UTxOState era -&gt; f (UTxOState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#utxosGovStateL"><span class="hs-identifier hs-var">utxosGovStateL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-678"></span><span>    </span><span id="local-6989586621682718736"><span class="annot"><span class="annottext">pools :: Map (KeyHash 'StakePool) PoolParams
</span><a href="#local-6989586621682718736"><span class="hs-identifier hs-var hs-var">pools</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Map (KeyHash 'StakePool) PoolParams
forall era. GenState era -&gt; Map (KeyHash 'StakePool) PoolParams
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolParams"><span class="hs-identifier hs-var">gsInitialPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718717"><span class="hs-identifier hs-var">gstate</span></a></span><span>
</span><span id="line-679"></span><span>    </span><span id="local-6989586621682718721"><span class="annot"><span class="annottext">pp :: PParams era
</span><a href="#local-6989586621682718721"><span class="hs-identifier hs-var hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; PParams era
forall era. ModelNewEpochState era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPParams"><span class="hs-identifier hs-var">mPParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenState era -&gt; ModelNewEpochState era
forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682718717"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-680"></span><span>    </span><span id="local-6989586621682718735"><span class="annot"><span class="annottext">poolDeposit :: CompactForm Coin
</span><a href="#local-6989586621682718735"><span class="hs-identifier hs-var hs-var">poolDeposit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682718721"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
-&gt; Getting (CompactForm Coin) (PParams era) (CompactForm Coin)
-&gt; CompactForm Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (CompactForm Coin) (PParams era) (CompactForm Coin)
forall era.
EraPParams era =&gt;
Lens' (PParams era) (CompactForm Coin)
Lens' (PParams era) (CompactForm Coin)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#ppPoolDepositCompactL"><span class="hs-identifier hs-var">ppPoolDepositCompactL</span></a></span><span>
</span><span id="line-681"></span><span>
</span><span id="line-682"></span><span class="hs-comment">-- =============================================</span><span>
</span><span id="line-683"></span><span class="hs-comment">-- Generators of inter-related items</span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span class="hs-comment">-- Adds to the gsKeys</span><span>
</span><span id="line-686"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier hs-type">genKeyHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682717384"><span class="annot"><a href="#local-6989586621682717384"><span class="hs-identifier hs-type">kr</span></a></span></span><span> </span><span id="local-6989586621682717383"><span class="annot"><a href="#local-6989586621682717383"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717383"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717384"><span class="hs-identifier hs-type">kr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span id="genKeyHash"><span class="annot"><span class="annottext">genKeyHash :: forall (kr :: KeyRole) era. GenRS era (KeyHash kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier hs-var hs-var">genKeyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-688"></span><span>  </span><span id="local-6989586621682718750"><span class="annot"><span class="annottext">KeyPair 'Witness
</span><a href="#local-6989586621682718750"><span class="hs-identifier hs-var">keyPair</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (KeyPair 'Witness)
-&gt; RWST (GenEnv era) () (GenState era) Gen (KeyPair 'Witness)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen (KeyPair 'Witness)
forall a. Arbitrary a =&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-689"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682718751"><span class="annot"><span class="annottext">keyHash :: KeyHash 'Witness
</span><a href="#local-6989586621682718751"><span class="hs-identifier hs-var hs-var">keyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VKey 'Witness -&gt; KeyHash 'Witness
forall (kd :: KeyRole). VKey kd -&gt; KeyHash kd
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#hashKey"><span class="hs-identifier hs-var">hashKey</span></a></span><span> </span><span class="annot"><span class="annottext">(VKey 'Witness -&gt; KeyHash 'Witness)
-&gt; VKey 'Witness -&gt; KeyHash 'Witness
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KeyPair 'Witness -&gt; VKey 'Witness
forall (kd :: KeyRole). KeyPair kd -&gt; VKey kd
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Core.KeyPair.html#vKey"><span class="hs-identifier hs-var">vKey</span></a></span><span> </span><span class="annot"><span class="annottext">KeyPair 'Witness
</span><a href="#local-6989586621682718750"><span class="hs-identifier hs-var">keyPair</span></a></span><span>
</span><span id="line-690"></span><span>  </span><span class="annot"><span class="annottext">(Map (KeyHash 'Witness) (KeyPair 'Witness)
 -&gt; Map (KeyHash 'Witness) (KeyPair 'Witness))
-&gt; GenRS era ()
forall era.
(Map (KeyHash 'Witness) (KeyPair 'Witness)
 -&gt; Map (KeyHash 'Witness) (KeyPair 'Witness))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateKeys"><span class="hs-identifier hs-var">modifyGenStateKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'Witness
-&gt; KeyPair 'Witness
-&gt; Map (KeyHash 'Witness) (KeyPair 'Witness)
-&gt; Map (KeyHash 'Witness) (KeyPair 'Witness)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Witness
</span><a href="#local-6989586621682718751"><span class="hs-identifier hs-var">keyHash</span></a></span><span> </span><span class="annot"><span class="annottext">KeyPair 'Witness
</span><a href="#local-6989586621682718750"><span class="hs-identifier hs-var">keyPair</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-691"></span><span>  </span><span class="annot"><span class="annottext">KeyHash kr -&gt; GenRS era (KeyHash kr)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(KeyHash kr -&gt; GenRS era (KeyHash kr))
-&gt; KeyHash kr -&gt; GenRS era (KeyHash kr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Witness -&gt; KeyHash kr
forall (r :: KeyRole) (r' :: KeyRole). KeyHash r -&gt; KeyHash r'
forall (a :: KeyRole -&gt; *) (r :: KeyRole) (r' :: KeyRole).
HasKeyRole a =&gt;
a r -&gt; a r'
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#coerceKeyRole"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Witness
</span><a href="#local-6989586621682718751"><span class="hs-identifier hs-var">keyHash</span></a></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span class="hs-comment">-- Adds to the gsDatums</span><span>
</span><span id="line-694"></span><span id="local-6989586621682717397"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genDatumWithHash"><span class="hs-identifier hs-type">genDatumWithHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717397"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717397"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#DataHash"><span class="hs-identifier hs-type">DataHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717397"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-695"></span><span id="genDatumWithHash"><span class="annot"><span class="annottext">genDatumWithHash :: forall era. Era era =&gt; GenRS era (DataHash, Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genDatumWithHash"><span class="hs-identifier hs-var hs-var">genDatumWithHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-696"></span><span>  </span><span id="local-6989586621682718765"><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621682718765"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Data era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Data era)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen (Data era)
forall a. Arbitrary a =&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-697"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682718766"><span class="annot"><span class="annottext">datumHash :: DataHash
</span><a href="#local-6989586621682718766"><span class="hs-identifier hs-var hs-var">datumHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Data era -&gt; DataHash
forall era. Data era -&gt; DataHash
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#hashData"><span class="hs-identifier hs-var">hashData</span></a></span><span> </span><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621682718765"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-698"></span><span>  </span><span class="annot"><span class="annottext">(Map DataHash (Data era) -&gt; Map DataHash (Data era))
-&gt; GenRS era ()
forall era.
(Map DataHash (Data era) -&gt; Map DataHash (Data era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateDatums"><span class="hs-identifier hs-var">modifyGenStateDatums</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataHash
-&gt; Data era -&gt; Map DataHash (Data era) -&gt; Map DataHash (Data era)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">DataHash
</span><a href="#local-6989586621682718766"><span class="hs-identifier hs-var">datumHash</span></a></span><span> </span><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621682718765"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-699"></span><span>  </span><span class="annot"><span class="annottext">(DataHash, Data era) -&gt; GenRS era (DataHash, Data era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataHash
</span><a href="#local-6989586621682718766"><span class="hs-identifier hs-var">datumHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621682718765"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-700"></span><span>
</span><span id="line-701"></span><span id="local-6989586621682717402"><span id="local-6989586621682717403"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshKeyHash"><span class="hs-identifier hs-type">genFreshKeyHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717402"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717403"><span class="hs-identifier hs-type">kr</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-702"></span><span id="genFreshKeyHash"><span class="annot"><span class="annottext">genFreshKeyHash :: forall era (kr :: KeyRole). GenRS era (KeyHash kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshKeyHash"><span class="hs-identifier hs-var hs-var">genFreshKeyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash kr)
forall {a} {era} {r :: KeyRole}.
(Ord a, Num a) =&gt;
a -&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash r)
</span><a href="#local-6989586621682718769"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- avoid unlikely chance of generated hash collisions.</span><span>
</span><span id="line-703"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-704"></span><span>    </span><span id="local-6989586621682718769"><span class="annot"><span class="annottext">go :: a -&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash r)
</span><a href="#local-6989586621682718769"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682718790"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682718790"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-705"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682718790"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash r)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Something very unlikely happened&quot;</span></span><span>
</span><span id="line-706"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-707"></span><span>          </span><span id="local-6989586621682718791"><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
</span><a href="#local-6989586621682718791"><span class="hs-identifier hs-var">avoidKeys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Set (KeyHash 'StakePool))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Set (KeyHash 'StakePool))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Set (KeyHash 'StakePool)
forall era. GenState era -&gt; Set (KeyHash 'StakePool)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidKey"><span class="hs-identifier hs-var">gsAvoidKey</span></a></span><span>
</span><span id="line-708"></span><span>          </span><span id="local-6989586621682718792"><span class="annot"><span class="annottext">KeyHash r
</span><a href="#local-6989586621682718792"><span class="hs-identifier hs-var">kh</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (KeyHash r)
forall (kr :: KeyRole) era. GenRS era (KeyHash kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier hs-var">genKeyHash</span></a></span><span>
</span><span id="line-709"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">KeyHash r -&gt; KeyHash 'StakePool
forall (r :: KeyRole) (r' :: KeyRole). KeyHash r -&gt; KeyHash r'
forall (a :: KeyRole -&gt; *) (r :: KeyRole) (r' :: KeyRole).
HasKeyRole a =&gt;
a r -&gt; a r'
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#coerceKeyRole"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash r
</span><a href="#local-6989586621682718792"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; Set (KeyHash 'StakePool) -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
</span><a href="#local-6989586621682718791"><span class="hs-identifier hs-var">avoidKeys</span></a></span><span>
</span><span id="line-710"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash r)
</span><a href="#local-6989586621682718769"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash r))
-&gt; a -&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682718790"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span>
</span><span id="line-711"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">KeyHash r -&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash r)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">KeyHash r
</span><a href="#local-6989586621682718792"><span class="hs-identifier hs-var">kh</span></a></span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span class="hs-comment">-- ===========================================================</span><span>
</span><span id="line-714"></span><span class="hs-comment">-- Generate Era agnostic Scripts</span><span>
</span><span id="line-715"></span><span>
</span><span id="line-716"></span><span class="hs-comment">-- Adds to gsScripts and gsPlutusScripts</span><span>
</span><span id="line-717"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier hs-type">genScript</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682717412"><span class="annot"><a href="#local-6989586621682717412"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717412"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717412"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span>
</span><span id="line-718"></span><span id="genScript"><span class="annot"><span class="annottext">genScript :: forall era. Reflect era =&gt; PlutusPurposeTag -&gt; GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier hs-var hs-var">genScript</span></a></span></span><span> </span><span id="local-6989586621682718796"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682718796"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682717412"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-719"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[GenRS era ScriptHash] -&gt; GenRS era ScriptHash
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GenRS era ScriptHash
forall era.
(AllegraEraScript era, NativeScript era ~ Timelock era) =&gt;
GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genTimelockScript"><span class="hs-identifier hs-var">genTimelockScript</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag -&gt; GenRS era ScriptHash
forall era.
(Reflect era, EraPlutusContext era) =&gt;
PlutusPurposeTag -&gt; GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPlutusScript"><span class="hs-identifier hs-var">genPlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682718796"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-720"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[GenRS era ScriptHash] -&gt; GenRS era ScriptHash
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GenRS era ScriptHash
forall era.
(AllegraEraScript era, NativeScript era ~ Timelock era) =&gt;
GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genTimelockScript"><span class="hs-identifier hs-var">genTimelockScript</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag -&gt; GenRS era ScriptHash
forall era.
(Reflect era, EraPlutusContext era) =&gt;
PlutusPurposeTag -&gt; GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPlutusScript"><span class="hs-identifier hs-var">genPlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682718796"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-721"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-var">Alonzo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[GenRS era ScriptHash] -&gt; GenRS era ScriptHash
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GenRS era ScriptHash
forall era.
(AllegraEraScript era, NativeScript era ~ Timelock era) =&gt;
GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genTimelockScript"><span class="hs-identifier hs-var">genTimelockScript</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag -&gt; GenRS era ScriptHash
forall era.
(Reflect era, EraPlutusContext era) =&gt;
PlutusPurposeTag -&gt; GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPlutusScript"><span class="hs-identifier hs-var">genPlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682718796"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-722"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-var">Mary</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenRS era ScriptHash
forall era.
(AllegraEraScript era, NativeScript era ~ Timelock era) =&gt;
GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genTimelockScript"><span class="hs-identifier hs-var">genTimelockScript</span></a></span><span>
</span><span id="line-723"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-var">Allegra</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenRS era ScriptHash
forall era.
(AllegraEraScript era, NativeScript era ~ Timelock era) =&gt;
GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genTimelockScript"><span class="hs-identifier hs-var">genTimelockScript</span></a></span><span>
</span><span id="line-724"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-var">Shelley</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenRS era ScriptHash
forall era.
(ShelleyEraScript era, NativeScript era ~ MultiSig era) =&gt;
GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMultiSigScript"><span class="hs-identifier hs-var">genMultiSigScript</span></a></span><span>
</span><span id="line-725"></span><span>
</span><span id="line-726"></span><span class="hs-comment">-- Adds to gsScripts</span><span>
</span><span id="line-727"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genTimelockScript"><span class="hs-identifier hs-type">genTimelockScript</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-728"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682717420"><span class="annot"><a href="#local-6989586621682717420"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-729"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#AllegraEraScript"><span class="hs-identifier hs-type">AllegraEraScript</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717420"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#NativeScript"><span class="hs-identifier hs-type">NativeScript</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717420"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#Timelock"><span class="hs-identifier hs-type">Timelock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717420"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-730"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717420"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span>
</span><span id="line-731"></span><span id="genTimelockScript"><span class="annot"><span class="annottext">genTimelockScript :: forall era.
(AllegraEraScript era, NativeScript era ~ Timelock era) =&gt;
GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genTimelockScript"><span class="hs-identifier hs-var hs-var">genTimelockScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-732"></span><span>  </span><span id="local-6989586621682719001"><span class="annot"><span class="annottext">vi :: ValidityInterval
</span><a href="#local-6989586621682719001"><span class="hs-identifier hs-var">vi</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#ValidityInterval"><span class="hs-identifier hs-type">ValidityInterval</span></a></span><span> </span><span id="local-6989586621682719002"><span class="annot"><span class="annottext">StrictMaybe SlotNo
</span><a href="#local-6989586621682719002"><span class="hs-identifier hs-var">mBefore</span></a></span></span><span> </span><span id="local-6989586621682719003"><span class="annot"><span class="annottext">StrictMaybe SlotNo
</span><a href="#local-6989586621682719003"><span class="hs-identifier hs-var">mAfter</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; ValidityInterval)
-&gt; RWST (GenEnv era) () (GenState era) Gen ValidityInterval
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; ValidityInterval
forall era. GenState era -&gt; ValidityInterval
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsValidityInterval"><span class="hs-identifier hs-var">gsValidityInterval</span></a></span><span>
</span><span id="line-733"></span><span>  </span><span class="hs-comment">-- We need to limit how deep these timelocks can go, otherwise this generator will</span><span>
</span><span id="line-734"></span><span>  </span><span class="hs-comment">-- diverge. It also has to stay very shallow because it grows too fast.</span><span>
</span><span id="line-735"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682719004"><span class="annot"><span class="annottext">genNestedTimelock :: Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621682719004"><span class="hs-identifier hs-var hs-var">genNestedTimelock</span></a></span></span><span> </span><span id="local-6989586621682719005"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719005"><span class="hs-identifier hs-var">k</span></a></span></span><span>
</span><span id="line-736"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719005"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-737"></span><span>            </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen (Timelock era)]
-&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="annot"><span class="annottext">([RWST (GenEnv era) () (GenState era) Gen (Timelock era)]
 -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era))
-&gt; [RWST (GenEnv era) () (GenState era) Gen (Timelock era)]
-&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-738"></span><span>              </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen (Timelock era)]
</span><a href="#local-6989586621682719007"><span class="hs-identifier hs-var">nonRecTimelocks</span></a></span><span> </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen (Timelock era)]
-&gt; [RWST (GenEnv era) () (GenState era) Gen (Timelock era)]
-&gt; [RWST (GenEnv era) () (GenState era) Gen (Timelock era)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621682719008"><span class="hs-identifier hs-var">requireAllOf</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719005"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621682719009"><span class="hs-identifier hs-var">requireAnyOf</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719005"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621682719010"><span class="hs-identifier hs-var">requireMOf</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719005"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-739"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen (Timelock era)]
-&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen (Timelock era)]
</span><a href="#local-6989586621682719007"><span class="hs-identifier hs-var">nonRecTimelocks</span></a></span><span>
</span><span id="line-740"></span><span>      </span><span class="annot"><a href="#local-6989586621682719007"><span class="hs-identifier hs-type">nonRecTimelocks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717420"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#Timelock"><span class="hs-identifier hs-type">Timelock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717420"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-741"></span><span>      </span><span id="local-6989586621682719007"><span class="annot"><span class="annottext">nonRecTimelocks :: [RWST (GenEnv era) () (GenState era) Gen (Timelock era)]
</span><a href="#local-6989586621682719007"><span class="hs-identifier hs-var hs-var">nonRecTimelocks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-742"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621682719011"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-743"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-type">SJust</span></a></span><span> </span><span id="local-6989586621682719011"><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621682719011"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-744"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
SlotNo
-&gt; RWST (GenEnv era) () (GenState era) Gen (NativeScript era)
forall {era} {t :: (* -&gt; *) -&gt; * -&gt; *}.
(Assert
   (OrdCond
      (CmpNat (ProtVerLow era) (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 0 (ProtVerLow era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 0 (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 Monad (t Gen), MonadTrans t, AllegraEraScript era) =&gt;
SlotNo -&gt; t Gen (NativeScript era)
</span><a href="#local-6989586621682719012"><span class="hs-identifier hs-var">requireTimeStart</span></a></span><span> </span><span class="annot"><span class="annottext">(SlotNo -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era))
-&gt; StrictMaybe SlotNo
-&gt; StrictMaybe
     (RWST (GenEnv era) () (GenState era) Gen (Timelock era))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo
</span><a href="#local-6989586621682719002"><span class="hs-identifier hs-var">mBefore</span></a></span><span>
</span><span id="line-745"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
SlotNo
-&gt; RWST (GenEnv era) () (GenState era) Gen (NativeScript era)
forall {era} {t :: (* -&gt; *) -&gt; * -&gt; *}.
(Assert
   (OrdCond
      (CmpNat (ProtVerLow era) (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 0 (ProtVerLow era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 0 (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 Monad (t Gen), MonadTrans t, AllegraEraScript era) =&gt;
SlotNo -&gt; t Gen (NativeScript era)
</span><a href="#local-6989586621682719013"><span class="hs-identifier hs-var">requireTimeExpire</span></a></span><span> </span><span class="annot"><span class="annottext">(SlotNo -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era))
-&gt; StrictMaybe SlotNo
-&gt; StrictMaybe
     (RWST (GenEnv era) () (GenState era) Gen (Timelock era))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe SlotNo
</span><a href="#local-6989586621682719003"><span class="hs-identifier hs-var">mAfter</span></a></span><span>
</span><span id="line-746"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (Timelock era)
-&gt; StrictMaybe
     (RWST (GenEnv era) () (GenState era) Gen (Timelock era))
forall a. a -&gt; StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (Timelock era)
RWST (GenEnv era) () (GenState era) Gen (NativeScript era)
forall {era}.
RWST (GenEnv era) () (GenState era) Gen (NativeScript era)
</span><a href="#local-6989586621682719014"><span class="hs-identifier hs-var">requireSignature</span></a></span><span>
</span><span id="line-747"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-748"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-749"></span><span>      </span><span id="local-6989586621682719014"><span class="annot"><span class="annottext">requireSignature :: RWST (GenEnv era) () (GenState era) Gen (NativeScript era)
</span><a href="#local-6989586621682719014"><span class="hs-identifier hs-var hs-var">requireSignature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyHash 'Witness -&gt; NativeScript era
forall era.
ShelleyEraScript era =&gt;
KeyHash 'Witness -&gt; NativeScript era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireSignature"><span class="hs-identifier hs-var">RequireSignature</span></a></span><span> </span><span class="annot"><span class="annottext">(KeyHash 'Witness -&gt; NativeScript era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash 'Witness)
-&gt; RWST (GenEnv era) () (GenState era) Gen (NativeScript era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (KeyHash 'Witness)
forall (kr :: KeyRole) era. GenRS era (KeyHash kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier hs-var">genKeyHash</span></a></span><span>
</span><span id="line-750"></span><span>      </span><span id="local-6989586621682719008"><span class="annot"><span class="annottext">requireAllOf :: Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621682719008"><span class="hs-identifier hs-var hs-var">requireAllOf</span></a></span></span><span> </span><span id="local-6989586621682719051"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719051"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-751"></span><span>        </span><span id="local-6989586621682719052"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719052"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#nonNegativeSingleDigitInt"><span class="hs-identifier hs-var">nonNegativeSingleDigitInt</span></a></span><span>
</span><span id="line-752"></span><span>        </span><span class="annot"><span class="annottext">StrictSeq (Timelock era) -&gt; Timelock era
StrictSeq (NativeScript era) -&gt; NativeScript era
forall era.
ShelleyEraScript era =&gt;
StrictSeq (NativeScript era) -&gt; NativeScript era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireAllOf"><span class="hs-identifier hs-var">RequireAllOf</span></a></span><span> </span><span class="annot"><span class="annottext">(StrictSeq (Timelock era) -&gt; Timelock era)
-&gt; ([Timelock era] -&gt; StrictSeq (Timelock era))
-&gt; [Timelock era]
-&gt; Timelock era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Timelock era] -&gt; StrictSeq (Timelock era)
forall a. [a] -&gt; StrictSeq a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html#fromList"><span class="hs-identifier hs-var">Seq.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([Timelock era] -&gt; Timelock era)
-&gt; RWST (GenEnv era) () (GenState era) Gen [Timelock era]
-&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
-&gt; RWST (GenEnv era) () (GenState era) Gen [Timelock era]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719052"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621682719004"><span class="hs-identifier hs-var">genNestedTimelock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719051"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-753"></span><span>      </span><span id="local-6989586621682719009"><span class="annot"><span class="annottext">requireAnyOf :: Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621682719009"><span class="hs-identifier hs-var hs-var">requireAnyOf</span></a></span></span><span> </span><span id="local-6989586621682719054"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719054"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-754"></span><span>        </span><span id="local-6989586621682719055"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719055"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#positiveSingleDigitInt"><span class="hs-identifier hs-var">positiveSingleDigitInt</span></a></span><span>
</span><span id="line-755"></span><span>        </span><span class="annot"><span class="annottext">StrictSeq (Timelock era) -&gt; Timelock era
StrictSeq (NativeScript era) -&gt; NativeScript era
forall era.
ShelleyEraScript era =&gt;
StrictSeq (NativeScript era) -&gt; NativeScript era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireAnyOf"><span class="hs-identifier hs-var">RequireAnyOf</span></a></span><span> </span><span class="annot"><span class="annottext">(StrictSeq (Timelock era) -&gt; Timelock era)
-&gt; ([Timelock era] -&gt; StrictSeq (Timelock era))
-&gt; [Timelock era]
-&gt; Timelock era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Timelock era] -&gt; StrictSeq (Timelock era)
forall a. [a] -&gt; StrictSeq a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html#fromList"><span class="hs-identifier hs-var">Seq.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([Timelock era] -&gt; Timelock era)
-&gt; RWST (GenEnv era) () (GenState era) Gen [Timelock era]
-&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
-&gt; RWST (GenEnv era) () (GenState era) Gen [Timelock era]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719055"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621682719004"><span class="hs-identifier hs-var">genNestedTimelock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719054"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span>      </span><span id="local-6989586621682719010"><span class="annot"><span class="annottext">requireMOf :: Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621682719010"><span class="hs-identifier hs-var hs-var">requireMOf</span></a></span></span><span> </span><span id="local-6989586621682719056"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719056"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-757"></span><span>        </span><span id="local-6989586621682719057"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719057"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#nonNegativeSingleDigitInt"><span class="hs-identifier hs-var">nonNegativeSingleDigitInt</span></a></span><span>
</span><span id="line-758"></span><span>        </span><span id="local-6989586621682719058"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719058"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int)
-&gt; Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719057"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-759"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; StrictSeq (NativeScript era) -&gt; NativeScript era
forall era.
ShelleyEraScript era =&gt;
Int -&gt; StrictSeq (NativeScript era) -&gt; NativeScript era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireMOf"><span class="hs-identifier hs-var">RequireMOf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719058"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(StrictSeq (Timelock era) -&gt; Timelock era)
-&gt; ([Timelock era] -&gt; StrictSeq (Timelock era))
-&gt; [Timelock era]
-&gt; Timelock era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Timelock era] -&gt; StrictSeq (Timelock era)
forall a. [a] -&gt; StrictSeq a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html#fromList"><span class="hs-identifier hs-var">Seq.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([Timelock era] -&gt; Timelock era)
-&gt; RWST (GenEnv era) () (GenState era) Gen [Timelock era]
-&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
-&gt; RWST (GenEnv era) () (GenState era) Gen [Timelock era]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719057"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621682719004"><span class="hs-identifier hs-var">genNestedTimelock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719056"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-760"></span><span>      </span><span id="local-6989586621682719012"><span class="annot"><span class="annottext">requireTimeStart :: SlotNo -&gt; t Gen (NativeScript era)
</span><a href="#local-6989586621682719012"><span class="hs-identifier hs-var hs-var">requireTimeStart</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span id="local-6989586621682719143"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682719143"><span class="hs-identifier hs-var">validFrom</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-761"></span><span>        </span><span id="local-6989586621682719144"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682719144"><span class="hs-identifier hs-var">minSlotNo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Word64 -&gt; t Gen Word64
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Word64 -&gt; t Gen Word64) -&gt; Gen Word64 -&gt; t Gen Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Gen Word64
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">minBound</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682719143"><span class="hs-identifier hs-var">validFrom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-762"></span><span>        </span><span class="annot"><span class="annottext">NativeScript era -&gt; t Gen (NativeScript era)
forall a. a -&gt; t Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(NativeScript era -&gt; t Gen (NativeScript era))
-&gt; NativeScript era -&gt; t Gen (NativeScript era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; NativeScript era
forall era. AllegraEraScript era =&gt; SlotNo -&gt; NativeScript era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#RequireTimeStart"><span class="hs-identifier hs-var">RequireTimeStart</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682719144"><span class="hs-identifier hs-var">minSlotNo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>      </span><span id="local-6989586621682719013"><span class="annot"><span class="annottext">requireTimeExpire :: SlotNo -&gt; t Gen (NativeScript era)
</span><a href="#local-6989586621682719013"><span class="hs-identifier hs-var hs-var">requireTimeExpire</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span id="local-6989586621682719227"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682719227"><span class="hs-identifier hs-var">validTill</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-764"></span><span>        </span><span id="local-6989586621682719228"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682719228"><span class="hs-identifier hs-var">maxSlotNo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Word64 -&gt; t Gen Word64
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Word64 -&gt; t Gen Word64) -&gt; Gen Word64 -&gt; t Gen Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Gen Word64
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682719227"><span class="hs-identifier hs-var">validTill</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span class="hs-special">)</span><span>
</span><span id="line-765"></span><span>        </span><span class="annot"><span class="annottext">NativeScript era -&gt; t Gen (NativeScript era)
forall a. a -&gt; t Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(NativeScript era -&gt; t Gen (NativeScript era))
-&gt; NativeScript era -&gt; t Gen (NativeScript era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; NativeScript era
forall era. AllegraEraScript era =&gt; SlotNo -&gt; NativeScript era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#RequireTimeExpire"><span class="hs-identifier hs-var">RequireTimeExpire</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682719228"><span class="hs-identifier hs-var">maxSlotNo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-766"></span><span>  </span><span id="local-6989586621682719229"><span class="annot"><span class="annottext">Timelock era
</span><a href="#local-6989586621682719229"><span class="hs-identifier hs-var">tlscript</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
</span><a href="#local-6989586621682719004"><span class="hs-identifier hs-var">genNestedTimelock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">)</span><span>
</span><span id="line-767"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682719230"><span class="annot"><span class="annottext">corescript :: Script era
</span><a href="#local-6989586621682719230"><span class="hs-identifier hs-var hs-var">corescript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NativeScript era -&gt; Script era
forall era. EraScript era =&gt; NativeScript era -&gt; Script era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#fromNativeScript"><span class="hs-identifier hs-var">fromNativeScript</span></a></span><span> </span><span class="annot"><span class="annottext">Timelock era
NativeScript era
</span><a href="#local-6989586621682719229"><span class="hs-identifier hs-var">tlscript</span></a></span><span>
</span><span id="line-768"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682719232"><span class="annot"><span class="annottext">scriptHash :: ScriptHash
</span><a href="#local-6989586621682719232"><span class="hs-identifier hs-var hs-var">scriptHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. EraScript era =&gt; Script era -&gt; ScriptHash
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#hashScript"><span class="hs-identifier hs-var">hashScript</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682717420"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682719230"><span class="hs-identifier hs-var">corescript</span></a></span><span>
</span><span id="line-769"></span><span>      </span><span id="local-6989586621682719238"><span class="annot"><span class="annottext">insertOrCreate :: a -&gt; Maybe (Set a) -&gt; Maybe (Set a)
</span><a href="#local-6989586621682719238"><span class="hs-identifier hs-var hs-var">insertOrCreate</span></a></span></span><span> </span><span id="local-6989586621682719239"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682719239"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Set a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Maybe (Set a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Set a
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682719239"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-770"></span><span>      </span><span class="annot"><a href="#local-6989586621682719238"><span class="hs-identifier hs-var">insertOrCreate</span></a></span><span> </span><span id="local-6989586621682719241"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682719241"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682719242"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621682719242"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Maybe (Set a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682719241"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621682719242"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-771"></span><span>  </span><span class="annot"><span class="annottext">(Map ScriptHash (Script era) -&gt; Map ScriptHash (Script era))
-&gt; GenRS era ()
forall era.
(Map ScriptHash (Script era) -&gt; Map ScriptHash (Script era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateScripts"><span class="hs-identifier hs-var">modifyGenStateScripts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash
-&gt; Script era
-&gt; Map ScriptHash (Script era)
-&gt; Map ScriptHash (Script era)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682719232"><span class="hs-identifier hs-var">scriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682719230"><span class="hs-identifier hs-var">corescript</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-772"></span><span>  </span><span class="annot"><span class="annottext">(Map ValidityInterval (Set ScriptHash)
 -&gt; Map ValidityInterval (Set ScriptHash))
-&gt; GenRS era ()
forall era.
(Map ValidityInterval (Set ScriptHash)
 -&gt; Map ValidityInterval (Set ScriptHash))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateVI"><span class="hs-identifier hs-var">modifyGenStateVI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe (Set ScriptHash) -&gt; Maybe (Set ScriptHash))
-&gt; ValidityInterval
-&gt; Map ValidityInterval (Set ScriptHash)
-&gt; Map ValidityInterval (Set ScriptHash)
forall k a.
Ord k =&gt;
(Maybe a -&gt; Maybe a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.alter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash -&gt; Maybe (Set ScriptHash) -&gt; Maybe (Set ScriptHash)
forall {a}. Ord a =&gt; a -&gt; Maybe (Set a) -&gt; Maybe (Set a)
</span><a href="#local-6989586621682719238"><span class="hs-identifier hs-var">insertOrCreate</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682719232"><span class="hs-identifier hs-var">scriptHash</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621682719001"><span class="hs-identifier hs-var">vi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-773"></span><span>  </span><span class="annot"><span class="annottext">ScriptHash -&gt; GenRS era ScriptHash
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682719232"><span class="hs-identifier hs-var">scriptHash</span></a></span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span class="hs-comment">-- Adds to gsScripts</span><span>
</span><span id="line-776"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genMultiSigScript"><span class="hs-identifier hs-type">genMultiSigScript</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-777"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682717424"><span class="annot"><a href="#local-6989586621682717424"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-778"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#ShelleyEraScript"><span class="hs-identifier hs-type">ShelleyEraScript</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717424"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#NativeScript"><span class="hs-identifier hs-type">NativeScript</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717424"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#MultiSig"><span class="hs-identifier hs-type">MultiSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717424"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-779"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717424"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span>
</span><span id="line-780"></span><span id="genMultiSigScript"><span class="annot"><span class="annottext">genMultiSigScript :: forall era.
(ShelleyEraScript era, NativeScript era ~ MultiSig era) =&gt;
GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMultiSigScript"><span class="hs-identifier hs-var hs-var">genMultiSigScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-781"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682719294"><span class="annot"><span class="annottext">genNestedMultiSig :: Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621682719294"><span class="hs-identifier hs-var hs-var">genNestedMultiSig</span></a></span></span><span> </span><span id="local-6989586621682719295"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719295"><span class="hs-identifier hs-var">k</span></a></span></span><span>
</span><span id="line-782"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719295"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-783"></span><span>            </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen (MultiSig era)]
-&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="annot"><span class="annottext">([RWST (GenEnv era) () (GenState era) Gen (MultiSig era)]
 -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era))
-&gt; [RWST (GenEnv era) () (GenState era) Gen (MultiSig era)]
-&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-784"></span><span>              </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen (MultiSig era)]
</span><a href="#local-6989586621682719296"><span class="hs-identifier hs-var">nonRecTimelocks</span></a></span><span> </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen (MultiSig era)]
-&gt; [RWST (GenEnv era) () (GenState era) Gen (MultiSig era)]
-&gt; [RWST (GenEnv era) () (GenState era) Gen (MultiSig era)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621682719297"><span class="hs-identifier hs-var">requireAllOf</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719295"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621682719298"><span class="hs-identifier hs-var">requireAnyOf</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719295"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621682719299"><span class="hs-identifier hs-var">requireMOf</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719295"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-785"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen (MultiSig era)]
-&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen (MultiSig era)]
</span><a href="#local-6989586621682719296"><span class="hs-identifier hs-var">nonRecTimelocks</span></a></span><span>
</span><span id="line-786"></span><span>      </span><span id="local-6989586621682719296"><span class="annot"><span class="annottext">nonRecTimelocks :: [RWST (GenEnv era) () (GenState era) Gen (MultiSig era)]
</span><a href="#local-6989586621682719296"><span class="hs-identifier hs-var hs-var">nonRecTimelocks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621682719300"><span class="hs-identifier hs-var">requireSignature</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-787"></span><span>      </span><span id="local-6989586621682719300"><span class="annot"><span class="annottext">requireSignature :: RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621682719300"><span class="hs-identifier hs-var hs-var">requireSignature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era.
ShelleyEraScript era =&gt;
KeyHash 'Witness -&gt; NativeScript era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireSignature"><span class="hs-identifier hs-var">RequireSignature</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682717424"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">(KeyHash 'Witness -&gt; MultiSig era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash 'Witness)
-&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (KeyHash 'Witness)
forall (kr :: KeyRole) era. GenRS era (KeyHash kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier hs-var">genKeyHash</span></a></span><span>
</span><span id="line-788"></span><span>      </span><span id="local-6989586621682719297"><span class="annot"><span class="annottext">requireAllOf :: Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621682719297"><span class="hs-identifier hs-var hs-var">requireAllOf</span></a></span></span><span> </span><span id="local-6989586621682719301"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719301"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-789"></span><span>        </span><span id="local-6989586621682719302"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719302"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#nonNegativeSingleDigitInt"><span class="hs-identifier hs-var">nonNegativeSingleDigitInt</span></a></span><span>
</span><span id="line-790"></span><span>        </span><span class="annot"><span class="annottext">StrictSeq (NativeScript era) -&gt; NativeScript era
StrictSeq (MultiSig era) -&gt; MultiSig era
forall era.
ShelleyEraScript era =&gt;
StrictSeq (NativeScript era) -&gt; NativeScript era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireAllOf"><span class="hs-identifier hs-var">RequireAllOf</span></a></span><span> </span><span class="annot"><span class="annottext">(StrictSeq (MultiSig era) -&gt; MultiSig era)
-&gt; ([MultiSig era] -&gt; StrictSeq (MultiSig era))
-&gt; [MultiSig era]
-&gt; MultiSig era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[MultiSig era] -&gt; StrictSeq (MultiSig era)
forall a. [a] -&gt; StrictSeq a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html#fromList"><span class="hs-identifier hs-var">Seq.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([MultiSig era] -&gt; MultiSig era)
-&gt; RWST (GenEnv era) () (GenState era) Gen [MultiSig era]
-&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
-&gt; RWST (GenEnv era) () (GenState era) Gen [MultiSig era]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719302"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621682719294"><span class="hs-identifier hs-var">genNestedMultiSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719301"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-791"></span><span>      </span><span id="local-6989586621682719298"><span class="annot"><span class="annottext">requireAnyOf :: Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621682719298"><span class="hs-identifier hs-var hs-var">requireAnyOf</span></a></span></span><span> </span><span id="local-6989586621682719303"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719303"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-792"></span><span>        </span><span id="local-6989586621682719304"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719304"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#positiveSingleDigitInt"><span class="hs-identifier hs-var">positiveSingleDigitInt</span></a></span><span>
</span><span id="line-793"></span><span>        </span><span class="annot"><span class="annottext">StrictSeq (NativeScript era) -&gt; NativeScript era
StrictSeq (MultiSig era) -&gt; MultiSig era
forall era.
ShelleyEraScript era =&gt;
StrictSeq (NativeScript era) -&gt; NativeScript era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireAnyOf"><span class="hs-identifier hs-var">RequireAnyOf</span></a></span><span> </span><span class="annot"><span class="annottext">(StrictSeq (MultiSig era) -&gt; MultiSig era)
-&gt; ([MultiSig era] -&gt; StrictSeq (MultiSig era))
-&gt; [MultiSig era]
-&gt; MultiSig era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[MultiSig era] -&gt; StrictSeq (MultiSig era)
forall a. [a] -&gt; StrictSeq a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html#fromList"><span class="hs-identifier hs-var">Seq.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([MultiSig era] -&gt; MultiSig era)
-&gt; RWST (GenEnv era) () (GenState era) Gen [MultiSig era]
-&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
-&gt; RWST (GenEnv era) () (GenState era) Gen [MultiSig era]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719304"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621682719294"><span class="hs-identifier hs-var">genNestedMultiSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719303"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>      </span><span id="local-6989586621682719299"><span class="annot"><span class="annottext">requireMOf :: Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621682719299"><span class="hs-identifier hs-var hs-var">requireMOf</span></a></span></span><span> </span><span id="local-6989586621682719305"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719305"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-795"></span><span>        </span><span id="local-6989586621682719306"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719306"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#nonNegativeSingleDigitInt"><span class="hs-identifier hs-var">nonNegativeSingleDigitInt</span></a></span><span>
</span><span id="line-796"></span><span>        </span><span id="local-6989586621682719307"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719307"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int)
-&gt; Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719306"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-797"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; StrictSeq (NativeScript era) -&gt; NativeScript era
forall era.
ShelleyEraScript era =&gt;
Int -&gt; StrictSeq (NativeScript era) -&gt; NativeScript era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireMOf"><span class="hs-identifier hs-var">RequireMOf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719307"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(StrictSeq (MultiSig era) -&gt; MultiSig era)
-&gt; ([MultiSig era] -&gt; StrictSeq (MultiSig era))
-&gt; [MultiSig era]
-&gt; MultiSig era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[MultiSig era] -&gt; StrictSeq (MultiSig era)
forall a. [a] -&gt; StrictSeq a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html#fromList"><span class="hs-identifier hs-var">Seq.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([MultiSig era] -&gt; MultiSig era)
-&gt; RWST (GenEnv era) () (GenState era) Gen [MultiSig era]
-&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
-&gt; RWST (GenEnv era) () (GenState era) Gen [MultiSig era]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719306"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621682719294"><span class="hs-identifier hs-var">genNestedMultiSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719305"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-798"></span><span>  </span><span id="local-6989586621682719308"><span class="annot"><span class="annottext">MultiSig era
</span><a href="#local-6989586621682719308"><span class="hs-identifier hs-var">msscript</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
</span><a href="#local-6989586621682719294"><span class="hs-identifier hs-var">genNestedMultiSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">)</span><span>
</span><span id="line-799"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682719309"><span class="annot"><span class="annottext">corescript :: Script era
</span><a href="#local-6989586621682719309"><span class="hs-identifier hs-var hs-var">corescript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NativeScript era -&gt; Script era
forall era. EraScript era =&gt; NativeScript era -&gt; Script era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#fromNativeScript"><span class="hs-identifier hs-var">fromNativeScript</span></a></span><span> </span><span class="annot"><span class="annottext">NativeScript era
MultiSig era
</span><a href="#local-6989586621682719308"><span class="hs-identifier hs-var">msscript</span></a></span><span>
</span><span id="line-800"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682719310"><span class="annot"><span class="annottext">scriptHash :: ScriptHash
</span><a href="#local-6989586621682719310"><span class="hs-identifier hs-var hs-var">scriptHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. EraScript era =&gt; Script era -&gt; ScriptHash
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#hashScript"><span class="hs-identifier hs-var">hashScript</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682717424"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682719309"><span class="hs-identifier hs-var">corescript</span></a></span><span>
</span><span id="line-801"></span><span>  </span><span class="annot"><span class="annottext">(Map ScriptHash (Script era) -&gt; Map ScriptHash (Script era))
-&gt; GenRS era ()
forall era.
(Map ScriptHash (Script era) -&gt; Map ScriptHash (Script era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateScripts"><span class="hs-identifier hs-var">modifyGenStateScripts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash
-&gt; Script era
-&gt; Map ScriptHash (Script era)
-&gt; Map ScriptHash (Script era)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682719310"><span class="hs-identifier hs-var">scriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682719309"><span class="hs-identifier hs-var">corescript</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-802"></span><span>  </span><span class="annot"><span class="annottext">ScriptHash -&gt; GenRS era ScriptHash
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682719310"><span class="hs-identifier hs-var">scriptHash</span></a></span><span>
</span><span id="line-803"></span><span>
</span><span id="line-804"></span><span class="hs-comment">-- Adds to gsPlutusScripts</span><span>
</span><span id="line-805"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPlutusScript"><span class="hs-identifier hs-type">genPlutusScript</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-806"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682717421"><span class="annot"><a href="#local-6989586621682717421"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-807"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717421"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-808"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Plutus.Context.html#EraPlutusContext"><span class="hs-identifier hs-type">EraPlutusContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717421"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-809"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-810"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-811"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717421"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span>
</span><span id="line-812"></span><span id="genPlutusScript"><span class="annot"><span class="annottext">genPlutusScript :: forall era.
(Reflect era, EraPlutusContext era) =&gt;
PlutusPurposeTag -&gt; GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPlutusScript"><span class="hs-identifier hs-var hs-var">genPlutusScript</span></a></span></span><span> </span><span id="local-6989586621682719352"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682719352"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-813"></span><span>  </span><span id="local-6989586621682719353"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719353"><span class="hs-identifier hs-var">falseFreq</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; Int) -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall w (m :: * -&gt; *) r a s.
(Monoid w, Monad m) =&gt;
(r -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">((GenEnv era -&gt; Int)
 -&gt; RWST (GenEnv era) () (GenState era) Gen Int)
-&gt; (GenEnv era -&gt; Int)
-&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#invalidScriptFreq"><span class="hs-identifier hs-var">invalidScriptFreq</span></a></span><span> </span><span class="annot"><span class="annottext">(GenSize -&gt; Int) -&gt; (GenEnv era -&gt; GenSize) -&gt; GenEnv era -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; GenSize
forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span>
</span><span id="line-814"></span><span>  </span><span id="local-6989586621682719354"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682719354"><span class="hs-identifier hs-var">isValid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Bool -&gt; RWST (GenEnv era) () (GenState era) Gen Bool
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Bool -&gt; RWST (GenEnv era) () (GenState era) Gen Bool)
-&gt; Gen Bool -&gt; RWST (GenEnv era) () (GenState era) Gen Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Int, Gen Bool)] -&gt; Gen Bool
forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#frequency"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719353"><span class="hs-identifier hs-var">falseFreq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Gen Bool
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682719353"><span class="hs-identifier hs-var">falseFreq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Gen Bool
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-815"></span><span>  </span><span class="hs-comment">-- Plutus scripts alwaysSucceeds needs at least numArgs, while</span><span>
</span><span id="line-816"></span><span>  </span><span class="hs-comment">-- alwaysFails needs exactly numArgs to have the desired affect.</span><span>
</span><span id="line-817"></span><span>  </span><span class="hs-comment">-- For reasons unknown, this number differs from Alonzo to Babbage</span><span>
</span><span id="line-818"></span><span>  </span><span class="hs-comment">-- Perhaps because Babbage is using PlutusV2 scripts?</span><span>
</span><span id="line-819"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682719355"><span class="annot"><span class="annottext">numArgs :: Natural
</span><a href="#local-6989586621682719355"><span class="hs-identifier hs-var hs-var">numArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682717421"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682719352"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-820"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span>
</span><span id="line-821"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span>
</span><span id="line-822"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span>
</span><span id="line-823"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span>
</span><span id="line-824"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">3</span></span><span>
</span><span id="line-825"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span>
</span><span id="line-826"></span><span>  </span><span class="hs-comment">-- While using varying number of arguments for alwaysSucceeds we get</span><span>
</span><span id="line-827"></span><span>  </span><span class="hs-comment">-- varying script hashes, which helps with the fuzziness</span><span>
</span><span id="line-828"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682719364"><span class="annot"><span class="annottext">mlanguage :: Maybe Language
</span><a href="#local-6989586621682719364"><span class="hs-identifier hs-var hs-var">mlanguage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682717421"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-829"></span><span>        </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Language -&gt; Maybe Language
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Language
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Language.html#PlutusV2"><span class="hs-identifier hs-var">PlutusV2</span></a></span><span>
</span><span id="line-830"></span><span>        </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Language -&gt; Maybe Language
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Language
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Language.html#PlutusV2"><span class="hs-identifier hs-var">PlutusV2</span></a></span><span>
</span><span id="line-831"></span><span>        </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-var">Alonzo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Language -&gt; Maybe Language
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Language
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Language.html#PlutusV1"><span class="hs-identifier hs-var">PlutusV1</span></a></span><span>
</span><span id="line-832"></span><span>        </span><span class="annot"><span class="annottext">Proof era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Language
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-833"></span><span>  </span><span id="local-6989586621682719370"><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682719370"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-834"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682719354"><span class="hs-identifier hs-var">isValid</span></a></span><span>
</span><span id="line-835"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Language -&gt; Natural -&gt; Script era
forall era.
EraPlutusContext era =&gt;
Maybe Language -&gt; Natural -&gt; Script era
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#alwaysTrue"><span class="hs-identifier hs-var">alwaysTrue</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Language
</span><a href="#local-6989586621682719364"><span class="hs-identifier hs-var">mlanguage</span></a></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Script era)
-&gt; (Natural -&gt; Natural) -&gt; Natural -&gt; Script era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719355"><span class="hs-identifier hs-var">numArgs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Script era)
-&gt; RWST (GenEnv era) () (GenState era) Gen Natural
-&gt; RWST (GenEnv era) () (GenState era) Gen (Script era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Gen Natural -&gt; RWST (GenEnv era) () (GenState era) Gen Natural
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Natural] -&gt; Gen Natural
forall a. HasCallStack =&gt; [a] -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#elements"><span class="hs-identifier hs-var">elements</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-836"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Script era -&gt; RWST (GenEnv era) () (GenState era) Gen (Script era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Script era
 -&gt; RWST (GenEnv era) () (GenState era) Gen (Script era))
-&gt; Script era
-&gt; RWST (GenEnv era) () (GenState era) Gen (Script era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Language -&gt; Natural -&gt; Script era
forall era.
EraPlutusContext era =&gt;
Maybe Language -&gt; Natural -&gt; Script era
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#alwaysFalse"><span class="hs-identifier hs-var">alwaysFalse</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Language
</span><a href="#local-6989586621682719364"><span class="hs-identifier hs-var">mlanguage</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682719355"><span class="hs-identifier hs-var">numArgs</span></a></span><span>
</span><span id="line-837"></span><span>
</span><span id="line-838"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682719371"><span class="annot"><span class="annottext">scriptHash :: ScriptHash
</span><a href="#local-6989586621682719371"><span class="hs-identifier hs-var hs-var">scriptHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. EraScript era =&gt; Script era -&gt; ScriptHash
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#hashScript"><span class="hs-identifier hs-var">hashScript</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682717421"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682719370"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-839"></span><span>  </span><span class="annot"><span class="annottext">(Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
 -&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era))
-&gt; GenRS era ()
forall era.
(Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
 -&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyPlutusScripts"><span class="hs-identifier hs-var">modifyPlutusScripts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ScriptHash, PlutusPurposeTag)
-&gt; (IsValid, Script era)
-&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
-&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682719371"><span class="hs-identifier hs-var">scriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682719352"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; IsValid
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682719354"><span class="hs-identifier hs-var">isValid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682719370"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-840"></span><span>  </span><span class="annot"><span class="annottext">ScriptHash -&gt; GenRS era ScriptHash
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682719371"><span class="hs-identifier hs-var">scriptHash</span></a></span><span>
</span><span id="line-841"></span><span>
</span><span id="line-842"></span><span class="hs-comment">-- ======================================================================</span><span>
</span><span id="line-843"></span><span class="hs-comment">-- Generators of Transaction components</span><span>
</span><span id="line-844"></span><span class="hs-comment">-- =======================================================================</span><span>
</span><span id="line-845"></span><span>
</span><span id="line-846"></span><span class="hs-comment">-- | Generate a credential that can be used for supplied purpose (in case of</span><span>
</span><span id="line-847"></span><span class="hs-comment">-- plutus scripts), while occasionally picking out randomly from previously</span><span>
</span><span id="line-848"></span><span class="hs-comment">-- generated set. Returns the credential</span><span>
</span><span id="line-849"></span><span class="hs-comment">-- Adds to both gsKeys and gsScripts and gsPlutusScript</span><span>
</span><span id="line-850"></span><span class="hs-comment">-- via genKeyHash and genScript</span><span>
</span><span id="line-851"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genCredential"><span class="hs-identifier hs-type">genCredential</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-852"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682717482"><span class="annot"><a href="#local-6989586621682717482"><span class="hs-identifier hs-type">kr</span></a></span></span><span> </span><span id="local-6989586621682717481"><span class="annot"><a href="#local-6989586621682717481"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717481"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717481"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717482"><span class="hs-identifier hs-type">kr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-853"></span><span id="genCredential"><span class="annot"><span class="annottext">genCredential :: forall (kr :: KeyRole) era.
Reflect era =&gt;
PlutusPurposeTag -&gt; GenRS era (Credential kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genCredential"><span class="hs-identifier hs-var hs-var">genCredential</span></a></span></span><span> </span><span id="local-6989586621682719870"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682719870"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-854"></span><span>  </span><span class="annot"><span class="annottext">[(Int, RWST (GenEnv era) () (GenState era) Gen (Credential kr))]
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential kr)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span>
</span><span id="line-855"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">35</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeyHash kr -&gt; Credential kr
forall (kr :: KeyRole). KeyHash kr -&gt; Credential kr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#KeyHashObj"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">(KeyHash kr -&gt; Credential kr)
-&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash kr)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential kr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (KeyHash kr)
</span><a href="#local-6989586621682719871"><span class="hs-identifier hs-var">genKeyHash'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-856"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">35</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ScriptHash -&gt; Credential kr
forall (kr :: KeyRole). ScriptHash -&gt; Credential kr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#ScriptHashObj"><span class="hs-identifier hs-var">ScriptHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">(ScriptHash -&gt; Credential kr)
-&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential kr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen ScriptHash
</span><a href="#local-6989586621682719872"><span class="hs-identifier hs-var">genScript'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-857"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (Credential kr)
</span><a href="#local-6989586621682719873"><span class="hs-identifier hs-var">pickExistingKeyHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-858"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (Credential kr)
</span><a href="#local-6989586621682719874"><span class="hs-identifier hs-var">pickExistingScript</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-859"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-860"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-861"></span><span>    </span><span id="local-6989586621682721327"><span class="annot"><span class="annottext">genNewAccountState :: RWST (GenEnv era) () (GenState era) Gen (AccountState era)
</span><a href="#local-6989586621682721327"><span class="hs-identifier hs-var hs-var">genNewAccountState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-862"></span><span>      </span><span id="local-6989586621682721328"><span class="annot"><span class="annottext">Ptr
</span><a href="#local-6989586621682721328"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Ptr -&gt; RWST (GenEnv era) () (GenState era) Gen Ptr
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen Ptr
forall a. Arbitrary a =&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-863"></span><span>      </span><span id="local-6989586621682721329"><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621682721329"><span class="hs-identifier hs-var">deposit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (CompactForm Coin)
-&gt; RWST (GenEnv era) () (GenState era) Gen (CompactForm Coin)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen (CompactForm Coin)
forall a. Arbitrary a =&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-864"></span><span>      </span><span class="annot"><span class="annottext">AccountState era
-&gt; RWST (GenEnv era) () (GenState era) Gen (AccountState era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(AccountState era
 -&gt; RWST (GenEnv era) () (GenState era) Gen (AccountState era))
-&gt; AccountState era
-&gt; RWST (GenEnv era) () (GenState era) Gen (AccountState era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Ptr
-&gt; CompactForm Coin
-&gt; Maybe (KeyHash 'StakePool)
-&gt; Maybe DRep
-&gt; AccountState era
forall era.
(EraTest era, HasCallStack) =&gt;
Maybe Ptr
-&gt; CompactForm Coin
-&gt; Maybe (KeyHash 'StakePool)
-&gt; Maybe DRep
-&gt; AccountState era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Era.html#mkTestAccountState"><span class="hs-identifier hs-var">mkTestAccountState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr -&gt; Maybe Ptr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Ptr
</span><a href="#local-6989586621682721328"><span class="hs-identifier hs-var">ptr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621682721329"><span class="hs-identifier hs-var">deposit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (KeyHash 'StakePool)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe DRep
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-865"></span><span>    </span><span id="local-6989586621682719871"><span class="annot"><span class="annottext">genKeyHash' :: RWST (GenEnv era) () (GenState era) Gen (KeyHash kr)
</span><a href="#local-6989586621682719871"><span class="hs-identifier hs-var hs-var">genKeyHash'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-866"></span><span>      </span><span id="local-6989586621682721331"><span class="annot"><span class="annottext">KeyHash 'Staking
</span><a href="#local-6989586621682721331"><span class="hs-identifier hs-var">kh</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era (KeyHash 'Staking)
forall era (kr :: KeyRole). GenRS era (KeyHash kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshKeyHash"><span class="hs-identifier hs-var">genFreshKeyHash</span></a></span><span> </span><span class="hs-comment">-- We need to avoid some key credentials</span><span>
</span><span id="line-867"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682719870"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-868"></span><span>        </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-869"></span><span>          </span><span id="local-6989586621682721332"><span class="annot"><span class="annottext">AccountState era
</span><a href="#local-6989586621682721332"><span class="hs-identifier hs-var">accountState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (AccountState era)
</span><a href="#local-6989586621682721327"><span class="hs-identifier hs-var">genNewAccountState</span></a></span><span>
</span><span id="line-870"></span><span>          </span><span class="annot"><span class="annottext">(Map (Credential 'Staking) (AccountState era)
 -&gt; Map (Credential 'Staking) (AccountState era))
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall era.
(Map (Credential 'Staking) (AccountState era)
 -&gt; Map (Credential 'Staking) (AccountState era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialAccounts"><span class="hs-identifier hs-var">modifyGenStateInitialAccounts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential 'Staking
-&gt; AccountState era
-&gt; Map (Credential 'Staking) (AccountState era)
-&gt; Map (Credential 'Staking) (AccountState era)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'Staking -&gt; Credential 'Staking
forall (kr :: KeyRole). KeyHash kr -&gt; Credential kr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#KeyHashObj"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Staking
</span><a href="#local-6989586621682721331"><span class="hs-identifier hs-var">kh</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AccountState era
</span><a href="#local-6989586621682721332"><span class="hs-identifier hs-var">accountState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-871"></span><span>        </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-872"></span><span>      </span><span class="annot"><span class="annottext">KeyHash kr -&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash kr)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(KeyHash kr
 -&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash kr))
-&gt; KeyHash kr
-&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash kr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Staking -&gt; KeyHash kr
forall (r :: KeyRole) (r' :: KeyRole). KeyHash r -&gt; KeyHash r'
forall (a :: KeyRole -&gt; *) (r :: KeyRole) (r' :: KeyRole).
HasKeyRole a =&gt;
a r -&gt; a r'
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#coerceKeyRole"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Staking
</span><a href="#local-6989586621682721331"><span class="hs-identifier hs-var">kh</span></a></span><span>
</span><span id="line-873"></span><span>    </span><span id="local-6989586621682719872"><span class="annot"><span class="annottext">genScript' :: RWST (GenEnv era) () (GenState era) Gen ScriptHash
</span><a href="#local-6989586621682719872"><span class="hs-identifier hs-var hs-var">genScript'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash
</span><a href="#local-6989586621682721333"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-874"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-875"></span><span>        </span><span id="local-6989586621682721333"><span class="annot"><span class="annottext">f :: Int -&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash
</span><a href="#local-6989586621682721333"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682721334"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682721334"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-876"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682721334"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Failed to generate a fresh script hash&quot;</span></span><span>
</span><span id="line-877"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-878"></span><span>              </span><span id="local-6989586621682721335"><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682721335"><span class="hs-identifier hs-var">sh</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; PlutusPurposeTag -&gt; GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier hs-var">genScript</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682717481"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682719870"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-879"></span><span>              </span><span id="local-6989586621682721336"><span class="annot"><span class="annottext">Map (Credential 'Staking) (AccountState era)
</span><a href="#local-6989586621682721336"><span class="hs-identifier hs-var">initialRewards</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Map (Credential 'Staking) (AccountState era))
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map (Credential 'Staking) (AccountState era))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Map (Credential 'Staking) (AccountState era)
forall era.
GenState era -&gt; Map (Credential 'Staking) (AccountState era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialAccounts"><span class="hs-identifier hs-var">gsInitialAccounts</span></a></span><span>
</span><span id="line-880"></span><span>              </span><span id="local-6989586621682721337"><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682721337"><span class="hs-identifier hs-var">avoidCredentials</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Set (Credential 'Staking))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Set (Credential 'Staking))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Set (Credential 'Staking)
forall era. GenState era -&gt; Set (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidCred"><span class="hs-identifier hs-var">gsAvoidCred</span></a></span><span>
</span><span id="line-881"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682721338"><span class="annot"><span class="annottext">newcred :: Credential 'Staking
</span><a href="#local-6989586621682721338"><span class="hs-identifier hs-var hs-var">newcred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScriptHash -&gt; Credential 'Staking
forall (kr :: KeyRole). ScriptHash -&gt; Credential kr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#ScriptHashObj"><span class="hs-identifier hs-var">ScriptHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682721335"><span class="hs-identifier hs-var">sh</span></a></span><span>
</span><span id="line-882"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
-&gt; Map (Credential 'Staking) (AccountState era) -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.notMember</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682721338"><span class="hs-identifier hs-var">newcred</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) (AccountState era)
</span><a href="#local-6989586621682721336"><span class="hs-identifier hs-var">initialRewards</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Set (Credential 'Staking) -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.notMember</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682721338"><span class="hs-identifier hs-var">newcred</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682721337"><span class="hs-identifier hs-var">avoidCredentials</span></a></span><span>
</span><span id="line-883"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-884"></span><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682719870"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-885"></span><span>                    </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-886"></span><span>                      </span><span id="local-6989586621682721342"><span class="annot"><span class="annottext">AccountState era
</span><a href="#local-6989586621682721342"><span class="hs-identifier hs-var">accountState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (AccountState era)
</span><a href="#local-6989586621682721327"><span class="hs-identifier hs-var">genNewAccountState</span></a></span><span>
</span><span id="line-887"></span><span>                      </span><span class="annot"><span class="annottext">(Map (Credential 'Staking) (AccountState era)
 -&gt; Map (Credential 'Staking) (AccountState era))
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall era.
(Map (Credential 'Staking) (AccountState era)
 -&gt; Map (Credential 'Staking) (AccountState era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialAccounts"><span class="hs-identifier hs-var">modifyGenStateInitialAccounts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential 'Staking
-&gt; AccountState era
-&gt; Map (Credential 'Staking) (AccountState era)
-&gt; Map (Credential 'Staking) (AccountState era)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682721338"><span class="hs-identifier hs-var">newcred</span></a></span><span> </span><span class="annot"><span class="annottext">AccountState era
</span><a href="#local-6989586621682721342"><span class="hs-identifier hs-var">accountState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-888"></span><span>                    </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-889"></span><span>                  </span><span class="annot"><span class="annottext">ScriptHash -&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682721335"><span class="hs-identifier hs-var">sh</span></a></span><span>
</span><span id="line-890"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash
</span><a href="#local-6989586621682721333"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash)
-&gt; Int -&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682721334"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-891"></span><span>    </span><span id="local-6989586621682719873"><span class="annot"><span class="annottext">pickExistingKeyHash :: RWST (GenEnv era) () (GenState era) Gen (Credential kr)
</span><a href="#local-6989586621682719873"><span class="hs-identifier hs-var hs-var">pickExistingKeyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-892"></span><span>      </span><span class="annot"><span class="annottext">KeyHash kr -&gt; Credential kr
forall (kr :: KeyRole). KeyHash kr -&gt; Credential kr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#KeyHashObj"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">(KeyHash kr -&gt; Credential kr)
-&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash kr)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential kr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-893"></span><span>        </span><span id="local-6989586621682721343"><span class="annot"><span class="annottext">Map (KeyHash 'Witness) (KeyPair 'Witness)
</span><a href="#local-6989586621682721343"><span class="hs-identifier hs-var">keysMap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Map (KeyHash 'Witness) (KeyPair 'Witness)
forall era.
GenState era -&gt; Map (KeyHash 'Witness) (KeyPair 'Witness)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsKeys"><span class="hs-identifier hs-var">gsKeys</span></a></span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Map (KeyHash 'Witness) (KeyPair 'Witness))
-&gt; RWST (GenEnv era) () (GenState era) Gen (GenState era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map (KeyHash 'Witness) (KeyPair 'Witness))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (GenState era)
forall w (m :: * -&gt; *) r s. (Monoid w, Monad m) =&gt; RWST r w s m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-894"></span><span>        </span><span class="annot"><span class="annottext">Gen (Maybe (KeyHash 'Witness, KeyPair 'Witness))
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Maybe (KeyHash 'Witness, KeyPair 'Witness))
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (KeyHash 'Witness) (KeyPair 'Witness)
-&gt; Gen (Maybe (KeyHash 'Witness, KeyPair 'Witness))
forall k a. Map k a -&gt; Gen (Maybe (k, a))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElem"><span class="hs-identifier hs-var">genMapElem</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'Witness) (KeyPair 'Witness)
</span><a href="#local-6989586621682721343"><span class="hs-identifier hs-var">keysMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RWST
  (GenEnv era)
  ()
  (GenState era)
  Gen
  (Maybe (KeyHash 'Witness, KeyPair 'Witness))
-&gt; (Maybe (KeyHash 'Witness, KeyPair 'Witness)
    -&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash kr))
-&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash kr)
forall a b.
RWST (GenEnv era) () (GenState era) Gen a
-&gt; (a -&gt; RWST (GenEnv era) () (GenState era) Gen b)
-&gt; RWST (GenEnv era) () (GenState era) Gen b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-895"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682721344"><span class="annot"><span class="annottext">KeyHash 'Witness
</span><a href="#local-6989586621682721344"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeyPair 'Witness
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KeyHash kr -&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash kr)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(KeyHash kr
 -&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash kr))
-&gt; KeyHash kr
-&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash kr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Witness -&gt; KeyHash kr
forall (r :: KeyRole) (r' :: KeyRole). KeyHash r -&gt; KeyHash r'
forall (a :: KeyRole -&gt; *) (r :: KeyRole) (r' :: KeyRole).
HasKeyRole a =&gt;
a r -&gt; a r'
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#coerceKeyRole"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Witness
</span><a href="#local-6989586621682721344"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-896"></span><span>          </span><span class="annot"><span class="annottext">Maybe (KeyHash 'Witness, KeyPair 'Witness)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (KeyHash kr)
</span><a href="#local-6989586621682719871"><span class="hs-identifier hs-var">genKeyHash'</span></a></span><span>
</span><span id="line-897"></span><span>    </span><span id="local-6989586621682719874"><span class="annot"><span class="annottext">pickExistingScript :: RWST (GenEnv era) () (GenState era) Gen (Credential kr)
</span><a href="#local-6989586621682719874"><span class="hs-identifier hs-var hs-var">pickExistingScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-898"></span><span>      </span><span class="annot"><span class="annottext">ScriptHash -&gt; Credential kr
forall (kr :: KeyRole). ScriptHash -&gt; Credential kr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#ScriptHashObj"><span class="hs-identifier hs-var">ScriptHashObj</span></a></span><span>
</span><span id="line-899"></span><span>        </span><span class="annot"><span class="annottext">(ScriptHash -&gt; Credential kr)
-&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential kr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen ScriptHash]
-&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen ScriptHash
</span><a href="#local-6989586621682721345"><span class="hs-identifier hs-var">pickExistingPlutusScript</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen ScriptHash
</span><a href="#local-6989586621682721346"><span class="hs-identifier hs-var">pickExistingTimelockScript</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-900"></span><span>    </span><span id="local-6989586621682721345"><span class="annot"><span class="annottext">pickExistingPlutusScript :: RWST (GenEnv era) () (GenState era) Gen ScriptHash
</span><a href="#local-6989586621682721345"><span class="hs-identifier hs-var hs-var">pickExistingPlutusScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-901"></span><span>      </span><span id="local-6989586621682721347"><span class="annot"><span class="annottext">Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
</span><a href="#local-6989586621682721347"><span class="hs-identifier hs-var">plutusScriptsMap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-902"></span><span>        </span><span class="annot"><span class="annottext">((ScriptHash, PlutusPurposeTag) -&gt; (IsValid, Script era) -&gt; Bool)
-&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
-&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
forall k a. (k -&gt; a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filterWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682721349"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682721349"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IsValid, Script era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682721349"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag -&gt; PlutusPurposeTag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682719870"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
 -&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era))
-&gt; (GenState era
    -&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era))
-&gt; GenState era
-&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era
-&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
forall era.
GenState era
-&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsPlutusScripts"><span class="hs-identifier hs-var">gsPlutusScripts</span></a></span><span> </span><span class="annot"><span class="annottext">(GenState era
 -&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era))
-&gt; RWST (GenEnv era) () (GenState era) Gen (GenState era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (GenState era)
forall w (m :: * -&gt; *) r s. (Monoid w, Monad m) =&gt; RWST r w s m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-903"></span><span>      </span><span class="annot"><span class="annottext">Gen (Maybe ((ScriptHash, PlutusPurposeTag), (IsValid, Script era)))
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Maybe ((ScriptHash, PlutusPurposeTag), (IsValid, Script era)))
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
-&gt; Gen
     (Maybe ((ScriptHash, PlutusPurposeTag), (IsValid, Script era)))
forall k a. Map k a -&gt; Gen (Maybe (k, a))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElem"><span class="hs-identifier hs-var">genMapElem</span></a></span><span> </span><span class="annot"><span class="annottext">Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
</span><a href="#local-6989586621682721347"><span class="hs-identifier hs-var">plutusScriptsMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RWST
  (GenEnv era)
  ()
  (GenState era)
  Gen
  (Maybe ((ScriptHash, PlutusPurposeTag), (IsValid, Script era)))
-&gt; (Maybe ((ScriptHash, PlutusPurposeTag), (IsValid, Script era))
    -&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash)
-&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash
forall a b.
RWST (GenEnv era) () (GenState era) Gen a
-&gt; (a -&gt; RWST (GenEnv era) () (GenState era) Gen b)
-&gt; RWST (GenEnv era) () (GenState era) Gen b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-904"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682721350"><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682721350"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(IsValid, Script era)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ScriptHash -&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682721350"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-905"></span><span>        </span><span class="annot"><span class="annottext">Maybe ((ScriptHash, PlutusPurposeTag), (IsValid, Script era))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
-&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash
forall era. Reflect era =&gt; PlutusPurposeTag -&gt; GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier hs-var">genScript</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682719870"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-906"></span><span>    </span><span id="local-6989586621682721346"><span class="annot"><span class="annottext">pickExistingTimelockScript :: RWST (GenEnv era) () (GenState era) Gen ScriptHash
</span><a href="#local-6989586621682721346"><span class="hs-identifier hs-var hs-var">pickExistingTimelockScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-907"></span><span>      </span><span class="hs-comment">-- Only pick one if it matches the</span><span>
</span><span id="line-908"></span><span>      </span><span id="local-6989586621682721351"><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621682721351"><span class="hs-identifier hs-var">vi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; ValidityInterval)
-&gt; RWST (GenEnv era) () (GenState era) Gen ValidityInterval
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; ValidityInterval
forall era. GenState era -&gt; ValidityInterval
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsValidityInterval"><span class="hs-identifier hs-var">gsValidityInterval</span></a></span><span> </span><span class="hs-comment">-- current ValidityInterval</span><span>
</span><span id="line-909"></span><span>      </span><span id="local-6989586621682721352"><span class="annot"><span class="annottext">Map ValidityInterval (Set ScriptHash)
</span><a href="#local-6989586621682721352"><span class="hs-identifier hs-var">vimap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Map ValidityInterval (Set ScriptHash))
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map ValidityInterval (Set ScriptHash))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Map ValidityInterval (Set ScriptHash)
forall era. GenState era -&gt; Map ValidityInterval (Set ScriptHash)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsVI"><span class="hs-identifier hs-var">gsVI</span></a></span><span>
</span><span id="line-910"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ValidityInterval
-&gt; Map ValidityInterval (Set ScriptHash) -&gt; Maybe (Set ScriptHash)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621682721351"><span class="hs-identifier hs-var">vi</span></a></span><span> </span><span class="annot"><span class="annottext">Map ValidityInterval (Set ScriptHash)
</span><a href="#local-6989586621682721352"><span class="hs-identifier hs-var">vimap</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-911"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Set ScriptHash)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; PlutusPurposeTag -&gt; GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier hs-var">genScript</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682717481"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682719870"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-912"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682721354"><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682721354"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-913"></span><span>          </span><span class="annot"><span class="annottext">Gen (Maybe ScriptHash)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Maybe ScriptHash)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set ScriptHash -&gt; Gen (Maybe ScriptHash)
forall a. Set a -&gt; Gen (Maybe a)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genSetElem"><span class="hs-identifier hs-var">genSetElem</span></a></span><span> </span><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682721354"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (Maybe ScriptHash)
-&gt; (Maybe ScriptHash
    -&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash)
-&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash
forall a b.
RWST (GenEnv era) () (GenState era) Gen a
-&gt; (a -&gt; RWST (GenEnv era) () (GenState era) Gen b)
-&gt; RWST (GenEnv era) () (GenState era) Gen b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-914"></span><span>            </span><span class="annot"><span class="annottext">Maybe ScriptHash
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
-&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash
forall era. Reflect era =&gt; PlutusPurposeTag -&gt; GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier hs-var">genScript</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682719870"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-915"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682721355"><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682721355"><span class="hs-identifier hs-var">hash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ScriptHash -&gt; RWST (GenEnv era) () (GenState era) Gen ScriptHash
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682721355"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-916"></span><span>
</span><span id="line-917"></span><span class="hs-comment">-- Return a fresh credential, one that is not a member of the set 'old'.</span><span>
</span><span id="line-918"></span><span class="hs-comment">-- One gets 'tries' chances to generate a fresh one, before an error is raised.</span><span>
</span><span id="line-919"></span><span class="hs-comment">-- This avoids silent infinite loops.</span><span>
</span><span id="line-920"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredential"><span class="hs-identifier hs-type">genFreshCredential</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-921"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682717563"><span class="annot"><a href="#local-6989586621682717563"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621682717564"><span class="annot"><a href="#local-6989586621682717564"><span class="hs-identifier hs-type">kr</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-922"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717563"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-923"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-924"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-925"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717564"><span class="hs-identifier hs-type">kr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-926"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717563"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717564"><span class="hs-identifier hs-type">kr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-927"></span><span id="genFreshCredential"><span class="annot"><span class="annottext">genFreshCredential :: forall era (kr :: KeyRole).
Reflect era =&gt;
Int
-&gt; PlutusPurposeTag
-&gt; Set (Credential kr)
-&gt; GenRS era (Credential kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredential"><span class="hs-identifier hs-var hs-var">genFreshCredential</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621682721368"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682721368"><span class="hs-identifier hs-var">_tag</span></a></span></span><span> </span><span id="local-6989586621682721369"><span class="annot"><span class="annottext">Set (Credential kr)
</span><a href="#local-6989586621682721369"><span class="hs-identifier hs-var">_old</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; GenRS era (Credential kr)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Ran out of tries in genFreshCredential.&quot;</span></span><span>
</span><span id="line-928"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredential"><span class="hs-identifier hs-var">genFreshCredential</span></a></span><span> </span><span id="local-6989586621682721370"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682721370"><span class="hs-identifier hs-var">tries0</span></a></span></span><span> </span><span id="local-6989586621682721371"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682721371"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621682721372"><span class="annot"><span class="annottext">Set (Credential kr)
</span><a href="#local-6989586621682721372"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; GenRS era (Credential kr)
</span><a href="#local-6989586621682721373"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682721370"><span class="hs-identifier hs-var">tries0</span></a></span><span>
</span><span id="line-929"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-930"></span><span>    </span><span id="local-6989586621682721373"><span class="annot"><span class="annottext">go :: Int -&gt; GenRS era (Credential kr)
</span><a href="#local-6989586621682721373"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682721374"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682721374"><span class="hs-identifier hs-var">tries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-931"></span><span>      </span><span id="local-6989586621682721375"><span class="annot"><span class="annottext">Credential kr
</span><a href="#local-6989586621682721375"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag -&gt; GenRS era (Credential kr)
forall (kr :: KeyRole) era.
Reflect era =&gt;
PlutusPurposeTag -&gt; GenRS era (Credential kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genCredential"><span class="hs-identifier hs-var">genCredential</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682721371"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-932"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Credential kr -&gt; Set (Credential kr) -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">Credential kr
</span><a href="#local-6989586621682721375"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential kr)
</span><a href="#local-6989586621682721372"><span class="hs-identifier hs-var">old</span></a></span><span>
</span><span id="line-933"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; GenRS era (Credential kr)
</span><a href="#local-6989586621682721373"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682721374"><span class="hs-identifier hs-var">tries</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-934"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Credential kr -&gt; GenRS era (Credential kr)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Credential kr
</span><a href="#local-6989586621682721375"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-935"></span><span>
</span><span id="line-936"></span><span id="local-6989586621682717567"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshRegCred"><span class="hs-identifier hs-type">genFreshRegCred</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-937"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717567"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717567"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-938"></span><span id="genFreshRegCred"><span class="annot"><span class="annottext">genFreshRegCred :: forall era.
Reflect era =&gt;
PlutusPurposeTag -&gt; GenRS era (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshRegCred"><span class="hs-identifier hs-var hs-var">genFreshRegCred</span></a></span></span><span> </span><span id="local-6989586621682721400"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682721400"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-939"></span><span>  </span><span id="local-6989586621682721401"><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682721401"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Set (Credential 'Staking))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Set (Credential 'Staking))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Credential 'Staking) (AccountState era)
-&gt; Set (Credential 'Staking)
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">(Map (Credential 'Staking) (AccountState era)
 -&gt; Set (Credential 'Staking))
-&gt; (GenState era -&gt; Map (Credential 'Staking) (AccountState era))
-&gt; GenState era
-&gt; Set (Credential 'Staking)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Map (Credential 'Staking) (AccountState era)
forall era.
GenState era -&gt; Map (Credential 'Staking) (AccountState era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialAccounts"><span class="hs-identifier hs-var">gsInitialAccounts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-940"></span><span>  </span><span id="local-6989586621682721403"><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682721403"><span class="hs-identifier hs-var">avoid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Set (Credential 'Staking))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Set (Credential 'Staking))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Set (Credential 'Staking)
forall era. GenState era -&gt; Set (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidCred"><span class="hs-identifier hs-var">gsAvoidCred</span></a></span><span>
</span><span id="line-941"></span><span>  </span><span id="local-6989586621682721404"><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682721404"><span class="hs-identifier hs-var">rewards</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Set (Credential 'Staking))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Set (Credential 'Staking))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((GenState era -&gt; Set (Credential 'Staking))
 -&gt; RWST
      (GenEnv era) () (GenState era) Gen (Set (Credential 'Staking)))
-&gt; (GenState era -&gt; Set (Credential 'Staking))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Set (Credential 'Staking))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) (AccountState era)
-&gt; Set (Credential 'Staking)
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">(Map (Credential 'Staking) (AccountState era)
 -&gt; Set (Credential 'Staking))
-&gt; (GenState era -&gt; Map (Credential 'Staking) (AccountState era))
-&gt; GenState era
-&gt; Set (Credential 'Staking)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Accounts era
-&gt; Getting
     (Map (Credential 'Staking) (AccountState era))
     (Accounts era)
     (Map (Credential 'Staking) (AccountState era))
-&gt; Map (Credential 'Staking) (AccountState era)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map (Credential 'Staking) (AccountState era))
  (Accounts era)
  (Map (Credential 'Staking) (AccountState era))
forall era.
EraAccounts era =&gt;
Lens' (Accounts era) (Map (Credential 'Staking) (AccountState era))
Lens' (Accounts era) (Map (Credential 'Staking) (AccountState era))
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#accountsMapL"><span class="hs-identifier hs-var">accountsMapL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Accounts era -&gt; Map (Credential 'Staking) (AccountState era))
-&gt; (GenState era -&gt; Accounts era)
-&gt; GenState era
-&gt; Map (Credential 'Staking) (AccountState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; Accounts era
forall era. ModelNewEpochState era -&gt; Accounts era
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mAccounts"><span class="hs-identifier hs-var">mAccounts</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; Accounts era)
-&gt; (GenState era -&gt; ModelNewEpochState era)
-&gt; GenState era
-&gt; Accounts era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; ModelNewEpochState era
forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span>
</span><span id="line-942"></span><span>  </span><span id="local-6989586621682721406"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682721406"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; PlutusPurposeTag
-&gt; Set (Credential 'Staking)
-&gt; GenRS era (Credential 'Staking)
forall era (kr :: KeyRole).
Reflect era =&gt;
Int
-&gt; PlutusPurposeTag
-&gt; Set (Credential kr)
-&gt; GenRS era (Credential kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredential"><span class="hs-identifier hs-var">genFreshCredential</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682721400"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">(Set (Credential 'Staking) -&gt; GenRS era (Credential 'Staking))
-&gt; Set (Credential 'Staking) -&gt; GenRS era (Credential 'Staking)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682721401"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking)
-&gt; Set (Credential 'Staking) -&gt; Set (Credential 'Staking)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682721403"><span class="hs-identifier hs-var">avoid</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking)
-&gt; Set (Credential 'Staking) -&gt; Set (Credential 'Staking)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682721404"><span class="hs-identifier hs-var">rewards</span></a></span><span>
</span><span id="line-943"></span><span>  </span><span class="annot"><span class="annottext">(Set (Credential 'Staking) -&gt; Set (Credential 'Staking))
-&gt; GenRS era ()
forall era.
(Set (Credential 'Staking) -&gt; Set (Credential 'Staking))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateAvoidCred"><span class="hs-identifier hs-var">modifyGenStateAvoidCred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential 'Staking
-&gt; Set (Credential 'Staking) -&gt; Set (Credential 'Staking)
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682721406"><span class="hs-identifier hs-var">cred</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-944"></span><span>  </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; GenRS era (Credential 'Staking)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682721406"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-945"></span><span>
</span><span id="line-946"></span><span id="local-6989586621682717573"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPoolParams"><span class="hs-identifier hs-type">genPoolParams</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-947"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717573"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-948"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-949"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717573"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#PoolParams"><span class="hs-identifier hs-type">PoolParams</span></a></span></span><span>
</span><span id="line-950"></span><span id="genPoolParams"><span class="annot"><span class="annottext">genPoolParams :: forall era.
Reflect era =&gt;
KeyHash 'StakePool -&gt; GenRS era PoolParams
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPoolParams"><span class="hs-identifier hs-var hs-var">genPoolParams</span></a></span></span><span> </span><span id="local-6989586621682721432"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682721432"><span class="hs-identifier hs-var">ppId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-951"></span><span>  </span><span id="local-6989586621682721433"><span class="annot"><span class="annottext">VRFVerKeyHash 'StakePoolVRF
</span><a href="#local-6989586621682721433"><span class="hs-identifier hs-var">ppVrf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (VRFVerKeyHash 'StakePoolVRF)
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (VRFVerKeyHash 'StakePoolVRF)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen (VRFVerKeyHash 'StakePoolVRF)
forall a. Arbitrary a =&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-952"></span><span>  </span><span id="local-6989586621682721434"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682721434"><span class="hs-identifier hs-var">ppPledge</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Coin -&gt; RWST (GenEnv era) () (GenState era) Gen Coin
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen Coin
forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier hs-var">genPositiveVal</span></a></span><span>
</span><span id="line-953"></span><span>  </span><span id="local-6989586621682721435"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682721435"><span class="hs-identifier hs-var">ppCost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Coin -&gt; RWST (GenEnv era) () (GenState era) Gen Coin
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen Coin
forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier hs-var">genPositiveVal</span></a></span><span>
</span><span id="line-954"></span><span>  </span><span id="local-6989586621682721436"><span class="annot"><span class="annottext">UnitInterval
</span><a href="#local-6989586621682721436"><span class="hs-identifier hs-var">ppMargin</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen UnitInterval
-&gt; RWST (GenEnv era) () (GenState era) Gen UnitInterval
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen UnitInterval
forall a. Arbitrary a =&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-955"></span><span>  </span><span id="local-6989586621682721437"><span class="annot"><span class="annottext">RewardAccount
</span><a href="#local-6989586621682721437"><span class="hs-identifier hs-var">ppRewardAccount</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Network -&gt; Credential 'Staking -&gt; RewardAccount
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#RewardAccount"><span class="hs-identifier hs-var">RewardAccount</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#Testnet"><span class="hs-identifier hs-var">Testnet</span></a></span><span> </span><span class="annot"><span class="annottext">(Credential 'Staking -&gt; RewardAccount)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential 'Staking)
-&gt; RWST (GenEnv era) () (GenState era) Gen RewardAccount
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential 'Staking)
forall era.
Reflect era =&gt;
PlutusPurposeTag -&gt; GenRS era (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshRegCred"><span class="hs-identifier hs-var">genFreshRegCred</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span>
</span><span id="line-956"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682721443"><span class="annot"><span class="annottext">ppOwners :: Set (KeyHash 'Staking)
</span><a href="#local-6989586621682721443"><span class="hs-identifier hs-var hs-var">ppOwners</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'Staking)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-957"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682721448"><span class="annot"><span class="annottext">ppRelays :: StrictSeq StakePoolRelay
</span><a href="#local-6989586621682721448"><span class="hs-identifier hs-var hs-var">ppRelays</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictSeq StakePoolRelay
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-958"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682721449"><span class="annot"><span class="annottext">ppMetadata :: StrictMaybe a
</span><a href="#local-6989586621682721449"><span class="hs-identifier hs-var hs-var">ppMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictMaybe a
forall a. StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-959"></span><span>  </span><span class="annot"><span class="annottext">PoolParams -&gt; GenRS era PoolParams
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#PoolParams"><span class="hs-identifier hs-type">PoolParams</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Set (KeyHash 'Staking)
StrictMaybe PoolMetadata
KeyHash 'StakePool
VRFVerKeyHash 'StakePoolVRF
RewardAccount
Coin
StrictSeq StakePoolRelay
UnitInterval
forall a. StrictMaybe a
ppId :: KeyHash 'StakePool
ppVrf :: VRFVerKeyHash 'StakePoolVRF
ppPledge :: Coin
ppCost :: Coin
ppMargin :: UnitInterval
ppRewardAccount :: RewardAccount
ppOwners :: Set (KeyHash 'Staking)
ppRelays :: StrictSeq StakePoolRelay
ppMetadata :: forall a. StrictMaybe a
ppId :: KeyHash 'StakePool
ppVrf :: VRFVerKeyHash 'StakePoolVRF
ppPledge :: Coin
ppCost :: Coin
ppMargin :: UnitInterval
ppRewardAccount :: RewardAccount
ppOwners :: Set (KeyHash 'Staking)
ppRelays :: StrictSeq StakePoolRelay
ppMetadata :: StrictMaybe PoolMetadata
</span><a href="#local-6989586621682721432"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-960"></span><span>
</span><span id="line-961"></span><span class="hs-comment">-- | Generate a 'n' fresh credentials (ones not in the set 'old'). We get 'tries' chances,</span><span>
</span><span id="line-962"></span><span class="hs-comment">--   if it doesn't work in 'tries' attempts then quit with an error. Better to raise an error</span><span>
</span><span id="line-963"></span><span class="hs-comment">--   than go into an infinite loop.</span><span>
</span><span id="line-964"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredentials"><span class="hs-identifier hs-type">genFreshCredentials</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-965"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682717586"><span class="annot"><a href="#local-6989586621682717586"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621682717587"><span class="annot"><a href="#local-6989586621682717587"><span class="hs-identifier hs-type">kr</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-966"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717586"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-967"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-968"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-969"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-970"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717587"><span class="hs-identifier hs-type">kr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-971"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717587"><span class="hs-identifier hs-type">kr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-972"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717586"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717587"><span class="hs-identifier hs-type">kr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-973"></span><span id="genFreshCredentials"><span class="annot"><span class="annottext">genFreshCredentials :: forall era (kr :: KeyRole).
Reflect era =&gt;
Int
-&gt; Int
-&gt; PlutusPurposeTag
-&gt; Set (Credential kr)
-&gt; [Credential kr]
-&gt; GenRS era [Credential kr]
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredentials"><span class="hs-identifier hs-var hs-var">genFreshCredentials</span></a></span></span><span> </span><span id="local-6989586621682721475"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682721475"><span class="hs-identifier hs-var">_n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621682721476"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682721476"><span class="hs-identifier hs-var">_tag</span></a></span></span><span> </span><span id="local-6989586621682721477"><span class="annot"><span class="annottext">Set (Credential kr)
</span><a href="#local-6989586621682721477"><span class="hs-identifier hs-var">_old</span></a></span></span><span> </span><span id="local-6989586621682721478"><span class="annot"><span class="annottext">[Credential kr]
</span><a href="#local-6989586621682721478"><span class="hs-identifier hs-var">_ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; GenRS era [Credential kr]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Ran out of tries in genFreshCredentials.&quot;</span></span><span>
</span><span id="line-974"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredentials"><span class="hs-identifier hs-var">genFreshCredentials</span></a></span><span> </span><span id="local-6989586621682721479"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682721479"><span class="hs-identifier hs-var">n0</span></a></span></span><span> </span><span id="local-6989586621682721480"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682721480"><span class="hs-identifier hs-var">tries</span></a></span></span><span> </span><span id="local-6989586621682721481"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682721481"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621682721482"><span class="annot"><span class="annottext">Set (Credential kr)
</span><a href="#local-6989586621682721482"><span class="hs-identifier hs-var">old0</span></a></span></span><span> </span><span id="local-6989586621682721483"><span class="annot"><span class="annottext">[Credential kr]
</span><a href="#local-6989586621682721483"><span class="hs-identifier hs-var">ans0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Set (Credential kr)
-&gt; [Credential kr]
-&gt; GenRS era [Credential kr]
</span><a href="#local-6989586621682721484"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682721479"><span class="hs-identifier hs-var">n0</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential kr)
</span><a href="#local-6989586621682721482"><span class="hs-identifier hs-var">old0</span></a></span><span> </span><span class="annot"><span class="annottext">[Credential kr]
</span><a href="#local-6989586621682721483"><span class="hs-identifier hs-var">ans0</span></a></span><span>
</span><span id="line-975"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-976"></span><span>    </span><span id="local-6989586621682721484"><span class="annot"><span class="annottext">go :: Int
-&gt; Set (Credential kr)
-&gt; [Credential kr]
-&gt; GenRS era [Credential kr]
</span><a href="#local-6989586621682721484"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential kr)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682721485"><span class="annot"><span class="annottext">[Credential kr]
</span><a href="#local-6989586621682721485"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Credential kr] -&gt; GenRS era [Credential kr]
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Credential kr]
</span><a href="#local-6989586621682721485"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-977"></span><span>    </span><span class="annot"><a href="#local-6989586621682721484"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621682721486"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682721486"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682721487"><span class="annot"><span class="annottext">Set (Credential kr)
</span><a href="#local-6989586621682721487"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621682721488"><span class="annot"><span class="annottext">[Credential kr]
</span><a href="#local-6989586621682721488"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-978"></span><span>      </span><span id="local-6989586621682721489"><span class="annot"><span class="annottext">Credential kr
</span><a href="#local-6989586621682721489"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; PlutusPurposeTag
-&gt; Set (Credential kr)
-&gt; GenRS era (Credential kr)
forall era (kr :: KeyRole).
Reflect era =&gt;
Int
-&gt; PlutusPurposeTag
-&gt; Set (Credential kr)
-&gt; GenRS era (Credential kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredential"><span class="hs-identifier hs-var">genFreshCredential</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682721480"><span class="hs-identifier hs-var">tries</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682721481"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential kr)
</span><a href="#local-6989586621682721487"><span class="hs-identifier hs-var">old</span></a></span><span>
</span><span id="line-979"></span><span>      </span><span class="annot"><span class="annottext">Int
-&gt; Set (Credential kr)
-&gt; [Credential kr]
-&gt; GenRS era [Credential kr]
</span><a href="#local-6989586621682721484"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682721486"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential kr -&gt; Set (Credential kr) -&gt; Set (Credential kr)
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">Credential kr
</span><a href="#local-6989586621682721489"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential kr)
</span><a href="#local-6989586621682721487"><span class="hs-identifier hs-var">old</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential kr
</span><a href="#local-6989586621682721489"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Credential kr -&gt; [Credential kr] -&gt; [Credential kr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Credential kr]
</span><a href="#local-6989586621682721488"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-980"></span><span>
</span><span id="line-981"></span><span class="annot"><span class="hs-comment">-- | Use this function to get a new pool that should not be used in the future transactions</span></span><span>
</span><span id="line-982"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genNewPool"><span class="hs-identifier hs-type">genNewPool</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-983"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682717590"><span class="annot"><a href="#local-6989586621682717590"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-984"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717590"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-985"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span>
</span><span id="line-986"></span><span>    </span><span class="annot"><a href="#local-6989586621682717590"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-987"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span>
</span><span id="line-988"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#PoolParams"><span class="hs-identifier hs-type">PoolParams</span></a></span><span>
</span><span id="line-989"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#IndividualPoolStake"><span class="hs-identifier hs-type">IndividualPoolStake</span></a></span><span>
</span><span id="line-990"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-991"></span><span id="genNewPool"><span class="annot"><span class="annottext">genNewPool :: forall era.
Reflect era =&gt;
GenRS era (KeyHash 'StakePool, PoolParams, IndividualPoolStake)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genNewPool"><span class="hs-identifier hs-var hs-var">genNewPool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-992"></span><span>  </span><span id="local-6989586621682721510"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682721510"><span class="hs-identifier hs-var">poolId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era (KeyHash 'StakePool)
forall era (kr :: KeyRole). GenRS era (KeyHash kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshKeyHash"><span class="hs-identifier hs-var">genFreshKeyHash</span></a></span><span>
</span><span id="line-993"></span><span>  </span><span id="local-6989586621682721511"><span class="annot"><span class="annottext">PoolParams
</span><a href="#local-6989586621682721511"><span class="hs-identifier hs-var">poolParam</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; GenRS era PoolParams
forall era.
Reflect era =&gt;
KeyHash 'StakePool -&gt; GenRS era PoolParams
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPoolParams"><span class="hs-identifier hs-var">genPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682721510"><span class="hs-identifier hs-var">poolId</span></a></span><span>
</span><span id="line-994"></span><span>  </span><span id="local-6989586621682721512"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682721512"><span class="hs-identifier hs-var">percent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Float -&gt; RWST (GenEnv era) () (GenState era) Gen Float
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Float -&gt; RWST (GenEnv era) () (GenState era) Gen Float)
-&gt; Gen Float -&gt; RWST (GenEnv era) () (GenState era) Gen Float
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Float, Float) -&gt; Gen Float
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">)</span><span>
</span><span id="line-995"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682721513"><span class="annot"><span class="annottext">stake :: IndividualPoolStake
</span><a href="#local-6989586621682721513"><span class="hs-identifier hs-var hs-var">stake</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational
-&gt; CompactForm Coin
-&gt; VRFVerKeyHash 'StakePoolVRF
-&gt; IndividualPoolStake
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#IndividualPoolStake"><span class="hs-identifier hs-var">IndividualPoolStake</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682721512"><span class="hs-identifier hs-var">percent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PoolParams -&gt; VRFVerKeyHash 'StakePoolVRF
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#ppVrf"><span class="hs-identifier hs-var">ppVrf</span></a></span><span> </span><span class="annot"><span class="annottext">PoolParams
</span><a href="#local-6989586621682721511"><span class="hs-identifier hs-var">poolParam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-996"></span><span>  </span><span class="annot"><span class="annottext">(Set (KeyHash 'StakePool) -&gt; Set (KeyHash 'StakePool))
-&gt; GenRS era ()
forall era.
(Set (KeyHash 'StakePool) -&gt; Set (KeyHash 'StakePool))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateAvoidKey"><span class="hs-identifier hs-var">modifyGenStateAvoidKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; Set (KeyHash 'StakePool) -&gt; Set (KeyHash 'StakePool)
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; KeyHash 'StakePool
forall (r :: KeyRole) (r' :: KeyRole). KeyHash r -&gt; KeyHash r'
forall (a :: KeyRole -&gt; *) (r :: KeyRole) (r' :: KeyRole).
HasKeyRole a =&gt;
a r -&gt; a r'
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#coerceKeyRole"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682721510"><span class="hs-identifier hs-var">poolId</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-997"></span><span>  </span><span class="annot"><span class="annottext">(KeyHash 'StakePool, PoolParams, IndividualPoolStake)
-&gt; GenRS era (KeyHash 'StakePool, PoolParams, IndividualPoolStake)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682721510"><span class="hs-identifier hs-var">poolId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PoolParams
</span><a href="#local-6989586621682721511"><span class="hs-identifier hs-var">poolParam</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake
</span><a href="#local-6989586621682721513"><span class="hs-identifier hs-var">stake</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-998"></span><span>
</span><span id="line-999"></span><span class="hs-comment">-- | Initialize (or overwrite if they are not empty) the Stable fields. It is</span><span>
</span><span id="line-1000"></span><span class="hs-comment">--   intended that this be called just once at the beginning of a trace generation.</span><span>
</span><span id="line-1001"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier hs-type">initStableFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682717593"><span class="annot"><a href="#local-6989586621682717593"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717593"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717593"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1002"></span><span id="initStableFields"><span class="annot"><span class="annottext">initStableFields :: forall era. Reflect era =&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier hs-var hs-var">initStableFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1003"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621682721569"><span class="annot"><span class="annottext">GenSize
geSize :: forall era. GenEnv era -&gt; GenSize
geSize :: GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var hs-var">geSize</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (GenEnv era)
forall w (m :: * -&gt; *) r s. (Monoid w, Monad m) =&gt; RWST r w s m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-1004"></span><span>  </span><span id="local-6989586621682721570"><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621682721570"><span class="hs-identifier hs-var">hashes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash 'StakePool)
-&gt; RWST (GenEnv era) () (GenState era) Gen [KeyHash 'StakePool]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#maxStablePools"><span class="hs-identifier hs-var">maxStablePools</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682721569"><span class="hs-identifier hs-var">geSize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RWST (GenEnv era) () (GenState era) Gen (KeyHash 'StakePool)
 -&gt; RWST (GenEnv era) () (GenState era) Gen [KeyHash 'StakePool])
-&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash 'StakePool)
-&gt; RWST (GenEnv era) () (GenState era) Gen [KeyHash 'StakePool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1005"></span><span>    </span><span id="local-6989586621682721571"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682721571"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; PParams era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (PParams era)
forall w (m :: * -&gt; *) r a s.
(Monoid w, Monad m) =&gt;
(r -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; PParams era
forall era. GenEnv era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var">gePParams</span></a></span><span>
</span><span id="line-1006"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682721572"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682721572"><span class="hs-identifier hs-var">kh</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682721573"><span class="annot"><span class="annottext">PoolParams
</span><a href="#local-6989586621682721573"><span class="hs-identifier hs-var">poolParams</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682721574"><span class="annot"><span class="annottext">IndividualPoolStake
</span><a href="#local-6989586621682721574"><span class="hs-identifier hs-var">ips</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era (KeyHash 'StakePool, PoolParams, IndividualPoolStake)
forall era.
Reflect era =&gt;
GenRS era (KeyHash 'StakePool, PoolParams, IndividualPoolStake)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genNewPool"><span class="hs-identifier hs-var">genNewPool</span></a></span><span>
</span><span id="line-1007"></span><span>    </span><span class="annot"><span class="annottext">(Set (KeyHash 'StakePool) -&gt; Set (KeyHash 'StakePool))
-&gt; GenRS era ()
forall era.
(Set (KeyHash 'StakePool) -&gt; Set (KeyHash 'StakePool))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateStablePools"><span class="hs-identifier hs-var">modifyGenStateStablePools</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; Set (KeyHash 'StakePool) -&gt; Set (KeyHash 'StakePool)
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682721572"><span class="hs-identifier hs-var">kh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1008"></span><span>    </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) PoolParams
 -&gt; Map (KeyHash 'StakePool) PoolParams)
-&gt; GenRS era ()
forall era.
(Map (KeyHash 'StakePool) PoolParams
 -&gt; Map (KeyHash 'StakePool) PoolParams)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolParams"><span class="hs-identifier hs-var">modifyGenStateInitialPoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; PoolParams
-&gt; Map (KeyHash 'StakePool) PoolParams
-&gt; Map (KeyHash 'StakePool) PoolParams
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682721572"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">PoolParams
</span><a href="#local-6989586621682721573"><span class="hs-identifier hs-var">poolParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1009"></span><span>    </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) IndividualPoolStake
 -&gt; Map (KeyHash 'StakePool) IndividualPoolStake)
-&gt; GenRS era ()
forall era.
(Map (KeyHash 'StakePool) IndividualPoolStake
 -&gt; Map (KeyHash 'StakePool) IndividualPoolStake)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolDistr"><span class="hs-identifier hs-var">modifyGenStateInitialPoolDistr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; IndividualPoolStake
-&gt; Map (KeyHash 'StakePool) IndividualPoolStake
-&gt; Map (KeyHash 'StakePool) IndividualPoolStake
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682721572"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake
</span><a href="#local-6989586621682721574"><span class="hs-identifier hs-var">ips</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1010"></span><span>    </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) StakePoolState
 -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; GenRS era ()
forall era.
(Map (KeyHash 'StakePool) StakePoolState
 -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelStakePools"><span class="hs-identifier hs-var">modifyModelStakePools</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682721572"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">(StakePoolState
 -&gt; Map (KeyHash 'StakePool) StakePoolState
 -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin -&gt; PoolParams -&gt; StakePoolState
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#mkStakePoolState"><span class="hs-identifier hs-var">mkStakePoolState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682721571"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
-&gt; Getting (CompactForm Coin) (PParams era) (CompactForm Coin)
-&gt; CompactForm Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (CompactForm Coin) (PParams era) (CompactForm Coin)
forall era.
EraPParams era =&gt;
Lens' (PParams era) (CompactForm Coin)
Lens' (PParams era) (CompactForm Coin)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#ppPoolDepositCompactL"><span class="hs-identifier hs-var">ppPoolDepositCompactL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PoolParams
</span><a href="#local-6989586621682721573"><span class="hs-identifier hs-var">poolParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1011"></span><span>    </span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash 'StakePool)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682721572"><span class="hs-identifier hs-var">kh</span></a></span><span>
</span><span id="line-1012"></span><span>
</span><span id="line-1013"></span><span>  </span><span class="hs-comment">-- This incantation gets a list of fresh (not previously generated) Credential</span><span>
</span><span id="line-1014"></span><span>  </span><span id="local-6989586621682721575"><span class="annot"><span class="annottext">[Credential 'Staking]
</span><a href="#local-6989586621682721575"><span class="hs-identifier hs-var">credentials</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential 'Staking)
-&gt; RWST (GenEnv era) () (GenState era) Gen [Credential 'Staking]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#maxStablePools"><span class="hs-identifier hs-var">maxStablePools</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682721569"><span class="hs-identifier hs-var">geSize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RWST (GenEnv era) () (GenState era) Gen (Credential 'Staking)
 -&gt; RWST (GenEnv era) () (GenState era) Gen [Credential 'Staking])
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential 'Staking)
-&gt; RWST (GenEnv era) () (GenState era) Gen [Credential 'Staking]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1015"></span><span>    </span><span id="local-6989586621682721576"><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682721576"><span class="hs-identifier hs-var">old'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Set (Credential 'Staking))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Set (Credential 'Staking))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Credential 'Staking) (AccountState era)
-&gt; Set (Credential 'Staking)
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">(Map (Credential 'Staking) (AccountState era)
 -&gt; Set (Credential 'Staking))
-&gt; (GenState era -&gt; Map (Credential 'Staking) (AccountState era))
-&gt; GenState era
-&gt; Set (Credential 'Staking)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Map (Credential 'Staking) (AccountState era)
forall era.
GenState era -&gt; Map (Credential 'Staking) (AccountState era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialAccounts"><span class="hs-identifier hs-var">gsInitialAccounts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1016"></span><span>    </span><span id="local-6989586621682721577"><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682721577"><span class="hs-identifier hs-var">prev</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Set (Credential 'Staking))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Set (Credential 'Staking))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Set (Credential 'Staking)
forall era. GenState era -&gt; Set (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidCred"><span class="hs-identifier hs-var">gsAvoidCred</span></a></span><span>
</span><span id="line-1017"></span><span>    </span><span id="local-6989586621682721578"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682721578"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; PlutusPurposeTag
-&gt; Set (Credential 'Staking)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential 'Staking)
forall era (kr :: KeyRole).
Reflect era =&gt;
Int
-&gt; PlutusPurposeTag
-&gt; Set (Credential kr)
-&gt; GenRS era (Credential kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredential"><span class="hs-identifier hs-var">genFreshCredential</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (Credential 'Staking)
-&gt; Set (Credential 'Staking) -&gt; Set (Credential 'Staking)
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682721576"><span class="hs-identifier hs-var">old'</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682721577"><span class="hs-identifier hs-var">prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1018"></span><span>    </span><span class="annot"><span class="annottext">Credential 'Staking
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential 'Staking)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682721578"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-1019"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682723265"><span class="annot"><span class="annottext">registerNewAccount' :: Credential 'Staking -&gt; KeyHash 'StakePool -&gt; GenRS era ()
</span><a href="#local-6989586621682723265"><span class="hs-identifier hs-var hs-var">registerNewAccount'</span></a></span></span><span> </span><span id="local-6989586621682723266"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682723266"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span id="local-6989586621682723267"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682723267"><span class="hs-identifier hs-var">poolId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1020"></span><span>        </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Maybe (KeyHash 'StakePool) -&gt; GenRS era ()
forall era.
EraTest era =&gt;
Credential 'Staking -&gt; Maybe (KeyHash 'StakePool) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#registerNewAccount"><span class="hs-identifier hs-var">registerNewAccount</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682723266"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; Maybe (KeyHash 'StakePool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682723267"><span class="hs-identifier hs-var">poolId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1021"></span><span>  </span><span class="annot"><span class="annottext">(Credential 'Staking -&gt; KeyHash 'StakePool -&gt; GenRS era ())
-&gt; [Credential 'Staking] -&gt; [KeyHash 'StakePool] -&gt; GenRS era ()
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m ()
</span><span class="hs-identifier hs-var">zipWithM_</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; KeyHash 'StakePool -&gt; GenRS era ()
forall {era}.
(Assert
   (OrdCond
      (CmpNat (ProtVerLow era) (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 0 (ProtVerLow era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 0 (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 EraTest era) =&gt;
Credential 'Staking -&gt; KeyHash 'StakePool -&gt; GenRS era ()
</span><a href="#local-6989586621682723265"><span class="hs-identifier hs-var">registerNewAccount'</span></a></span><span> </span><span class="annot"><span class="annottext">[Credential 'Staking]
</span><a href="#local-6989586621682721575"><span class="hs-identifier hs-var">credentials</span></a></span><span> </span><span class="annot"><span class="annottext">[KeyHash 'StakePool]
</span><a href="#local-6989586621682721570"><span class="hs-identifier hs-var">hashes</span></a></span><span>
</span><span id="line-1022"></span><span>  </span><span class="annot"><span class="annottext">(Set (Credential 'Staking) -&gt; Set (Credential 'Staking))
-&gt; GenRS era ()
forall era.
(Set (Credential 'Staking) -&gt; Set (Credential 'Staking))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateStableDelegators"><span class="hs-identifier hs-var">modifyGenStateStableDelegators</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (Credential 'Staking)
-&gt; Set (Credential 'Staking) -&gt; Set (Credential 'Staking)
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Credential 'Staking] -&gt; Set (Credential 'Staking)
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Credential 'Staking]
</span><a href="#local-6989586621682721575"><span class="hs-identifier hs-var">credentials</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1023"></span><span>
</span><span id="line-1024"></span><span id="local-6989586621682717601"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#registerNewAccount"><span class="hs-identifier hs-type">registerNewAccount</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1025"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Era.html#EraTest"><span class="hs-identifier hs-type">EraTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717601"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717601"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-1026"></span><span id="registerNewAccount"><span class="annot"><span class="annottext">registerNewAccount :: forall era.
EraTest era =&gt;
Credential 'Staking -&gt; Maybe (KeyHash 'StakePool) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#registerNewAccount"><span class="hs-identifier hs-var hs-var">registerNewAccount</span></a></span></span><span> </span><span id="local-6989586621682723299"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682723299"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span id="local-6989586621682723300"><span class="annot"><span class="annottext">Maybe (KeyHash 'StakePool)
</span><a href="#local-6989586621682723300"><span class="hs-identifier hs-var">mPoolId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1027"></span><span>  </span><span id="local-6989586621682723301"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682723301"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; PParams era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (PParams era)
forall w (m :: * -&gt; *) r a s.
(Monoid w, Monad m) =&gt;
(r -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; PParams era
forall era. GenEnv era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var">gePParams</span></a></span><span>
</span><span id="line-1028"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682723302"><span class="annot"><span class="annottext">deposit :: Coin
</span><a href="#local-6989586621682723302"><span class="hs-identifier hs-var hs-var">deposit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682723301"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; Getting Coin (PParams era) Coin -&gt; Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Coin (PParams era) Coin
forall era. EraPParams era =&gt; Lens' (PParams era) Coin
Lens' (PParams era) Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#ppKeyDepositL"><span class="hs-identifier hs-var">ppKeyDepositL</span></a></span><span>
</span><span id="line-1029"></span><span>  </span><span id="local-6989586621682723304"><span class="annot"><span class="annottext">Ptr
</span><a href="#local-6989586621682723304"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Ptr -&gt; RWST (GenEnv era) () (GenState era) Gen Ptr
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen Ptr
forall a. Arbitrary a =&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-1030"></span><span>  </span><span class="annot"><span class="annottext">(Accounts era -&gt; Accounts era) -&gt; GenRS era ()
forall era. (Accounts era -&gt; Accounts era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelAccounts"><span class="hs-identifier hs-var">modifyModelAccounts</span></a></span><span> </span><span class="annot"><span class="annottext">((Accounts era -&gt; Accounts era) -&gt; GenRS era ())
-&gt; (Accounts era -&gt; Accounts era) -&gt; GenRS era ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1031"></span><span>    </span><span class="annot"><span class="annottext">Credential 'Staking
-&gt; Maybe Ptr
-&gt; CompactForm Coin
-&gt; Maybe (KeyHash 'StakePool)
-&gt; Maybe DRep
-&gt; Accounts era
-&gt; Accounts era
forall era.
(HasCallStack, EraTest era) =&gt;
Credential 'Staking
-&gt; Maybe Ptr
-&gt; CompactForm Coin
-&gt; Maybe (KeyHash 'StakePool)
-&gt; Maybe DRep
-&gt; Accounts era
-&gt; Accounts era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Era.html#registerTestAccount"><span class="hs-identifier hs-var">registerTestAccount</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682723299"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr -&gt; Maybe Ptr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Ptr
</span><a href="#local-6989586621682723304"><span class="hs-identifier hs-var">ptr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; Coin -&gt; CompactForm Coin
Coin -&gt; CompactForm Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#compactCoinOrError"><span class="hs-identifier hs-var">compactCoinOrError</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682723302"><span class="hs-identifier hs-var">deposit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (KeyHash 'StakePool)
</span><a href="#local-6989586621682723300"><span class="hs-identifier hs-var">mPoolId</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DRep
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1032"></span><span>  </span><span id="local-6989586621682723306"><span class="annot"><span class="annottext">AccountState era
</span><a href="#local-6989586621682723306"><span class="hs-identifier hs-var">accountState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (AccountState era) -&gt; AccountState era
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (AccountState era) -&gt; AccountState era)
-&gt; (GenState era -&gt; Maybe (AccountState era))
-&gt; GenState era
-&gt; AccountState era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Accounts era -&gt; Maybe (AccountState era)
forall era.
EraAccounts era =&gt;
Credential 'Staking -&gt; Accounts era -&gt; Maybe (AccountState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#lookupAccountState"><span class="hs-identifier hs-var">lookupAccountState</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682723299"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="annot"><span class="annottext">(Accounts era -&gt; Maybe (AccountState era))
-&gt; (GenState era -&gt; Accounts era)
-&gt; GenState era
-&gt; Maybe (AccountState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; Accounts era
forall era. ModelNewEpochState era -&gt; Accounts era
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mAccounts"><span class="hs-identifier hs-var">mAccounts</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; Accounts era)
-&gt; (GenState era -&gt; ModelNewEpochState era)
-&gt; GenState era
-&gt; Accounts era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; ModelNewEpochState era
forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; AccountState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (AccountState era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (GenState era)
forall w (m :: * -&gt; *) r s. (Monoid w, Monad m) =&gt; RWST r w s m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1033"></span><span>  </span><span class="annot"><span class="annottext">(Coin -&gt; Coin) -&gt; GenRS era ()
forall era. (Coin -&gt; Coin) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelDeposited"><span class="hs-identifier hs-var">modifyModelDeposited</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682723302"><span class="hs-identifier hs-var">deposit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1034"></span><span>  </span><span class="annot"><span class="annottext">(Map (Credential 'Staking) (AccountState era)
 -&gt; Map (Credential 'Staking) (AccountState era))
-&gt; GenRS era ()
forall era.
(Map (Credential 'Staking) (AccountState era)
 -&gt; Map (Credential 'Staking) (AccountState era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialAccounts"><span class="hs-identifier hs-var">modifyGenStateInitialAccounts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential 'Staking
-&gt; AccountState era
-&gt; Map (Credential 'Staking) (AccountState era)
-&gt; Map (Credential 'Staking) (AccountState era)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682723299"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="annot"><span class="annottext">AccountState era
</span><a href="#local-6989586621682723306"><span class="hs-identifier hs-var">accountState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1035"></span><span>
</span><span id="line-1036"></span><span class="hs-comment">-- =============================================</span><span>
</span><span id="line-1037"></span><span class="hs-comment">-- Generators of inter-related items</span><span>
</span><span id="line-1038"></span><span>
</span><span id="line-1039"></span><span class="hs-comment">-- Adds to the rewards of the ModelNewEpochState. This used exclusively to generate Withdrawals, so</span><span>
</span><span id="line-1040"></span><span class="hs-comment">-- we mark these as ones to avoid in the future. Especialy when generating DeRegKey.</span><span>
</span><span id="line-1041"></span><span id="local-6989586621682717612"><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewards"><span class="hs-identifier hs-type">genRewards</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717612"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717612"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1042"></span><span id="genRewards"><span class="annot"><span class="annottext">genRewards :: forall era.
Reflect era =&gt;
GenRS era (Map (Credential 'Staking) Coin)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewards"><span class="hs-identifier hs-var hs-var">genRewards</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1043"></span><span>  </span><span id="local-6989586621682723353"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682723353"><span class="hs-identifier hs-var">wmax</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Int)
-&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#withdrawalMax"><span class="hs-identifier hs-var">withdrawalMax</span></a></span><span> </span><span class="annot"><span class="annottext">(GenSize -&gt; Int)
-&gt; (GenState era -&gt; GenSize) -&gt; GenState era -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; GenSize
forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; GenSize)
-&gt; (GenState era -&gt; GenEnv era) -&gt; GenState era -&gt; GenSize
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; GenEnv era
forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1044"></span><span>  </span><span id="local-6989586621682723354"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682723354"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int)
-&gt; Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682723353"><span class="hs-identifier hs-var">wmax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1045"></span><span>  </span><span class="hs-comment">-- we need a fresh credential, one that was not previously</span><span>
</span><span id="line-1046"></span><span>  </span><span class="hs-comment">-- generated here, or one that arose from gsAvoidCred (i.e. prev)</span><span>
</span><span id="line-1047"></span><span>  </span><span id="local-6989586621682723355"><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682723355"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Set (Credential 'Staking))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Set (Credential 'Staking))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Credential 'Staking) (AccountState era)
-&gt; Set (Credential 'Staking)
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">(Map (Credential 'Staking) (AccountState era)
 -&gt; Set (Credential 'Staking))
-&gt; (GenState era -&gt; Map (Credential 'Staking) (AccountState era))
-&gt; GenState era
-&gt; Set (Credential 'Staking)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Map (Credential 'Staking) (AccountState era)
forall era.
GenState era -&gt; Map (Credential 'Staking) (AccountState era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialAccounts"><span class="hs-identifier hs-var">gsInitialAccounts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1048"></span><span>  </span><span id="local-6989586621682723356"><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682723356"><span class="hs-identifier hs-var">prev</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Set (Credential 'Staking))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Set (Credential 'Staking))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Set (Credential 'Staking)
forall era. GenState era -&gt; Set (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidCred"><span class="hs-identifier hs-var">gsAvoidCred</span></a></span><span>
</span><span id="line-1049"></span><span>  </span><span id="local-6989586621682723357"><span class="annot"><span class="annottext">[Credential 'Staking]
</span><a href="#local-6989586621682723357"><span class="hs-identifier hs-var">credentials</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; PlutusPurposeTag
-&gt; Set (Credential 'Staking)
-&gt; [Credential 'Staking]
-&gt; GenRS era [Credential 'Staking]
forall era (kr :: KeyRole).
Reflect era =&gt;
Int
-&gt; Int
-&gt; PlutusPurposeTag
-&gt; Set (Credential kr)
-&gt; [Credential kr]
-&gt; GenRS era [Credential kr]
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshCredentials"><span class="hs-identifier hs-var">genFreshCredentials</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682723354"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (Credential 'Staking)
-&gt; Set (Credential 'Staking) -&gt; Set (Credential 'Staking)
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682723355"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682723356"><span class="hs-identifier hs-var">prev</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1050"></span><span>  </span><span id="local-6989586621682723358"><span class="annot"><span class="annottext">[(Credential 'Staking, Coin)]
</span><a href="#local-6989586621682723358"><span class="hs-identifier hs-var">balances</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Credential 'Staking]
-&gt; (Credential 'Staking
    -&gt; RWST
         (GenEnv era) () (GenState era) Gen (Credential 'Staking, Coin))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen [(Credential 'Staking, Coin)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">[Credential 'Staking]
</span><a href="#local-6989586621682723357"><span class="hs-identifier hs-var">credentials</span></a></span><span> </span><span class="annot"><span class="annottext">((Credential 'Staking
  -&gt; RWST
       (GenEnv era) () (GenState era) Gen (Credential 'Staking, Coin))
 -&gt; RWST
      (GenEnv era) () (GenState era) Gen [(Credential 'Staking, Coin)])
-&gt; (Credential 'Staking
    -&gt; RWST
         (GenEnv era) () (GenState era) Gen (Credential 'Staking, Coin))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen [(Credential 'Staking, Coin)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682723359"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682723359"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1051"></span><span>    </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Maybe (KeyHash 'StakePool) -&gt; GenRS era ()
forall era.
EraTest era =&gt;
Credential 'Staking -&gt; Maybe (KeyHash 'StakePool) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#registerNewAccount"><span class="hs-identifier hs-var">registerNewAccount</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682723359"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (KeyHash 'StakePool)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1052"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682723359"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; (Credential 'Staking, Coin))
-&gt; RWST (GenEnv era) () (GenState era) Gen Coin
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Credential 'Staking, Coin)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Gen Coin -&gt; RWST (GenEnv era) () (GenState era) Gen Coin
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen Coin
forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewardVal"><span class="hs-identifier hs-var">genRewardVal</span></a></span><span>
</span><span id="line-1053"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682723360"><span class="annot"><span class="annottext">balanceMap :: Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682723360"><span class="hs-identifier hs-var hs-var">balanceMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Credential 'Staking, Coin)] -&gt; Map (Credential 'Staking) Coin
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">[(Credential 'Staking, Coin)]
</span><a href="#local-6989586621682723358"><span class="hs-identifier hs-var">balances</span></a></span><span>
</span><span id="line-1054"></span><span>      </span><span id="local-6989586621682723362"><span class="annot"><span class="annottext">compactBalanceMap :: Map (Credential 'Staking) (CompactForm Coin)
</span><a href="#local-6989586621682723362"><span class="hs-identifier hs-var hs-var">compactBalanceMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; CompactForm Coin)
-&gt; Map (Credential 'Staking) Coin
-&gt; Map (Credential 'Staking) (CompactForm Coin)
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Coin -&gt; CompactForm Coin
Coin -&gt; CompactForm Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#compactCoinOrError"><span class="hs-identifier hs-var">compactCoinOrError</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682723360"><span class="hs-identifier hs-var">balanceMap</span></a></span><span>
</span><span id="line-1055"></span><span>      </span><span id="local-6989586621682723364"><span class="annot"><span class="annottext">replaceBalances :: Map (Credential 'Staking) (AccountState era)
-&gt; Map (Credential 'Staking) (AccountState era)
</span><a href="#local-6989586621682723364"><span class="hs-identifier hs-var hs-var">replaceBalances</span></a></span></span><span> </span><span id="local-6989586621682723365"><span class="annot"><span class="annottext">Map (Credential 'Staking) (AccountState era)
</span><a href="#local-6989586621682723365"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1056"></span><span>        </span><span class="annot"><span class="annottext">(Credential 'Staking
 -&gt; CompactForm Coin
 -&gt; Map (Credential 'Staking) (AccountState era)
 -&gt; Map (Credential 'Staking) (AccountState era))
-&gt; Map (Credential 'Staking) (AccountState era)
-&gt; Map (Credential 'Staking) (CompactForm Coin)
-&gt; Map (Credential 'Staking) (AccountState era)
forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><span class="hs-identifier hs-var">Map.foldrWithKey'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682723367"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682723367"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span id="local-6989586621682723368"><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621682723368"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(AccountState era -&gt; AccountState era)
-&gt; Credential 'Staking
-&gt; Map (Credential 'Staking) (AccountState era)
-&gt; Map (Credential 'Staking) (AccountState era)
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.adjust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CompactForm Coin -&gt; Identity (CompactForm Coin))
-&gt; AccountState era -&gt; Identity (AccountState era)
forall era.
EraAccounts era =&gt;
Lens' (AccountState era) (CompactForm Coin)
Lens' (AccountState era) (CompactForm Coin)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#balanceAccountStateL"><span class="hs-identifier hs-var">balanceAccountStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CompactForm Coin -&gt; Identity (CompactForm Coin))
 -&gt; AccountState era -&gt; Identity (AccountState era))
-&gt; CompactForm Coin -&gt; AccountState era -&gt; AccountState era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621682723368"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682723367"><span class="hs-identifier hs-var">cred</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) (AccountState era)
</span><a href="#local-6989586621682723365"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) (CompactForm Coin)
</span><a href="#local-6989586621682723362"><span class="hs-identifier hs-var">compactBalanceMap</span></a></span><span>
</span><span id="line-1057"></span><span>  </span><span class="annot"><span class="annottext">(Accounts era -&gt; Accounts era) -&gt; GenRS era ()
forall era. (Accounts era -&gt; Accounts era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelAccounts"><span class="hs-identifier hs-var">modifyModelAccounts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Credential 'Staking) (CompactForm Coin)
-&gt; Accounts era -&gt; Accounts era
forall era.
EraAccounts era =&gt;
Map (Credential 'Staking) (CompactForm Coin)
-&gt; Accounts era -&gt; Accounts era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#addToBalanceAccounts"><span class="hs-identifier hs-var">addToBalanceAccounts</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) (CompactForm Coin)
</span><a href="#local-6989586621682723362"><span class="hs-identifier hs-var">compactBalanceMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1058"></span><span>  </span><span class="annot"><span class="annottext">(Map (Credential 'Staking) (AccountState era)
 -&gt; Map (Credential 'Staking) (AccountState era))
-&gt; GenRS era ()
forall era.
(Map (Credential 'Staking) (AccountState era)
 -&gt; Map (Credential 'Staking) (AccountState era))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialAccounts"><span class="hs-identifier hs-var">modifyGenStateInitialAccounts</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) (AccountState era)
-&gt; Map (Credential 'Staking) (AccountState era)
</span><a href="#local-6989586621682723364"><span class="hs-identifier hs-var">replaceBalances</span></a></span><span>
</span><span id="line-1059"></span><span>  </span><span class="annot"><span class="annottext">(Set (Credential 'Staking) -&gt; Set (Credential 'Staking))
-&gt; GenRS era ()
forall era.
(Set (Credential 'Staking) -&gt; Set (Credential 'Staking))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateAvoidCred"><span class="hs-identifier hs-var">modifyGenStateAvoidCred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (Credential 'Staking)
-&gt; Set (Credential 'Staking) -&gt; Set (Credential 'Staking)
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin -&gt; Set (Credential 'Staking)
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682723360"><span class="hs-identifier hs-var">balanceMap</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1060"></span><span>  </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
-&gt; GenRS era (Map (Credential 'Staking) Coin)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682723360"><span class="hs-identifier hs-var">balanceMap</span></a></span><span>
</span><span id="line-1061"></span><span>
</span><span id="line-1062"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genRetirementHash"><span class="hs-identifier hs-type">genRetirementHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682717629"><span class="annot"><a href="#local-6989586621682717629"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717629"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717629"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1063"></span><span id="genRetirementHash"><span class="annot"><span class="annottext">genRetirementHash :: forall era. Reflect era =&gt; GenRS era (KeyHash 'StakePool)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genRetirementHash"><span class="hs-identifier hs-var hs-var">genRetirementHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1064"></span><span>  </span><span id="local-6989586621682723409"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621682723409"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map (KeyHash 'StakePool) StakePoolState)
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; Map (KeyHash 'StakePool) StakePoolState
forall era.
ModelNewEpochState era -&gt; Map (KeyHash 'StakePool) StakePoolState
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mStakePools"><span class="hs-identifier hs-var">mStakePools</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; (GenState era -&gt; ModelNewEpochState era)
-&gt; GenState era
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; ModelNewEpochState era
forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1065"></span><span>  </span><span id="local-6989586621682723410"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682723410"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; PParams era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (PParams era)
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; PParams era
forall era. ModelNewEpochState era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPParams"><span class="hs-identifier hs-var">mPParams</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; PParams era)
-&gt; (GenState era -&gt; ModelNewEpochState era)
-&gt; GenState era
-&gt; PParams era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; ModelNewEpochState era
forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1066"></span><span>  </span><span id="local-6989586621682723411"><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
</span><a href="#local-6989586621682723411"><span class="hs-identifier hs-var">honestKhs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Set (KeyHash 'StakePool))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Set (KeyHash 'StakePool))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Set (KeyHash 'StakePool)
forall era. GenState era -&gt; Set (KeyHash 'StakePool)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStablePools"><span class="hs-identifier hs-var">gsStablePools</span></a></span><span>
</span><span id="line-1067"></span><span>  </span><span id="local-6989586621682723412"><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
</span><a href="#local-6989586621682723412"><span class="hs-identifier hs-var">avoidKey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Set (KeyHash 'StakePool))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Set (KeyHash 'StakePool))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Set (KeyHash 'StakePool)
forall era. GenState era -&gt; Set (KeyHash 'StakePool)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidKey"><span class="hs-identifier hs-var">gsAvoidKey</span></a></span><span>
</span><span id="line-1068"></span><span>  </span><span id="local-6989586621682723413"><span class="annot"><span class="annottext">Maybe (KeyHash 'StakePool, StakePoolState)
</span><a href="#local-6989586621682723413"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Maybe (KeyHash 'StakePool, StakePoolState))
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Maybe (KeyHash 'StakePool, StakePoolState))
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen (Maybe (KeyHash 'StakePool, StakePoolState))
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (Maybe (KeyHash 'StakePool, StakePoolState)))
-&gt; ((KeyHash 'StakePool -&gt; StakePoolState -&gt; Bool)
    -&gt; Gen (Maybe (KeyHash 'StakePool, StakePoolState)))
-&gt; (KeyHash 'StakePool -&gt; StakePoolState -&gt; Bool)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Maybe (KeyHash 'StakePool, StakePoolState))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
-&gt; Int
-&gt; (KeyHash 'StakePool -&gt; StakePoolState -&gt; Bool)
-&gt; Gen (Maybe (KeyHash 'StakePool, StakePoolState))
forall k a.
Map k a -&gt; Int -&gt; (k -&gt; a -&gt; Bool) -&gt; Gen (Maybe (k, a))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElemWhere"><span class="hs-identifier hs-var">genMapElemWhere</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621682723409"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">((KeyHash 'StakePool -&gt; StakePoolState -&gt; Bool)
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (Maybe (KeyHash 'StakePool, StakePoolState)))
-&gt; (KeyHash 'StakePool -&gt; StakePoolState -&gt; Bool)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Maybe (KeyHash 'StakePool, StakePoolState))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682723414"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682723414"><span class="hs-identifier hs-var">kh</span></a></span></span><span> </span><span class="annot"><span class="annottext">StakePoolState
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1069"></span><span>    </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682723414"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; Set (KeyHash 'StakePool) -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.notMember`</span></span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
</span><a href="#local-6989586621682723411"><span class="hs-identifier hs-var">honestKhs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682723414"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; Set (KeyHash 'StakePool) -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.notMember`</span></span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
</span><a href="#local-6989586621682723412"><span class="hs-identifier hs-var">avoidKey</span></a></span><span>
</span><span id="line-1070"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (KeyHash 'StakePool, StakePoolState)
</span><a href="#local-6989586621682723413"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1071"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682723415"><span class="annot"><span class="annottext">(KeyHash 'StakePool, StakePoolState)
</span><a href="#local-6989586621682723415"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1072"></span><span>      </span><span class="annot"><span class="annottext">(Set (KeyHash 'StakePool) -&gt; Set (KeyHash 'StakePool))
-&gt; GenRS era ()
forall era.
(Set (KeyHash 'StakePool) -&gt; Set (KeyHash 'StakePool))
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateAvoidKey"><span class="hs-identifier hs-var">modifyGenStateAvoidKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; Set (KeyHash 'StakePool) -&gt; Set (KeyHash 'StakePool)
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(KeyHash 'StakePool, StakePoolState) -&gt; KeyHash 'StakePool
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(KeyHash 'StakePool, StakePoolState)
</span><a href="#local-6989586621682723415"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1073"></span><span>      </span><span class="hs-comment">-- if it is retiring, we should probably avoid it in the future</span><span>
</span><span id="line-1074"></span><span>      </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; GenRS era (KeyHash 'StakePool)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(KeyHash 'StakePool -&gt; GenRS era (KeyHash 'StakePool))
-&gt; KeyHash 'StakePool -&gt; GenRS era (KeyHash 'StakePool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(KeyHash 'StakePool, StakePoolState) -&gt; KeyHash 'StakePool
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(KeyHash 'StakePool, StakePoolState)
</span><a href="#local-6989586621682723415"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1075"></span><span>    </span><span class="annot"><span class="annottext">Maybe (KeyHash 'StakePool, StakePoolState)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1076"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682723417"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682723417"><span class="hs-identifier hs-var">poolid</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682723418"><span class="annot"><span class="annottext">PoolParams
</span><a href="#local-6989586621682723418"><span class="hs-identifier hs-var">poolparams</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682723419"><span class="annot"><span class="annottext">IndividualPoolStake
</span><a href="#local-6989586621682723419"><span class="hs-identifier hs-var">stake</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era (KeyHash 'StakePool, PoolParams, IndividualPoolStake)
forall era.
Reflect era =&gt;
GenRS era (KeyHash 'StakePool, PoolParams, IndividualPoolStake)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genNewPool"><span class="hs-identifier hs-var">genNewPool</span></a></span><span>
</span><span id="line-1077"></span><span>
</span><span id="line-1078"></span><span>      </span><span class="hs-comment">-- add the Pool to the initial state</span><span>
</span><span id="line-1079"></span><span>      </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) PoolParams
 -&gt; Map (KeyHash 'StakePool) PoolParams)
-&gt; GenRS era ()
forall era.
(Map (KeyHash 'StakePool) PoolParams
 -&gt; Map (KeyHash 'StakePool) PoolParams)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolParams"><span class="hs-identifier hs-var">modifyGenStateInitialPoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; PoolParams
-&gt; Map (KeyHash 'StakePool) PoolParams
-&gt; Map (KeyHash 'StakePool) PoolParams
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682723417"><span class="hs-identifier hs-var">poolid</span></a></span><span> </span><span class="annot"><span class="annottext">PoolParams
</span><a href="#local-6989586621682723418"><span class="hs-identifier hs-var">poolparams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1080"></span><span>      </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) IndividualPoolStake
 -&gt; Map (KeyHash 'StakePool) IndividualPoolStake)
-&gt; GenRS era ()
forall era.
(Map (KeyHash 'StakePool) IndividualPoolStake
 -&gt; Map (KeyHash 'StakePool) IndividualPoolStake)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolDistr"><span class="hs-identifier hs-var">modifyGenStateInitialPoolDistr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; IndividualPoolStake
-&gt; Map (KeyHash 'StakePool) IndividualPoolStake
-&gt; Map (KeyHash 'StakePool) IndividualPoolStake
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682723417"><span class="hs-identifier hs-var">poolid</span></a></span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake
</span><a href="#local-6989586621682723419"><span class="hs-identifier hs-var">stake</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1081"></span><span>
</span><span id="line-1082"></span><span>      </span><span class="hs-comment">-- add the Pool to the Model</span><span>
</span><span id="line-1083"></span><span>      </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) StakePoolState
 -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; GenRS era ()
forall era.
(Map (KeyHash 'StakePool) StakePoolState
 -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelStakePools"><span class="hs-identifier hs-var">modifyModelStakePools</span></a></span><span>
</span><span id="line-1084"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682723417"><span class="hs-identifier hs-var">poolid</span></a></span><span> </span><span class="annot"><span class="annottext">(StakePoolState
 -&gt; Map (KeyHash 'StakePool) StakePoolState
 -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin -&gt; PoolParams -&gt; StakePoolState
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#mkStakePoolState"><span class="hs-identifier hs-var">mkStakePoolState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682723410"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
-&gt; Getting (CompactForm Coin) (PParams era) (CompactForm Coin)
-&gt; CompactForm Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (CompactForm Coin) (PParams era) (CompactForm Coin)
forall era.
EraPParams era =&gt;
Lens' (PParams era) (CompactForm Coin)
Lens' (PParams era) (CompactForm Coin)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#ppPoolDepositCompactL"><span class="hs-identifier hs-var">ppPoolDepositCompactL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PoolParams
</span><a href="#local-6989586621682723418"><span class="hs-identifier hs-var">poolparams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1085"></span><span>      </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) IndividualPoolStake
 -&gt; Map (KeyHash 'StakePool) IndividualPoolStake)
-&gt; GenRS era ()
forall era.
(Map (KeyHash 'StakePool) IndividualPoolStake
 -&gt; Map (KeyHash 'StakePool) IndividualPoolStake)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelPoolDistr"><span class="hs-identifier hs-var">modifyModelPoolDistr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; IndividualPoolStake
-&gt; Map (KeyHash 'StakePool) IndividualPoolStake
-&gt; Map (KeyHash 'StakePool) IndividualPoolStake
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682723417"><span class="hs-identifier hs-var">poolid</span></a></span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake
</span><a href="#local-6989586621682723419"><span class="hs-identifier hs-var">stake</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1086"></span><span>      </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; GenRS era (KeyHash 'StakePool)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682723417"><span class="hs-identifier hs-var">poolid</span></a></span><span>
</span><span id="line-1087"></span><span>
</span><span id="line-1088"></span><span class="hs-comment">-- Adds to the mPoolParams and the  mPoolDistr of the Model, and the initial set of objects for Traces</span><span>
</span><span id="line-1089"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPool"><span class="hs-identifier hs-type">genPool</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1090"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682717633"><span class="annot"><a href="#local-6989586621682717633"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1091"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717633"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1092"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682717633"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#PoolParams"><span class="hs-identifier hs-type">PoolParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1093"></span><span id="genPool"><span class="annot"><span class="annottext">genPool :: forall era.
Reflect era =&gt;
GenRS era (KeyHash 'StakePool, PoolParams)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPool"><span class="hs-identifier hs-var hs-var">genPool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int,
  RWST
    (GenEnv era)
    ()
    (GenState era)
    Gen
    (KeyHash 'StakePool, PoolParams))]
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (KeyHash 'StakePool, PoolParams)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST
  (GenEnv era) () (GenState era) Gen (KeyHash 'StakePool, PoolParams)
</span><a href="#local-6989586621682723678"><span class="hs-identifier hs-var">genNew</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">90</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST
  (GenEnv era) () (GenState era) Gen (KeyHash 'StakePool, PoolParams)
</span><a href="#local-6989586621682723679"><span class="hs-identifier hs-var">pickExisting</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1094"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1095"></span><span>    </span><span id="local-6989586621682723678"><span class="annot"><span class="annottext">genNew :: RWST
  (GenEnv era) () (GenState era) Gen (KeyHash 'StakePool, PoolParams)
</span><a href="#local-6989586621682723678"><span class="hs-identifier hs-var hs-var">genNew</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1096"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682725905"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682725905"><span class="hs-identifier hs-var">kh</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682725906"><span class="annot"><span class="annottext">PoolParams
</span><a href="#local-6989586621682725906"><span class="hs-identifier hs-var">pp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682725907"><span class="annot"><span class="annottext">IndividualPoolStake
</span><a href="#local-6989586621682725907"><span class="hs-identifier hs-var">ips</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era (KeyHash 'StakePool, PoolParams, IndividualPoolStake)
forall era.
Reflect era =&gt;
GenRS era (KeyHash 'StakePool, PoolParams, IndividualPoolStake)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genNewPool"><span class="hs-identifier hs-var">genNewPool</span></a></span><span>
</span><span id="line-1097"></span><span>      </span><span id="local-6989586621682725908"><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682725908"><span class="hs-identifier hs-var">pparams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; PParams era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (PParams era)
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; PParams era
forall era. ModelNewEpochState era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mPParams"><span class="hs-identifier hs-var">mPParams</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; PParams era)
-&gt; (GenState era -&gt; ModelNewEpochState era)
-&gt; GenState era
-&gt; PParams era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; ModelNewEpochState era
forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1098"></span><span>      </span><span class="hs-comment">-- add pool to initial state</span><span>
</span><span id="line-1099"></span><span>      </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) PoolParams
 -&gt; Map (KeyHash 'StakePool) PoolParams)
-&gt; GenRS era ()
forall era.
(Map (KeyHash 'StakePool) PoolParams
 -&gt; Map (KeyHash 'StakePool) PoolParams)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolParams"><span class="hs-identifier hs-var">modifyGenStateInitialPoolParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; PoolParams
-&gt; Map (KeyHash 'StakePool) PoolParams
-&gt; Map (KeyHash 'StakePool) PoolParams
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682725905"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">PoolParams
</span><a href="#local-6989586621682725906"><span class="hs-identifier hs-var">pp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1100"></span><span>      </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) IndividualPoolStake
 -&gt; Map (KeyHash 'StakePool) IndividualPoolStake)
-&gt; GenRS era ()
forall era.
(Map (KeyHash 'StakePool) IndividualPoolStake
 -&gt; Map (KeyHash 'StakePool) IndividualPoolStake)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialPoolDistr"><span class="hs-identifier hs-var">modifyGenStateInitialPoolDistr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; IndividualPoolStake
-&gt; Map (KeyHash 'StakePool) IndividualPoolStake
-&gt; Map (KeyHash 'StakePool) IndividualPoolStake
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682725905"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake
</span><a href="#local-6989586621682725907"><span class="hs-identifier hs-var">ips</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1101"></span><span>      </span><span class="hs-comment">-- update the model</span><span>
</span><span id="line-1102"></span><span>      </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) StakePoolState
 -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; GenRS era ()
forall era.
(Map (KeyHash 'StakePool) StakePoolState
 -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelStakePools"><span class="hs-identifier hs-var">modifyModelStakePools</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682725905"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">(StakePoolState
 -&gt; Map (KeyHash 'StakePool) StakePoolState
 -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin -&gt; PoolParams -&gt; StakePoolState
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#mkStakePoolState"><span class="hs-identifier hs-var">mkStakePoolState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682725908"><span class="hs-identifier hs-var">pparams</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
-&gt; Getting (CompactForm Coin) (PParams era) (CompactForm Coin)
-&gt; CompactForm Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (CompactForm Coin) (PParams era) (CompactForm Coin)
forall era.
EraPParams era =&gt;
Lens' (PParams era) (CompactForm Coin)
Lens' (PParams era) (CompactForm Coin)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#ppPoolDepositCompactL"><span class="hs-identifier hs-var">ppPoolDepositCompactL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PoolParams
</span><a href="#local-6989586621682725906"><span class="hs-identifier hs-var">pp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1103"></span><span>      </span><span class="annot"><span class="annottext">(KeyHash 'StakePool, PoolParams)
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (KeyHash 'StakePool, PoolParams)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682725905"><span class="hs-identifier hs-var">kh</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PoolParams
</span><a href="#local-6989586621682725906"><span class="hs-identifier hs-var">pp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1104"></span><span>    </span><span id="local-6989586621682723679"><span class="annot"><span class="annottext">pickExisting :: RWST
  (GenEnv era) () (GenState era) Gen (KeyHash 'StakePool, PoolParams)
</span><a href="#local-6989586621682723679"><span class="hs-identifier hs-var hs-var">pickExisting</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1105"></span><span>      </span><span id="local-6989586621682725909"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621682725909"><span class="hs-identifier hs-var">psStakePools</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map (KeyHash 'StakePool) StakePoolState)
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; Map (KeyHash 'StakePool) StakePoolState
forall era.
ModelNewEpochState era -&gt; Map (KeyHash 'StakePool) StakePoolState
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mStakePools"><span class="hs-identifier hs-var">mStakePools</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; (GenState era -&gt; ModelNewEpochState era)
-&gt; GenState era
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; ModelNewEpochState era
forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1106"></span><span>      </span><span id="local-6989586621682725910"><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
</span><a href="#local-6989586621682725910"><span class="hs-identifier hs-var">avoidKey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Set (KeyHash 'StakePool))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Set (KeyHash 'StakePool))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Set (KeyHash 'StakePool)
forall era. GenState era -&gt; Set (KeyHash 'StakePool)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsAvoidKey"><span class="hs-identifier hs-var">gsAvoidKey</span></a></span><span>
</span><span id="line-1107"></span><span>      </span><span class="annot"><span class="annottext">Gen (Maybe (KeyHash 'StakePool, StakePoolState))
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Maybe (KeyHash 'StakePool, StakePoolState))
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
-&gt; Int
-&gt; (KeyHash 'StakePool -&gt; StakePoolState -&gt; Bool)
-&gt; Gen (Maybe (KeyHash 'StakePool, StakePoolState))
forall k a.
Map k a -&gt; Int -&gt; (k -&gt; a -&gt; Bool) -&gt; Gen (Maybe (k, a))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genMapElemWhere"><span class="hs-identifier hs-var">genMapElemWhere</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621682725909"><span class="hs-identifier hs-var">psStakePools</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682725911"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682725911"><span class="hs-identifier hs-var">kh</span></a></span></span><span> </span><span class="annot"><span class="annottext">StakePoolState
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682725911"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; Set (KeyHash 'StakePool) -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.notMember`</span></span><span> </span><span class="annot"><span class="annottext">Set (KeyHash 'StakePool)
</span><a href="#local-6989586621682725910"><span class="hs-identifier hs-var">avoidKey</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RWST
  (GenEnv era)
  ()
  (GenState era)
  Gen
  (Maybe (KeyHash 'StakePool, StakePoolState))
-&gt; (Maybe (KeyHash 'StakePool, StakePoolState)
    -&gt; RWST
         (GenEnv era)
         ()
         (GenState era)
         Gen
         (KeyHash 'StakePool, PoolParams))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (KeyHash 'StakePool, PoolParams)
forall a b.
RWST (GenEnv era) () (GenState era) Gen a
-&gt; (a -&gt; RWST (GenEnv era) () (GenState era) Gen b)
-&gt; RWST (GenEnv era) () (GenState era) Gen b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1108"></span><span>        </span><span class="annot"><span class="annottext">Maybe (KeyHash 'StakePool, StakePoolState)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RWST
  (GenEnv era) () (GenState era) Gen (KeyHash 'StakePool, PoolParams)
</span><a href="#local-6989586621682723678"><span class="hs-identifier hs-var">genNew</span></a></span><span>
</span><span id="line-1109"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682725912"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682725912"><span class="hs-identifier hs-var">kh</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682725913"><span class="annot"><span class="annottext">StakePoolState
</span><a href="#local-6989586621682725913"><span class="hs-identifier hs-var">pp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(KeyHash 'StakePool, PoolParams)
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (KeyHash 'StakePool, PoolParams)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682725912"><span class="hs-identifier hs-var">kh</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; StakePoolState -&gt; PoolParams
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#stakePoolStateToPoolParams"><span class="hs-identifier hs-var">stakePoolStateToPoolParams</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682725912"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">StakePoolState
</span><a href="#local-6989586621682725913"><span class="hs-identifier hs-var">pp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1110"></span></pre></body></html>