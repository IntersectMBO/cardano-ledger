<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE OverloadedLists #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE UndecidableSuperClasses #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Cardano.Ledger.Generic.TxGen</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#alonzoMkRedeemers"><span class="hs-identifier">alonzoMkRedeemers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#alonzoMkRedeemersFromTags"><span class="hs-identifier">alonzoMkRedeemersFromTags</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ApplyTx.html#mkAlonzoPlutusPurposePointer"><span class="hs-identifier">mkAlonzoPlutusPurposePointer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ApplyTx.html#mkConwayPlutusPurposePointer"><span class="hs-identifier">mkConwayPlutusPurposePointer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genAlonzoTx"><span class="hs-identifier">genAlonzoTx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#runSTSWithContext"><span class="hs-identifier">runSTSWithContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genUTxO"><span class="hs-identifier">genUTxO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html"><span class="hs-identifier">Cardano.Ledger.Allegra.Scripts</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#AllegraEraScript"><span class="hs-identifier">AllegraEraScript</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#Timelock"><span class="hs-identifier">Timelock</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#RequireTimeExpire"><span class="hs-identifier">RequireTimeExpire</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#RequireTimeStart"><span class="hs-identifier">RequireTimeStart</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Scripts.html"><span class="hs-identifier">Cardano.Ledger.Alonzo.Scripts</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Script"><span class="hs-identifier">Script</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxBody.html"><span class="hs-identifier">Cardano.Ledger.Alonzo.TxBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxOut.html#AlonzoTxOut"><span class="hs-identifier">AlonzoTxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxWits.html"><span class="hs-identifier">Cardano.Ledger.Alonzo.TxWits</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxWits.html#Redeemers"><span class="hs-identifier">Redeemers</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxWits.html#TxDats"><span class="hs-identifier">TxDats</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-babbage-1.12.1.0/doc/html/cardano-ledger-babbage/src/Cardano.Ledger.Babbage.TxBody.html"><span class="hs-identifier">Cardano.Ledger.Babbage.TxBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-babbage-1.12.1.0/doc/html/cardano-ledger-babbage/src/Cardano.Ledger.Babbage.TxOut.html#BabbageTxOut"><span class="hs-identifier">BabbageTxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html"><span class="hs-identifier">Cardano.Ledger.BaseTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochInterval"><span class="hs-identifier">EpochInterval</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#Network"><span class="hs-identifier">Network</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#ShelleyBase"><span class="hs-identifier">ShelleyBase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#mkTxIxPartial"><span class="hs-identifier">mkTxIxPartial</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html"><span class="hs-identifier">Cardano.Ledger.Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html"><span class="hs-identifier">Cardano.Ledger.Compactible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#fromCompact"><span class="hs-identifier">fromCompact</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.Core.html"><span class="hs-identifier">Cardano.Ledger.Conway.Core</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.TxCert.html"><span class="hs-identifier">Cardano.Ledger.Conway.TxCert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.TxCert.html#ConwayDelegCert"><span class="hs-identifier">ConwayDelegCert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.TxCert.html#ConwayTxCert"><span class="hs-identifier">ConwayTxCert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.html"><span class="hs-identifier">Cardano.Ledger.Keys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#coerceKeyRole"><span class="hs-identifier">coerceKeyRole</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html"><span class="hs-identifier">Cardano.Ledger.Plutus.Data</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#Data"><span class="hs-identifier">Data</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#Datum"><span class="hs-identifier">Datum</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#dataToBinaryData"><span class="hs-identifier">dataToBinaryData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#hashData"><span class="hs-identifier">hashData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.API.html"><span class="hs-identifier">Cardano.Ledger.Shelley.API</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#Addr"><span class="hs-identifier">Addr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier">Credential</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#RewardAccount"><span class="hs-identifier">RewardAccount</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#ShelleyDelegCert"><span class="hs-identifier">ShelleyDelegCert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html"><span class="hs-identifier">Cardano.Ledger.Shelley.Scripts</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#MultiSig"><span class="hs-identifier">MultiSig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#ShelleyEraScript"><span class="hs-identifier">ShelleyEraScript</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireAllOf"><span class="hs-identifier">RequireAllOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireAnyOf"><span class="hs-identifier">RequireAnyOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireMOf"><span class="hs-identifier">RequireMOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireSignature"><span class="hs-identifier">RequireSignature</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html"><span class="hs-identifier">Cardano.Ledger.Shelley.TxCert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#ShelleyTxCert"><span class="hs-identifier">ShelleyTxCert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Slot.html"><span class="hs-identifier">Cardano.Ledger.Slot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier">EpochNo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier">EpochNo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.html"><span class="hs-identifier">Cardano.Ledger.State</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#balance"><span class="hs-identifier">balance</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html"><span class="hs-identifier">Cardano.Ledger.TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxId"><span class="hs-identifier">TxId</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html"><span class="hs-identifier">Cardano.Ledger.Val</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html"><span class="hs-identifier">Cardano.Slotting.Slot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier">SlotNo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">replicateM</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadTrans</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.RWS.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">gets</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">modify</span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html"><span class="hs-identifier">Control.State.Transition.Extended</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#Assertion"><span class="hs-identifier">Assertion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&amp;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html"><span class="hs-identifier">Data.Maybe.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#StrictMaybe"><span class="hs-identifier">StrictMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">All</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ratio</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(%)</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html"><span class="hs-identifier">Data.Sequence.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SSeq</span></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word16</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Stack</span></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html"><span class="hs-identifier">Lens.Micro</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%25~"><span class="hs-operator">(%~)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&amp;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator">(.~)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%3C%3E~"><span class="hs-operator">(&lt;&gt;~)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator">(^.)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Extras.html"><span class="hs-identifier">Lens.Micro.Extras</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Core.KeyPair.html"><span class="hs-identifier">Test.Cardano.Ledger.Core.KeyPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Core.KeyPair.html#mkAddr"><span class="hs-identifier">mkAddr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Core.KeyPair.html#mkWitnessVKey"><span class="hs-identifier">mkWitnessVKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html"><span class="hs-identifier">Test.Cardano.Ledger.Examples.STSTestUtils</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#EraModel"><span class="hs-identifier">EraModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ApplyTx.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.ApplyTx</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ApplyTx.html#mkAlonzoPlutusPurposePointer"><span class="hs-identifier">mkAlonzoPlutusPurposePointer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ApplyTx.html#mkConwayPlutusPurposePointer"><span class="hs-identifier">mkConwayPlutusPurposePointer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Functions</span></a></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.GenState</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier">EraGenericGen</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier">GenEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier">GenRS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier">GenSize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier">PlutusPurposeTag</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier">elementsT</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier">frequencyT</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genCredential"><span class="hs-identifier">genCredential</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genDatumWithHash"><span class="hs-identifier">genDatumWithHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshRegCred"><span class="hs-identifier">genFreshRegCred</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier">genKeyHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genNewPool"><span class="hs-identifier">genNewPool</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPool"><span class="hs-identifier">genPool</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier">genPositiveVal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genRetirementHash"><span class="hs-identifier">genRetirementHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-118"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewards"><span class="hs-identifier">genRewards</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier">genScript</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#genValidityInterval"><span class="hs-identifier">genValidityInterval</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getCertificateMax"><span class="hs-identifier">getCertificateMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-122"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getOldUtxoPercent"><span class="hs-identifier">getOldUtxoPercent</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getRefInputsMax"><span class="hs-identifier">getRefInputsMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSpendInputsMax"><span class="hs-identifier">getSpendInputsMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoChoicesMax"><span class="hs-identifier">getUtxoChoicesMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoElem"><span class="hs-identifier">getUtxoElem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoTest"><span class="hs-identifier">getUtxoTest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-128"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialUtxo"><span class="hs-identifier">modifyGenStateInitialUtxo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelCount"><span class="hs-identifier">modifyModelCount</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelIndex"><span class="hs-identifier">modifyModelIndex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelMutFee"><span class="hs-identifier">modifyModelMutFee</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelUTxO"><span class="hs-identifier">modifyModelUTxO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-133"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.ModelState</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier">MUtxo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-136"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#ModelNewEpochState"><span class="hs-identifier">ModelNewEpochState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#UtxoEntry"><span class="hs-identifier">UtxoEntry</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-138"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Proof</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#lift"><span class="hs-identifier">lift</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-test-1.7.0.0/doc/html/cardano-ledger-shelley-test/src/Test.Cardano.Ledger.Shelley.Serialisation.EraIndepGenerators.html"><span class="hs-identifier">Test.Cardano.Ledger.Shelley.Serialisation.EraIndepGenerators</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-test-1.7.0.0/doc/html/cardano-ledger-shelley-test/src/Test.Cardano.Ledger.Shelley.Utils.html"><span class="hs-identifier">Test.Cardano.Ledger.Shelley.Utils</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-test-1.7.0.0/doc/html/cardano-ledger-shelley-test/src/Test.Cardano.Ledger.Shelley.Utils.html#epochFromSlotNo"><span class="hs-identifier">epochFromSlotNo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-test-1.7.0.0/doc/html/cardano-ledger-shelley-test/src/Test.Cardano.Ledger.Shelley.Utils.html#runShelleyBase"><span class="hs-identifier">runShelleyBase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.html"><span class="hs-identifier">Test.QuickCheck</span></a></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span id="local-6989586621682728867"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#alonzoMkRedeemersFromTags"><span class="hs-identifier hs-type">alonzoMkRedeemersFromTags</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Scripts.html#AlonzoEraScript"><span class="hs-identifier hs-type">AlonzoEraScript</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728867"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#EraModel"><span class="hs-identifier hs-type">EraModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728867"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728867"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.ExUnits.html#ExUnits"><span class="hs-identifier hs-type">ExUnits</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxWits.html#Redeemers"><span class="hs-identifier hs-type">Redeemers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728867"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-147"></span><span id="alonzoMkRedeemersFromTags"><span class="annot"><span class="annottext">alonzoMkRedeemersFromTags :: forall era.
(AlonzoEraScript era, EraModel era) =&gt;
[((PlutusPurposeTag, Word32), (Data era, ExUnits))]
-&gt; Redeemers era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#alonzoMkRedeemersFromTags"><span class="hs-identifier hs-var hs-var">alonzoMkRedeemersFromTags</span></a></span></span><span> </span><span id="local-6989586621682729593"><span class="annot"><span class="annottext">[((PlutusPurposeTag, Word32), (Data era, ExUnits))]
</span><a href="#local-6989586621682729593"><span class="hs-identifier hs-var">redeemerPointers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><span class="annottext">[(PlutusPurpose AsIx era, (Data era, ExUnits))] -&gt; Redeemers era
forall era.
AlonzoEraScript era =&gt;
[(PlutusPurpose AsIx era, (Data era, ExUnits))] -&gt; Redeemers era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#alonzoMkRedeemers"><span class="hs-identifier hs-var">alonzoMkRedeemers</span></a></span><span> </span><span class="annot"><span class="annottext">[(PlutusPurpose AsIx era, (Data era, ExUnits))]
</span><a href="#local-6989586621682729594"><span class="hs-identifier hs-var">redeemerAssocs</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-150"></span><span>    </span><span id="local-6989586621682729594"><span class="annot"><span class="annottext">redeemerAssocs :: [(PlutusPurpose AsIx era, (Data era, ExUnits))]
</span><a href="#local-6989586621682729594"><span class="hs-identifier hs-var hs-var">redeemerAssocs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-151"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlutusPurposeTag -&gt; Word32 -&gt; PlutusPurpose AsIx era
forall era.
EraModel era =&gt;
PlutusPurposeTag -&gt; Word32 -&gt; PlutusPurpose AsIx era
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#mkPlutusPurposePointer"><span class="hs-identifier hs-var">mkPlutusPurposePointer</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682729596"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682729597"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Data era, ExUnits)
</span><a href="#local-6989586621682729598"><span class="hs-identifier hs-var">redeemer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621682729596"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682729596"><span class="hs-identifier hs-var">tag</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682729597"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682729597"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682729598"><span class="annot"><span class="annottext">(Data era, ExUnits)
</span><a href="#local-6989586621682729598"><span class="hs-identifier hs-var">redeemer</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[((PlutusPurposeTag, Word32), (Data era, ExUnits))]
</span><a href="#local-6989586621682729593"><span class="hs-identifier hs-var">redeemerPointers</span></a></span><span>
</span><span id="line-153"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#alonzoMkRedeemers"><span class="hs-identifier hs-type">alonzoMkRedeemers</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682728877"><span class="annot"><a href="#local-6989586621682728877"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-157"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Scripts.html#AlonzoEraScript"><span class="hs-identifier hs-type">AlonzoEraScript</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728877"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Scripts.html#PlutusPurpose"><span class="hs-identifier hs-type">PlutusPurpose</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Scripts.html#AsIx"><span class="hs-identifier hs-type">AsIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728877"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728877"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.ExUnits.html#ExUnits"><span class="hs-identifier hs-type">ExUnits</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxWits.html#Redeemers"><span class="hs-identifier hs-type">Redeemers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728877"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-160"></span><span id="alonzoMkRedeemers"><span class="annot"><span class="annottext">alonzoMkRedeemers :: forall era.
AlonzoEraScript era =&gt;
[(PlutusPurpose AsIx era, (Data era, ExUnits))] -&gt; Redeemers era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#alonzoMkRedeemers"><span class="hs-identifier hs-var hs-var">alonzoMkRedeemers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (PlutusPurpose AsIx era) (Data era, ExUnits) -&gt; Redeemers era
forall era.
AlonzoEraScript era =&gt;
Map (PlutusPurpose AsIx era) (Data era, ExUnits) -&gt; Redeemers era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxWits.html#Redeemers"><span class="hs-identifier hs-var">Redeemers</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (PlutusPurpose AsIx era) (Data era, ExUnits) -&gt; Redeemers era)
-&gt; ([(PlutusPurpose AsIx era, (Data era, ExUnits))]
    -&gt; Map (PlutusPurpose AsIx era) (Data era, ExUnits))
-&gt; [(PlutusPurpose AsIx era, (Data era, ExUnits))]
-&gt; Redeemers era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(PlutusPurpose AsIx era, (Data era, ExUnits))]
-&gt; Map (PlutusPurpose AsIx era) (Data era, ExUnits)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span id="local-6989586621682728888"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOut"><span class="hs-identifier hs-type">genTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728888"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728888"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728888"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728888"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-163"></span><span id="genTxOut"><span class="annot"><span class="annottext">genTxOut :: forall era. Reflect era =&gt; Value era -&gt; GenRS era (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOut"><span class="hs-identifier hs-var hs-var">genTxOut</span></a></span></span><span> </span><span id="local-6989586621682729635"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621682729635"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621682729636"><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621682729636"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era Addr
forall era. Reflect era =&gt; GenRS era Addr
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRecipient"><span class="hs-identifier hs-var">genRecipient</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621682729638"><span class="annot"><span class="annottext">Credential 'Payment
</span><a href="#local-6989586621682729638"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (Credential 'Payment)
-&gt; (Credential 'Payment
    -&gt; RWST (GenEnv era) () (GenState era) Gen (Credential 'Payment))
-&gt; Maybe (Credential 'Payment)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential 'Payment)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential 'Payment)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;BootstrapAddress encountered&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Credential 'Payment
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential 'Payment)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Credential 'Payment)
 -&gt; RWST (GenEnv era) () (GenState era) Gen (Credential 'Payment))
-&gt; Maybe (Credential 'Payment)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential 'Payment)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Addr -&gt; Maybe (Credential 'Payment)
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#paymentCredAddr"><span class="hs-identifier hs-var">paymentCredAddr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621682729636"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621682729642"><span class="annot"><span class="annottext">TxOut era -&gt; TxOut era
</span><a href="#local-6989586621682729642"><span class="hs-identifier hs-var">dataHashFields</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Credential 'Payment
</span><a href="#local-6989586621682729638"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-168"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#KeyHashObj"><span class="hs-identifier hs-type">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Payment
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TxOut era -&gt; TxOut era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (TxOut era -&gt; TxOut era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; TxOut era
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-169"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#ScriptHashObj"><span class="hs-identifier hs-type">ScriptHashObj</span></a></span><span> </span><span id="local-6989586621682729646"><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682729646"><span class="hs-identifier hs-var">scriptHash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-170"></span><span>        </span><span id="local-6989586621682729647"><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="#local-6989586621682729647"><span class="hs-identifier hs-var">maybeCoreScript</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ScriptHash
-&gt; Maybe PlutusPurposeTag
-&gt; RWST (GenEnv era) () (GenState era) Gen (Maybe (Script era))
forall era.
ScriptHash
-&gt; Maybe PlutusPurposeTag -&gt; GenRS era (Maybe (Script era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupScript"><span class="hs-identifier hs-var">lookupScript</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682729646"><span class="hs-identifier hs-var">scriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlutusPurposeTag -&gt; Maybe PlutusPurposeTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Script era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (TxOut era -&gt; TxOut era)
forall era.
Reflect era =&gt;
Maybe (Script era) -&gt; GenRS era (TxOut era -&gt; TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genDataHashField"><span class="hs-identifier hs-var">genDataHashField</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="#local-6989586621682729647"><span class="hs-identifier hs-var">maybeCoreScript</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span class="annot"><span class="annottext">TxOut era -&gt; GenRS era (TxOut era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(TxOut era -&gt; GenRS era (TxOut era))
-&gt; (TxOut era -&gt; TxOut era) -&gt; TxOut era -&gt; GenRS era (TxOut era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; TxOut era
</span><a href="#local-6989586621682729642"><span class="hs-identifier hs-var">dataHashFields</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut era -&gt; GenRS era (TxOut era))
-&gt; TxOut era -&gt; GenRS era (TxOut era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Addr -&gt; Value era -&gt; TxOut era
forall era.
(EraTxOut era, HasCallStack) =&gt;
Addr -&gt; Value era -&gt; TxOut era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#mkBasicTxOut"><span class="hs-identifier hs-var">mkBasicTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621682729636"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621682729635"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- ====================================================================</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span id="local-6989586621682728932"><span id="local-6989586621682728933"><span id="local-6989586621682728934"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupByKeyM"><span class="hs-identifier hs-type">lookupByKeyM</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621682728932"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621682728932"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682728932"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728933"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621682728932"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728934"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728933"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728934"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-178"></span><span id="lookupByKeyM"><span class="annot"><span class="annottext">lookupByKeyM :: forall k era v.
(Ord k, Show k, HasCallStack) =&gt;
[Char] -&gt; k -&gt; (GenState era -&gt; Map k v) -&gt; GenRS era v
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupByKeyM"><span class="hs-identifier hs-var hs-var">lookupByKeyM</span></a></span></span><span> </span><span id="local-6989586621682729671"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682729671"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682729672"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621682729672"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621682729673"><span class="annot"><span class="annottext">GenState era -&gt; Map k v
</span><a href="#local-6989586621682729673"><span class="hs-identifier hs-var">getMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621682729674"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621682729674"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Map k v)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Map k v)
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Map k v
</span><a href="#local-6989586621682729673"><span class="hs-identifier hs-var">getMap</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Maybe v
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621682729672"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621682729674"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="annottext">Maybe v
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-182"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; GenRS era v
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; GenRS era v) -&gt; [Char] -&gt; GenRS era v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Can't find &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621682729671"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; in the test enviroment: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621682729672"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682729677"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621682729677"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; GenRS era v
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621682729677"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupScript"><span class="hs-identifier hs-type">lookupScript</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682728928"><span class="annot"><a href="#local-6989586621682728928"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728928"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Script"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728928"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span id="lookupScript"><span class="annot"><span class="annottext">lookupScript :: forall era.
ScriptHash
-&gt; Maybe PlutusPurposeTag -&gt; GenRS era (Maybe (Script era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupScript"><span class="hs-identifier hs-var hs-var">lookupScript</span></a></span></span><span> </span><span id="local-6989586621682729703"><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682729703"><span class="hs-identifier hs-var">scriptHash</span></a></span></span><span> </span><span id="local-6989586621682729704"><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729704"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-192"></span><span>  </span><span id="local-6989586621682729705"><span class="annot"><span class="annottext">Map ScriptHash (Script era)
</span><a href="#local-6989586621682729705"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Map ScriptHash (Script era)
forall era. GenState era -&gt; Map ScriptHash (Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsScripts"><span class="hs-identifier hs-var">gsScripts</span></a></span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Map ScriptHash (Script era))
-&gt; RWST (GenEnv era) () (GenState era) Gen (GenState era)
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Map ScriptHash (Script era))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (GenState era)
forall w (m :: * -&gt; *) r s. (Monoid w, Monad m) =&gt; RWST r w s m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ScriptHash -&gt; Map ScriptHash (Script era) -&gt; Maybe (Script era)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682729703"><span class="hs-identifier hs-var">scriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">Map ScriptHash (Script era)
</span><a href="#local-6989586621682729705"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682729708"><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682729708"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Script era) -&gt; GenRS era (Maybe (Script era))
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Script era) -&gt; GenRS era (Maybe (Script era)))
-&gt; Maybe (Script era) -&gt; GenRS era (Maybe (Script era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Script era -&gt; Maybe (Script era)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682729708"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-196"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682729709"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682729709"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729704"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-197"></span><span>          </span><span class="annot"><span class="annottext">Script era -&gt; Maybe (Script era)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Script era -&gt; Maybe (Script era))
-&gt; ((IsValid, Script era) -&gt; Script era)
-&gt; (IsValid, Script era)
-&gt; Maybe (Script era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(IsValid, Script era) -&gt; Script era
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((IsValid, Script era) -&gt; Maybe (Script era))
-&gt; RWST (GenEnv era) () (GenState era) Gen (IsValid, Script era)
-&gt; GenRS era (Maybe (Script era))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; (ScriptHash, PlutusPurposeTag)
-&gt; (GenState era
    -&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era))
-&gt; RWST (GenEnv era) () (GenState era) Gen (IsValid, Script era)
forall k era v.
(Ord k, Show k, HasCallStack) =&gt;
[Char] -&gt; k -&gt; (GenState era -&gt; Map k v) -&gt; GenRS era v
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupByKeyM"><span class="hs-identifier hs-var">lookupByKeyM</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;plutusScript&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682729703"><span class="hs-identifier hs-var">scriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682729709"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenState era
-&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
forall era.
GenState era
-&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsPlutusScripts"><span class="hs-identifier hs-var">gsPlutusScripts</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Script era) -&gt; GenRS era (Maybe (Script era))
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Script era)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-- =====================================</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genGenericScriptWitness"><span class="hs-identifier hs-type">genGenericScriptWitness</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682728971"><span class="annot"><a href="#local-6989586621682728971"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728971"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Script"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728971"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728971"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#SafeHash"><span class="hs-identifier hs-type">SafeHash</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#EraIndependentTxBody"><span class="hs-identifier hs-type">EraIndependentTxBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728971"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728971"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span id="genGenericScriptWitness"><span class="annot"><span class="annottext">genGenericScriptWitness :: forall era.
Reflect era =&gt;
Maybe PlutusPurposeTag
-&gt; Script era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genGenericScriptWitness"><span class="hs-identifier hs-var hs-var">genGenericScriptWitness</span></a></span></span><span> </span><span id="local-6989586621682729715"><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729715"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span id="local-6989586621682729716"><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682729716"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682728971"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-var">Shelley</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; MultiSig era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
(ShelleyEraScript era, NativeScript era ~ MultiSig era,
 Reflect era) =&gt;
Maybe PlutusPurposeTag
-&gt; MultiSig era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var">mkMultiSigWit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729715"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
MultiSig era
</span><a href="#local-6989586621682729716"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-var">Allegra</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
(AllegraEraScript era, NativeScript era ~ Timelock era,
 Reflect era) =&gt;
Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var">mkTimelockWit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729715"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Timelock era
Script era
</span><a href="#local-6989586621682729716"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-var">Mary</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
(AllegraEraScript era, NativeScript era ~ Timelock era,
 Reflect era) =&gt;
Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var">mkTimelockWit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729715"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Timelock era
Script era
</span><a href="#local-6989586621682729716"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-var">Alonzo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682729716"><span class="hs-identifier hs-var">script</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-214"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Scripts.html#NativeScript"><span class="hs-identifier hs-type">NativeScript</span></a></span><span> </span><span id="local-6989586621682729762"><span class="annot"><span class="annottext">NativeScript AlonzoEra
</span><a href="#local-6989586621682729762"><span class="hs-identifier hs-var">timelock</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
(AllegraEraScript era, NativeScript era ~ Timelock era,
 Reflect era) =&gt;
Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var">mkTimelockWit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729715"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Timelock era
NativeScript AlonzoEra
</span><a href="#local-6989586621682729762"><span class="hs-identifier hs-var">timelock</span></a></span><span>
</span><span id="line-215"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Scripts.html#PlutusScript"><span class="hs-identifier hs-type">PlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusScript AlonzoEra
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SafeHash EraIndependentTxBody
 -&gt; AlonzoTxWits AlonzoEra -&gt; AlonzoTxWits AlonzoEra)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody
      -&gt; AlonzoTxWits AlonzoEra -&gt; AlonzoTxWits AlonzoEra)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AlonzoTxWits AlonzoEra -&gt; AlonzoTxWits AlonzoEra)
-&gt; SafeHash EraIndependentTxBody
-&gt; AlonzoTxWits AlonzoEra
-&gt; AlonzoTxWits AlonzoEra
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">AlonzoTxWits AlonzoEra -&gt; AlonzoTxWits AlonzoEra
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682729716"><span class="hs-identifier hs-var">script</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Scripts.html#NativeScript"><span class="hs-identifier hs-type">NativeScript</span></a></span><span> </span><span id="local-6989586621682729779"><span class="annot"><span class="annottext">NativeScript BabbageEra
</span><a href="#local-6989586621682729779"><span class="hs-identifier hs-var">timelock</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
(AllegraEraScript era, NativeScript era ~ Timelock era,
 Reflect era) =&gt;
Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var">mkTimelockWit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729715"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Timelock era
NativeScript BabbageEra
</span><a href="#local-6989586621682729779"><span class="hs-identifier hs-var">timelock</span></a></span><span>
</span><span id="line-218"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Scripts.html#PlutusScript"><span class="hs-identifier hs-type">PlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusScript BabbageEra
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SafeHash EraIndependentTxBody
 -&gt; AlonzoTxWits BabbageEra -&gt; AlonzoTxWits BabbageEra)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody
      -&gt; AlonzoTxWits BabbageEra -&gt; AlonzoTxWits BabbageEra)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AlonzoTxWits BabbageEra -&gt; AlonzoTxWits BabbageEra)
-&gt; SafeHash EraIndependentTxBody
-&gt; AlonzoTxWits BabbageEra
-&gt; AlonzoTxWits BabbageEra
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">AlonzoTxWits BabbageEra -&gt; AlonzoTxWits BabbageEra
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682729716"><span class="hs-identifier hs-var">script</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-220"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Scripts.html#NativeScript"><span class="hs-identifier hs-type">NativeScript</span></a></span><span> </span><span id="local-6989586621682729794"><span class="annot"><span class="annottext">NativeScript ConwayEra
</span><a href="#local-6989586621682729794"><span class="hs-identifier hs-var">timelock</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
(AllegraEraScript era, NativeScript era ~ Timelock era,
 Reflect era) =&gt;
Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var">mkTimelockWit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729715"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Timelock era
NativeScript ConwayEra
</span><a href="#local-6989586621682729794"><span class="hs-identifier hs-var">timelock</span></a></span><span>
</span><span id="line-221"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Scripts.html#PlutusScript"><span class="hs-identifier hs-type">PlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusScript ConwayEra
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SafeHash EraIndependentTxBody
 -&gt; AlonzoTxWits ConwayEra -&gt; AlonzoTxWits ConwayEra)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody
      -&gt; AlonzoTxWits ConwayEra -&gt; AlonzoTxWits ConwayEra)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AlonzoTxWits ConwayEra -&gt; AlonzoTxWits ConwayEra)
-&gt; SafeHash EraIndependentTxBody
-&gt; AlonzoTxWits ConwayEra
-&gt; AlonzoTxWits ConwayEra
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">AlonzoTxWits ConwayEra -&gt; AlonzoTxWits ConwayEra
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- | Generate a TxWits producing function. We handle TxWits come from Keys and Scripts</span><span>
</span><span id="line-224"></span><span class="hs-comment">--   Because scripts vary be Era, we need some Era specific code here: genGenericScriptWitness</span><span>
</span><span id="line-225"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-type">mkWitVKey</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682728996"><span class="annot"><a href="#local-6989586621682728996"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621682728997"><span class="annot"><a href="#local-6989586621682728997"><span class="hs-identifier hs-type">kr</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728996"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-228"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728997"><span class="hs-identifier hs-type">kr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728996"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#SafeHash"><span class="hs-identifier hs-type">SafeHash</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#EraIndependentTxBody"><span class="hs-identifier hs-type">EraIndependentTxBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728996"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728996"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span id="mkWitVKey"><span class="annot"><span class="annottext">mkWitVKey :: forall era (kr :: KeyRole).
Reflect era =&gt;
Maybe PlutusPurposeTag
-&gt; Credential kr
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-var hs-var">mkWitVKey</span></a></span></span><span> </span><span id="local-6989586621682729844"><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729844"><span class="hs-identifier hs-var">_mTag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#KeyHashObj"><span class="hs-identifier hs-type">KeyHashObj</span></a></span><span> </span><span id="local-6989586621682729845"><span class="annot"><span class="annottext">KeyHash kr
</span><a href="#local-6989586621682729845"><span class="hs-identifier hs-var">keyHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-232"></span><span>  </span><span id="local-6989586621682729846"><span class="annot"><span class="annottext">KeyPair 'Witness
</span><a href="#local-6989586621682729846"><span class="hs-identifier hs-var">keyPair</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; KeyHash 'Witness
-&gt; (GenState era -&gt; Map (KeyHash 'Witness) (KeyPair 'Witness))
-&gt; GenRS era (KeyPair 'Witness)
forall k era v.
(Ord k, Show k, HasCallStack) =&gt;
[Char] -&gt; k -&gt; (GenState era -&gt; Map k v) -&gt; GenRS era v
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupByKeyM"><span class="hs-identifier hs-var">lookupByKeyM</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;credential&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash kr -&gt; KeyHash 'Witness
forall (r :: KeyRole) (r' :: KeyRole). KeyHash r -&gt; KeyHash r'
forall (a :: KeyRole -&gt; *) (r :: KeyRole) (r' :: KeyRole).
HasKeyRole a =&gt;
a r -&gt; a r'
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#coerceKeyRole"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash kr
</span><a href="#local-6989586621682729845"><span class="hs-identifier hs-var">keyHash</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Map (KeyHash 'Witness) (KeyPair 'Witness)
forall era.
GenState era -&gt; Map (KeyHash 'Witness) (KeyPair 'Witness)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsKeys"><span class="hs-identifier hs-var">gsKeys</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><span class="annottext">(SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">((SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
 -&gt; GenRS
      era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era))
-&gt; (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682729848"><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody
</span><a href="#local-6989586621682729848"><span class="hs-identifier hs-var">bodyHash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Set (WitVKey 'Witness) -&gt; Identity (Set (WitVKey 'Witness)))
-&gt; TxWits era -&gt; Identity (TxWits era)
forall era.
EraTxWits era =&gt;
Lens' (TxWits era) (Set (WitVKey 'Witness))
Lens' (TxWits era) (Set (WitVKey 'Witness))
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#addrTxWitsL"><span class="hs-identifier hs-var">addrTxWitsL</span></a></span><span> </span><span class="annot"><span class="annottext">((Set (WitVKey 'Witness) -&gt; Identity (Set (WitVKey 'Witness)))
 -&gt; TxWits era -&gt; Identity (TxWits era))
-&gt; Set (WitVKey 'Witness) -&gt; TxWits era -&gt; TxWits era
forall a s t. Monoid a =&gt; ASetter s t a a -&gt; a -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%3C%3E~"><span class="hs-operator hs-var">&lt;&gt;~</span></a></span><span> </span><span class="annot"><span class="annottext">[WitVKey 'Witness] -&gt; Set (WitVKey 'Witness)
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody
-&gt; KeyPair 'Witness -&gt; WitVKey 'Witness
forall (kr :: KeyRole).
SafeHash EraIndependentTxBody -&gt; KeyPair kr -&gt; WitVKey 'Witness
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Core.KeyPair.html#mkWitnessVKey"><span class="hs-identifier hs-var">mkWitnessVKey</span></a></span><span> </span><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody
</span><a href="#local-6989586621682729848"><span class="hs-identifier hs-var">bodyHash</span></a></span><span> </span><span class="annot"><span class="annottext">KeyPair 'Witness
</span><a href="#local-6989586621682729846"><span class="hs-identifier hs-var">keyPair</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-234"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-var">mkWitVKey</span></a></span><span> </span><span id="local-6989586621682729851"><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729851"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#ScriptHashObj"><span class="hs-identifier hs-type">ScriptHashObj</span></a></span><span> </span><span id="local-6989586621682729852"><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682729852"><span class="hs-identifier hs-var">scriptHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="annottext">forall era.
ScriptHash
-&gt; Maybe PlutusPurposeTag -&gt; GenRS era (Maybe (Script era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupScript"><span class="hs-identifier hs-var">lookupScript</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682728996"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682729852"><span class="hs-identifier hs-var">scriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729851"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (Maybe (Script era))
-&gt; (Maybe (Script era)
    -&gt; GenRS
         era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era))
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall a b.
RWST (GenEnv era) () (GenState era) Gen a
-&gt; (a -&gt; RWST (GenEnv era) () (GenState era) Gen b)
-&gt; RWST (GenEnv era) () (GenState era) Gen b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char]
 -&gt; GenRS
      era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era))
-&gt; [Char]
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Impossible: Cannot find script with hash &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682729852"><span class="hs-identifier hs-var">scriptHash</span></a></span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682729853"><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682729853"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-238"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682729854"><span class="annot"><span class="annottext">scriptWit :: TxWits era -&gt; TxWits era
</span><a href="#local-6989586621682729854"><span class="hs-identifier hs-var hs-var">scriptWit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map ScriptHash (Script era)
 -&gt; Identity (Map ScriptHash (Script era)))
-&gt; TxWits era -&gt; Identity (TxWits era)
forall era.
EraTxWits era =&gt;
Lens' (TxWits era) (Map ScriptHash (Script era))
Lens' (TxWits era) (Map ScriptHash (Script era))
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#scriptTxWitsL"><span class="hs-identifier hs-var">scriptTxWitsL</span></a></span><span> </span><span class="annot"><span class="annottext">((Map ScriptHash (Script era)
  -&gt; Identity (Map ScriptHash (Script era)))
 -&gt; TxWits era -&gt; Identity (TxWits era))
-&gt; Map ScriptHash (Script era) -&gt; TxWits era -&gt; TxWits era
forall a s t. Monoid a =&gt; ASetter s t a a -&gt; a -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%3C%3E~"><span class="hs-operator hs-var">&lt;&gt;~</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Script era -&gt; ScriptHash
forall era. EraScript era =&gt; Script era -&gt; ScriptHash
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#hashScript"><span class="hs-identifier hs-var">hashScript</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682729853"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682729853"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-239"></span><span>      </span><span id="local-6989586621682729857"><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era
</span><a href="#local-6989586621682729857"><span class="hs-identifier hs-var">otherWit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; Script era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
Reflect era =&gt;
Maybe PlutusPurposeTag
-&gt; Script era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genGenericScriptWitness"><span class="hs-identifier hs-var">genGenericScriptWitness</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729851"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682729853"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-240"></span><span>      </span><span class="annot"><span class="annottext">(SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682729858"><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody
</span><a href="#local-6989586621682729858"><span class="hs-identifier hs-var">hash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxWits era -&gt; TxWits era
</span><a href="#local-6989586621682729854"><span class="hs-identifier hs-var">scriptWit</span></a></span><span> </span><span class="annot"><span class="annottext">(TxWits era -&gt; TxWits era)
-&gt; (TxWits era -&gt; TxWits era) -&gt; TxWits era -&gt; TxWits era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era
</span><a href="#local-6989586621682729857"><span class="hs-identifier hs-var">otherWit</span></a></span><span> </span><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody
</span><a href="#local-6989586621682729858"><span class="hs-identifier hs-var">hash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">-- ========================================================================</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- Generating TxWits, here we are not adding anything to the GenState</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- only looking up things already added, and assembling the right pieces to</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- make TxWits.</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="annot"><span class="hs-comment">-- | Used in Shelley Eras</span></span><span>
</span><span id="line-248"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-type">mkMultiSigWit</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682728981"><span class="annot"><a href="#local-6989586621682728981"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#ShelleyEraScript"><span class="hs-identifier hs-type">ShelleyEraScript</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728981"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#NativeScript"><span class="hs-identifier hs-type">NativeScript</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728981"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#MultiSig"><span class="hs-identifier hs-type">MultiSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728981"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728981"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-251"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-252"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#MultiSig"><span class="hs-identifier hs-type">MultiSig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728981"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728981"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#SafeHash"><span class="hs-identifier hs-type">SafeHash</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#EraIndependentTxBody"><span class="hs-identifier hs-type">EraIndependentTxBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728981"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728981"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span id="mkMultiSigWit"><span class="annot"><span class="annottext">mkMultiSigWit :: forall era.
(ShelleyEraScript era, NativeScript era ~ MultiSig era,
 Reflect era) =&gt;
Maybe PlutusPurposeTag
-&gt; MultiSig era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var hs-var">mkMultiSigWit</span></a></span></span><span> </span><span id="local-6989586621682729906"><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729906"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireSignature"><span class="hs-identifier hs-type">RequireSignature</span></a></span><span> </span><span id="local-6989586621682729907"><span class="annot"><span class="annottext">KeyHash 'Witness
</span><a href="#local-6989586621682729907"><span class="hs-identifier hs-var">keyHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; Credential 'Witness
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era (kr :: KeyRole).
Reflect era =&gt;
Maybe PlutusPurposeTag
-&gt; Credential kr
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-var">mkWitVKey</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729906"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'Witness -&gt; Credential 'Witness
forall (kr :: KeyRole). KeyHash kr -&gt; Credential kr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#KeyHashObj"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Witness
</span><a href="#local-6989586621682729907"><span class="hs-identifier hs-var">keyHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var">mkMultiSigWit</span></a></span><span> </span><span id="local-6989586621682729908"><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729908"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireAllOf"><span class="hs-identifier hs-type">RequireAllOf</span></a></span><span> </span><span id="local-6989586621682729909"><span class="annot"><span class="annottext">StrictSeq (NativeScript era)
</span><a href="#local-6989586621682729909"><span class="hs-identifier hs-var">timelocks</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era
forall a b. [a -&gt; b -&gt; b] -&gt; a -&gt; b -&gt; b
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#foldFn%27"><span class="hs-identifier hs-var">foldFn'</span></a></span><span> </span><span class="annot"><span class="annottext">([SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
 -&gt; SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(MultiSig era
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era))
-&gt; [MultiSig era]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; MultiSig era
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
(ShelleyEraScript era, NativeScript era ~ MultiSig era,
 Reflect era) =&gt;
Maybe PlutusPurposeTag
-&gt; MultiSig era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var">mkMultiSigWit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729908"><span class="hs-identifier hs-var">mTag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictSeq (MultiSig era) -&gt; [MultiSig era]
forall a. StrictSeq a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">StrictSeq (NativeScript era)
StrictSeq (MultiSig era)
</span><a href="#local-6989586621682729909"><span class="hs-identifier hs-var">timelocks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var">mkMultiSigWit</span></a></span><span> </span><span id="local-6989586621682729913"><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729913"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireAnyOf"><span class="hs-identifier hs-type">RequireAnyOf</span></a></span><span> </span><span id="local-6989586621682729914"><span class="annot"><span class="annottext">StrictSeq (NativeScript era)
</span><a href="#local-6989586621682729914"><span class="hs-identifier hs-var">timelocks</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">StrictSeq (MultiSig era) -&gt; Bool
forall a. StrictSeq a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">F.null</span></span><span> </span><span class="annot"><span class="annottext">StrictSeq (NativeScript era)
StrictSeq (MultiSig era)
</span><a href="#local-6989586621682729914"><span class="hs-identifier hs-var">timelocks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxWits era -&gt; TxWits era)
-&gt; SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">TxWits era -&gt; TxWits era
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; MultiSig era
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
(ShelleyEraScript era, NativeScript era ~ MultiSig era,
 Reflect era) =&gt;
Maybe PlutusPurposeTag
-&gt; MultiSig era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var">mkMultiSigWit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729913"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">(MultiSig era
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era))
-&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Gen (MultiSig era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (MultiSig era)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MultiSig era] -&gt; Gen (MultiSig era)
forall a. HasCallStack =&gt; [a] -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#elements"><span class="hs-identifier hs-var">elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictSeq (MultiSig era) -&gt; [MultiSig era]
forall a. StrictSeq a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">StrictSeq (NativeScript era)
StrictSeq (MultiSig era)
</span><a href="#local-6989586621682729914"><span class="hs-identifier hs-var">timelocks</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var">mkMultiSigWit</span></a></span><span> </span><span id="local-6989586621682729918"><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729918"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireMOf"><span class="hs-identifier hs-type">RequireMOf</span></a></span><span> </span><span id="local-6989586621682729919"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682729919"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682729920"><span class="annot"><span class="annottext">StrictSeq (NativeScript era)
</span><a href="#local-6989586621682729920"><span class="hs-identifier hs-var">timelocks</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621682729921"><span class="annot"><span class="annottext">[MultiSig era]
</span><a href="#local-6989586621682729921"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [MultiSig era] -&gt; [MultiSig era]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682729919"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">([MultiSig era] -&gt; [MultiSig era])
-&gt; RWST (GenEnv era) () (GenState era) Gen [MultiSig era]
-&gt; RWST (GenEnv era) () (GenState era) Gen [MultiSig era]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Gen [MultiSig era]
-&gt; RWST (GenEnv era) () (GenState era) Gen [MultiSig era]
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MultiSig era] -&gt; Gen [MultiSig era]
forall a. [a] -&gt; Gen [a]
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#shuffle"><span class="hs-identifier hs-var">shuffle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictSeq (MultiSig era) -&gt; [MultiSig era]
forall a. StrictSeq a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">StrictSeq (NativeScript era)
StrictSeq (MultiSig era)
</span><a href="#local-6989586621682729920"><span class="hs-identifier hs-var">timelocks</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>  </span><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era
forall a b. [a -&gt; b -&gt; b] -&gt; a -&gt; b -&gt; b
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#foldFn%27"><span class="hs-identifier hs-var">foldFn'</span></a></span><span> </span><span class="annot"><span class="annottext">([SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
 -&gt; SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(MultiSig era
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era))
-&gt; [MultiSig era]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; MultiSig era
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
(ShelleyEraScript era, NativeScript era ~ MultiSig era,
 Reflect era) =&gt;
Maybe PlutusPurposeTag
-&gt; MultiSig era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var">mkMultiSigWit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729918"><span class="hs-identifier hs-var">mTag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MultiSig era]
</span><a href="#local-6989586621682729921"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-262"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkMultiSigWit"><span class="hs-identifier hs-var">mkMultiSigWit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MultiSig era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Impossible: All NativeScripts should have been accounted for&quot;</span></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="annot"><span class="hs-comment">-- | Timeock scripts are used in Mary and subsequent Eras.</span></span><span>
</span><span id="line-265"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-type">mkTimelockWit</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682728985"><span class="annot"><a href="#local-6989586621682728985"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#AllegraEraScript"><span class="hs-identifier hs-type">AllegraEraScript</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728985"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#NativeScript"><span class="hs-identifier hs-type">NativeScript</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728985"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#Timelock"><span class="hs-identifier hs-type">Timelock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728985"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728985"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-268"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-269"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#Timelock"><span class="hs-identifier hs-type">Timelock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728985"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728985"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#SafeHash"><span class="hs-identifier hs-type">SafeHash</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#EraIndependentTxBody"><span class="hs-identifier hs-type">EraIndependentTxBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728985"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728985"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span id="mkTimelockWit"><span class="annot"><span class="annottext">mkTimelockWit :: forall era.
(AllegraEraScript era, NativeScript era ~ Timelock era,
 Reflect era) =&gt;
Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var hs-var">mkTimelockWit</span></a></span></span><span> </span><span id="local-6989586621682729974"><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729974"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireSignature"><span class="hs-identifier hs-type">RequireSignature</span></a></span><span> </span><span id="local-6989586621682729975"><span class="annot"><span class="annottext">KeyHash 'Witness
</span><a href="#local-6989586621682729975"><span class="hs-identifier hs-var">keyHash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; Credential 'Witness
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era (kr :: KeyRole).
Reflect era =&gt;
Maybe PlutusPurposeTag
-&gt; Credential kr
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-var">mkWitVKey</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729974"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'Witness -&gt; Credential 'Witness
forall (kr :: KeyRole). KeyHash kr -&gt; Credential kr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#KeyHashObj"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Witness
</span><a href="#local-6989586621682729975"><span class="hs-identifier hs-var">keyHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireAllOf"><span class="hs-identifier hs-type">RequireAllOf</span></a></span><span> </span><span id="local-6989586621682729976"><span class="annot"><span class="annottext">StrictSeq (NativeScript era)
</span><a href="#local-6989586621682729976"><span class="hs-identifier hs-var">timelocks</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era
forall a b. [a -&gt; b -&gt; b] -&gt; a -&gt; b -&gt; b
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#foldFn%27"><span class="hs-identifier hs-var">foldFn'</span></a></span><span> </span><span class="annot"><span class="annottext">([SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
 -&gt; SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Timelock era
 -&gt; GenRS
      era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era))
-&gt; [Timelock era]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
(AllegraEraScript era, NativeScript era ~ Timelock era,
 Reflect era) =&gt;
Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var">mkTimelockWit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729974"><span class="hs-identifier hs-var">mTag</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictSeq (Timelock era) -&gt; [Timelock era]
forall a. StrictSeq a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">StrictSeq (Timelock era)
StrictSeq (NativeScript era)
</span><a href="#local-6989586621682729976"><span class="hs-identifier hs-var">timelocks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireAnyOf"><span class="hs-identifier hs-type">RequireAnyOf</span></a></span><span> </span><span id="local-6989586621682729977"><span class="annot"><span class="annottext">StrictSeq (NativeScript era)
</span><a href="#local-6989586621682729977"><span class="hs-identifier hs-var">timelocks</span></a></span></span><span>
</span><span id="line-276"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">StrictSeq (Timelock era) -&gt; Bool
forall a. StrictSeq a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">F.null</span></span><span> </span><span class="annot"><span class="annottext">StrictSeq (Timelock era)
StrictSeq (NativeScript era)
</span><a href="#local-6989586621682729977"><span class="hs-identifier hs-var">timelocks</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxWits era -&gt; TxWits era)
-&gt; SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">TxWits era -&gt; TxWits era
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
(AllegraEraScript era, NativeScript era ~ Timelock era,
 Reflect era) =&gt;
Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var">mkTimelockWit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729974"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">(Timelock era
 -&gt; GenRS
      era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era))
-&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Gen (Timelock era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Timelock era)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Timelock era] -&gt; Gen (Timelock era)
forall a. HasCallStack =&gt; [a] -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#elements"><span class="hs-identifier hs-var">elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictSeq (Timelock era) -&gt; [Timelock era]
forall a. StrictSeq a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">StrictSeq (Timelock era)
StrictSeq (NativeScript era)
</span><a href="#local-6989586621682729977"><span class="hs-identifier hs-var">timelocks</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Scripts.html#RequireMOf"><span class="hs-identifier hs-type">RequireMOf</span></a></span><span> </span><span id="local-6989586621682729978"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682729978"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682729979"><span class="annot"><span class="annottext">StrictSeq (NativeScript era)
</span><a href="#local-6989586621682729979"><span class="hs-identifier hs-var">timelocks</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-279"></span><span>      </span><span id="local-6989586621682729980"><span class="annot"><span class="annottext">[Timelock era]
</span><a href="#local-6989586621682729980"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Timelock era] -&gt; [Timelock era]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682729978"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">([Timelock era] -&gt; [Timelock era])
-&gt; RWST (GenEnv era) () (GenState era) Gen [Timelock era]
-&gt; RWST (GenEnv era) () (GenState era) Gen [Timelock era]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Gen [Timelock era]
-&gt; RWST (GenEnv era) () (GenState era) Gen [Timelock era]
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Timelock era] -&gt; Gen [Timelock era]
forall a. [a] -&gt; Gen [a]
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#shuffle"><span class="hs-identifier hs-var">shuffle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictSeq (Timelock era) -&gt; [Timelock era]
forall a. StrictSeq a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">StrictSeq (Timelock era)
StrictSeq (NativeScript era)
</span><a href="#local-6989586621682729979"><span class="hs-identifier hs-var">timelocks</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>      </span><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era
forall a b. [a -&gt; b -&gt; b] -&gt; a -&gt; b -&gt; b
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#foldFn%27"><span class="hs-identifier hs-var">foldFn'</span></a></span><span> </span><span class="annot"><span class="annottext">([SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
 -&gt; SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Timelock era
 -&gt; GenRS
      era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era))
-&gt; [Timelock era]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
(AllegraEraScript era, NativeScript era ~ Timelock era,
 Reflect era) =&gt;
Maybe PlutusPurposeTag
-&gt; Timelock era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkTimelockWit"><span class="hs-identifier hs-var">mkTimelockWit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682729974"><span class="hs-identifier hs-var">mTag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Timelock era]
</span><a href="#local-6989586621682729980"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#RequireTimeStart"><span class="hs-identifier hs-type">RequireTimeStart</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxWits era -&gt; TxWits era)
-&gt; SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">TxWits era -&gt; TxWits era
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-allegra-1.9.0.0/doc/html/cardano-ledger-allegra/src/Cardano.Ledger.Allegra.Scripts.html#RequireTimeExpire"><span class="hs-identifier hs-type">RequireTimeExpire</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxWits era -&gt; TxWits era)
-&gt; SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">TxWits era -&gt; TxWits era
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><span class="annottext">Timelock era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Impossible: All NativeScripts should have been accounted for&quot;</span></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="annot"><span class="hs-comment">-- | Same as `genCredKeyWit`, but for `TxOuts`</span></span><span>
</span><span id="line-286"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOutKeyWitness"><span class="hs-identifier hs-type">genTxOutKeyWitness</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729064"><span class="annot"><a href="#local-6989586621682729064"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-288"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729064"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-289"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729064"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-291"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729064"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#SafeHash"><span class="hs-identifier hs-type">SafeHash</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#EraIndependentTxBody"><span class="hs-identifier hs-type">EraIndependentTxBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729064"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729064"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span id="genTxOutKeyWitness"><span class="annot"><span class="annottext">genTxOutKeyWitness :: forall era.
Reflect era =&gt;
Maybe PlutusPurposeTag
-&gt; TxOut era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOutKeyWitness"><span class="hs-identifier hs-var hs-var">genTxOutKeyWitness</span></a></span></span><span> </span><span id="local-6989586621682730004"><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682730004"><span class="hs-identifier hs-var">mTag</span></a></span></span><span> </span><span id="local-6989586621682730005"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682730005"><span class="hs-identifier hs-var">txOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682730005"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; Getting Addr (TxOut era) Addr -&gt; Addr
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Addr (TxOut era) Addr
forall era. EraTxOut era =&gt; Lens' (TxOut era) Addr
Lens' (TxOut era) Addr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#addrTxOutL"><span class="hs-identifier hs-var">addrTxOutL</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#AddrBootstrap"><span class="hs-identifier hs-type">AddrBootstrap</span></a></span><span> </span><span id="local-6989586621682730008"><span class="annot"><span class="annottext">BootstrapAddress
</span><a href="#local-6989586621682730008"><span class="hs-identifier hs-var">baddr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-295"></span><span>      </span><span class="annot"><span class="annottext">[Char]
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char]
 -&gt; GenRS
      era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era))
-&gt; [Char]
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Can't authorize bootstrap address: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">BootstrapAddress -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">BootstrapAddress
</span><a href="#local-6989586621682730008"><span class="hs-identifier hs-var">baddr</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682730010"><span class="annot"><span class="annottext">Credential 'Payment
</span><a href="#local-6989586621682730010"><span class="hs-identifier hs-var">payCred</span></a></span></span><span> </span><span class="annot"><span class="annottext">StakeReference
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-297"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Proof era -&gt; TxOut era -&gt; StrictMaybe (Script era)
forall era. Proof era -&gt; TxOut era -&gt; StrictMaybe (Script era)
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#getTxOutRefScript"><span class="hs-identifier hs-var">getTxOutRefScript</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682730005"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-298"></span><span>        </span><span class="annot"><span class="annottext">StrictMaybe (Script era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; Credential 'Payment
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era (kr :: KeyRole).
Reflect era =&gt;
Maybe PlutusPurposeTag
-&gt; Credential kr
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-var">mkWitVKey</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682730004"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Payment
</span><a href="#local-6989586621682730010"><span class="hs-identifier hs-var">payCred</span></a></span><span>
</span><span id="line-299"></span><span>        </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-type">SJust</span></a></span><span> </span><span id="local-6989586621682730014"><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682730014"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-300"></span><span>          </span><span id="local-6989586621682730015"><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era
</span><a href="#local-6989586621682730015"><span class="hs-identifier hs-var">f1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; Credential 'Payment
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era (kr :: KeyRole).
Reflect era =&gt;
Maybe PlutusPurposeTag
-&gt; Credential kr
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-var">mkWitVKey</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
</span><a href="#local-6989586621682730004"><span class="hs-identifier hs-var">mTag</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Payment
</span><a href="#local-6989586621682730010"><span class="hs-identifier hs-var">payCred</span></a></span><span>
</span><span id="line-301"></span><span>          </span><span id="local-6989586621682730016"><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era
</span><a href="#local-6989586621682730016"><span class="hs-identifier hs-var">f2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; Script era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
Reflect era =&gt;
Maybe PlutusPurposeTag
-&gt; Script era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genGenericScriptWitness"><span class="hs-identifier hs-var">genGenericScriptWitness</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlutusPurposeTag -&gt; Maybe PlutusPurposeTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682730014"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-302"></span><span>          </span><span class="annot"><span class="annottext">(SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682730017"><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody
</span><a href="#local-6989586621682730017"><span class="hs-identifier hs-var">safehash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era
</span><a href="#local-6989586621682730015"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody
</span><a href="#local-6989586621682730017"><span class="hs-identifier hs-var">safehash</span></a></span><span> </span><span class="annot"><span class="annottext">(TxWits era -&gt; TxWits era)
-&gt; (TxWits era -&gt; TxWits era) -&gt; TxWits era -&gt; TxWits era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era
</span><a href="#local-6989586621682730016"><span class="hs-identifier hs-var">f2</span></a></span><span> </span><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody
</span><a href="#local-6989586621682730017"><span class="hs-identifier hs-var">safehash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#makeDatumWitness"><span class="hs-identifier hs-type">makeDatumWitness</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729076"><span class="annot"><a href="#local-6989586621682729076"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729076"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729076"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729076"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729076"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729076"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span id="makeDatumWitness"><span class="annot"><span class="annottext">makeDatumWitness :: forall era.
Reflect era =&gt;
TxOut era -&gt; GenRS era (TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#makeDatumWitness"><span class="hs-identifier hs-var hs-var">makeDatumWitness</span></a></span></span><span> </span><span id="local-6989586621682730034"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682730034"><span class="hs-identifier hs-var">txout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682730035"><span class="annot"><span class="annottext">proof :: Proof era
</span><a href="#local-6989586621682730035"><span class="hs-identifier hs-var hs-var">proof</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682729076"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-307"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621682730035"><span class="hs-identifier hs-var">proof</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682730034"><span class="hs-identifier hs-var">txout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-308"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-babbage-1.12.1.0/doc/html/cardano-ledger-babbage/src/Cardano.Ledger.Babbage.TxOut.html#BabbageTxOut"><span class="hs-identifier hs-type">BabbageTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value BabbageEra
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#DatumHash"><span class="hs-identifier hs-type">DatumHash</span></a></span><span> </span><span id="local-6989586621682730048"><span class="annot"><span class="annottext">DataHash
</span><a href="#local-6989586621682730048"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Script BabbageEra)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StrictMaybe DataHash -&gt; GenRS era (TxWits era -&gt; TxWits era)
forall era'.
AlonzoEraTxWits era' =&gt;
StrictMaybe DataHash -&gt; GenRS era' (TxWits era' -&gt; TxWits era')
</span><a href="#local-6989586621682730049"><span class="hs-identifier hs-var">mkDatumWit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataHash -&gt; StrictMaybe DataHash
forall a. a -&gt; StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">DataHash
</span><a href="#local-6989586621682730048"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-babbage-1.12.1.0/doc/html/cardano-ledger-babbage/src/Cardano.Ledger.Babbage.TxOut.html#BabbageTxOut"><span class="hs-identifier hs-type">BabbageTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value BabbageEra
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#Datum"><span class="hs-identifier hs-type">Datum</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryData BabbageEra
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Script BabbageEra)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(AlonzoTxWits BabbageEra -&gt; AlonzoTxWits BabbageEra)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (AlonzoTxWits BabbageEra -&gt; AlonzoTxWits BabbageEra)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">AlonzoTxWits BabbageEra -&gt; AlonzoTxWits BabbageEra
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-310"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-babbage-1.12.1.0/doc/html/cardano-ledger-babbage/src/Cardano.Ledger.Babbage.TxOut.html#BabbageTxOut"><span class="hs-identifier hs-type">BabbageTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value BabbageEra
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Datum BabbageEra
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#NoDatum"><span class="hs-identifier hs-var">NoDatum</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Script BabbageEra)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(AlonzoTxWits BabbageEra -&gt; AlonzoTxWits BabbageEra)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (AlonzoTxWits BabbageEra -&gt; AlonzoTxWits BabbageEra)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">AlonzoTxWits BabbageEra -&gt; AlonzoTxWits BabbageEra
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-babbage-1.12.1.0/doc/html/cardano-ledger-babbage/src/Cardano.Ledger.Babbage.TxOut.html#BabbageTxOut"><span class="hs-identifier hs-type">BabbageTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value ConwayEra
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#DatumHash"><span class="hs-identifier hs-type">DatumHash</span></a></span><span> </span><span id="local-6989586621682730080"><span class="annot"><span class="annottext">DataHash
</span><a href="#local-6989586621682730080"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Script ConwayEra)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StrictMaybe DataHash -&gt; GenRS era (TxWits era -&gt; TxWits era)
forall era'.
AlonzoEraTxWits era' =&gt;
StrictMaybe DataHash -&gt; GenRS era' (TxWits era' -&gt; TxWits era')
</span><a href="#local-6989586621682730049"><span class="hs-identifier hs-var">mkDatumWit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataHash -&gt; StrictMaybe DataHash
forall a. a -&gt; StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">DataHash
</span><a href="#local-6989586621682730080"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-babbage-1.12.1.0/doc/html/cardano-ledger-babbage/src/Cardano.Ledger.Babbage.TxOut.html#BabbageTxOut"><span class="hs-identifier hs-type">BabbageTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value ConwayEra
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#Datum"><span class="hs-identifier hs-type">Datum</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryData ConwayEra
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Script ConwayEra)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(AlonzoTxWits ConwayEra -&gt; AlonzoTxWits ConwayEra)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (AlonzoTxWits ConwayEra -&gt; AlonzoTxWits ConwayEra)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">AlonzoTxWits ConwayEra -&gt; AlonzoTxWits ConwayEra
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-313"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-babbage-1.12.1.0/doc/html/cardano-ledger-babbage/src/Cardano.Ledger.Babbage.TxOut.html#BabbageTxOut"><span class="hs-identifier hs-type">BabbageTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value ConwayEra
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Datum ConwayEra
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#NoDatum"><span class="hs-identifier hs-var">NoDatum</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Script ConwayEra)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(AlonzoTxWits ConwayEra -&gt; AlonzoTxWits ConwayEra)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (AlonzoTxWits ConwayEra -&gt; AlonzoTxWits ConwayEra)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">AlonzoTxWits ConwayEra -&gt; AlonzoTxWits ConwayEra
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-314"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-var">Alonzo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxOut.html#AlonzoTxOut"><span class="hs-identifier hs-type">AlonzoTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value AlonzoEra
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682730111"><span class="annot"><span class="annottext">StrictMaybe DataHash
</span><a href="#local-6989586621682730111"><span class="hs-identifier hs-var">mDatum</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StrictMaybe DataHash -&gt; GenRS era (TxWits era -&gt; TxWits era)
forall era'.
AlonzoEraTxWits era' =&gt;
StrictMaybe DataHash -&gt; GenRS era' (TxWits era' -&gt; TxWits era')
</span><a href="#local-6989586621682730049"><span class="hs-identifier hs-var">mkDatumWit</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe DataHash
</span><a href="#local-6989586621682730111"><span class="hs-identifier hs-var">mDatum</span></a></span><span>
</span><span id="line-315"></span><span>        </span><span class="annot"><span class="annottext">(Proof era, TxOut era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TxWits era -&gt; TxWits era) -&gt; GenRS era (TxWits era -&gt; TxWits era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TxWits era -&gt; TxWits era
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-comment">-- No other era has data witnesses</span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><a href="#local-6989586621682730049"><span class="hs-identifier hs-type">mkDatumWit</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-318"></span><span>      </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729087"><span class="annot"><a href="#local-6989586621682729087"><span class="hs-identifier hs-type">era'</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxWits.html#AlonzoEraTxWits"><span class="hs-identifier hs-type">AlonzoEraTxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729087"><span class="hs-identifier hs-type">era'</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#StrictMaybe"><span class="hs-identifier hs-type">StrictMaybe</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#DataHash"><span class="hs-identifier hs-type">DataHash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729087"><span class="hs-identifier hs-type">era'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729087"><span class="hs-identifier hs-type">era'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729087"><span class="hs-identifier hs-type">era'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>    </span><span id="local-6989586621682730049"><span class="annot"><span class="annottext">mkDatumWit :: forall era'.
AlonzoEraTxWits era' =&gt;
StrictMaybe DataHash -&gt; GenRS era' (TxWits era' -&gt; TxWits era')
</span><a href="#local-6989586621682730049"><span class="hs-identifier hs-var hs-var">mkDatumWit</span></a></span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe DataHash
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxWits era' -&gt; TxWits era')
-&gt; RWST
     (GenEnv era') () (GenState era') Gen (TxWits era' -&gt; TxWits era')
forall a. a -&gt; RWST (GenEnv era') () (GenState era') Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TxWits era' -&gt; TxWits era'
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><a href="#local-6989586621682730049"><span class="hs-identifier hs-var">mkDatumWit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-type">SJust</span></a></span><span> </span><span id="local-6989586621682730134"><span class="annot"><span class="annottext">DataHash
</span><a href="#local-6989586621682730134"><span class="hs-identifier hs-var">datumHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-321"></span><span>      </span><span id="local-6989586621682730135"><span class="annot"><span class="annottext">Data era'
</span><a href="#local-6989586621682730135"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; DataHash
-&gt; (GenState era' -&gt; Map DataHash (Data era'))
-&gt; GenRS era' (Data era')
forall k era v.
(Ord k, Show k, HasCallStack) =&gt;
[Char] -&gt; k -&gt; (GenState era -&gt; Map k v) -&gt; GenRS era v
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupByKeyM"><span class="hs-identifier hs-var">lookupByKeyM</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;datum&quot;</span></span><span> </span><span class="annot"><span class="annottext">DataHash
</span><a href="#local-6989586621682730134"><span class="hs-identifier hs-var">datumHash</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era' -&gt; Map DataHash (Data era')
forall era. GenState era -&gt; Map DataHash (Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsDatums"><span class="hs-identifier hs-var">gsDatums</span></a></span><span>
</span><span id="line-322"></span><span>      </span><span class="annot"><span class="annottext">(TxWits era' -&gt; TxWits era')
-&gt; RWST
     (GenEnv era') () (GenState era') Gen (TxWits era' -&gt; TxWits era')
forall a. a -&gt; RWST (GenEnv era') () (GenState era') Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">((TxWits era' -&gt; TxWits era')
 -&gt; RWST
      (GenEnv era') () (GenState era') Gen (TxWits era' -&gt; TxWits era'))
-&gt; (TxWits era' -&gt; TxWits era')
-&gt; RWST
     (GenEnv era') () (GenState era') Gen (TxWits era' -&gt; TxWits era')
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall era. AlonzoEraTxWits era =&gt; Lens' (TxWits era) (TxDats era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxWits.html#datsTxWitsL"><span class="hs-identifier hs-var">datsTxWitsL</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682729087"><span class="hs-identifier hs-type">era'</span></a></span><span> </span><span class="annot"><span class="annottext">((TxDats era' -&gt; Identity (TxDats era'))
 -&gt; TxWits era' -&gt; Identity (TxWits era'))
-&gt; TxDats era' -&gt; TxWits era' -&gt; TxWits era'
forall a s t. Monoid a =&gt; ASetter s t a a -&gt; a -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%3C%3E~"><span class="hs-operator hs-var">&lt;&gt;~</span></a></span><span> </span><span class="annot"><span class="annottext">Map DataHash (Data era') -&gt; TxDats era'
forall era. Era era =&gt; Map DataHash (Data era) -&gt; TxDats era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxWits.html#TxDats"><span class="hs-identifier hs-var">TxDats</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Data era' -&gt; DataHash
forall era. Data era -&gt; DataHash
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#hashData"><span class="hs-identifier hs-var">hashData</span></a></span><span> </span><span class="annot"><span class="annottext">Data era'
</span><a href="#local-6989586621682730135"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Data era'
</span><a href="#local-6989586621682730135"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="annot"><span class="hs-comment">-- | Does the current Credential point to a PlutusScript? If so return its IsValid and Hash</span></span><span>
</span><span id="line-325"></span><span id="local-6989586621682729101"><span id="local-6989586621682729102"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#plutusScriptHashFromTag"><span class="hs-identifier hs-type">plutusScriptHashFromTag</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729101"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-328"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729102"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#IsValid"><span class="hs-identifier hs-type">IsValid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-329"></span><span id="plutusScriptHashFromTag"><span class="annot"><span class="annottext">plutusScriptHashFromTag :: forall (k :: KeyRole) era.
Credential k
-&gt; PlutusPurposeTag -&gt; GenRS era (Maybe (IsValid, ScriptHash))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#plutusScriptHashFromTag"><span class="hs-identifier hs-var hs-var">plutusScriptHashFromTag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#KeyHashObj"><span class="hs-identifier hs-type">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash k
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (IsValid, ScriptHash)
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Maybe (IsValid, ScriptHash))
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (IsValid, ScriptHash)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-330"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#plutusScriptHashFromTag"><span class="hs-identifier hs-var">plutusScriptHashFromTag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#ScriptHashObj"><span class="hs-identifier hs-type">ScriptHashObj</span></a></span><span> </span><span id="local-6989586621682730151"><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682730151"><span class="hs-identifier hs-var">scriptHash</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682730152"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682730152"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-331"></span><span>  </span><span class="annot"><span class="annottext">(GenState era -&gt; Maybe (IsValid, Script era))
-&gt; RWST (GenEnv era) () (GenState era) Gen (GenState era)
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Maybe (IsValid, Script era))
forall a b.
(a -&gt; b)
-&gt; RWST (GenEnv era) () (GenState era) Gen a
-&gt; RWST (GenEnv era) () (GenState era) Gen b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ScriptHash, PlutusPurposeTag)
-&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
-&gt; Maybe (IsValid, Script era)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682730151"><span class="hs-identifier hs-var">scriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682730152"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
 -&gt; Maybe (IsValid, Script era))
-&gt; (GenState era
    -&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era))
-&gt; GenState era
-&gt; Maybe (IsValid, Script era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era
-&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
forall era.
GenState era
-&gt; Map (ScriptHash, PlutusPurposeTag) (IsValid, Script era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsPlutusScripts"><span class="hs-identifier hs-var">gsPlutusScripts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (GenState era)
forall w (m :: * -&gt; *) r s. (Monoid w, Monad m) =&gt; RWST r w s m s
</span><span class="hs-identifier hs-var">get</span></span><span> </span><span class="annot"><span class="annottext">RWST
  (GenEnv era) () (GenState era) Gen (Maybe (IsValid, Script era))
-&gt; (Maybe (IsValid, Script era) -&gt; Maybe (IsValid, ScriptHash))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Maybe (IsValid, ScriptHash))
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><span class="annottext">Maybe (IsValid, Script era)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (IsValid, ScriptHash)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682730153"><span class="annot"><span class="annottext">IsValid
</span><a href="#local-6989586621682730153"><span class="hs-identifier hs-var">isValid</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Script era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(IsValid, ScriptHash) -&gt; Maybe (IsValid, ScriptHash)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsValid
</span><a href="#local-6989586621682730153"><span class="hs-identifier hs-var">isValid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682730151"><span class="hs-identifier hs-var">scriptHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-comment">-- | Make RdmrWits WitnessesField only if the Credential is for a Plutus Script</span><span>
</span><span id="line-336"></span><span class="hs-comment">--  And it is in the spending inputs, not the reference inputs</span><span>
</span><span id="line-337"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#redeemerWitnessMaker"><span class="hs-identifier hs-type">redeemerWitnessMaker</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729111"><span class="annot"><a href="#local-6989586621682729111"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621682729113"><span class="annot"><a href="#local-6989586621682729113"><span class="hs-identifier hs-type">k</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-339"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729111"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-340"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#PlutusPurposeTag"><span class="hs-identifier hs-type">PlutusPurposeTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729111"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729111"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729113"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-342"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729111"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#IsValid"><span class="hs-identifier hs-type">IsValid</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.ExUnits.html#ExUnits"><span class="hs-identifier hs-type">ExUnits</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729111"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729111"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span id="redeemerWitnessMaker"><span class="annot"><span class="annottext">redeemerWitnessMaker :: forall era (k :: KeyRole).
EraGenericGen era =&gt;
PlutusPurposeTag
-&gt; [Maybe (GenRS era (Data era), Credential k)]
-&gt; GenRS era (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#redeemerWitnessMaker"><span class="hs-identifier hs-var hs-var">redeemerWitnessMaker</span></a></span></span><span> </span><span id="local-6989586621682730184"><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682730184"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621682730185"><span class="annot"><span class="annottext">[Maybe
   (RWST (GenEnv era) () (GenState era) Gen (Data era), Credential k)]
</span><a href="#local-6989586621682730185"><span class="hs-identifier hs-var">listWithCred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-344"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682730186"><span class="annot"><span class="annottext">creds :: [(Word32, RWST (GenEnv era) () (GenState era) Gen (Data era),
  Credential k)]
</span><a href="#local-6989586621682730186"><span class="hs-identifier hs-var hs-var">creds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682730187"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (Data era)
</span><a href="#local-6989586621682730188"><span class="hs-identifier hs-var">genDat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Credential k
</span><a href="#local-6989586621682730189"><span class="hs-identifier hs-var">cred</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682730187"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682730187"><span class="hs-identifier hs-var">ix</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682730190"><span class="annot"><span class="annottext">Maybe
  (RWST (GenEnv era) () (GenState era) Gen (Data era), Credential k)
</span><a href="#local-6989586621682730190"><span class="hs-identifier hs-var">mCred</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Word32]
-&gt; [Maybe
      (RWST (GenEnv era) () (GenState era) Gen (Data era), Credential k)]
-&gt; [(Word32,
     Maybe
       (RWST (GenEnv era) () (GenState era) Gen (Data era),
        Credential k))]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word32
Item [Word32]
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Maybe
   (RWST (GenEnv era) () (GenState era) Gen (Data era), Credential k)]
</span><a href="#local-6989586621682730185"><span class="hs-identifier hs-var">listWithCred</span></a></span><span>
</span><span id="line-347"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682730188"><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (Data era)
</span><a href="#local-6989586621682730188"><span class="hs-identifier hs-var">genDat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682730189"><span class="annot"><span class="annottext">Credential k
</span><a href="#local-6989586621682730189"><span class="hs-identifier hs-var">cred</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe
  (RWST (GenEnv era) () (GenState era) Gen (Data era), Credential k)
Item
  [Maybe
     (RWST (GenEnv era) () (GenState era) Gen (Data era), Credential k)]
</span><a href="#local-6989586621682730190"><span class="hs-identifier hs-var">mCred</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-348"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-349"></span><span>      </span><span class="annot"><a href="#local-6989586621682730191"><span class="hs-identifier hs-type">allValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#IsValid"><span class="hs-identifier hs-type">IsValid</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#IsValid"><span class="hs-identifier hs-type">IsValid</span></a></span><span>
</span><span id="line-350"></span><span>      </span><span id="local-6989586621682730191"><span class="annot"><span class="annottext">allValid :: [IsValid] -&gt; IsValid
</span><a href="#local-6989586621682730191"><span class="hs-identifier hs-var hs-var">allValid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IsValid
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IsValid) -&gt; ([IsValid] -&gt; Bool) -&gt; [IsValid] -&gt; IsValid
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">All -&gt; Bool
</span><span class="hs-identifier hs-var">getAll</span></span><span> </span><span class="annot"><span class="annottext">(All -&gt; Bool) -&gt; ([IsValid] -&gt; All) -&gt; [IsValid] -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(IsValid -&gt; All) -&gt; [IsValid] -&gt; All
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#IsValid"><span class="hs-identifier hs-type">IsValid</span></a></span><span> </span><span id="local-6989586621682730195"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682730195"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><span class="hs-identifier hs-var">All</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682730195"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">([Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)]
 -&gt; (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era]))
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era])
forall a b.
(a -&gt; b)
-&gt; RWST (GenEnv era) () (GenState era) Gen a
-&gt; RWST (GenEnv era) () (GenState era) Gen b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([IsValid] -&gt; IsValid)
-&gt; ([IsValid], [ExUnits -&gt; TxWits era -&gt; TxWits era])
-&gt; (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era])
forall a b c. (a -&gt; b) -&gt; (a, c) -&gt; (b, c)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">[IsValid] -&gt; IsValid
</span><a href="#local-6989586621682730191"><span class="hs-identifier hs-var">allValid</span></a></span><span> </span><span class="annot"><span class="annottext">(([IsValid], [ExUnits -&gt; TxWits era -&gt; TxWits era])
 -&gt; (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era]))
-&gt; ([Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)]
    -&gt; ([IsValid], [ExUnits -&gt; TxWits era -&gt; TxWits era]))
-&gt; [Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)]
-&gt; (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)]
-&gt; ([IsValid], [ExUnits -&gt; TxWits era -&gt; TxWits era])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">([(IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)]
 -&gt; ([IsValid], [ExUnits -&gt; TxWits era -&gt; TxWits era]))
-&gt; ([Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)]
    -&gt; [(IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)])
-&gt; [Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)]
-&gt; ([IsValid], [ExUnits -&gt; TxWits era -&gt; TxWits era])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)]
-&gt; [(IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RWST
   (GenEnv era)
   ()
   (GenState era)
   Gen
   [Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)]
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era]))
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-352"></span><span>        </span><span class="annot"><span class="annottext">[(Word32, RWST (GenEnv era) () (GenState era) Gen (Data era),
  Credential k)]
-&gt; ((Word32, RWST (GenEnv era) () (GenState era) Gen (Data era),
     Credential k)
    -&gt; RWST
         (GenEnv era)
         ()
         (GenState era)
         Gen
         (Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)))
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">[(Word32, RWST (GenEnv era) () (GenState era) Gen (Data era),
  Credential k)]
</span><a href="#local-6989586621682730186"><span class="hs-identifier hs-var">creds</span></a></span><span> </span><span class="annot"><span class="annottext">(((Word32, RWST (GenEnv era) () (GenState era) Gen (Data era),
   Credential k)
  -&gt; RWST
       (GenEnv era)
       ()
       (GenState era)
       Gen
       (Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)))
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      [Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)])
-&gt; ((Word32, RWST (GenEnv era) () (GenState era) Gen (Data era),
     Credential k)
    -&gt; RWST
         (GenEnv era)
         ()
         (GenState era)
         Gen
         (Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)))
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682730198"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682730198"><span class="hs-identifier hs-var">ix</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682730199"><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (Data era)
</span><a href="#local-6989586621682730199"><span class="hs-identifier hs-var">genDat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682730200"><span class="annot"><span class="annottext">Credential k
</span><a href="#local-6989586621682730200"><span class="hs-identifier hs-var">cred</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-353"></span><span>          </span><span class="annot"><span class="annottext">Credential k
-&gt; PlutusPurposeTag -&gt; GenRS era (Maybe (IsValid, ScriptHash))
forall (k :: KeyRole) era.
Credential k
-&gt; PlutusPurposeTag -&gt; GenRS era (Maybe (IsValid, ScriptHash))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#plutusScriptHashFromTag"><span class="hs-identifier hs-var">plutusScriptHashFromTag</span></a></span><span> </span><span class="annot"><span class="annottext">Credential k
</span><a href="#local-6989586621682730200"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682730184"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">GenRS era (Maybe (IsValid, ScriptHash))
-&gt; (Maybe (IsValid, ScriptHash)
    -&gt; RWST
         (GenEnv era)
         ()
         (GenState era)
         Gen
         (Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)))
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era))
forall a b.
RWST (GenEnv era) () (GenState era) Gen a
-&gt; (a -&gt; RWST (GenEnv era) () (GenState era) Gen b)
-&gt; RWST (GenEnv era) () (GenState era) Gen b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-354"></span><span>            </span><span class="annot"><span class="annottext">Maybe (IsValid, ScriptHash)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era))
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-355"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682730201"><span class="annot"><span class="annottext">IsValid
</span><a href="#local-6989586621682730201"><span class="hs-identifier hs-var">isValid</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-356"></span><span>              </span><span id="local-6989586621682730202"><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621682730202"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (Data era)
</span><a href="#local-6989586621682730199"><span class="hs-identifier hs-var">genDat</span></a></span><span>
</span><span id="line-357"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682730203"><span class="annot"><span class="annottext">mkWit3 :: ExUnits -&gt; TxWits era -&gt; TxWits era
</span><a href="#local-6989586621682730203"><span class="hs-identifier hs-var hs-var">mkWit3</span></a></span></span><span> </span><span id="local-6989586621682730204"><span class="annot"><span class="annottext">ExUnits
</span><a href="#local-6989586621682730204"><span class="hs-identifier hs-var">exUnits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-358"></span><span>                    </span><span class="annot"><span class="annottext">Redeemers era -&gt; TxWits era -&gt; TxWits era
forall era.
EraGenericGen era =&gt;
Redeemers era -&gt; TxWits era -&gt; TxWits era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#addRedeemers"><span class="hs-identifier hs-var">addRedeemers</span></a></span><span> </span><span class="annot"><span class="annottext">(Redeemers era -&gt; TxWits era -&gt; TxWits era)
-&gt; Redeemers era -&gt; TxWits era -&gt; TxWits era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall era.
EraModel era =&gt;
[((PlutusPurposeTag, Word32), (Data era, ExUnits))]
-&gt; Redeemers era
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#mkRedeemersFromTags"><span class="hs-identifier hs-var">mkRedeemersFromTags</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682729111"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="#local-6989586621682730184"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682730198"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621682730202"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExUnits
</span><a href="#local-6989586621682730204"><span class="hs-identifier hs-var">exUnits</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-359"></span><span>              </span><span class="hs-comment">-- we should not add this if the tx turns out to be in the reference inputs.</span><span>
</span><span id="line-360"></span><span>              </span><span class="hs-comment">-- we accomplish this by not calling this function on referenceInputs</span><span>
</span><span id="line-361"></span><span>              </span><span class="annot"><span class="annottext">Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era))
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)))
-&gt; Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)
-&gt; Maybe (IsValid, ExUnits -&gt; TxWits era -&gt; TxWits era)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsValid
</span><a href="#local-6989586621682730201"><span class="hs-identifier hs-var">isValid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExUnits -&gt; TxWits era -&gt; TxWits era
</span><a href="#local-6989586621682730203"><span class="hs-identifier hs-var">mkWit3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">-- ===================================================================================</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- Now we start actual generators that create things and enter them into</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- the GenState, and sometimes into the Model.</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">-- | Collaterals can't have scripts, this is where this generator is needed.</span><span>
</span><span id="line-368"></span><span class="hs-comment">--   As we generate this we add to the gsKeys field of the GenState.</span><span>
</span><span id="line-369"></span><span id="local-6989586621682729134"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genNoScriptRecipient"><span class="hs-identifier hs-type">genNoScriptRecipient</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729134"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span></span><span>
</span><span id="line-370"></span><span id="genNoScriptRecipient"><span class="annot"><span class="annottext">genNoScriptRecipient :: forall era. GenRS era Addr
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genNoScriptRecipient"><span class="hs-identifier hs-var hs-var">genNoScriptRecipient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-371"></span><span>  </span><span id="local-6989586621682730218"><span class="annot"><span class="annottext">KeyHash 'Payment
</span><a href="#local-6989586621682730218"><span class="hs-identifier hs-var">paymentCred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (kr :: KeyRole) era. GenRS era (KeyHash kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier hs-var">genKeyHash</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Payment"><span class="hs-identifier hs-type">Payment</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span id="local-6989586621682730219"><span class="annot"><span class="annottext">KeyHash 'Staking
</span><a href="#local-6989586621682730219"><span class="hs-identifier hs-var">stakeCred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (kr :: KeyRole) era. GenRS era (KeyHash kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genKeyHash"><span class="hs-identifier hs-var">genKeyHash</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span>
</span><span id="line-373"></span><span>  </span><span class="annot"><span class="annottext">Addr -&gt; GenRS era Addr
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'Payment -&gt; KeyHash 'Staking -&gt; Addr
forall p s.
(MakeCredential p 'Payment, MakeStakeReference s) =&gt;
p -&gt; s -&gt; Addr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Core.KeyPair.html#mkAddr"><span class="hs-identifier hs-var">mkAddr</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Payment
</span><a href="#local-6989586621682730218"><span class="hs-identifier hs-var">paymentCred</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Staking
</span><a href="#local-6989586621682730219"><span class="hs-identifier hs-var">stakeCred</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="annot"><span class="hs-comment">-- | Sometimes generates new Credentials, and some times reuses old ones</span></span><span>
</span><span id="line-376"></span><span id="local-6989586621682728912"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRecipient"><span class="hs-identifier hs-type">genRecipient</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728912"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728912"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span></span><span>
</span><span id="line-377"></span><span id="genRecipient"><span class="annot"><span class="annottext">genRecipient :: forall era. Reflect era =&gt; GenRS era Addr
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRecipient"><span class="hs-identifier hs-var hs-var">genRecipient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-378"></span><span>  </span><span id="local-6989586621682730233"><span class="annot"><span class="annottext">Credential 'Payment
</span><a href="#local-6989586621682730233"><span class="hs-identifier hs-var">paymentCred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (kr :: KeyRole) era.
Reflect era =&gt;
PlutusPurposeTag -&gt; GenRS era (Credential kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genCredential"><span class="hs-identifier hs-var">genCredential</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Payment"><span class="hs-identifier hs-type">Payment</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span id="local-6989586621682730234"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682730234"><span class="hs-identifier hs-var">stakeCred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (kr :: KeyRole) era.
Reflect era =&gt;
PlutusPurposeTag -&gt; GenRS era (Credential kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genCredential"><span class="hs-identifier hs-var">genCredential</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span>
</span><span id="line-380"></span><span>  </span><span class="annot"><span class="annottext">Addr -&gt; GenRS era Addr
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential 'Payment -&gt; Credential 'Staking -&gt; Addr
forall p s.
(MakeCredential p 'Payment, MakeStakeReference s) =&gt;
p -&gt; s -&gt; Addr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Core.KeyPair.html#mkAddr"><span class="hs-identifier hs-var">mkAddr</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Payment
</span><a href="#local-6989586621682730233"><span class="hs-identifier hs-var">paymentCred</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682730234"><span class="hs-identifier hs-var">stakeCred</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span id="local-6989586621682729148"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genDatum"><span class="hs-identifier hs-type">genDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729148"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729148"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729148"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-383"></span><span id="genDatum"><span class="annot"><span class="annottext">genDatum :: forall era. Era era =&gt; GenRS era (Data era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genDatum"><span class="hs-identifier hs-var hs-var">genDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DataHash, Data era) -&gt; Data era
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((DataHash, Data era) -&gt; Data era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (DataHash, Data era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Data era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (DataHash, Data era)
forall era. Era era =&gt; GenRS era (DataHash, Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genDatumWithHash"><span class="hs-identifier hs-var">genDatumWithHash</span></a></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="hs-comment">-- | Generate a Babbage Datum witness to use as a redeemer for a Plutus Script.</span><span>
</span><span id="line-386"></span><span class="hs-comment">--   TxWits can be a ScriptHash, or an inline Datum</span><span>
</span><span id="line-387"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genBabbageDatum"><span class="hs-identifier hs-type">genBabbageDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729151"><span class="annot"><a href="#local-6989586621682729151"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729151"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729151"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#Datum"><span class="hs-identifier hs-type">Datum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729151"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span id="genBabbageDatum"><span class="annot"><span class="annottext">genBabbageDatum :: forall era. Era era =&gt; GenRS era (Datum era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genBabbageDatum"><span class="hs-identifier hs-var hs-var">genBabbageDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-389"></span><span>  </span><span class="annot"><span class="annottext">[(Int, RWST (GenEnv era) () (GenState era) Gen (Datum era))]
-&gt; RWST (GenEnv era) () (GenState era) Gen (Datum era)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span>
</span><span id="line-390"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DataHash -&gt; Datum era
forall era. DataHash -&gt; Datum era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#DatumHash"><span class="hs-identifier hs-var">DatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">(DataHash -&gt; Datum era)
-&gt; ((DataHash, Data era) -&gt; DataHash)
-&gt; (DataHash, Data era)
-&gt; Datum era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DataHash, Data era) -&gt; DataHash
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((DataHash, Data era) -&gt; Datum era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (DataHash, Data era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Datum era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (DataHash, Data era)
forall era. Era era =&gt; GenRS era (DataHash, Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genDatumWithHash"><span class="hs-identifier hs-var">genDatumWithHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BinaryData era -&gt; Datum era
forall era. BinaryData era -&gt; Datum era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#Datum"><span class="hs-identifier hs-var">Datum</span></a></span><span> </span><span class="annot"><span class="annottext">(BinaryData era -&gt; Datum era)
-&gt; ((DataHash, Data era) -&gt; BinaryData era)
-&gt; (DataHash, Data era)
-&gt; Datum era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Data era -&gt; BinaryData era
forall era. Data era -&gt; BinaryData era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.Data.html#dataToBinaryData"><span class="hs-identifier hs-var">dataToBinaryData</span></a></span><span> </span><span class="annot"><span class="annottext">(Data era -&gt; BinaryData era)
-&gt; ((DataHash, Data era) -&gt; Data era)
-&gt; (DataHash, Data era)
-&gt; BinaryData era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DataHash, Data era) -&gt; Data era
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((DataHash, Data era) -&gt; Datum era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (DataHash, Data era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Datum era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (DataHash, Data era)
forall era. Era era =&gt; GenRS era (DataHash, Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genDatumWithHash"><span class="hs-identifier hs-var">genDatumWithHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span id="local-6989586621682729159"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRefScript"><span class="hs-identifier hs-type">genRefScript</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729159"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729159"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#StrictMaybe"><span class="hs-identifier hs-type">StrictMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Script"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729159"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-395"></span><span id="genRefScript"><span class="annot"><span class="annottext">genRefScript :: forall era. Reflect era =&gt; GenRS era (StrictMaybe (Script era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRefScript"><span class="hs-identifier hs-var hs-var">genRefScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-396"></span><span>  </span><span id="local-6989586621682730267"><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682730267"><span class="hs-identifier hs-var">scripthash</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag -&gt; GenRS era ScriptHash
forall era. Reflect era =&gt; PlutusPurposeTag -&gt; GenRS era ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genScript"><span class="hs-identifier hs-var">genScript</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span>
</span><span id="line-397"></span><span>  </span><span id="local-6989586621682730268"><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="#local-6989586621682730268"><span class="hs-identifier hs-var">mscript</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ScriptHash
-&gt; Maybe PlutusPurposeTag
-&gt; RWST (GenEnv era) () (GenState era) Gen (Maybe (Script era))
forall era.
ScriptHash
-&gt; Maybe PlutusPurposeTag -&gt; GenRS era (Maybe (Script era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupScript"><span class="hs-identifier hs-var">lookupScript</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682730267"><span class="hs-identifier hs-var">scripthash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlutusPurposeTag -&gt; Maybe PlutusPurposeTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="#local-6989586621682730268"><span class="hs-identifier hs-var">mscript</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Script era) -&gt; GenRS era (StrictMaybe (Script era))
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Script era)
forall a. StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-400"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682730269"><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682730269"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StrictMaybe (Script era) -&gt; GenRS era (StrictMaybe (Script era))
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Script era -&gt; StrictMaybe (Script era)
forall a. a -&gt; StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621682730269"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="annot"><span class="hs-comment">-- | Gen the Datum and RefScript fields of a TxOut by Analyzing the payment credential's script</span></span><span>
</span><span id="line-403"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genDataHashField"><span class="hs-identifier hs-type">genDataHashField</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682728930"><span class="annot"><a href="#local-6989586621682728930"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728930"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Script"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728930"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728930"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728930"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682728930"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span id="genDataHashField"><span class="annot"><span class="annottext">genDataHashField :: forall era.
Reflect era =&gt;
Maybe (Script era) -&gt; GenRS era (TxOut era -&gt; TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genDataHashField"><span class="hs-identifier hs-var hs-var">genDataHashField</span></a></span></span><span> </span><span id="local-6989586621682730278"><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="#local-6989586621682730278"><span class="hs-identifier hs-var">maybeCoreScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682728930"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-407"></span><span>    </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="#local-6989586621682730278"><span class="hs-identifier hs-var">maybeCoreScript</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-408"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Scripts.html#PlutusScript"><span class="hs-identifier hs-type">PlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusScript ConwayEra
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-409"></span><span>        </span><span id="local-6989586621682730296"><span class="annot"><span class="annottext">Datum era
</span><a href="#local-6989586621682730296"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era (Datum era)
forall era. Era era =&gt; GenRS era (Datum era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genBabbageDatum"><span class="hs-identifier hs-var">genBabbageDatum</span></a></span><span>
</span><span id="line-410"></span><span>        </span><span id="local-6989586621682730297"><span class="annot"><span class="annottext">StrictMaybe (AlonzoScript ConwayEra)
</span><a href="#local-6989586621682730297"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era (StrictMaybe (Script era))
RWST
  (GenEnv era)
  ()
  (GenState era)
  Gen
  (StrictMaybe (AlonzoScript ConwayEra))
forall era. Reflect era =&gt; GenRS era (StrictMaybe (Script era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRefScript"><span class="hs-identifier hs-var">genRefScript</span></a></span><span>
</span><span id="line-411"></span><span>        </span><span class="annot"><span class="annottext">(BabbageTxOut ConwayEra -&gt; BabbageTxOut ConwayEra)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (BabbageTxOut ConwayEra -&gt; BabbageTxOut ConwayEra)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">((BabbageTxOut ConwayEra -&gt; BabbageTxOut ConwayEra)
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (BabbageTxOut ConwayEra -&gt; BabbageTxOut ConwayEra))
-&gt; (BabbageTxOut ConwayEra -&gt; BabbageTxOut ConwayEra)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (BabbageTxOut ConwayEra -&gt; BabbageTxOut ConwayEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682730298"><span class="annot"><span class="annottext">BabbageTxOut ConwayEra
</span><a href="#local-6989586621682730298"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-412"></span><span>          </span><span class="annot"><span class="annottext">BabbageTxOut ConwayEra
</span><a href="#local-6989586621682730298"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-413"></span><span>            </span><span class="annot"><span class="annottext">BabbageTxOut ConwayEra
-&gt; (BabbageTxOut ConwayEra -&gt; BabbageTxOut ConwayEra)
-&gt; BabbageTxOut ConwayEra
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Datum era -&gt; Identity (Datum era))
-&gt; TxOut era -&gt; Identity (TxOut era)
(Datum era -&gt; Identity (Datum era))
-&gt; BabbageTxOut ConwayEra -&gt; Identity (BabbageTxOut ConwayEra)
forall era. BabbageEraTxOut era =&gt; Lens' (TxOut era) (Datum era)
Lens' (TxOut era) (Datum era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-babbage-1.12.1.0/doc/html/cardano-ledger-babbage/src/Cardano.Ledger.Babbage.TxOut.html#datumTxOutL"><span class="hs-identifier hs-var">datumTxOutL</span></a></span><span> </span><span class="annot"><span class="annottext">((Datum era -&gt; Identity (Datum era))
 -&gt; BabbageTxOut ConwayEra -&gt; Identity (BabbageTxOut ConwayEra))
-&gt; Datum era -&gt; BabbageTxOut ConwayEra -&gt; BabbageTxOut ConwayEra
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Datum era
</span><a href="#local-6989586621682730296"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-414"></span><span>            </span><span class="annot"><span class="annottext">BabbageTxOut ConwayEra
-&gt; (BabbageTxOut ConwayEra -&gt; BabbageTxOut ConwayEra)
-&gt; BabbageTxOut ConwayEra
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(StrictMaybe (Script ConwayEra)
 -&gt; Identity (StrictMaybe (Script ConwayEra)))
-&gt; TxOut ConwayEra -&gt; Identity (TxOut ConwayEra)
(StrictMaybe (Script ConwayEra)
 -&gt; Identity (StrictMaybe (AlonzoScript ConwayEra)))
-&gt; BabbageTxOut ConwayEra -&gt; Identity (BabbageTxOut ConwayEra)
forall era.
BabbageEraTxOut era =&gt;
Lens' (TxOut era) (StrictMaybe (Script era))
Lens' (TxOut ConwayEra) (StrictMaybe (Script ConwayEra))
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-babbage-1.12.1.0/doc/html/cardano-ledger-babbage/src/Cardano.Ledger.Babbage.TxOut.html#referenceScriptTxOutL"><span class="hs-identifier hs-var">referenceScriptTxOutL</span></a></span><span> </span><span class="annot"><span class="annottext">((StrictMaybe (Script ConwayEra)
  -&gt; Identity (StrictMaybe (AlonzoScript ConwayEra)))
 -&gt; BabbageTxOut ConwayEra -&gt; Identity (BabbageTxOut ConwayEra))
-&gt; StrictMaybe (AlonzoScript ConwayEra)
-&gt; BabbageTxOut ConwayEra
-&gt; BabbageTxOut ConwayEra
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (AlonzoScript ConwayEra)
</span><a href="#local-6989586621682730297"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-415"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(BabbageTxOut ConwayEra -&gt; BabbageTxOut ConwayEra)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (BabbageTxOut ConwayEra -&gt; BabbageTxOut ConwayEra)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">BabbageTxOut ConwayEra -&gt; BabbageTxOut ConwayEra
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-416"></span><span>    </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="#local-6989586621682730278"><span class="hs-identifier hs-var">maybeCoreScript</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-417"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Scripts.html#PlutusScript"><span class="hs-identifier hs-type">PlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusScript BabbageEra
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-418"></span><span>        </span><span id="local-6989586621682730318"><span class="annot"><span class="annottext">Datum era
</span><a href="#local-6989586621682730318"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era (Datum era)
forall era. Era era =&gt; GenRS era (Datum era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genBabbageDatum"><span class="hs-identifier hs-var">genBabbageDatum</span></a></span><span>
</span><span id="line-419"></span><span>        </span><span id="local-6989586621682730319"><span class="annot"><span class="annottext">StrictMaybe (AlonzoScript BabbageEra)
</span><a href="#local-6989586621682730319"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era (StrictMaybe (Script era))
RWST
  (GenEnv era)
  ()
  (GenState era)
  Gen
  (StrictMaybe (AlonzoScript BabbageEra))
forall era. Reflect era =&gt; GenRS era (StrictMaybe (Script era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRefScript"><span class="hs-identifier hs-var">genRefScript</span></a></span><span>
</span><span id="line-420"></span><span>        </span><span class="annot"><span class="annottext">(BabbageTxOut BabbageEra -&gt; BabbageTxOut BabbageEra)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (BabbageTxOut BabbageEra -&gt; BabbageTxOut BabbageEra)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">((BabbageTxOut BabbageEra -&gt; BabbageTxOut BabbageEra)
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (BabbageTxOut BabbageEra -&gt; BabbageTxOut BabbageEra))
-&gt; (BabbageTxOut BabbageEra -&gt; BabbageTxOut BabbageEra)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (BabbageTxOut BabbageEra -&gt; BabbageTxOut BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682730320"><span class="annot"><span class="annottext">BabbageTxOut BabbageEra
</span><a href="#local-6989586621682730320"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-421"></span><span>          </span><span class="annot"><span class="annottext">BabbageTxOut BabbageEra
</span><a href="#local-6989586621682730320"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-422"></span><span>            </span><span class="annot"><span class="annottext">BabbageTxOut BabbageEra
-&gt; (BabbageTxOut BabbageEra -&gt; BabbageTxOut BabbageEra)
-&gt; BabbageTxOut BabbageEra
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Datum era -&gt; Identity (Datum era))
-&gt; TxOut era -&gt; Identity (TxOut era)
(Datum era -&gt; Identity (Datum era))
-&gt; BabbageTxOut BabbageEra -&gt; Identity (BabbageTxOut BabbageEra)
forall era. BabbageEraTxOut era =&gt; Lens' (TxOut era) (Datum era)
Lens' (TxOut era) (Datum era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-babbage-1.12.1.0/doc/html/cardano-ledger-babbage/src/Cardano.Ledger.Babbage.TxOut.html#datumTxOutL"><span class="hs-identifier hs-var">datumTxOutL</span></a></span><span> </span><span class="annot"><span class="annottext">((Datum era -&gt; Identity (Datum era))
 -&gt; BabbageTxOut BabbageEra -&gt; Identity (BabbageTxOut BabbageEra))
-&gt; Datum era -&gt; BabbageTxOut BabbageEra -&gt; BabbageTxOut BabbageEra
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Datum era
</span><a href="#local-6989586621682730318"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-423"></span><span>            </span><span class="annot"><span class="annottext">BabbageTxOut BabbageEra
-&gt; (BabbageTxOut BabbageEra -&gt; BabbageTxOut BabbageEra)
-&gt; BabbageTxOut BabbageEra
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(StrictMaybe (Script BabbageEra)
 -&gt; Identity (StrictMaybe (Script BabbageEra)))
-&gt; TxOut BabbageEra -&gt; Identity (TxOut BabbageEra)
(StrictMaybe (Script BabbageEra)
 -&gt; Identity (StrictMaybe (AlonzoScript BabbageEra)))
-&gt; BabbageTxOut BabbageEra -&gt; Identity (BabbageTxOut BabbageEra)
forall era.
BabbageEraTxOut era =&gt;
Lens' (TxOut era) (StrictMaybe (Script era))
Lens' (TxOut BabbageEra) (StrictMaybe (Script BabbageEra))
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-babbage-1.12.1.0/doc/html/cardano-ledger-babbage/src/Cardano.Ledger.Babbage.TxOut.html#referenceScriptTxOutL"><span class="hs-identifier hs-var">referenceScriptTxOutL</span></a></span><span> </span><span class="annot"><span class="annottext">((StrictMaybe (Script BabbageEra)
  -&gt; Identity (StrictMaybe (AlonzoScript BabbageEra)))
 -&gt; BabbageTxOut BabbageEra -&gt; Identity (BabbageTxOut BabbageEra))
-&gt; StrictMaybe (AlonzoScript BabbageEra)
-&gt; BabbageTxOut BabbageEra
-&gt; BabbageTxOut BabbageEra
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (AlonzoScript BabbageEra)
</span><a href="#local-6989586621682730319"><span class="hs-identifier hs-var">script</span></a></span><span>
</span><span id="line-424"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(BabbageTxOut BabbageEra -&gt; BabbageTxOut BabbageEra)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (BabbageTxOut BabbageEra -&gt; BabbageTxOut BabbageEra)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">BabbageTxOut BabbageEra -&gt; BabbageTxOut BabbageEra
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-425"></span><span>    </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-var">Alonzo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><a href="#local-6989586621682730278"><span class="hs-identifier hs-var">maybeCoreScript</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-426"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Scripts.html#PlutusScript"><span class="hs-identifier hs-type">PlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusScript AlonzoEra
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-427"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682730332"><span class="annot"><span class="annottext">DataHash
</span><a href="#local-6989586621682730332"><span class="hs-identifier hs-var">datahash</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682730333"><span class="annot"><span class="annottext">Data era
</span><a href="#local-6989586621682730333"><span class="hs-identifier hs-var">_data</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era (DataHash, Data era)
forall era. Era era =&gt; GenRS era (DataHash, Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genDatumWithHash"><span class="hs-identifier hs-var">genDatumWithHash</span></a></span><span>
</span><span id="line-428"></span><span>        </span><span class="annot"><span class="annottext">(AlonzoTxOut AlonzoEra -&gt; AlonzoTxOut AlonzoEra)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (AlonzoTxOut AlonzoEra -&gt; AlonzoTxOut AlonzoEra)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">((AlonzoTxOut AlonzoEra -&gt; AlonzoTxOut AlonzoEra)
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (AlonzoTxOut AlonzoEra -&gt; AlonzoTxOut AlonzoEra))
-&gt; (AlonzoTxOut AlonzoEra -&gt; AlonzoTxOut AlonzoEra)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (AlonzoTxOut AlonzoEra -&gt; AlonzoTxOut AlonzoEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682730334"><span class="annot"><span class="annottext">AlonzoTxOut AlonzoEra
</span><a href="#local-6989586621682730334"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-429"></span><span>          </span><span class="annot"><span class="annottext">AlonzoTxOut AlonzoEra
</span><a href="#local-6989586621682730334"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-430"></span><span>            </span><span class="annot"><span class="annottext">AlonzoTxOut AlonzoEra
-&gt; (AlonzoTxOut AlonzoEra -&gt; AlonzoTxOut AlonzoEra)
-&gt; AlonzoTxOut AlonzoEra
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(StrictMaybe DataHash -&gt; Identity (StrictMaybe DataHash))
-&gt; TxOut AlonzoEra -&gt; Identity (TxOut AlonzoEra)
(StrictMaybe DataHash -&gt; Identity (StrictMaybe DataHash))
-&gt; AlonzoTxOut AlonzoEra -&gt; Identity (AlonzoTxOut AlonzoEra)
forall era.
AlonzoEraTxOut era =&gt;
Lens' (TxOut era) (StrictMaybe DataHash)
Lens' (TxOut AlonzoEra) (StrictMaybe DataHash)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.TxOut.html#dataHashTxOutL"><span class="hs-identifier hs-var">dataHashTxOutL</span></a></span><span> </span><span class="annot"><span class="annottext">((StrictMaybe DataHash -&gt; Identity (StrictMaybe DataHash))
 -&gt; AlonzoTxOut AlonzoEra -&gt; Identity (AlonzoTxOut AlonzoEra))
-&gt; StrictMaybe DataHash
-&gt; AlonzoTxOut AlonzoEra
-&gt; AlonzoTxOut AlonzoEra
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">DataHash -&gt; StrictMaybe DataHash
forall a. a -&gt; StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">DataHash
</span><a href="#local-6989586621682730332"><span class="hs-identifier hs-var">datahash</span></a></span><span>
</span><span id="line-431"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Script era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(AlonzoTxOut AlonzoEra -&gt; AlonzoTxOut AlonzoEra)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (AlonzoTxOut AlonzoEra -&gt; AlonzoTxOut AlonzoEra)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">AlonzoTxOut AlonzoEra -&gt; AlonzoTxOut AlonzoEra
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-432"></span><span>    </span><span class="annot"><span class="annottext">Proof era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TxOut era -&gt; TxOut era) -&gt; GenRS era (TxOut era -&gt; TxOut era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; TxOut era
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-comment">-- No other Era has any datum in the TxOut</span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="hs-comment">-- ================================================================================</span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="annot"><span class="hs-comment">-- | Generate a TxIn whose TxIx will never clash with an Input created from a TxOut</span></span><span>
</span><span id="line-437"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxIn"><span class="hs-identifier hs-type">genTxIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729173"><span class="annot"><a href="#local-6989586621682729173"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729173"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span>
</span><span id="line-438"></span><span id="genTxIn"><span class="annot"><span class="annottext">genTxIn :: forall era. Proof era -&gt; Int -&gt; Gen TxIn
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxIn"><span class="hs-identifier hs-var hs-var">genTxIn</span></a></span></span><span> </span><span id="local-6989586621682730358"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621682730358"><span class="hs-identifier hs-var">_proof</span></a></span></span><span> </span><span id="local-6989586621682730359"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682730359"><span class="hs-identifier hs-var">numChoices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-439"></span><span>  </span><span id="local-6989586621682730360"><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621682730360"><span class="hs-identifier hs-var">txId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Gen TxId -&gt; Gen TxId
forall a. HasCallStack =&gt; Int -&gt; Gen a -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#resize"><span class="hs-identifier hs-var">resize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">Gen TxId
forall a. Arbitrary a =&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-440"></span><span>  </span><span class="hs-comment">-- The TxIx for Inputs created from outputs of a TxBody, will only range from (1..numChoices)</span><span>
</span><span id="line-441"></span><span>  </span><span class="hs-comment">-- TxIx for these arbitrary Inputs range from (n+1..n+100). This makes the TxIx ranges</span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-comment">-- incommensurate.</span><span>
</span><span id="line-443"></span><span>  </span><span id="local-6989586621682730363"><span class="annot"><span class="annottext">TxIx
</span><a href="#local-6989586621682730363"><span class="hs-identifier hs-var">txIx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Integer -&gt; TxIx
Integer -&gt; TxIx
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#mkTxIxPartial"><span class="hs-identifier hs-var">mkTxIxPartial</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; TxIx) -&gt; (Int -&gt; Integer) -&gt; Int -&gt; TxIx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; TxIx) -&gt; Gen Int -&gt; Gen TxIx
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682730359"><span class="hs-identifier hs-var">numChoices</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682730359"><span class="hs-identifier hs-var">numChoices</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>  </span><span class="annot"><span class="annottext">TxIn -&gt; Gen TxIn
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxId -&gt; TxIx -&gt; TxIn
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-var">TxIn</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621682730360"><span class="hs-identifier hs-var">txId</span></a></span><span> </span><span class="annot"><span class="annottext">TxIx
</span><a href="#local-6989586621682730363"><span class="hs-identifier hs-var">txIx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span class="hs-comment">-- | Generate a non-empty List of fresh TxIn. By fresh we mean TxIn's that</span><span>
</span><span id="line-447"></span><span class="hs-comment">--   we have not generated previously. We use the current InitialUtxo to test this.</span><span>
</span><span id="line-448"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genFreshTxIn"><span class="hs-identifier hs-type">genFreshTxIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729186"><span class="annot"><a href="#local-6989586621682729186"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729186"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729186"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-449"></span><span id="genFreshTxIn"><span class="annot"><span class="annottext">genFreshTxIn :: forall era. Reflect era =&gt; Int -&gt; GenRS era [TxIn]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genFreshTxIn"><span class="hs-identifier hs-var hs-var">genFreshTxIn</span></a></span></span><span> </span><span id="local-6989586621682730401"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682730401"><span class="hs-identifier hs-var">tries</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682730401"><span class="hs-identifier hs-var">tries</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; GenRS era [TxIn]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Could not generate a fresh TxIn after many tries.&quot;</span></span><span>
</span><span id="line-450"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genFreshTxIn"><span class="hs-identifier hs-var">genFreshTxIn</span></a></span><span> </span><span id="local-6989586621682730403"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682730403"><span class="hs-identifier hs-var">tries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-451"></span><span>  </span><span id="local-6989586621682730404"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682730404"><span class="hs-identifier hs-var">entriesInUse</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Map TxIn (TxOut era))
-&gt; RWST (GenEnv era) () (GenState era) Gen (Map TxIn (TxOut era))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Map TxIn (TxOut era)
forall era. GenState era -&gt; Map TxIn (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialUtxo"><span class="hs-identifier hs-var">gsInitialUtxo</span></a></span><span>
</span><span id="line-452"></span><span>  </span><span class="hs-comment">-- Max number of choices. So the UTxO will never be larger than this</span><span>
</span><span id="line-453"></span><span>  </span><span id="local-6989586621682730406"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682730406"><span class="hs-identifier hs-var">numChoicesMax</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Int)
-&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Int
forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoChoicesMax"><span class="hs-identifier hs-var">getUtxoChoicesMax</span></a></span><span>
</span><span id="line-454"></span><span>  </span><span id="local-6989586621682730407"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682730407"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int)
-&gt; Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682730406"><span class="hs-identifier hs-var">numChoicesMax</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>  </span><span id="local-6989586621682730408"><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621682730408"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen [TxIn] -&gt; GenRS era [TxIn]
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen [TxIn] -&gt; GenRS era [TxIn]) -&gt; Gen [TxIn] -&gt; GenRS era [TxIn]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Gen TxIn -&gt; Gen [TxIn]
forall a. Int -&gt; Gen a -&gt; Gen [a]
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#vectorOf"><span class="hs-identifier hs-var">vectorOf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682730407"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Proof era -&gt; Int -&gt; Gen TxIn
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxIn"><span class="hs-identifier hs-var">genTxIn</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682729186"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682730406"><span class="hs-identifier hs-var">numChoicesMax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(TxIn -&gt; Bool) -&gt; [TxIn] -&gt; [TxIn]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn -&gt; Map TxIn (TxOut era) -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-operator hs-var">`Map.notMember`</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682730404"><span class="hs-identifier hs-var">entriesInUse</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621682730408"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-457"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; GenRS era [TxIn]
forall era. Reflect era =&gt; Int -&gt; GenRS era [TxIn]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genFreshTxIn"><span class="hs-identifier hs-var">genFreshTxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682730403"><span class="hs-identifier hs-var">tries</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>    </span><span id="local-6989586621682730411"><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621682730411"><span class="hs-identifier hs-var">freshTxIns</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[TxIn] -&gt; GenRS era [TxIn]
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [TxIn] -&gt; [TxIn]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682730406"><span class="hs-identifier hs-var">numChoicesMax</span></a></span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621682730411"><span class="hs-identifier hs-var">freshTxIns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="hs-comment">-- ====================================================================</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- Generating UTxO and associated Inputs (Set (TxIn era))</span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="hs-comment">-- | Generate a somewhat arbitrary MUtxo.  Occasionally add a bit of</span><span>
</span><span id="line-464"></span><span class="hs-comment">--   the MUtxo in the Model to the one generated.  This way the Tx we generate may</span><span>
</span><span id="line-465"></span><span class="hs-comment">--   spend some of the old UTxo. The result has at most 1 entry from the</span><span>
</span><span id="line-466"></span><span class="hs-comment">--   old MUtxo, and If it has only one entry, that entry is not from the old MUtxo</span><span>
</span><span id="line-467"></span><span id="local-6989586621682729195"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genUTxO"><span class="hs-identifier hs-type">genUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729195"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729195"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier hs-type">MUtxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729195"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#UtxoEntry"><span class="hs-identifier hs-type">UtxoEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729195"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-468"></span><span id="genUTxO"><span class="annot"><span class="annottext">genUTxO :: forall era.
EraGenericGen era =&gt;
GenRS era (MUtxo era, Maybe (UtxoEntry era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genUTxO"><span class="hs-identifier hs-var hs-var">genUTxO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-469"></span><span>  </span><span id="local-6989586621682730906"><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621682730906"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; GenRS era [TxIn]
forall era. Reflect era =&gt; Int -&gt; GenRS era [TxIn]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genFreshTxIn"><span class="hs-identifier hs-var">genFreshTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span>
</span><span id="line-470"></span><span>  </span><span id="local-6989586621682730907"><span class="annot"><span class="annottext">[(TxIn, TxOut era)]
</span><a href="#local-6989586621682730907"><span class="hs-identifier hs-var">pairs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen (TxIn, TxOut era)]
-&gt; RWST (GenEnv era) () (GenState era) Gen [(TxIn, TxOut era)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxIn -&gt; RWST (GenEnv era) () (GenState era) Gen (TxIn, TxOut era))
-&gt; [TxIn]
-&gt; [RWST (GenEnv era) () (GenState era) Gen (TxIn, TxOut era)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682730909"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621682730909"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621682730909"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TxOut era -&gt; (TxIn, TxOut era))
-&gt; RWST (GenEnv era) () (GenState era) Gen (TxOut era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (TxIn, TxOut era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (TxOut era)
</span><a href="#local-6989586621682730910"><span class="hs-identifier hs-var">genOut</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621682730906"><span class="hs-identifier hs-var">ins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>  </span><span id="local-6989586621682730911"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682730911"><span class="hs-identifier hs-var">percent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Int)
-&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Int
forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getOldUtxoPercent"><span class="hs-identifier hs-var">getOldUtxoPercent</span></a></span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-comment">-- Choose a pair from the oldUTxO</span><span>
</span><span id="line-473"></span><span>  </span><span id="local-6989586621682730912"><span class="annot"><span class="annottext">Maybe (TxIn, TxOut era)
</span><a href="#local-6989586621682730912"><span class="hs-identifier hs-var">maybepair</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Int,
  RWST (GenEnv era) () (GenState era) Gen (Maybe (TxIn, TxOut era)))]
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Maybe (TxIn, TxOut era))
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682730911"><span class="hs-identifier hs-var">percent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (Maybe (TxIn, TxOut era))
forall era. EraModel era =&gt; GenRS era (Maybe (TxIn, TxOut era))
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoElem"><span class="hs-identifier hs-var">getUtxoElem</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682730911"><span class="hs-identifier hs-var">percent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (TxIn, TxOut era)
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Maybe (TxIn, TxOut era))
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (TxIn, TxOut era)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-474"></span><span>  </span><span class="annot"><span class="annottext">(MUtxo era, Maybe (TxIn, TxOut era))
-&gt; GenRS era (MUtxo era, Maybe (TxIn, TxOut era))
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(TxIn, TxOut era)] -&gt; MUtxo era
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (TxIn, TxOut era)
-&gt; [(TxIn, TxOut era)] -&gt; [(TxIn, TxOut era)]
forall {a}. Maybe a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621682730913"><span class="hs-identifier hs-var">maybeCons</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (TxIn, TxOut era)
</span><a href="#local-6989586621682730912"><span class="hs-identifier hs-var">maybepair</span></a></span><span> </span><span class="annot"><span class="annottext">[(TxIn, TxOut era)]
</span><a href="#local-6989586621682730907"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (TxIn, TxOut era)
</span><a href="#local-6989586621682730912"><span class="hs-identifier hs-var">maybepair</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-476"></span><span>    </span><span class="hs-comment">-- Note: Never add an old pair unless there are more than 1 new pairs</span><span>
</span><span id="line-477"></span><span>    </span><span id="local-6989586621682730913"><span class="annot"><span class="annottext">maybeCons :: Maybe a -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621682730913"><span class="hs-identifier hs-var hs-var">maybeCons</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682730917"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682730917"><span class="hs-identifier hs-var">pair</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682730918"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682730918"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682730918"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682730917"><span class="hs-identifier hs-var">pair</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682730918"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-478"></span><span>    </span><span class="annot"><a href="#local-6989586621682730913"><span class="hs-identifier hs-var">maybeCons</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682730921"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682730921"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682730921"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-479"></span><span>    </span><span id="local-6989586621682730910"><span class="annot"><span class="annottext">genOut :: RWST (GenEnv era) () (GenState era) Gen (TxOut era)
</span><a href="#local-6989586621682730910"><span class="hs-identifier hs-var hs-var">genOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-480"></span><span>      </span><span id="local-6989586621682733142"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621682733142"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Value era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Value era)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen (Value era)
forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier hs-var">genPositiveVal</span></a></span><span>
</span><span id="line-481"></span><span>      </span><span class="annot"><span class="annottext">Value era -&gt; RWST (GenEnv era) () (GenState era) Gen (TxOut era)
forall era. Reflect era =&gt; Value era -&gt; GenRS era (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOut"><span class="hs-identifier hs-var">genTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621682733142"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="hs-comment">-- | Generate both the spending and reference inputs and a key from the spending</span><span>
</span><span id="line-484"></span><span class="hs-comment">--   inputs we can use to pay the fee. That key is never from the oldUTxO</span><span>
</span><span id="line-485"></span><span id="local-6989586621682729303"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genSpendReferenceInputs"><span class="hs-identifier hs-type">genSpendReferenceInputs</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-486"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729303"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-487"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span>
</span><span id="line-488"></span><span>    </span><span class="annot"><a href="#local-6989586621682729303"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-489"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#UtxoEntry"><span class="hs-identifier hs-type">UtxoEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729303"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-comment">-- The fee key, used to pay the fee.</span><span>
</span><span id="line-490"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729303"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729303"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729303"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>    </span><span class="hs-special">)</span></span><span>
</span><span id="line-494"></span><span id="genSpendReferenceInputs"><span class="annot"><span class="annottext">genSpendReferenceInputs :: forall era.
Map TxIn (TxOut era)
-&gt; GenRS
     era
     (UtxoEntry era, Map TxIn (TxOut era), Map TxIn (TxOut era),
      Map TxIn (TxOut era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genSpendReferenceInputs"><span class="hs-identifier hs-var hs-var">genSpendReferenceInputs</span></a></span></span><span> </span><span id="local-6989586621682733179"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682733179"><span class="hs-identifier hs-var">newUTxO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682733180"><span class="annot"><span class="annottext">pairs :: [UtxoEntry era]
</span><a href="#local-6989586621682733180"><span class="hs-identifier hs-var hs-var">pairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; [UtxoEntry era]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682733179"><span class="hs-identifier hs-var">newUTxO</span></a></span><span>
</span><span id="line-496"></span><span>  </span><span id="local-6989586621682733182"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682733182"><span class="hs-identifier hs-var">maxInputs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Int)
-&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Int
forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getSpendInputsMax"><span class="hs-identifier hs-var">getSpendInputsMax</span></a></span><span>
</span><span id="line-497"></span><span>  </span><span id="local-6989586621682733183"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682733183"><span class="hs-identifier hs-var">maxRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Int)
-&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Int
forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getRefInputsMax"><span class="hs-identifier hs-var">getRefInputsMax</span></a></span><span>
</span><span id="line-498"></span><span>  </span><span id="local-6989586621682733184"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682733184"><span class="hs-identifier hs-var">numInputs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int)
-&gt; Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; Int
forall k a. Map k a -&gt; Int
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682733179"><span class="hs-identifier hs-var">newUTxO</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682733182"><span class="hs-identifier hs-var">maxInputs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>  </span><span id="local-6989586621682733187"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682733187"><span class="hs-identifier hs-var">numRefInputs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int)
-&gt; Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682733183"><span class="hs-identifier hs-var">maxRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>  </span><span id="local-6989586621682733188"><span class="annot"><span class="annottext">TxIn -&gt; Bool
</span><a href="#local-6989586621682733188"><span class="hs-identifier hs-var">badTest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era (TxIn -&gt; Bool)
forall era. GenRS era (TxIn -&gt; Bool)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getUtxoTest"><span class="hs-identifier hs-var">getUtxoTest</span></a></span><span>
</span><span id="line-501"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682733189"><span class="annot"><span class="annottext">feepair :: UtxoEntry era
</span><a href="#local-6989586621682733189"><span class="hs-identifier hs-var">feepair</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621682733190"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621682733190"><span class="hs-identifier hs-var">txin</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682733191"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682733191"><span class="hs-identifier hs-var">txout</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682733192"><span class="annot"><span class="annottext">[UtxoEntry era]
</span><a href="#local-6989586621682733192"><span class="hs-identifier hs-var">inputPairs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (UtxoEntry era, [UtxoEntry era])
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (UtxoEntry era, [UtxoEntry era])
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen (UtxoEntry era, [UtxoEntry era])
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (UtxoEntry era, [UtxoEntry era]))
-&gt; Gen (UtxoEntry era, [UtxoEntry era])
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (UtxoEntry era, [UtxoEntry era])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(UtxoEntry era -&gt; Bool)
-&gt; Int -&gt; [UtxoEntry era] -&gt; Gen (UtxoEntry era, [UtxoEntry era])
forall a. (a -&gt; Bool) -&gt; Int -&gt; [a] -&gt; Gen (a, [a])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#chooseGood"><span class="hs-identifier hs-var">chooseGood</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn -&gt; Bool
</span><a href="#local-6989586621682733188"><span class="hs-identifier hs-var">badTest</span></a></span><span> </span><span class="annot"><span class="annottext">(TxIn -&gt; Bool) -&gt; (UtxoEntry era -&gt; TxIn) -&gt; UtxoEntry era -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UtxoEntry era -&gt; TxIn
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682733184"><span class="hs-identifier hs-var">numInputs</span></a></span><span> </span><span class="annot"><span class="annottext">[UtxoEntry era]
</span><a href="#local-6989586621682733180"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-502"></span><span>  </span><span id="local-6989586621682733194"><span class="annot"><span class="annottext">[UtxoEntry era]
</span><a href="#local-6989586621682733194"><span class="hs-identifier hs-var">refInputPairs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [UtxoEntry era] -&gt; [UtxoEntry era]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682733187"><span class="hs-identifier hs-var">numRefInputs</span></a></span><span> </span><span class="annot"><span class="annottext">([UtxoEntry era] -&gt; [UtxoEntry era])
-&gt; RWST (GenEnv era) () (GenState era) Gen [UtxoEntry era]
-&gt; RWST (GenEnv era) () (GenState era) Gen [UtxoEntry era]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Gen [UtxoEntry era]
-&gt; RWST (GenEnv era) () (GenState era) Gen [UtxoEntry era]
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[UtxoEntry era] -&gt; Gen [UtxoEntry era]
forall a. [a] -&gt; Gen [a]
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#shuffle"><span class="hs-identifier hs-var">shuffle</span></a></span><span> </span><span class="annot"><span class="annottext">[UtxoEntry era]
</span><a href="#local-6989586621682733180"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682733195"><span class="annot"><span class="annottext">inputs :: Map TxIn (TxOut era)
</span><a href="#local-6989586621682733195"><span class="hs-identifier hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[UtxoEntry era] -&gt; Map TxIn (TxOut era)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">[UtxoEntry era]
</span><a href="#local-6989586621682733192"><span class="hs-identifier hs-var">inputPairs</span></a></span><span>
</span><span id="line-504"></span><span>      </span><span id="local-6989586621682733196"><span class="annot"><span class="annottext">refInputs :: Map TxIn (TxOut era)
</span><a href="#local-6989586621682733196"><span class="hs-identifier hs-var hs-var">refInputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[UtxoEntry era] -&gt; Map TxIn (TxOut era)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">[UtxoEntry era]
</span><a href="#local-6989586621682733194"><span class="hs-identifier hs-var">refInputPairs</span></a></span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-comment">-- The feepair is added to the mMutFee field</span><span>
</span><span id="line-506"></span><span>  </span><span class="annot"><span class="annottext">(Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)) -&gt; GenRS era ()
forall era.
(Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelMutFee"><span class="hs-identifier hs-var">modifyModelMutFee</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn -&gt; TxOut era -&gt; Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621682733190"><span class="hs-identifier hs-var">txin</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682733191"><span class="hs-identifier hs-var">txout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682733198"><span class="annot"><span class="annottext">filtered :: Map TxIn (TxOut era)
</span><a href="#local-6989586621682733198"><span class="hs-identifier hs-var hs-var">filtered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; Set TxIn -&gt; Map TxIn (TxOut era)
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.restrictKeys</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682733179"><span class="hs-identifier hs-var">newUTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set TxIn -&gt; Set TxIn -&gt; Set TxIn
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; Set TxIn
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682733195"><span class="hs-identifier hs-var">inputs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; Set TxIn
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682733196"><span class="hs-identifier hs-var">refInputs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>  </span><span class="annot"><span class="annottext">(UtxoEntry era, Map TxIn (TxOut era), Map TxIn (TxOut era),
 Map TxIn (TxOut era))
-&gt; GenRS
     era
     (UtxoEntry era, Map TxIn (TxOut era), Map TxIn (TxOut era),
      Map TxIn (TxOut era))
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UtxoEntry era
</span><a href="#local-6989586621682733189"><span class="hs-identifier hs-var">feepair</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682733195"><span class="hs-identifier hs-var">inputs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682733196"><span class="hs-identifier hs-var">refInputs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682733198"><span class="hs-identifier hs-var">filtered</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="hs-comment">-- | The invariant is:</span><span>
</span><span id="line-511"></span><span class="hs-comment">--</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- * 'xs' is a non empty list.</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- * 'xs' has at most one 'bad' element</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- * if 'xs' has length 1, then the element is guaranteed to be good.</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- * 'n' is a positive `Int`, ranging between (1 .. length xs).</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- Return a pair (good,ys) where</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- &gt; (bad good)==False,</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- &gt; (good `elem` ys),</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- &gt; (length ys) == n, and</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- &gt; all (`elem` xs) ys.</span><span>
</span><span id="line-521"></span><span class="hs-comment">--</span><span>
</span><span id="line-522"></span><span class="hs-comment">-- This is used to generate the spending inputs, which always contain on</span><span>
</span><span id="line-523"></span><span class="hs-comment">-- Input we can use to pay the fee, that does not come from the oldUTxO.</span><span>
</span><span id="line-524"></span><span id="local-6989586621682729310"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#chooseGood"><span class="hs-identifier hs-type">chooseGood</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682729310"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682729310"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682729310"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682729310"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-525"></span><span id="chooseGood"><span class="annot"><span class="annottext">chooseGood :: forall a. (a -&gt; Bool) -&gt; Int -&gt; [a] -&gt; Gen (a, [a])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#chooseGood"><span class="hs-identifier hs-var hs-var">chooseGood</span></a></span></span><span> </span><span id="local-6989586621682733221"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682733221"><span class="hs-identifier hs-var">bad</span></a></span></span><span> </span><span id="local-6989586621682733222"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682733222"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682733223"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682733223"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682733224"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682733224"><span class="hs-identifier hs-var">good</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682733225"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682733225"><span class="hs-identifier hs-var">others</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-527"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682733223"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-528"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-529"></span><span>            </span><span class="annot"><span class="annottext">[Char] -&gt; (a, [a])
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; (a, [a])) -&gt; [Char] -&gt; (a, [a])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-530"></span><span>              </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;empty list in chooseGood, should never happen. n = &quot;</span></span><span>
</span><span id="line-531"></span><span>                </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682733222"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-532"></span><span>                </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;, length xs = &quot;</span></span><span>
</span><span id="line-533"></span><span>                </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682733223"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682733226"><span class="annot"><span class="annottext">Item [a]
</span><a href="#local-6989586621682733226"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
Item [a]
</span><a href="#local-6989586621682733226"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621682733227"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682733227"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682733228"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682733228"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682733229"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682733229"><span class="hs-identifier hs-var">more</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621682733221"><span class="hs-identifier hs-var">bad</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682733227"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682733228"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682733227"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682733229"><span class="hs-identifier hs-var">more</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682733227"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682733228"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682733229"><span class="hs-identifier hs-var">more</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>  </span><span id="local-6989586621682733230"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682733230"><span class="hs-identifier hs-var">tailx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682733222"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; Gen [a] -&gt; Gen [a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Gen [a]
forall a. [a] -&gt; Gen [a]
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#shuffle"><span class="hs-identifier hs-var">shuffle</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682733225"><span class="hs-identifier hs-var">others</span></a></span><span>
</span><span id="line-537"></span><span>  </span><span id="local-6989586621682733231"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682733231"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Gen [a]
forall a. [a] -&gt; Gen [a]
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#shuffle"><span class="hs-identifier hs-var">shuffle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682733224"><span class="hs-identifier hs-var">good</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682733230"><span class="hs-identifier hs-var">tailx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>  </span><span class="annot"><span class="annottext">(a, [a]) -&gt; Gen (a, [a])
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682733224"><span class="hs-identifier hs-var">good</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682733231"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="hs-comment">-- ==================================================</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- Generating Certificates, May add to the Model</span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genShelleyDelegCert"><span class="hs-identifier hs-type">genShelleyDelegCert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729320"><span class="annot"><a href="#local-6989586621682729320"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729320"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729320"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.TxCert.html#TxCert"><span class="hs-identifier hs-type">TxCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729320"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span id="genShelleyDelegCert"><span class="annot"><span class="annottext">genShelleyDelegCert :: forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genShelleyDelegCert"><span class="hs-identifier hs-var hs-var">genShelleyDelegCert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-545"></span><span>  </span><span id="local-6989586621682733500"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682733500"><span class="hs-identifier hs-var">regCertFreq</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; Int) -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall w (m :: * -&gt; *) r a s.
(Monoid w, Monad m) =&gt;
(r -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">((GenEnv era -&gt; Int)
 -&gt; RWST (GenEnv era) () (GenState era) Gen Int)
-&gt; (GenEnv era -&gt; Int)
-&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#regCertFreq"><span class="hs-identifier hs-var">regCertFreq</span></a></span><span> </span><span class="annot"><span class="annottext">(GenSize -&gt; Int) -&gt; (GenEnv era -&gt; GenSize) -&gt; GenEnv era -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; GenSize
forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span>
</span><span id="line-546"></span><span>  </span><span id="local-6989586621682733503"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682733503"><span class="hs-identifier hs-var">delegCertFreq</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; Int) -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall w (m :: * -&gt; *) r a s.
(Monoid w, Monad m) =&gt;
(r -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">((GenEnv era -&gt; Int)
 -&gt; RWST (GenEnv era) () (GenState era) Gen Int)
-&gt; (GenEnv era -&gt; Int)
-&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenSize -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#delegCertFreq"><span class="hs-identifier hs-var">delegCertFreq</span></a></span><span> </span><span class="annot"><span class="annottext">(GenSize -&gt; Int) -&gt; (GenEnv era -&gt; GenSize) -&gt; GenEnv era -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; GenSize
forall era. GenEnv era -&gt; GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#geSize"><span class="hs-identifier hs-var">geSize</span></a></span><span>
</span><span id="line-547"></span><span>  </span><span class="annot"><span class="annottext">[(Int, RWST (GenEnv era) () (GenState era) Gen (TxCert era))]
-&gt; RWST (GenEnv era) () (GenState era) Gen (TxCert era)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span>
</span><span id="line-548"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682733500"><span class="hs-identifier hs-var">regCertFreq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (TxCert era)
</span><a href="#local-6989586621682733505"><span class="hs-identifier hs-var">genShelleyRegCert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">25</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (TxCert era)
</span><a href="#local-6989586621682733506"><span class="hs-identifier hs-var">genShelleyUnRegCert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682733503"><span class="hs-identifier hs-var">delegCertFreq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (TxCert era)
</span><a href="#local-6989586621682733507"><span class="hs-identifier hs-var">genDelegation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-552"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-553"></span><span>    </span><span id="local-6989586621682733505"><span class="annot"><span class="annottext">genShelleyRegCert :: RWST (GenEnv era) () (GenState era) Gen (TxCert era)
</span><a href="#local-6989586621682733505"><span class="hs-identifier hs-var hs-var">genShelleyRegCert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; TxCert era
forall era.
ShelleyEraTxCert era =&gt;
Credential 'Staking -&gt; TxCert era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#RegTxCert"><span class="hs-identifier hs-var">RegTxCert</span></a></span><span> </span><span class="annot"><span class="annottext">(Credential 'Staking -&gt; TxCert era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential 'Staking)
-&gt; RWST (GenEnv era) () (GenState era) Gen (TxCert era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall era.
Reflect era =&gt;
PlutusPurposeTag -&gt; GenRS era (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshRegCred"><span class="hs-identifier hs-var">genFreshRegCred</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682729320"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Certifying"><span class="hs-identifier hs-var">Certifying</span></a></span><span>
</span><span id="line-554"></span><span>    </span><span id="local-6989586621682733506"><span class="annot"><span class="annottext">genShelleyUnRegCert :: RWST (GenEnv era) () (GenState era) Gen (TxCert era)
</span><a href="#local-6989586621682733506"><span class="hs-identifier hs-var hs-var">genShelleyUnRegCert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; TxCert era
forall era.
ShelleyEraTxCert era =&gt;
Credential 'Staking -&gt; TxCert era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#UnRegTxCert"><span class="hs-identifier hs-var">UnRegTxCert</span></a></span><span> </span><span class="annot"><span class="annottext">(Credential 'Staking -&gt; TxCert era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential 'Staking)
-&gt; RWST (GenEnv era) () (GenState era) Gen (TxCert era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential 'Staking)
forall (kr :: KeyRole) era.
Reflect era =&gt;
PlutusPurposeTag -&gt; GenRS era (Credential kr)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genCredential"><span class="hs-identifier hs-var">genCredential</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Certifying"><span class="hs-identifier hs-var">Certifying</span></a></span><span>
</span><span id="line-555"></span><span>    </span><span id="local-6989586621682733507"><span class="annot"><span class="annottext">genDelegation :: RWST (GenEnv era) () (GenState era) Gen (TxCert era)
</span><a href="#local-6989586621682733507"><span class="hs-identifier hs-var hs-var">genDelegation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-556"></span><span>      </span><span id="local-6989586621682737946"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682737946"><span class="hs-identifier hs-var">rewardAccount</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
-&gt; RWST (GenEnv era) () (GenState era) Gen (Credential 'Staking)
forall era.
Reflect era =&gt;
PlutusPurposeTag -&gt; GenRS era (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genFreshRegCred"><span class="hs-identifier hs-var">genFreshRegCred</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Certifying"><span class="hs-identifier hs-var">Certifying</span></a></span><span>
</span><span id="line-557"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682737947"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682737947"><span class="hs-identifier hs-var">poolId</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PoolParams
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era (KeyHash 'StakePool, PoolParams)
forall era.
Reflect era =&gt;
GenRS era (KeyHash 'StakePool, PoolParams)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPool"><span class="hs-identifier hs-var">genPool</span></a></span><span>
</span><span id="line-558"></span><span>      </span><span class="annot"><span class="annottext">TxCert era -&gt; RWST (GenEnv era) () (GenState era) Gen (TxCert era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(TxCert era
 -&gt; RWST (GenEnv era) () (GenState era) Gen (TxCert era))
-&gt; TxCert era
-&gt; RWST (GenEnv era) () (GenState era) Gen (TxCert era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; KeyHash 'StakePool -&gt; TxCert era
forall era.
ShelleyEraTxCert era =&gt;
Credential 'Staking -&gt; KeyHash 'StakePool -&gt; TxCert era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#DelegStakeTxCert"><span class="hs-identifier hs-var">DelegStakeTxCert</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682737946"><span class="hs-identifier hs-var">rewardAccount</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682737947"><span class="hs-identifier hs-var">poolId</span></a></span><span>
</span><span id="line-559"></span><span>
</span><span id="line-560"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCertDeleg"><span class="hs-identifier hs-type">genTxCertDeleg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682737950"><span class="annot"><a href="#local-6989586621682737950"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682737950"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682737950"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.TxCert.html#TxCert"><span class="hs-identifier hs-type">TxCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682737950"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span id="genTxCertDeleg"><span class="annot"><span class="annottext">genTxCertDeleg :: forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCertDeleg"><span class="hs-identifier hs-var hs-var">genTxCertDeleg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682737950"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-562"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-var">Shelley</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenRS era (TxCert era)
forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genShelleyDelegCert"><span class="hs-identifier hs-var">genShelleyDelegCert</span></a></span><span>
</span><span id="line-563"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-var">Mary</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenRS era (TxCert era)
forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genShelleyDelegCert"><span class="hs-identifier hs-var">genShelleyDelegCert</span></a></span><span>
</span><span id="line-564"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-var">Allegra</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenRS era (TxCert era)
forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genShelleyDelegCert"><span class="hs-identifier hs-var">genShelleyDelegCert</span></a></span><span>
</span><span id="line-565"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-var">Alonzo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenRS era (TxCert era)
forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genShelleyDelegCert"><span class="hs-identifier hs-var">genShelleyDelegCert</span></a></span><span>
</span><span id="line-566"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenRS era (TxCert era)
forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genShelleyDelegCert"><span class="hs-identifier hs-var">genShelleyDelegCert</span></a></span><span>
</span><span id="line-567"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenRS era (TxCert era)
forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genShelleyDelegCert"><span class="hs-identifier hs-var">genShelleyDelegCert</span></a></span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCert"><span class="hs-identifier hs-type">genTxCert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729336"><span class="annot"><a href="#local-6989586621682729336"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729336"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729336"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.TxCert.html#TxCert"><span class="hs-identifier hs-type">TxCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729336"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span id="genTxCert"><span class="annot"><span class="annottext">genTxCert :: forall era. Reflect era =&gt; SlotNo -&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCert"><span class="hs-identifier hs-var hs-var">genTxCert</span></a></span></span><span> </span><span id="local-6989586621682738256"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682738256"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-571"></span><span>  </span><span class="annot"><span class="annottext">[RWST (GenEnv era) () (GenState era) Gen (TxCert era)]
-&gt; RWST (GenEnv era) () (GenState era) Gen (TxCert era)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span>
</span><span id="line-572"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Item [RWST (GenEnv era) () (GenState era) Gen (TxCert era)]
RWST (GenEnv era) () (GenState era) Gen (TxCert era)
forall era. Reflect era =&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCertDeleg"><span class="hs-identifier hs-var">genTxCertDeleg</span></a></span><span>
</span><span id="line-573"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Int, RWST (GenEnv era) () (GenState era) Gen (TxCert era))]
-&gt; RWST (GenEnv era) () (GenState era) Gen (TxCert era)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span>
</span><span id="line-574"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">75</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PoolParams -&gt; TxCert era
forall era. EraTxCert era =&gt; PoolParams -&gt; TxCert era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.TxCert.html#RegPoolTxCert"><span class="hs-identifier hs-var">RegPoolTxCert</span></a></span><span> </span><span class="annot"><span class="annottext">(PoolParams -&gt; TxCert era)
-&gt; RWST (GenEnv era) () (GenState era) Gen PoolParams
-&gt; RWST (GenEnv era) () (GenState era) Gen (TxCert era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen PoolParams
</span><a href="#local-6989586621682738258"><span class="hs-identifier hs-var">genFreshPool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">25</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; EpochNo -&gt; TxCert era
forall era.
EraTxCert era =&gt;
KeyHash 'StakePool -&gt; EpochNo -&gt; TxCert era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.TxCert.html#RetirePoolTxCert"><span class="hs-identifier hs-var">RetirePoolTxCert</span></a></span><span> </span><span class="annot"><span class="annottext">(KeyHash 'StakePool -&gt; EpochNo -&gt; TxCert era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (KeyHash 'StakePool)
-&gt; RWST (GenEnv era) () (GenState era) Gen (EpochNo -&gt; TxCert era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (KeyHash 'StakePool)
forall era. Reflect era =&gt; GenRS era (KeyHash 'StakePool)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genRetirementHash"><span class="hs-identifier hs-var">genRetirementHash</span></a></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (EpochNo -&gt; TxCert era)
-&gt; RWST (GenEnv era) () (GenState era) Gen EpochNo
-&gt; RWST (GenEnv era) () (GenState era) Gen (TxCert era)
forall a b.
RWST (GenEnv era) () (GenState era) Gen (a -&gt; b)
-&gt; RWST (GenEnv era) () (GenState era) Gen a
-&gt; RWST (GenEnv era) () (GenState era) Gen b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen EpochNo
</span><a href="#local-6989586621682738260"><span class="hs-identifier hs-var">genEpoch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-577"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-578"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-579"></span><span>    </span><span id="local-6989586621682738258"><span class="annot"><span class="annottext">genFreshPool :: RWST (GenEnv era) () (GenState era) Gen PoolParams
</span><a href="#local-6989586621682738258"><span class="hs-identifier hs-var hs-var">genFreshPool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-580"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682740449"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682740449"><span class="hs-identifier hs-var">_kh</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682740450"><span class="annot"><span class="annottext">PoolParams
</span><a href="#local-6989586621682740450"><span class="hs-identifier hs-var">pp</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era (KeyHash 'StakePool, PoolParams, IndividualPoolStake)
forall era.
Reflect era =&gt;
GenRS era (KeyHash 'StakePool, PoolParams, IndividualPoolStake)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genNewPool"><span class="hs-identifier hs-var">genNewPool</span></a></span><span>
</span><span id="line-581"></span><span>      </span><span class="annot"><span class="annottext">PoolParams -&gt; RWST (GenEnv era) () (GenState era) Gen PoolParams
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">PoolParams
</span><a href="#local-6989586621682740450"><span class="hs-identifier hs-var">pp</span></a></span><span>
</span><span id="line-582"></span><span>    </span><span id="local-6989586621682738260"><span class="annot"><span class="annottext">genEpoch :: RWST (GenEnv era) () (GenState era) Gen EpochNo
</span><a href="#local-6989586621682738260"><span class="hs-identifier hs-var hs-var">genEpoch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-583"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-type">EpochNo</span></a></span><span> </span><span id="local-6989586621682740451"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682740451"><span class="hs-identifier hs-var">txEpoch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; EpochNo
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-test-1.7.0.0/doc/html/cardano-ledger-shelley-test/src/Test.Cardano.Ledger.Shelley.Utils.html#epochFromSlotNo"><span class="hs-identifier hs-var">epochFromSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682738256"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-584"></span><span>      </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-type">EpochNo</span></a></span><span> </span><span id="local-6989586621682740452"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682740452"><span class="hs-identifier hs-var">curEpoch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; EpochNo)
-&gt; RWST (GenEnv era) () (GenState era) Gen EpochNo
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((GenState era -&gt; EpochNo)
 -&gt; RWST (GenEnv era) () (GenState era) Gen EpochNo)
-&gt; (GenState era -&gt; EpochNo)
-&gt; RWST (GenEnv era) () (GenState era) Gen EpochNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; EpochNo
forall era. ModelNewEpochState era -&gt; EpochNo
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mEL"><span class="hs-identifier hs-var">mEL</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; EpochNo)
-&gt; (GenState era -&gt; ModelNewEpochState era)
-&gt; GenState era
-&gt; EpochNo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; ModelNewEpochState era
forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span>
</span><span id="line-585"></span><span>      </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochInterval"><span class="hs-identifier hs-type">EpochInterval</span></a></span><span> </span><span id="local-6989586621682740456"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682740456"><span class="hs-identifier hs-var">maxEpoch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenEnv era -&gt; EpochInterval)
-&gt; RWST (GenEnv era) () (GenState era) Gen EpochInterval
forall w (m :: * -&gt; *) r a s.
(Monoid w, Monad m) =&gt;
(r -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">((GenEnv era -&gt; EpochInterval)
 -&gt; RWST (GenEnv era) () (GenState era) Gen EpochInterval)
-&gt; (GenEnv era -&gt; EpochInterval)
-&gt; RWST (GenEnv era) () (GenState era) Gen EpochInterval
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Getting EpochInterval (PParams era) EpochInterval
-&gt; PParams era -&gt; EpochInterval
forall a s. Getting a s a -&gt; s -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Extras.html#view"><span class="hs-identifier hs-var">L.view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting EpochInterval (PParams era) EpochInterval
forall era. EraPParams era =&gt; Lens' (PParams era) EpochInterval
Lens' (PParams era) EpochInterval
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#ppEMaxL"><span class="hs-identifier hs-var">ppEMaxL</span></a></span><span> </span><span class="annot"><span class="annottext">(PParams era -&gt; EpochInterval)
-&gt; (GenEnv era -&gt; PParams era) -&gt; GenEnv era -&gt; EpochInterval
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; PParams era
forall era. GenEnv era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var">gePParams</span></a></span><span>
</span><span id="line-586"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682740460"><span class="annot"><span class="annottext">nextEpoch :: Word64
</span><a href="#local-6989586621682740460"><span class="hs-identifier hs-var hs-var">nextEpoch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682740451"><span class="hs-identifier hs-var">txEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682740452"><span class="hs-identifier hs-var">curEpoch</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- This will be either 1 or 2. It is 2 if the Tx is at the epoch boundary</span><span>
</span><span id="line-587"></span><span>      </span><span id="local-6989586621682740461"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682740461"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Word64 -&gt; RWST (GenEnv era) () (GenState era) Gen Word64
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Word64 -&gt; RWST (GenEnv era) () (GenState era) Gen Word64)
-&gt; Gen Word64 -&gt; RWST (GenEnv era) () (GenState era) Gen Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Gen Word64
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682740460"><span class="hs-identifier hs-var">nextEpoch</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682740456"><span class="hs-identifier hs-var">maxEpoch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>      </span><span class="annot"><span class="annottext">EpochNo -&gt; RWST (GenEnv era) () (GenState era) Gen EpochNo
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(EpochNo -&gt; RWST (GenEnv era) () (GenState era) Gen EpochNo)
-&gt; (Word64 -&gt; EpochNo)
-&gt; Word64
-&gt; RWST (GenEnv era) () (GenState era) Gen EpochNo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; EpochNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-var">EpochNo</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; RWST (GenEnv era) () (GenState era) Gen EpochNo)
-&gt; Word64 -&gt; RWST (GenEnv era) () (GenState era) Gen EpochNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682740452"><span class="hs-identifier hs-var">curEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682740461"><span class="hs-identifier hs-var">delta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCerts"><span class="hs-identifier hs-type">genTxCerts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729358"><span class="annot"><a href="#local-6989586621682729358"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729358"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729358"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.TxCert.html#TxCert"><span class="hs-identifier hs-type">TxCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729358"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-591"></span><span id="genTxCerts"><span class="annot"><span class="annottext">genTxCerts :: forall era. Reflect era =&gt; SlotNo -&gt; GenRS era [TxCert era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCerts"><span class="hs-identifier hs-var hs-var">genTxCerts</span></a></span></span><span> </span><span id="local-6989586621682740541"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682740541"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682740542"><span class="annot"><span class="annottext">genUniqueScript :: ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
 Map (Credential 'Staking) Coin)
-&gt; Int
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
      Map (Credential 'Staking) Coin)
</span><a href="#local-6989586621682740542"><span class="hs-identifier hs-var hs-var">genUniqueScript</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621682740543"><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740543"><span class="hs-identifier hs-var">dcs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682740544"><span class="annot"><span class="annottext">Set (ScriptHash, Maybe (KeyHash 'StakePool))
</span><a href="#local-6989586621682740544"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682740545"><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-593"></span><span>        </span><span id="local-6989586621682740546"><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682740546"><span class="hs-identifier hs-var">honest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Set (Credential 'Staking))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Set (Credential 'Staking))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Set (Credential 'Staking)
forall era. GenState era -&gt; Set (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsStableDelegators"><span class="hs-identifier hs-var">gsStableDelegators</span></a></span><span>
</span><span id="line-594"></span><span>        </span><span id="local-6989586621682740548"><span class="annot"><span class="annottext">TxCert era
</span><a href="#local-6989586621682740548"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; RWST (GenEnv era) () (GenState era) Gen (TxCert era)
forall era. Reflect era =&gt; SlotNo -&gt; GenRS era (TxCert era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCert"><span class="hs-identifier hs-var">genTxCert</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682740541"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-595"></span><span>        </span><span class="hs-comment">-- Workaround a misfeature where duplicate plutus scripts in TxCert are ignored</span><span>
</span><span id="line-596"></span><span>        </span><span class="hs-comment">-- so if a duplicate might be generated, we don't do that generation</span><span>
</span><span id="line-597"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682740549"><span class="annot"><span class="annottext">insertIfNotPresent :: [TxCert era]
-&gt; Map (Credential 'Staking) Coin
-&gt; Maybe (KeyHash 'StakePool)
-&gt; Maybe (IsValid, ScriptHash)
-&gt; ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
    Map (Credential 'Staking) Coin)
</span><a href="#local-6989586621682740549"><span class="hs-identifier hs-var hs-var">insertIfNotPresent</span></a></span></span><span> </span><span id="local-6989586621682740550"><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740550"><span class="hs-identifier hs-var">dcs'</span></a></span></span><span> </span><span id="local-6989586621682740551"><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740551"><span class="hs-identifier hs-var">regCreds'</span></a></span></span><span> </span><span id="local-6989586621682740552"><span class="annot"><span class="annottext">Maybe (KeyHash 'StakePool)
</span><a href="#local-6989586621682740552"><span class="hs-identifier hs-var">mKey</span></a></span></span><span> </span><span id="local-6989586621682740553"><span class="annot"><span class="annottext">Maybe (IsValid, ScriptHash)
</span><a href="#local-6989586621682740553"><span class="hs-identifier hs-var">mScriptHash</span></a></span></span><span>
</span><span id="line-598"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsValid
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682740554"><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682740554"><span class="hs-identifier hs-var">scriptHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (IsValid, ScriptHash)
</span><a href="#local-6989586621682740553"><span class="hs-identifier hs-var">mScriptHash</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-599"></span><span>                  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682740554"><span class="hs-identifier hs-var">scriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (KeyHash 'StakePool)
</span><a href="#local-6989586621682740552"><span class="hs-identifier hs-var">mKey</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ScriptHash, Maybe (KeyHash 'StakePool))
-&gt; Set (ScriptHash, Maybe (KeyHash 'StakePool)) -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash, Maybe (KeyHash 'StakePool))
</span><a href="#local-6989586621682740544"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-600"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740543"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash, Maybe (KeyHash 'StakePool))
</span><a href="#local-6989586621682740544"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxCert era
</span><a href="#local-6989586621682740548"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">TxCert era -&gt; [TxCert era] -&gt; [TxCert era]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740550"><span class="hs-identifier hs-var">dcs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(ScriptHash, Maybe (KeyHash 'StakePool))
-&gt; Set (ScriptHash, Maybe (KeyHash 'StakePool))
-&gt; Set (ScriptHash, Maybe (KeyHash 'StakePool))
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash
</span><a href="#local-6989586621682740554"><span class="hs-identifier hs-var">scriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (KeyHash 'StakePool)
</span><a href="#local-6989586621682740552"><span class="hs-identifier hs-var">mKey</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash, Maybe (KeyHash 'StakePool))
</span><a href="#local-6989586621682740544"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740551"><span class="hs-identifier hs-var">regCreds'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxCert era
</span><a href="#local-6989586621682740548"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">TxCert era -&gt; [TxCert era] -&gt; [TxCert era]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740550"><span class="hs-identifier hs-var">dcs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash, Maybe (KeyHash 'StakePool))
</span><a href="#local-6989586621682740544"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740551"><span class="hs-identifier hs-var">regCreds'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>        </span><span class="hs-comment">-- Generate registration and de-registration delegation certificates,</span><span>
</span><span id="line-604"></span><span>        </span><span class="hs-comment">-- while ensuring the proper registered/unregistered state in DState</span><span>
</span><span id="line-605"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxCert era
</span><a href="#local-6989586621682740548"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-606"></span><span>          </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.TxCert.html#RegPoolTxCert"><span class="hs-identifier hs-type">RegPoolTxCert</span></a></span><span> </span><span class="annot"><span class="annottext">PoolParams
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
 Map (Credential 'Staking) Coin)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
      Map (Credential 'Staking) Coin)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxCert era
</span><a href="#local-6989586621682740548"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">TxCert era -&gt; [TxCert era] -&gt; [TxCert era]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740543"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash, Maybe (KeyHash 'StakePool))
</span><a href="#local-6989586621682740544"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-607"></span><span>          </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.TxCert.html#RetirePoolTxCert"><span class="hs-identifier hs-type">RetirePoolTxCert</span></a></span><span> </span><span id="local-6989586621682740557"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682740557"><span class="hs-identifier hs-var">kh</span></a></span></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-608"></span><span>            </span><span class="hs-comment">-- We need to make sure that the pool is registered before</span><span>
</span><span id="line-609"></span><span>            </span><span class="hs-comment">-- we try to retire it</span><span>
</span><span id="line-610"></span><span>            </span><span id="local-6989586621682740558"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621682740558"><span class="hs-identifier hs-var">modelPools</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map (KeyHash 'StakePool) StakePoolState)
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((GenState era -&gt; Map (KeyHash 'StakePool) StakePoolState)
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (Map (KeyHash 'StakePool) StakePoolState))
-&gt; (GenState era -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map (KeyHash 'StakePool) StakePoolState)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; Map (KeyHash 'StakePool) StakePoolState
forall era.
ModelNewEpochState era -&gt; Map (KeyHash 'StakePool) StakePoolState
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mStakePools"><span class="hs-identifier hs-var">mStakePools</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; Map (KeyHash 'StakePool) StakePoolState)
-&gt; (GenState era -&gt; ModelNewEpochState era)
-&gt; GenState era
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; ModelNewEpochState era
forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span>
</span><span id="line-611"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; Map (KeyHash 'StakePool) StakePoolState -&gt; Maybe StakePoolState
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682740557"><span class="hs-identifier hs-var">kh</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621682740558"><span class="hs-identifier hs-var">modelPools</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-612"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">StakePoolState
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
 Map (Credential 'Staking) Coin)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
      Map (Credential 'Staking) Coin)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxCert era
</span><a href="#local-6989586621682740548"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">TxCert era -&gt; [TxCert era] -&gt; [TxCert era]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740543"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash, Maybe (KeyHash 'StakePool))
</span><a href="#local-6989586621682740544"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>              </span><span class="annot"><span class="annottext">Maybe StakePoolState
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
 Map (Credential 'Staking) Coin)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
      Map (Credential 'Staking) Coin)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740543"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash, Maybe (KeyHash 'StakePool))
</span><a href="#local-6989586621682740544"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>          </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#RegTxCert"><span class="hs-identifier hs-type">RegTxCert</span></a></span><span> </span><span id="local-6989586621682740560"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682740560"><span class="hs-identifier hs-var">regCred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-615"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682740560"><span class="hs-identifier hs-var">regCred</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Map (Credential 'Staking) Coin -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-operator hs-var">`Map.member`</span></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span><span> </span><span class="hs-comment">-- Can't register if it is already registered</span><span>
</span><span id="line-616"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
 Map (Credential 'Staking) Coin)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
      Map (Credential 'Staking) Coin)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740543"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash, Maybe (KeyHash 'StakePool))
</span><a href="#local-6989586621682740544"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-617"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
 Map (Credential 'Staking) Coin)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
      Map (Credential 'Staking) Coin)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxCert era
</span><a href="#local-6989586621682740548"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">TxCert era -&gt; [TxCert era] -&gt; [TxCert era]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740543"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash, Maybe (KeyHash 'StakePool))
</span><a href="#local-6989586621682740544"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
-&gt; Coin
-&gt; Map (Credential 'Staking) Coin
-&gt; Map (Credential 'Staking) Coin
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682740560"><span class="hs-identifier hs-var">regCred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">99</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- 99 is a NonZero Value</span><span>
</span><span id="line-618"></span><span>          </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#UnRegTxCert"><span class="hs-identifier hs-type">UnRegTxCert</span></a></span><span> </span><span id="local-6989586621682740563"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682740563"><span class="hs-identifier hs-var">deregCred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-619"></span><span>            </span><span class="hs-comment">-- We can't make ShelleyUnRegCert certificate if deregCred is not already registered</span><span>
</span><span id="line-620"></span><span>            </span><span class="hs-comment">-- or if the Rewards balance for deregCred is not 0,</span><span>
</span><span id="line-621"></span><span>            </span><span class="hs-comment">-- or if the credential is one of the StableDelegators (which are never de-registered)</span><span>
</span><span id="line-622"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Map (Credential 'Staking) Coin -&gt; Maybe Coin
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682740563"><span class="hs-identifier hs-var">deregCred</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-623"></span><span>              </span><span class="annot"><span class="annottext">Maybe Coin
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
 Map (Credential 'Staking) Coin)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
      Map (Credential 'Staking) Coin)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740543"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash, Maybe (KeyHash 'StakePool))
</span><a href="#local-6989586621682740544"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>              </span><span class="hs-comment">-- No credential, skip making certificate</span><span>
</span><span id="line-625"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-626"></span><span>                </span><span class="hs-comment">-- Ok to make certificate, rewards balance is 0</span><span>
</span><span id="line-627"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Set (Credential 'Staking) -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682740563"><span class="hs-identifier hs-var">deregCred</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Credential 'Staking)
</span><a href="#local-6989586621682740546"><span class="hs-identifier hs-var">honest</span></a></span><span>
</span><span id="line-628"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
 Map (Credential 'Staking) Coin)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
      Map (Credential 'Staking) Coin)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740543"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash, Maybe (KeyHash 'StakePool))
</span><a href="#local-6989586621682740544"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>                  </span><span class="hs-keyword">else</span><span>
</span><span id="line-630"></span><span>                    </span><span class="annot"><span class="annottext">[TxCert era]
-&gt; Map (Credential 'Staking) Coin
-&gt; Maybe (KeyHash 'StakePool)
-&gt; Maybe (IsValid, ScriptHash)
-&gt; ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
    Map (Credential 'Staking) Coin)
</span><a href="#local-6989586621682740549"><span class="hs-identifier hs-var">insertIfNotPresent</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740543"><span class="hs-identifier hs-var">dcs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential 'Staking
-&gt; Map (Credential 'Staking) Coin -&gt; Map (Credential 'Staking) Coin
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682740563"><span class="hs-identifier hs-var">deregCred</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (KeyHash 'StakePool)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-631"></span><span>                      </span><span class="annot"><span class="annottext">(Maybe (IsValid, ScriptHash)
 -&gt; ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
     Map (Credential 'Staking) Coin))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Maybe (IsValid, ScriptHash))
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
      Map (Credential 'Staking) Coin)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
-&gt; PlutusPurposeTag
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Maybe (IsValid, ScriptHash))
forall (k :: KeyRole) era.
Credential k
-&gt; PlutusPurposeTag -&gt; GenRS era (Maybe (IsValid, ScriptHash))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#plutusScriptHashFromTag"><span class="hs-identifier hs-var">plutusScriptHashFromTag</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682740563"><span class="hs-identifier hs-var">deregCred</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Certifying"><span class="hs-identifier hs-var">Certifying</span></a></span><span>
</span><span id="line-632"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
 Map (Credential 'Staking) Coin)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
      Map (Credential 'Staking) Coin)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740543"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash, Maybe (KeyHash 'StakePool))
</span><a href="#local-6989586621682740544"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>          </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#DelegStakeTxCert"><span class="hs-identifier hs-type">DelegStakeTxCert</span></a></span><span> </span><span id="local-6989586621682740565"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682740565"><span class="hs-identifier hs-var">delegCred</span></a></span></span><span> </span><span id="local-6989586621682740566"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682740566"><span class="hs-identifier hs-var">delegKey</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-634"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682740567"><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740567"><span class="hs-identifier hs-var">dcs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682740568"><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740568"><span class="hs-identifier hs-var">regCreds'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-635"></span><span>                  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682740565"><span class="hs-identifier hs-var">delegCred</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Map (Credential 'Staking) Coin -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-operator hs-var">`Map.member`</span></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span><span>
</span><span id="line-636"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740543"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-comment">-- In order to Delegate, the delegCred must exist in rewards.</span><span>
</span><span id="line-638"></span><span>                    </span><span class="hs-comment">-- so if it is not there, we put it there, otherwise we may</span><span>
</span><span id="line-639"></span><span>                    </span><span class="hs-comment">-- never generate a valid delegation.</span><span>
</span><span id="line-640"></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; TxCert era
forall era.
ShelleyEraTxCert era =&gt;
Credential 'Staking -&gt; TxCert era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#RegTxCert"><span class="hs-identifier hs-var">RegTxCert</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682740565"><span class="hs-identifier hs-var">delegCred</span></a></span><span> </span><span class="annot"><span class="annottext">TxCert era -&gt; [TxCert era] -&gt; [TxCert era]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740543"><span class="hs-identifier hs-var">dcs</span></a></span><span>
</span><span id="line-641"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
-&gt; Coin
-&gt; Map (Credential 'Staking) Coin
-&gt; Map (Credential 'Staking) Coin
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682740565"><span class="hs-identifier hs-var">delegCred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">99</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span><span>
</span><span id="line-642"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[TxCert era]
-&gt; Map (Credential 'Staking) Coin
-&gt; Maybe (KeyHash 'StakePool)
-&gt; Maybe (IsValid, ScriptHash)
-&gt; ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
    Map (Credential 'Staking) Coin)
</span><a href="#local-6989586621682740549"><span class="hs-identifier hs-var">insertIfNotPresent</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740567"><span class="hs-identifier hs-var">dcs'</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740568"><span class="hs-identifier hs-var">regCreds'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; Maybe (KeyHash 'StakePool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682740566"><span class="hs-identifier hs-var">delegKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span>                  </span><span class="annot"><span class="annottext">(Maybe (IsValid, ScriptHash)
 -&gt; ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
     Map (Credential 'Staking) Coin))
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Maybe (IsValid, ScriptHash))
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
      Map (Credential 'Staking) Coin)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
-&gt; PlutusPurposeTag
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (Maybe (IsValid, ScriptHash))
forall (k :: KeyRole) era.
Credential k
-&gt; PlutusPurposeTag -&gt; GenRS era (Maybe (IsValid, ScriptHash))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#plutusScriptHashFromTag"><span class="hs-identifier hs-var">plutusScriptHashFromTag</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682740565"><span class="hs-identifier hs-var">delegCred</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Certifying"><span class="hs-identifier hs-var">Certifying</span></a></span><span>
</span><span id="line-645"></span><span>          </span><span class="annot"><span class="annottext">TxCert era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
 Map (Credential 'Staking) Coin)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
      Map (Credential 'Staking) Coin)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxCert era
</span><a href="#local-6989586621682740548"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">TxCert era -&gt; [TxCert era] -&gt; [TxCert era]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740543"><span class="hs-identifier hs-var">dcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash, Maybe (KeyHash 'StakePool))
</span><a href="#local-6989586621682740544"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682740545"><span class="hs-identifier hs-var">regCreds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>  </span><span id="local-6989586621682740569"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740569"><span class="hs-identifier hs-var">maxcert</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Int)
-&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Int
forall era. GenState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getCertificateMax"><span class="hs-identifier hs-var">getCertificateMax</span></a></span><span>
</span><span id="line-647"></span><span>  </span><span id="local-6989586621682740570"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740570"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int)
-&gt; Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740569"><span class="hs-identifier hs-var">maxcert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-648"></span><span>  </span><span id="local-6989586621682740571"><span class="annot"><span class="annottext">Accounts era
</span><a href="#local-6989586621682740571"><span class="hs-identifier hs-var">accounts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Accounts era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Accounts era)
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; Accounts era
forall era. ModelNewEpochState era -&gt; Accounts era
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mAccounts"><span class="hs-identifier hs-var">mAccounts</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; Accounts era)
-&gt; (GenState era -&gt; ModelNewEpochState era)
-&gt; GenState era
-&gt; Accounts era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; ModelNewEpochState era
forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-649"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621682740573"><span class="hs-identifier hs-type">initSets</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-650"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.TxCert.html#TxCert"><span class="hs-identifier hs-type">TxCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729358"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-651"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-653"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span>      </span><span id="local-6989586621682740573"><span class="annot"><span class="annottext">initSets :: ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
 Map (Credential 'Staking) Coin)
</span><a href="#local-6989586621682740573"><span class="hs-identifier hs-var hs-var">initSets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash, Maybe (KeyHash 'StakePool))
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(AccountState era -&gt; Coin)
-&gt; Map (Credential 'Staking) (AccountState era)
-&gt; Map (Credential 'Staking) Coin
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompactForm Coin -&gt; Coin
forall a. Compactible a =&gt; CompactForm a -&gt; a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#fromCompact"><span class="hs-identifier hs-var">fromCompact</span></a></span><span> </span><span class="annot"><span class="annottext">(CompactForm Coin -&gt; Coin)
-&gt; (AccountState era -&gt; CompactForm Coin)
-&gt; AccountState era
-&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AccountState era
-&gt; Getting (CompactForm Coin) (AccountState era) (CompactForm Coin)
-&gt; CompactForm Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (CompactForm Coin) (AccountState era) (CompactForm Coin)
forall era.
EraAccounts era =&gt;
Lens' (AccountState era) (CompactForm Coin)
Lens' (AccountState era) (CompactForm Coin)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#balanceAccountStateL"><span class="hs-identifier hs-var">balanceAccountStateL</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Accounts era
</span><a href="#local-6989586621682740571"><span class="hs-identifier hs-var">accounts</span></a></span><span> </span><span class="annot"><span class="annottext">Accounts era
-&gt; Getting
     (Map (Credential 'Staking) (AccountState era))
     (Accounts era)
     (Map (Credential 'Staking) (AccountState era))
-&gt; Map (Credential 'Staking) (AccountState era)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map (Credential 'Staking) (AccountState era))
  (Accounts era)
  (Map (Credential 'Staking) (AccountState era))
forall era.
EraAccounts era =&gt;
Lens' (Accounts era) (Map (Credential 'Staking) (AccountState era))
Lens' (Accounts era) (Map (Credential 'Staking) (AccountState era))
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#accountsMapL"><span class="hs-identifier hs-var">accountsMapL</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682740578"><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740578"><span class="hs-identifier hs-var">dcs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set (ScriptHash, Maybe (KeyHash 'StakePool))
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
  Map (Credential 'Staking) Coin)
 -&gt; Int
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
       Map (Credential 'Staking) Coin))
-&gt; ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
    Map (Credential 'Staking) Coin)
-&gt; [Int]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
      Map (Credential 'Staking) Coin)
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">F.foldlM</span></span><span> </span><span class="annot"><span class="annottext">([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
 Map (Credential 'Staking) Coin)
-&gt; Int
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     ([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
      Map (Credential 'Staking) Coin)
</span><a href="#local-6989586621682740542"><span class="hs-identifier hs-var">genUniqueScript</span></a></span><span> </span><span class="annot"><span class="annottext">([TxCert era], Set (ScriptHash, Maybe (KeyHash 'StakePool)),
 Map (Credential 'Staking) Coin)
</span><a href="#local-6989586621682740573"><span class="hs-identifier hs-var">initSets</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
Item [Int]
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
Item [Int]
</span><a href="#local-6989586621682740570"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span>  </span><span class="annot"><span class="annottext">[TxCert era] -&gt; GenRS era [TxCert era]
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([TxCert era] -&gt; GenRS era [TxCert era])
-&gt; [TxCert era] -&gt; GenRS era [TxCert era]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TxCert era] -&gt; [TxCert era]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682740578"><span class="hs-identifier hs-var">dcs</span></a></span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span id="local-6989586621682729379"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#spendOnly"><span class="hs-identifier hs-type">spendOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#EraTxOut"><span class="hs-identifier hs-type">EraTxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729379"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729379"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-659"></span><span id="spendOnly"><span class="annot"><span class="annottext">spendOnly :: forall era. EraTxOut era =&gt; TxOut era -&gt; Bool
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#spendOnly"><span class="hs-identifier hs-var hs-var">spendOnly</span></a></span></span><span> </span><span id="local-6989586621682740585"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682740585"><span class="hs-identifier hs-var">txOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682740585"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; Getting Addr (TxOut era) Addr -&gt; Addr
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Addr (TxOut era) Addr
forall era. EraTxOut era =&gt; Lens' (TxOut era) Addr
Lens' (TxOut era) Addr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#addrTxOutL"><span class="hs-identifier hs-var">addrTxOutL</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-660"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#ScriptHashObj"><span class="hs-identifier hs-type">ScriptHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StakeReference
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-661"></span><span>  </span><span class="annot"><span class="annottext">Addr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span class="hs-comment">-- | Generate a set of Collateral inputs sufficient to pay the minimum fee ('minCollTotal') computed</span><span>
</span><span id="line-664"></span><span class="hs-comment">--   from the fee and the collateralPercentage from the PParams. Return the new UTxO, the inputs,</span><span>
</span><span id="line-665"></span><span class="hs-comment">--   and coin of the excess amount included in the inputs, above what is needed to pay the minimum fee.</span><span>
</span><span id="line-666"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genCollateralUTxO"><span class="hs-identifier hs-type">genCollateralUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-667"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729381"><span class="annot"><a href="#local-6989586621682729381"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-668"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729381"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-669"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-670"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-671"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier hs-type">MUtxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729381"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-672"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729381"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier hs-type">MUtxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729381"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729381"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-673"></span><span id="genCollateralUTxO"><span class="annot"><span class="annottext">genCollateralUTxO :: forall era.
(HasCallStack, EraGenericGen era) =&gt;
[Addr]
-&gt; Coin -&gt; MUtxo era -&gt; GenRS era (MUtxo era, MUtxo era, Coin)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genCollateralUTxO"><span class="hs-identifier hs-var hs-var">genCollateralUTxO</span></a></span></span><span> </span><span id="local-6989586621682740669"><span class="annot"><span class="annottext">[Addr]
</span><a href="#local-6989586621682740669"><span class="hs-identifier hs-var">collateralAddresses</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span id="local-6989586621682740670"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682740670"><span class="hs-identifier hs-var">fee</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682740671"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740671"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-674"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621682740673"><span class="annot"><span class="annottext">PParams era
gePParams :: forall era. GenEnv era -&gt; PParams era
gePParams :: PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var hs-var">gePParams</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; GenEnv era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (GenEnv era)
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; GenEnv era
forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-675"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682740675"><span class="annot"><span class="annottext">collPerc :: Nat
</span><a href="#local-6989586621682740675"><span class="hs-identifier hs-var hs-var">collPerc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682740673"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; Getting Nat (PParams era) Nat -&gt; Nat
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Nat (PParams era) Nat
forall era. EraGenericGen era =&gt; Lens' (PParams era) Nat
Lens' (PParams era) Nat
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#ppCollateralPercentageT"><span class="hs-identifier hs-var">ppCollateralPercentageT</span></a></span><span>
</span><span id="line-676"></span><span>      </span><span id="local-6989586621682740677"><span class="annot"><span class="annottext">minCollTotal :: Coin
</span><a href="#local-6989586621682740677"><span class="hs-identifier hs-var hs-var">minCollTotal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ratio Integer -&gt; Integer
forall b. Integral b =&gt; Ratio Integer -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">ceiling</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682740670"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621682740675"><span class="hs-identifier hs-var">collPerc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Ratio Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-677"></span><span>      </span><span class="hs-comment">-- Generate a collateral that is neither in UTxO map nor has already been generated</span><span>
</span><span id="line-678"></span><span>      </span><span id="local-6989586621682740680"><span class="annot"><span class="annottext">genNewCollateral :: Addr
-&gt; Map TxIn (TxOut era)
-&gt; Map TxIn (TxOut era)
-&gt; Coin
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)
</span><a href="#local-6989586621682740680"><span class="hs-identifier hs-var hs-var">genNewCollateral</span></a></span></span><span> </span><span id="local-6989586621682740681"><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621682740681"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682740682"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740682"><span class="hs-identifier hs-var">coll</span></a></span></span><span> </span><span id="local-6989586621682740683"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740683"><span class="hs-identifier hs-var">um</span></a></span></span><span> </span><span id="local-6989586621682740684"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740684"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-679"></span><span>        </span><span class="hs-comment">-- The size of the Gen computation is driven down when we generate scripts, so it can be 0 here</span><span>
</span><span id="line-680"></span><span>        </span><span class="hs-comment">-- that is really bad, because if the happens we get the same TxIn every time, and 'coll' never grows,</span><span>
</span><span id="line-681"></span><span>        </span><span class="hs-comment">-- so this function doesn't terminate. We want many choices of TxIn, so resize just this arbitrary by 30.</span><span>
</span><span id="line-682"></span><span>        </span><span id="local-6989586621682740685"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740685"><span class="hs-identifier hs-var">entriesInUse</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Map TxIn (TxOut era))
-&gt; RWST (GenEnv era) () (GenState era) Gen (Map TxIn (TxOut era))
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Map TxIn (TxOut era)
forall era. GenState era -&gt; Map TxIn (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialUtxo"><span class="hs-identifier hs-var">gsInitialUtxo</span></a></span><span>
</span><span id="line-683"></span><span>        </span><span id="local-6989586621682740686"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621682740686"><span class="hs-identifier hs-var">txIn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen TxIn -&gt; RWST (GenEnv era) () (GenState era) Gen TxIn
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Gen TxIn -&gt; Gen TxIn
forall a. HasCallStack =&gt; Int -&gt; Gen a -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#resize"><span class="hs-identifier hs-var">resize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">30</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gen TxIn
forall a. Arbitrary a =&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; Map TxIn (TxOut era) -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.member</span></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621682740686"><span class="hs-identifier hs-var">txIn</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740671"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; Map TxIn (TxOut era) -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.member</span></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621682740686"><span class="hs-identifier hs-var">txIn</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740682"><span class="hs-identifier hs-var">coll</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621682740686"><span class="hs-identifier hs-var">txIn</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; Map TxIn (TxOut era) -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-operator hs-var">`Map.member`</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740685"><span class="hs-identifier hs-var">entriesInUse</span></a></span><span>
</span><span id="line-685"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Addr
-&gt; Map TxIn (TxOut era)
-&gt; Map TxIn (TxOut era)
-&gt; Coin
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)
</span><a href="#local-6989586621682740680"><span class="hs-identifier hs-var">genNewCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621682740681"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740682"><span class="hs-identifier hs-var">coll</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740683"><span class="hs-identifier hs-var">um</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740684"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-686"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740683"><span class="hs-identifier hs-var">um</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; TxOut era -&gt; Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621682740686"><span class="hs-identifier hs-var">txIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr -&gt; Value era -&gt; TxOut era
forall era.
(EraTxOut era, HasCallStack) =&gt;
Addr -&gt; Value era -&gt; TxOut era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#mkBasicTxOut"><span class="hs-identifier hs-var">mkBasicTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621682740681"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin -&gt; Value era
forall t s. Inject t s =&gt; t -&gt; s
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740684"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740682"><span class="hs-identifier hs-var">coll</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740684"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span>      </span><span class="hs-comment">-- Either pick a collateral from a map or generate a completely new one</span><span>
</span><span id="line-688"></span><span>      </span><span id="local-6989586621682740689"><span class="annot"><span class="annottext">genCollateral :: Addr
-&gt; Map TxIn (TxOut era)
-&gt; Map TxIn (TxOut era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)
</span><a href="#local-6989586621682740689"><span class="hs-identifier hs-var hs-var">genCollateral</span></a></span></span><span> </span><span id="local-6989586621682740690"><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621682740690"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621682740691"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740691"><span class="hs-identifier hs-var">coll</span></a></span></span><span> </span><span id="local-6989586621682740692"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740692"><span class="hs-identifier hs-var">um</span></a></span></span><span>
</span><span id="line-689"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; Bool
forall k a. Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.null</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740692"><span class="hs-identifier hs-var">um</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr
-&gt; Map TxIn (TxOut era)
-&gt; Map TxIn (TxOut era)
-&gt; Coin
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)
</span><a href="#local-6989586621682740680"><span class="hs-identifier hs-var">genNewCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621682740690"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740691"><span class="hs-identifier hs-var">coll</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740692"><span class="hs-identifier hs-var">um</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (Map TxIn (TxOut era), Map TxIn (TxOut era), Coin))
-&gt; RWST (GenEnv era) () (GenState era) Gen Coin
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Gen Coin -&gt; RWST (GenEnv era) () (GenState era) Gen Coin
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen Coin
forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier hs-var">genPositiveVal</span></a></span><span>
</span><span id="line-690"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-691"></span><span>            </span><span id="local-6989586621682740694"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740694"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int)
-&gt; Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#chooseInt"><span class="hs-identifier hs-var">chooseInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; Int
forall k a. Map k a -&gt; Int
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740692"><span class="hs-identifier hs-var">um</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-692"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682740696"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621682740696"><span class="hs-identifier hs-var">txIn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682740697"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682740697"><span class="hs-identifier hs-var">txOut</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Map TxIn (TxOut era) -&gt; (TxIn, TxOut era)
forall k a. Int -&gt; Map k a -&gt; (k, a)
</span><span class="hs-identifier hs-var">Map.elemAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740694"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740692"><span class="hs-identifier hs-var">um</span></a></span><span>
</span><span id="line-693"></span><span>            </span><span class="annot"><span class="annottext">(Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)
forall k a. Int -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.deleteAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740694"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740692"><span class="hs-identifier hs-var">um</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; TxOut era -&gt; Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621682740696"><span class="hs-identifier hs-var">txIn</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682740697"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740691"><span class="hs-identifier hs-var">coll</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682740697"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; Getting Coin (TxOut era) Coin -&gt; Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Coin (TxOut era) Coin
forall era. (HasCallStack, EraTxOut era) =&gt; Lens' (TxOut era) Coin
Lens' (TxOut era) Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#coinTxOutL"><span class="hs-identifier hs-var">coinTxOutL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-694"></span><span>      </span><span class="hs-comment">-- Recursively either pick existing key spend only outputs or generate new ones that</span><span>
</span><span id="line-695"></span><span>      </span><span class="hs-comment">-- will be later added to the UTxO map</span><span>
</span><span id="line-696"></span><span>      </span><span class="annot"><a href="#local-6989586621682740701"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-697"></span><span>        </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-698"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729381"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-699"></span><span>        </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-700"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729381"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-701"></span><span>        </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729381"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729381"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-702"></span><span>      </span><span id="local-6989586621682740701"><span class="annot"><span class="annottext">go :: [Addr]
-&gt; Map TxIn (TxOut era)
-&gt; Coin
-&gt; Map TxIn (TxOut era)
-&gt; GenRS era (Map TxIn (TxOut era), Coin)
</span><a href="#local-6989586621682740701"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621682740702"><span class="annot"><span class="annottext">[Addr]
</span><a href="#local-6989586621682740702"><span class="hs-identifier hs-var">ecs</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682740703"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740703"><span class="hs-identifier hs-var">coll</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682740704"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740704"><span class="hs-identifier hs-var">curCollTotal</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682740705"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740705"><span class="hs-identifier hs-var">um</span></a></span></span><span>
</span><span id="line-703"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740704"><span class="hs-identifier hs-var">curCollTotal</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740677"><span class="hs-identifier hs-var">minCollTotal</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map TxIn (TxOut era), Coin)
-&gt; GenRS era (Map TxIn (TxOut era), Coin)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740703"><span class="hs-identifier hs-var">coll</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740704"><span class="hs-identifier hs-var">curCollTotal</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740677"><span class="hs-identifier hs-var">minCollTotal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-704"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Addr]
</span><a href="#local-6989586621682740702"><span class="hs-identifier hs-var">ecs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; GenRS era (Map TxIn (TxOut era), Coin)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Impossible: supplied less addresses than `maxCollateralInputs`&quot;</span></span><span>
</span><span id="line-705"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682740707"><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621682740707"><span class="hs-identifier hs-var">ec</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682740708"><span class="annot"><span class="annottext">[Addr]
</span><a href="#local-6989586621682740708"><span class="hs-identifier hs-var">ecs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Addr]
</span><a href="#local-6989586621682740702"><span class="hs-identifier hs-var">ecs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-706"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621682740709"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740709"><span class="hs-identifier hs-var">um'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682740710"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740710"><span class="hs-identifier hs-var">coll'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682740711"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740711"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-707"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Addr] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Addr]
</span><a href="#local-6989586621682740708"><span class="hs-identifier hs-var">ecs'</span></a></span><span>
</span><span id="line-708"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-comment">-- This is the last input, so most of the time, put something (val &gt; 0)</span><span>
</span><span id="line-709"></span><span>                </span><span class="hs-comment">-- extra in it or we will always have a ColReturn with zero in it.</span><span>
</span><span id="line-710"></span><span>                  </span><span class="hs-keyword">do</span><span>
</span><span id="line-711"></span><span>                    </span><span id="local-6989586621682740712"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740712"><span class="hs-identifier hs-var">excess</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Coin -&gt; RWST (GenEnv era) () (GenState era) Gen Coin
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Gen Coin
forall v. Val v =&gt; Gen v
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genPositiveVal"><span class="hs-identifier hs-var">genPositiveVal</span></a></span><span>
</span><span id="line-712"></span><span>                    </span><span class="annot"><span class="annottext">Addr
-&gt; Map TxIn (TxOut era)
-&gt; Map TxIn (TxOut era)
-&gt; Coin
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)
</span><a href="#local-6989586621682740680"><span class="hs-identifier hs-var">genNewCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621682740707"><span class="hs-identifier hs-var">ec</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740703"><span class="hs-identifier hs-var">coll</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740705"><span class="hs-identifier hs-var">um</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740677"><span class="hs-identifier hs-var">minCollTotal</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740704"><span class="hs-identifier hs-var">curCollTotal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740712"><span class="hs-identifier hs-var">excess</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[RWST
   (GenEnv era)
   ()
   (GenState era)
   Gen
   (Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[t Gen b] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#elementsT"><span class="hs-identifier hs-var">elementsT</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Addr
-&gt; Map TxIn (TxOut era)
-&gt; Map TxIn (TxOut era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)
</span><a href="#local-6989586621682740689"><span class="hs-identifier hs-var">genCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621682740707"><span class="hs-identifier hs-var">ec</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740703"><span class="hs-identifier hs-var">coll</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Addr
-&gt; Map TxIn (TxOut era)
-&gt; Map TxIn (TxOut era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)
</span><a href="#local-6989586621682740689"><span class="hs-identifier hs-var">genCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621682740707"><span class="hs-identifier hs-var">ec</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740703"><span class="hs-identifier hs-var">coll</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740705"><span class="hs-identifier hs-var">um</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-714"></span><span>            </span><span class="annot"><span class="annottext">[Addr]
-&gt; Map TxIn (TxOut era)
-&gt; Coin
-&gt; Map TxIn (TxOut era)
-&gt; GenRS era (Map TxIn (TxOut era), Coin)
</span><a href="#local-6989586621682740701"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Addr]
</span><a href="#local-6989586621682740708"><span class="hs-identifier hs-var">ecs'</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740710"><span class="hs-identifier hs-var">coll'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740704"><span class="hs-identifier hs-var">curCollTotal</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740711"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740709"><span class="hs-identifier hs-var">um'</span></a></span><span>
</span><span id="line-715"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682740715"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740715"><span class="hs-identifier hs-var">collaterals</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682740716"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740716"><span class="hs-identifier hs-var">excessColCoin</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-716"></span><span>    </span><span class="annot"><span class="annottext">[Addr]
-&gt; Map TxIn (TxOut era)
-&gt; Coin
-&gt; Map TxIn (TxOut era)
-&gt; GenRS era (Map TxIn (TxOut era), Coin)
</span><a href="#local-6989586621682740701"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Addr]
</span><a href="#local-6989586621682740669"><span class="hs-identifier hs-var">collateralAddresses</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map TxIn (TxOut era) -&gt; GenRS era (Map TxIn (TxOut era), Coin))
-&gt; Map TxIn (TxOut era) -&gt; GenRS era (Map TxIn (TxOut era), Coin)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(TxOut era -&gt; Bool) -&gt; Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.filter</span></span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; Bool
forall era. EraTxOut era =&gt; TxOut era -&gt; Bool
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#spendOnly"><span class="hs-identifier hs-var">spendOnly</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740671"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-717"></span><span>  </span><span class="annot"><span class="annottext">(Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
-&gt; Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.union</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740715"><span class="hs-identifier hs-var">collaterals</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740671"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682740715"><span class="hs-identifier hs-var">collaterals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682740716"><span class="hs-identifier hs-var">excessColCoin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-718"></span><span>
</span><span id="line-719"></span><span class="hs-comment">-- | This function is used to generate the Outputs of a TxBody, It is computed by taking the</span><span>
</span><span id="line-720"></span><span class="hs-comment">--   Outputs of the range of the (UTxO resticted by the Inputs of the TxBody),</span><span>
</span><span id="line-721"></span><span class="hs-comment">--   as input to the function, and then making new Outputs, where the sum of the Coin is the same.</span><span>
</span><span id="line-722"></span><span class="hs-comment">--   This way we generate a 'balanced' TxBody (modulo fees, deposits, refunds etc. which are</span><span>
</span><span id="line-723"></span><span class="hs-comment">--   handled separately). The idea is to make sum(txOuts) == sum(genRecipientsFrom txouts), the</span><span>
</span><span id="line-724"></span><span class="hs-comment">--   sum will be the same, but the size may be different.</span><span>
</span><span id="line-725"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRecipientsFrom"><span class="hs-identifier hs-type">genRecipientsFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-726"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729404"><span class="annot"><a href="#local-6989586621682729404"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729404"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729404"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729404"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729404"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-727"></span><span id="genRecipientsFrom"><span class="annot"><span class="annottext">genRecipientsFrom :: forall era.
EraGenericGen era =&gt;
[TxOut era] -&gt; GenRS era [TxOut era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRecipientsFrom"><span class="hs-identifier hs-var hs-var">genRecipientsFrom</span></a></span></span><span> </span><span id="local-6989586621682740782"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740782"><span class="hs-identifier hs-var">txOuts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-728"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682740783"><span class="annot"><span class="annottext">outCount :: Int
</span><a href="#local-6989586621682740783"><span class="hs-identifier hs-var hs-var">outCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740782"><span class="hs-identifier hs-var">txOuts</span></a></span><span>
</span><span id="line-729"></span><span>  </span><span id="local-6989586621682740784"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740784"><span class="hs-identifier hs-var">approxCount</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int)
-&gt; Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740783"><span class="hs-identifier hs-var">outCount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-730"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682740785"><span class="annot"><span class="annottext">extra :: Int
</span><a href="#local-6989586621682740785"><span class="hs-identifier hs-var hs-var">extra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740783"><span class="hs-identifier hs-var">outCount</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740784"><span class="hs-identifier hs-var">approxCount</span></a></span><span>
</span><span id="line-731"></span><span>      </span><span id="local-6989586621682740786"><span class="annot"><span class="annottext">avgExtra :: Int
</span><a href="#local-6989586621682740786"><span class="hs-identifier hs-var hs-var">avgExtra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Integer -&gt; Int
forall b. Integral b =&gt; Ratio Integer -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">ceiling</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740785"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Ratio Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740784"><span class="hs-identifier hs-var">approxCount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-732"></span><span>      </span><span id="local-6989586621682740787"><span class="annot"><span class="annottext">genExtra :: Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
</span><a href="#local-6989586621682740787"><span class="hs-identifier hs-var hs-var">genExtra</span></a></span></span><span> </span><span id="local-6989586621682740788"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740788"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-733"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740788"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740786"><span class="hs-identifier hs-var">avgExtra</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-734"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int)
-&gt; Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#chooseInt"><span class="hs-identifier hs-var">chooseInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740786"><span class="hs-identifier hs-var">avgExtra</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-735"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682740789"><span class="annot"><span class="annottext">goNew :: Int -&gt; [TxOut era] -&gt; [TxOut era] -&gt; GenRS era [TxOut era]
</span><a href="#local-6989586621682740789"><span class="hs-identifier hs-var hs-var">goNew</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682740790"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740790"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; GenRS era [TxOut era]
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740790"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-736"></span><span>      </span><span class="annot"><a href="#local-6989586621682740789"><span class="hs-identifier hs-var">goNew</span></a></span><span> </span><span id="local-6989586621682740791"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740791"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682740792"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682740792"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682740793"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740793"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682740794"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740794"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-737"></span><span>        </span><span id="local-6989586621682740795"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740795"><span class="hs-identifier hs-var">leftToAdd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
</span><a href="#local-6989586621682740787"><span class="hs-identifier hs-var">genExtra</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740791"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-738"></span><span>        </span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; Value era
-&gt; TxOut era
-&gt; [TxOut era]
-&gt; [TxOut era]
-&gt; GenRS era [TxOut era]
</span><a href="#local-6989586621682740796"><span class="hs-identifier hs-var">goExtra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740791"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740795"><span class="hs-identifier hs-var">leftToAdd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740795"><span class="hs-identifier hs-var">leftToAdd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin -&gt; Value era
forall t s. Inject t s =&gt; t -&gt; s
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682740792"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740793"><span class="hs-identifier hs-var">txs</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740794"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-739"></span><span>      </span><span id="local-6989586621682740796"><span class="annot"><span class="annottext">goExtra :: Int
-&gt; Int
-&gt; Value era
-&gt; TxOut era
-&gt; [TxOut era]
-&gt; [TxOut era]
-&gt; GenRS era [TxOut era]
</span><a href="#local-6989586621682740796"><span class="hs-identifier hs-var hs-var">goExtra</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682740797"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621682740797"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621682740798"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682740798"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682740799"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740799"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value era -&gt; TxOut era -&gt; [TxOut era] -&gt; GenRS era [TxOut era]
forall {era}.
(Assert
   (OrdCond
      (CmpNat (ProtVerLow era) (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat MinVersion (ProtVerLow era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat MinVersion (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 Reflect era) =&gt;
Value era
-&gt; TxOut era
-&gt; [TxOut era]
-&gt; RWST (GenEnv era) () (GenState era) Gen [TxOut era]
</span><a href="#local-6989586621682740800"><span class="hs-identifier hs-var">genWithChange</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621682740797"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682740798"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740799"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-740"></span><span>      </span><span class="annot"><a href="#local-6989586621682740796"><span class="hs-identifier hs-var">goExtra</span></a></span><span> </span><span id="local-6989586621682740801"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740801"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621682740802"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621682740802"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621682740803"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682740803"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621682740804"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740804"><span class="hs-identifier hs-var">txs</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682740805"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740805"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [TxOut era] -&gt; [TxOut era] -&gt; GenRS era [TxOut era]
</span><a href="#local-6989586621682740789"><span class="hs-identifier hs-var">goNew</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740801"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740804"><span class="hs-identifier hs-var">txs</span></a></span><span> </span><span class="annot"><span class="annottext">([TxOut era] -&gt; GenRS era [TxOut era])
-&gt; GenRS era [TxOut era] -&gt; GenRS era [TxOut era]
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Value era -&gt; TxOut era -&gt; [TxOut era] -&gt; GenRS era [TxOut era]
forall {era}.
(Assert
   (OrdCond
      (CmpNat (ProtVerLow era) (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat MinVersion (ProtVerLow era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat MinVersion (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 Reflect era) =&gt;
Value era
-&gt; TxOut era
-&gt; [TxOut era]
-&gt; RWST (GenEnv era) () (GenState era) Gen [TxOut era]
</span><a href="#local-6989586621682740800"><span class="hs-identifier hs-var">genWithChange</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621682740802"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682740803"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740805"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-741"></span><span>      </span><span class="annot"><a href="#local-6989586621682740796"><span class="hs-identifier hs-var">goExtra</span></a></span><span> </span><span id="local-6989586621682740806"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740806"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682740807"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740807"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682740808"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621682740808"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621682740809"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682740809"><span class="hs-identifier hs-var">txOut</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682740810"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682740810"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682740811"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740811"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682740812"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740812"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; Value era
-&gt; TxOut era
-&gt; [TxOut era]
-&gt; [TxOut era]
-&gt; GenRS era [TxOut era]
</span><a href="#local-6989586621682740796"><span class="hs-identifier hs-var">goExtra</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740806"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740807"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621682740808"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Value era -&gt; Value era -&gt; Value era
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621682740813"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682740810"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740811"><span class="hs-identifier hs-var">txs</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740812"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-742"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-743"></span><span>          </span><span id="local-6989586621682740813"><span class="annot"><span class="annottext">v :: Value era
</span><a href="#local-6989586621682740813"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682740809"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
-&gt; Getting (Value era) (TxOut era) (Value era) -&gt; Value era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (Value era) (TxOut era) (Value era)
forall era. EraTxOut era =&gt; Lens' (TxOut era) (Value era)
Lens' (TxOut era) (Value era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#valueTxOutL"><span class="hs-identifier hs-var">valueTxOutL</span></a></span><span>
</span><span id="line-744"></span><span>      </span><span class="hs-comment">-- Potentially split 'txout' into two TxOuts. If the two piece path is used</span><span>
</span><span id="line-745"></span><span>      </span><span class="hs-comment">-- one of two TxOuts uses the same 'addr' as 'txout' and holds the 'change'</span><span>
</span><span id="line-746"></span><span>      </span><span class="hs-comment">-- (i.e. difference between the original and the second, non-change, TxOut).</span><span>
</span><span id="line-747"></span><span>      </span><span class="hs-comment">-- In either case whether it adds 1 or 2 TxOuts to 'rs', the coin value of</span><span>
</span><span id="line-748"></span><span>      </span><span class="hs-comment">-- the new TxOut(s), is the same as the coin value of 'txout'.</span><span>
</span><span id="line-749"></span><span>      </span><span id="local-6989586621682740800"><span class="annot"><span class="annottext">genWithChange :: Value era
-&gt; TxOut era
-&gt; [TxOut era]
-&gt; RWST (GenEnv era) () (GenState era) Gen [TxOut era]
</span><a href="#local-6989586621682740800"><span class="hs-identifier hs-var hs-var">genWithChange</span></a></span></span><span> </span><span id="local-6989586621682743366"><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621682743366"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621682743367"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682743367"><span class="hs-identifier hs-var">txout</span></a></span></span><span> </span><span id="local-6989586621682743368"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682743368"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-750"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682743369"><span class="annot"><span class="annottext">v :: Value era
</span><a href="#local-6989586621682743369"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682743367"><span class="hs-identifier hs-var">txout</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
-&gt; Getting (Value era) (TxOut era) (Value era) -&gt; Value era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (Value era) (TxOut era) (Value era)
forall era. EraTxOut era =&gt; Lens' (TxOut era) (Value era)
Lens' (TxOut era) (Value era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#valueTxOutL"><span class="hs-identifier hs-var">valueTxOutL</span></a></span><span>
</span><span id="line-751"></span><span>            </span><span id="local-6989586621682743370"><span class="annot"><span class="annottext">vCoin :: Integer
</span><a href="#local-6989586621682743370"><span class="hs-identifier hs-var hs-var">vCoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#unCoin"><span class="hs-identifier hs-var">unCoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value era -&gt; Coin
forall t. Val t =&gt; t -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#coin"><span class="hs-identifier hs-var">coin</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621682743369"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-752"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682743370"><span class="hs-identifier hs-var">vCoin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-comment">-- If the coin balance is 0, don't add any TxOuts to 'rs'</span><span>
</span><span id="line-753"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; RWST (GenEnv era) () (GenState era) Gen [TxOut era]
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682743368"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-754"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-755"></span><span>            </span><span id="local-6989586621682743373"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682743373"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Coin)
-&gt; RWST (GenEnv era) () (GenState era) Gen Integer
-&gt; RWST (GenEnv era) () (GenState era) Gen Coin
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Gen Integer -&gt; RWST (GenEnv era) () (GenState era) Gen Integer
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer, Integer) -&gt; Gen Integer
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682743370"><span class="hs-identifier hs-var">vCoin</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span>            </span><span id="local-6989586621682743374"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682743374"><span class="hs-identifier hs-var">newTxOut</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Value era -&gt; RWST (GenEnv era) () (GenState era) Gen (TxOut era)
forall era. Reflect era =&gt; Value era -&gt; GenRS era (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOut"><span class="hs-identifier hs-var">genTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">(Value era -&gt; RWST (GenEnv era) () (GenState era) Gen (TxOut era))
-&gt; Value era -&gt; RWST (GenEnv era) () (GenState era) Gen (TxOut era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621682743366"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Value era -&gt; Value era -&gt; Value era
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Value era
forall t s. Inject t s =&gt; t -&gt; s
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682743373"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-757"></span><span>            </span><span class="annot"><span class="annottext">[TxOut era] -&gt; RWST (GenEnv era) () (GenState era) Gen [TxOut era]
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([TxOut era]
 -&gt; RWST (GenEnv era) () (GenState era) Gen [TxOut era])
-&gt; [TxOut era]
-&gt; RWST (GenEnv era) () (GenState era) Gen [TxOut era]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-758"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682743373"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Value era -&gt; Coin
forall t. Val t =&gt; t -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#coin"><span class="hs-identifier hs-var">coin</span></a></span><span> </span><span class="annot"><span class="annottext">Value era
</span><a href="#local-6989586621682743369"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-759"></span><span>                </span><span class="hs-keyword">then</span><span>
</span><span id="line-760"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621682743376"><span class="annot"><span class="annottext">change :: TxOut era
</span><a href="#local-6989586621682743376"><span class="hs-identifier hs-var hs-var">change</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682743367"><span class="hs-identifier hs-var">txout</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; (TxOut era -&gt; TxOut era) -&gt; TxOut era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Value era -&gt; Identity (Value era))
-&gt; TxOut era -&gt; Identity (TxOut era)
forall era. EraTxOut era =&gt; Lens' (TxOut era) (Value era)
Lens' (TxOut era) (Value era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#valueTxOutL"><span class="hs-identifier hs-var">valueTxOutL</span></a></span><span> </span><span class="annot"><span class="annottext">((Value era -&gt; Identity (Value era))
 -&gt; TxOut era -&gt; Identity (TxOut era))
-&gt; (Value era -&gt; Value era) -&gt; TxOut era -&gt; TxOut era
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%25~"><span class="hs-operator hs-var">%~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value era -&gt; Value era -&gt; Value era
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Value era
forall t s. Inject t s =&gt; t -&gt; s
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682743373"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-761"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682743374"><span class="hs-identifier hs-var">newTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; [TxOut era] -&gt; [TxOut era]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682743376"><span class="hs-identifier hs-var">change</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; [TxOut era] -&gt; [TxOut era]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682743368"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-762"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682743374"><span class="hs-identifier hs-var">newTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; [TxOut era] -&gt; [TxOut era]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682743368"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-763"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; [TxOut era] -&gt; [TxOut era] -&gt; GenRS era [TxOut era]
</span><a href="#local-6989586621682740789"><span class="hs-identifier hs-var">goNew</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682740785"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682740782"><span class="hs-identifier hs-var">txOuts</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-764"></span><span>
</span><span id="line-765"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getTxCertCredential"><span class="hs-identifier hs-type">getTxCertCredential</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-766"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729412"><span class="annot"><a href="#local-6989586621682729412"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729412"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.TxCert.html#TxCert"><span class="hs-identifier hs-type">TxCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729412"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-767"></span><span id="getTxCertCredential"><span class="annot"><span class="annottext">getTxCertCredential :: forall era.
Reflect era =&gt;
TxCert era -&gt; Maybe (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getTxCertCredential"><span class="hs-identifier hs-var hs-var">getTxCertCredential</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682729412"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-768"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-var">Shelley</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxCert era -&gt; Maybe (Credential 'Staking)
ShelleyTxCert ShelleyEra -&gt; Maybe (Credential 'Staking)
forall era. ShelleyTxCert era -&gt; Maybe (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getShelleyTxCertCredential"><span class="hs-identifier hs-var">getShelleyTxCertCredential</span></a></span><span>
</span><span id="line-769"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-var">Mary</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxCert era -&gt; Maybe (Credential 'Staking)
ShelleyTxCert MaryEra -&gt; Maybe (Credential 'Staking)
forall era. ShelleyTxCert era -&gt; Maybe (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getShelleyTxCertCredential"><span class="hs-identifier hs-var">getShelleyTxCertCredential</span></a></span><span>
</span><span id="line-770"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-var">Allegra</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxCert era -&gt; Maybe (Credential 'Staking)
ShelleyTxCert AllegraEra -&gt; Maybe (Credential 'Staking)
forall era. ShelleyTxCert era -&gt; Maybe (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getShelleyTxCertCredential"><span class="hs-identifier hs-var">getShelleyTxCertCredential</span></a></span><span>
</span><span id="line-771"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-var">Alonzo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxCert era -&gt; Maybe (Credential 'Staking)
ShelleyTxCert AlonzoEra -&gt; Maybe (Credential 'Staking)
forall era. ShelleyTxCert era -&gt; Maybe (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getShelleyTxCertCredential"><span class="hs-identifier hs-var">getShelleyTxCertCredential</span></a></span><span>
</span><span id="line-772"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxCert era -&gt; Maybe (Credential 'Staking)
ShelleyTxCert BabbageEra -&gt; Maybe (Credential 'Staking)
forall era. ShelleyTxCert era -&gt; Maybe (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getShelleyTxCertCredential"><span class="hs-identifier hs-var">getShelleyTxCertCredential</span></a></span><span>
</span><span id="line-773"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxCert era -&gt; Maybe (Credential 'Staking)
ConwayTxCert ConwayEra -&gt; Maybe (Credential 'Staking)
forall era. ConwayTxCert era -&gt; Maybe (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-var">getConwayTxCertCredential</span></a></span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span id="local-6989586621682729415"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getShelleyTxCertCredential"><span class="hs-identifier hs-type">getShelleyTxCertCredential</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#ShelleyTxCert"><span class="hs-identifier hs-type">ShelleyTxCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729415"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-776"></span><span id="getShelleyTxCertCredential"><span class="annot"><span class="annottext">getShelleyTxCertCredential :: forall era. ShelleyTxCert era -&gt; Maybe (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getShelleyTxCertCredential"><span class="hs-identifier hs-var hs-var">getShelleyTxCertCredential</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-777"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#ShelleyTxCertDelegCert"><span class="hs-identifier hs-type">ShelleyTxCertDelegCert</span></a></span><span> </span><span id="local-6989586621682743392"><span class="annot"><span class="annottext">ShelleyDelegCert
</span><a href="#local-6989586621682743392"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-778"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ShelleyDelegCert
</span><a href="#local-6989586621682743392"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-779"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#ShelleyRegCert"><span class="hs-identifier hs-type">ShelleyRegCert</span></a></span><span> </span><span id="local-6989586621682743394"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682743394"><span class="hs-identifier hs-var">_rk</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Credential 'Staking)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- we don't require witnesses for ShelleyRegCert</span><span>
</span><span id="line-780"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#ShelleyUnRegCert"><span class="hs-identifier hs-type">ShelleyUnRegCert</span></a></span><span> </span><span id="local-6989586621682743396"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682743396"><span class="hs-identifier hs-var">drk</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Maybe (Credential 'Staking)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682743396"><span class="hs-identifier hs-var">drk</span></a></span><span>
</span><span id="line-781"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#ShelleyDelegCert"><span class="hs-identifier hs-type">ShelleyDelegCert</span></a></span><span> </span><span id="local-6989586621682743398"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682743398"><span class="hs-identifier hs-var">dk</span></a></span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Maybe (Credential 'Staking)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682743398"><span class="hs-identifier hs-var">dk</span></a></span><span>
</span><span id="line-782"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#ShelleyTxCertPool"><span class="hs-identifier hs-type">ShelleyTxCertPool</span></a></span><span> </span><span id="local-6989586621682743400"><span class="annot"><span class="annottext">PoolCert
</span><a href="#local-6989586621682743400"><span class="hs-identifier hs-var">pc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-783"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PoolCert
</span><a href="#local-6989586621682743400"><span class="hs-identifier hs-var">pc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-784"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.TxCert.html#RegPool"><span class="hs-identifier hs-type">RegPool</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#PoolParams"><span class="hs-identifier hs-type">PoolParams</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621682743403"><span id="local-6989586621682743404"><span id="local-6989586621682743405"><span id="local-6989586621682743406"><span id="local-6989586621682743407"><span id="local-6989586621682743408"><span id="local-6989586621682743409"><span id="local-6989586621682743410"><span id="local-6989586621682743411"><span class="annot"><span class="annottext">Set (KeyHash 'Staking)
StrictMaybe PoolMetadata
KeyHash 'StakePool
VRFVerKeyHash 'StakePoolVRF
RewardAccount
Coin
StrictSeq StakePoolRelay
UnitInterval
ppId :: KeyHash 'StakePool
ppVrf :: VRFVerKeyHash 'StakePoolVRF
ppPledge :: Coin
ppCost :: Coin
ppMargin :: UnitInterval
ppRewardAccount :: RewardAccount
ppOwners :: Set (KeyHash 'Staking)
ppRelays :: StrictSeq StakePoolRelay
ppMetadata :: StrictMaybe PoolMetadata
ppId :: PoolParams -&gt; KeyHash 'StakePool
ppVrf :: PoolParams -&gt; VRFVerKeyHash 'StakePoolVRF
ppPledge :: PoolParams -&gt; Coin
ppCost :: PoolParams -&gt; Coin
ppMargin :: PoolParams -&gt; UnitInterval
ppRewardAccount :: PoolParams -&gt; RewardAccount
ppOwners :: PoolParams -&gt; Set (KeyHash 'Staking)
ppRelays :: PoolParams -&gt; StrictSeq StakePoolRelay
ppMetadata :: PoolParams -&gt; StrictMaybe PoolMetadata
</span><a href="#local-6989586621682743403"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Maybe (Credential 'Staking)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Credential 'Staking -&gt; Maybe (Credential 'Staking))
-&gt; (Credential 'StakePool -&gt; Credential 'Staking)
-&gt; Credential 'StakePool
-&gt; Maybe (Credential 'Staking)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Credential 'StakePool -&gt; Credential 'Staking
forall (r :: KeyRole) (r' :: KeyRole).
Credential r -&gt; Credential r'
forall (a :: KeyRole -&gt; *) (r :: KeyRole) (r' :: KeyRole).
HasKeyRole a =&gt;
a r -&gt; a r'
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#coerceKeyRole"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">(Credential 'StakePool -&gt; Maybe (Credential 'Staking))
-&gt; Credential 'StakePool -&gt; Maybe (Credential 'Staking)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; Credential 'StakePool
forall (kr :: KeyRole). KeyHash kr -&gt; Credential kr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#KeyHashObj"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682743403"><span class="hs-identifier hs-var">ppId</span></a></span><span>
</span><span id="line-785"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.TxCert.html#RetirePool"><span class="hs-identifier hs-type">RetirePool</span></a></span><span> </span><span id="local-6989586621682743422"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682743422"><span class="hs-identifier hs-var">kh</span></a></span></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Maybe (Credential 'Staking)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Credential 'Staking -&gt; Maybe (Credential 'Staking))
-&gt; (Credential 'StakePool -&gt; Credential 'Staking)
-&gt; Credential 'StakePool
-&gt; Maybe (Credential 'Staking)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Credential 'StakePool -&gt; Credential 'Staking
forall (r :: KeyRole) (r' :: KeyRole).
Credential r -&gt; Credential r'
forall (a :: KeyRole -&gt; *) (r :: KeyRole) (r' :: KeyRole).
HasKeyRole a =&gt;
a r -&gt; a r'
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#coerceKeyRole"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">(Credential 'StakePool -&gt; Maybe (Credential 'Staking))
-&gt; Credential 'StakePool -&gt; Maybe (Credential 'Staking)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; Credential 'StakePool
forall (kr :: KeyRole). KeyHash kr -&gt; Credential kr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#KeyHashObj"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682743422"><span class="hs-identifier hs-var">kh</span></a></span><span>
</span><span id="line-786"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#ShelleyTxCertGenesisDeleg"><span class="hs-identifier hs-type">ShelleyTxCertGenesisDeleg</span></a></span><span> </span><span id="local-6989586621682743424"><span class="annot"><span class="annottext">GenesisDelegCert
</span><a href="#local-6989586621682743424"><span class="hs-identifier hs-var">_g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Credential 'Staking)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-787"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.TxCert.html#ShelleyTxCertMir"><span class="hs-identifier hs-type">ShelleyTxCertMir</span></a></span><span> </span><span id="local-6989586621682743426"><span class="annot"><span class="annottext">MIRCert
</span><a href="#local-6989586621682743426"><span class="hs-identifier hs-var">_m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Credential 'Staking)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-788"></span><span>
</span><span id="line-789"></span><span id="local-6989586621682729417"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-type">getConwayTxCertCredential</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.TxCert.html#ConwayTxCert"><span class="hs-identifier hs-type">ConwayTxCert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729417"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#Staking"><span class="hs-identifier hs-type">Staking</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-790"></span><span id="getConwayTxCertCredential"><span class="annot"><span class="annottext">getConwayTxCertCredential :: forall era. ConwayTxCert era -&gt; Maybe (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-var hs-var">getConwayTxCertCredential</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.TxCert.html#ConwayTxCertPool"><span class="hs-identifier hs-type">ConwayTxCertPool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.TxCert.html#RegPool"><span class="hs-identifier hs-type">RegPool</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#PoolParams"><span class="hs-identifier hs-type">PoolParams</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621682743430"><span id="local-6989586621682743431"><span id="local-6989586621682743432"><span id="local-6989586621682743433"><span id="local-6989586621682743434"><span id="local-6989586621682743435"><span id="local-6989586621682743436"><span id="local-6989586621682743437"><span id="local-6989586621682743438"><span class="annot"><span class="annottext">Set (KeyHash 'Staking)
StrictMaybe PoolMetadata
KeyHash 'StakePool
VRFVerKeyHash 'StakePoolVRF
RewardAccount
Coin
StrictSeq StakePoolRelay
UnitInterval
ppId :: PoolParams -&gt; KeyHash 'StakePool
ppVrf :: PoolParams -&gt; VRFVerKeyHash 'StakePoolVRF
ppPledge :: PoolParams -&gt; Coin
ppCost :: PoolParams -&gt; Coin
ppMargin :: PoolParams -&gt; UnitInterval
ppRewardAccount :: PoolParams -&gt; RewardAccount
ppOwners :: PoolParams -&gt; Set (KeyHash 'Staking)
ppRelays :: PoolParams -&gt; StrictSeq StakePoolRelay
ppMetadata :: PoolParams -&gt; StrictMaybe PoolMetadata
ppId :: KeyHash 'StakePool
ppVrf :: VRFVerKeyHash 'StakePoolVRF
ppPledge :: Coin
ppCost :: Coin
ppMargin :: UnitInterval
ppRewardAccount :: RewardAccount
ppOwners :: Set (KeyHash 'Staking)
ppRelays :: StrictSeq StakePoolRelay
ppMetadata :: StrictMaybe PoolMetadata
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#ppId"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Maybe (Credential 'Staking)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Credential 'Staking -&gt; Maybe (Credential 'Staking))
-&gt; (Credential 'StakePool -&gt; Credential 'Staking)
-&gt; Credential 'StakePool
-&gt; Maybe (Credential 'Staking)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Credential 'StakePool -&gt; Credential 'Staking
forall (r :: KeyRole) (r' :: KeyRole).
Credential r -&gt; Credential r'
forall (a :: KeyRole -&gt; *) (r :: KeyRole) (r' :: KeyRole).
HasKeyRole a =&gt;
a r -&gt; a r'
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#coerceKeyRole"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">(Credential 'StakePool -&gt; Maybe (Credential 'Staking))
-&gt; Credential 'StakePool -&gt; Maybe (Credential 'Staking)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; Credential 'StakePool
forall (kr :: KeyRole). KeyHash kr -&gt; Credential kr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#KeyHashObj"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682743430"><span class="hs-identifier hs-var">ppId</span></a></span><span>
</span><span id="line-791"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-var">getConwayTxCertCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.TxCert.html#ConwayTxCertPool"><span class="hs-identifier hs-type">ConwayTxCertPool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.TxCert.html#RetirePool"><span class="hs-identifier hs-type">RetirePool</span></a></span><span> </span><span id="local-6989586621682743439"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682743439"><span class="hs-identifier hs-var">kh</span></a></span></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Maybe (Credential 'Staking)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Credential 'Staking -&gt; Maybe (Credential 'Staking))
-&gt; (Credential 'StakePool -&gt; Credential 'Staking)
-&gt; Credential 'StakePool
-&gt; Maybe (Credential 'Staking)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Credential 'StakePool -&gt; Credential 'Staking
forall (r :: KeyRole) (r' :: KeyRole).
Credential r -&gt; Credential r'
forall (a :: KeyRole -&gt; *) (r :: KeyRole) (r' :: KeyRole).
HasKeyRole a =&gt;
a r -&gt; a r'
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#coerceKeyRole"><span class="hs-identifier hs-var">coerceKeyRole</span></a></span><span> </span><span class="annot"><span class="annottext">(Credential 'StakePool -&gt; Maybe (Credential 'Staking))
-&gt; Credential 'StakePool -&gt; Maybe (Credential 'Staking)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; Credential 'StakePool
forall (kr :: KeyRole). KeyHash kr -&gt; Credential kr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#KeyHashObj"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682743439"><span class="hs-identifier hs-var">kh</span></a></span><span>
</span><span id="line-792"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-var">getConwayTxCertCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.TxCert.html#ConwayTxCertDeleg"><span class="hs-identifier hs-type">ConwayTxCertDeleg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.TxCert.html#ConwayRegCert"><span class="hs-identifier hs-type">ConwayRegCert</span></a></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Coin
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Credential 'Staking)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-793"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-var">getConwayTxCertCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.TxCert.html#ConwayTxCertDeleg"><span class="hs-identifier hs-type">ConwayTxCertDeleg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.TxCert.html#ConwayUnRegCert"><span class="hs-identifier hs-type">ConwayUnRegCert</span></a></span><span> </span><span id="local-6989586621682743443"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682743443"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Coin
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Maybe (Credential 'Staking)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682743443"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-794"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-var">getConwayTxCertCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.TxCert.html#ConwayTxCertDeleg"><span class="hs-identifier hs-type">ConwayTxCertDeleg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.TxCert.html#ConwayDelegCert"><span class="hs-identifier hs-type">ConwayDelegCert</span></a></span><span> </span><span id="local-6989586621682743445"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682743445"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="annot"><span class="annottext">Delegatee
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Maybe (Credential 'Staking)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682743445"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-795"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-var">getConwayTxCertCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.TxCert.html#ConwayTxCertDeleg"><span class="hs-identifier hs-type">ConwayTxCertDeleg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.TxCert.html#ConwayRegDelegCert"><span class="hs-identifier hs-type">ConwayRegDelegCert</span></a></span><span> </span><span id="local-6989586621682743447"><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682743447"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="annot"><span class="annottext">Delegatee
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Coin
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential 'Staking -&gt; Maybe (Credential 'Staking)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Staking
</span><a href="#local-6989586621682743447"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-796"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#getConwayTxCertCredential"><span class="hs-identifier hs-var">getConwayTxCertCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-conway-1.21.0.0/doc/html/cardano-ledger-conway/src/Cardano.Ledger.Conway.TxCert.html#ConwayTxCertGov"><span class="hs-identifier hs-type">ConwayTxCertGov</span></a></span><span> </span><span class="annot"><span class="annottext">ConwayGovCert
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Credential 'Staking)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-797"></span><span>
</span><span id="line-798"></span><span id="local-6989586621682729433"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genWithdrawals"><span class="hs-identifier hs-type">genWithdrawals</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-799"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729433"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729433"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#Withdrawals"><span class="hs-identifier hs-type">Withdrawals</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-800"></span><span id="genWithdrawals"><span class="annot"><span class="annottext">genWithdrawals :: forall era. Reflect era =&gt; SlotNo -&gt; GenRS era Withdrawals
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genWithdrawals"><span class="hs-identifier hs-var hs-var">genWithdrawals</span></a></span></span><span> </span><span id="local-6989586621682743463"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682743463"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-801"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; EpochNo
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-test-1.7.0.0/doc/html/cardano-ledger-shelley-test/src/Test.Cardano.Ledger.Shelley.Utils.html#epochFromSlotNo"><span class="hs-identifier hs-var">epochFromSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682743463"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; EpochNo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; EpochNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-var">EpochNo</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-802"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-803"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682743464"><span class="annot"><span class="annottext">networkId :: Network
</span><a href="#local-6989586621682743464"><span class="hs-identifier hs-var hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#Testnet"><span class="hs-identifier hs-var">Testnet</span></a></span><span>
</span><span id="line-804"></span><span>      </span><span id="local-6989586621682743466"><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682743466"><span class="hs-identifier hs-var">newRewards</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era (Map (Credential 'Staking) Coin)
forall era.
Reflect era =&gt;
GenRS era (Map (Credential 'Staking) Coin)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genRewards"><span class="hs-identifier hs-var">genRewards</span></a></span><span>
</span><span id="line-805"></span><span>      </span><span class="annot"><span class="annottext">Withdrawals -&gt; GenRS era Withdrawals
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map RewardAccount Coin -&gt; Withdrawals
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#Withdrawals"><span class="hs-identifier hs-var">Withdrawals</span></a></span><span> </span><span class="annot"><span class="annottext">(Map RewardAccount Coin -&gt; Withdrawals)
-&gt; Map RewardAccount Coin -&gt; Withdrawals
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Credential 'Staking -&gt; RewardAccount)
-&gt; Map (Credential 'Staking) Coin -&gt; Map RewardAccount Coin
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">Map.mapKeys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Network -&gt; Credential 'Staking -&gt; RewardAccount
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#RewardAccount"><span class="hs-identifier hs-var">RewardAccount</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621682743464"><span class="hs-identifier hs-var">networkId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Credential 'Staking) Coin
</span><a href="#local-6989586621682743466"><span class="hs-identifier hs-var">newRewards</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-806"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Withdrawals -&gt; GenRS era Withdrawals
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map RewardAccount Coin -&gt; Withdrawals
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#Withdrawals"><span class="hs-identifier hs-var">Withdrawals</span></a></span><span> </span><span class="annot"><span class="annottext">Map RewardAccount Coin
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-807"></span><span>
</span><span id="line-808"></span><span class="hs-comment">-- ============================================================================</span><span>
</span><span id="line-809"></span><span>
</span><span id="line-810"></span><span id="local-6989586621682729440"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#minus"><span class="hs-identifier hs-type">minus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier hs-type">MUtxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729440"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#UtxoEntry"><span class="hs-identifier hs-type">UtxoEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729440"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier hs-type">MUtxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729440"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-811"></span><span id="minus"><span class="annot"><span class="annottext">minus :: forall era. MUtxo era -&gt; Maybe (UtxoEntry era) -&gt; MUtxo era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#minus"><span class="hs-identifier hs-var hs-var">minus</span></a></span></span><span> </span><span id="local-6989586621682743472"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621682743472"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (UtxoEntry era)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621682743472"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-812"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#minus"><span class="hs-identifier hs-var">minus</span></a></span><span> </span><span id="local-6989586621682743473"><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621682743473"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682743474"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621682743474"><span class="hs-identifier hs-var">txin</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; MUtxo era -&gt; MUtxo era
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621682743474"><span class="hs-identifier hs-var">txin</span></a></span><span> </span><span class="annot"><span class="annottext">MUtxo era
</span><a href="#local-6989586621682743473"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-813"></span><span>
</span><span id="line-814"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genAlonzoTx"><span class="hs-identifier hs-type">genAlonzoTx</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-815"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729442"><span class="annot"><a href="#local-6989586621682729442"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-816"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729442"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-817"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729442"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729442"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729442"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-818"></span><span id="genAlonzoTx"><span class="annot"><span class="annottext">genAlonzoTx :: forall era.
EraGenericGen era =&gt;
SlotNo -&gt; GenRS era (UTxO era, Tx era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genAlonzoTx"><span class="hs-identifier hs-var hs-var">genAlonzoTx</span></a></span></span><span> </span><span id="local-6989586621682743482"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682743482"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-819"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682743483"><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621682743483"><span class="hs-identifier hs-var">utxo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682743484"><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621682743484"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682743485"><span class="annot"><span class="annottext">(TxIn, TxOut era)
</span><a href="#local-6989586621682743485"><span class="hs-identifier hs-var">_fee</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682743486"><span class="annot"><span class="annottext">Maybe (TxIn, TxOut era)
</span><a href="#local-6989586621682743486"><span class="hs-identifier hs-var">_old</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SlotNo
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (UTxO era, Tx era, (TxIn, TxOut era), Maybe (TxIn, TxOut era))
forall era.
EraGenericGen era =&gt;
SlotNo
-&gt; GenRS
     era (UTxO era, Tx era, UtxoEntry era, Maybe (UtxoEntry era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genAlonzoTxAndInfo"><span class="hs-identifier hs-var">genAlonzoTxAndInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682743482"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-820"></span><span>  </span><span class="annot"><span class="annottext">(UTxO era, Tx era) -&gt; GenRS era (UTxO era, Tx era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621682743483"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621682743484"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-821"></span><span>
</span><span id="line-822"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#applyIsValid"><span class="hs-identifier hs-type">applyIsValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729446"><span class="annot"><a href="#local-6989586621682729446"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729446"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#IsValid"><span class="hs-identifier hs-type">IsValid</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729446"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729446"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-823"></span><span id="applyIsValid"><span class="annot"><span class="annottext">applyIsValid :: forall era. Reflect era =&gt; IsValid -&gt; Tx era -&gt; Tx era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#applyIsValid"><span class="hs-identifier hs-var hs-var">applyIsValid</span></a></span></span><span> </span><span id="local-6989586621682743491"><span class="annot"><span class="annottext">IsValid
</span><a href="#local-6989586621682743491"><span class="hs-identifier hs-var">isValid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682729446"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-824"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Shelley"><span class="hs-identifier hs-var">Shelley</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tx era -&gt; Tx era
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-825"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-var">Mary</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tx era -&gt; Tx era
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-826"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-var">Allegra</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tx era -&gt; Tx era
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-827"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-var">Alonzo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(IsValid -&gt; Identity IsValid) -&gt; Tx era -&gt; Identity (Tx era)
forall era. AlonzoEraTx era =&gt; Lens' (Tx era) IsValid
Lens' (Tx era) IsValid
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#isValidTxL"><span class="hs-identifier hs-var">isValidTxL</span></a></span><span> </span><span class="annot"><span class="annottext">((IsValid -&gt; Identity IsValid) -&gt; Tx era -&gt; Identity (Tx era))
-&gt; IsValid -&gt; Tx era -&gt; Tx era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">IsValid
</span><a href="#local-6989586621682743491"><span class="hs-identifier hs-var">isValid</span></a></span><span>
</span><span id="line-828"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(IsValid -&gt; Identity IsValid) -&gt; Tx era -&gt; Identity (Tx era)
forall era. AlonzoEraTx era =&gt; Lens' (Tx era) IsValid
Lens' (Tx era) IsValid
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#isValidTxL"><span class="hs-identifier hs-var">isValidTxL</span></a></span><span> </span><span class="annot"><span class="annottext">((IsValid -&gt; Identity IsValid) -&gt; Tx era -&gt; Identity (Tx era))
-&gt; IsValid -&gt; Tx era -&gt; Tx era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">IsValid
</span><a href="#local-6989586621682743491"><span class="hs-identifier hs-var">isValid</span></a></span><span>
</span><span id="line-829"></span><span>  </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Conway"><span class="hs-identifier hs-var">Conway</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(IsValid -&gt; Identity IsValid) -&gt; Tx era -&gt; Identity (Tx era)
forall era. AlonzoEraTx era =&gt; Lens' (Tx era) IsValid
Lens' (Tx era) IsValid
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#isValidTxL"><span class="hs-identifier hs-var">isValidTxL</span></a></span><span> </span><span class="annot"><span class="annottext">((IsValid -&gt; Identity IsValid) -&gt; Tx era -&gt; Identity (Tx era))
-&gt; IsValid -&gt; Tx era -&gt; Tx era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">IsValid
</span><a href="#local-6989586621682743491"><span class="hs-identifier hs-var">isValid</span></a></span><span>
</span><span id="line-830"></span><span>
</span><span id="line-831"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genAlonzoTxAndInfo"><span class="hs-identifier hs-type">genAlonzoTxAndInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-832"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729445"><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-833"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-834"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-835"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span>
</span><span id="line-836"></span><span>    </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-837"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-838"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-839"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#UtxoEntry"><span class="hs-identifier hs-type">UtxoEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-comment">-- The fee key</span><span>
</span><span id="line-840"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#UtxoEntry"><span class="hs-identifier hs-type">UtxoEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- from oldUtxO</span><span>
</span><span id="line-841"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-842"></span><span id="genAlonzoTxAndInfo"><span class="annot"><span class="annottext">genAlonzoTxAndInfo :: forall era.
EraGenericGen era =&gt;
SlotNo
-&gt; GenRS
     era (UTxO era, Tx era, UtxoEntry era, Maybe (UtxoEntry era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genAlonzoTxAndInfo"><span class="hs-identifier hs-var hs-var">genAlonzoTxAndInfo</span></a></span></span><span> </span><span id="local-6989586621682743774"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682743774"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-843"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier hs-type">GenEnv</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621682743775"><span class="annot"><span class="annottext">PParams era
gePParams :: forall era. GenEnv era -&gt; PParams era
gePParams :: PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var hs-var">gePParams</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; GenEnv era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (GenEnv era)
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; GenEnv era
forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span>
</span><span id="line-844"></span><span>  </span><span id="local-6989586621682743776"><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621682743776"><span class="hs-identifier hs-var">validityInterval</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen ValidityInterval
-&gt; RWST (GenEnv era) () (GenState era) Gen ValidityInterval
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen ValidityInterval
 -&gt; RWST (GenEnv era) () (GenState era) Gen ValidityInterval)
-&gt; Gen ValidityInterval
-&gt; RWST (GenEnv era) () (GenState era) Gen ValidityInterval
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Gen ValidityInterval
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genValidityInterval"><span class="hs-identifier hs-var">genValidityInterval</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682743774"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-845"></span><span>  </span><span class="annot"><span class="annottext">(GenState era -&gt; GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall w (m :: * -&gt; *) s r.
(Monoid w, Monad m) =&gt;
(s -&gt; s) -&gt; RWST r w s m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682743777"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682743777"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682743777"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#gsValidityInterval"><span class="hs-identifier hs-var">gsValidityInterval</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682743776"><span class="hs-identifier hs-type">validityInterval</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-846"></span><span>
</span><span id="line-847"></span><span>  </span><span class="hs-comment">-- 1. Produce utxos that will be spent</span><span>
</span><span id="line-848"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682743779"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682743779"><span class="hs-identifier hs-var">utxoChoices</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682743780"><span class="annot"><span class="annottext">Maybe (UtxoEntry era)
</span><a href="#local-6989586621682743780"><span class="hs-identifier hs-var">maybeoldpair</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenRS era (Map TxIn (TxOut era), Maybe (UtxoEntry era))
forall era.
EraGenericGen era =&gt;
GenRS era (MUtxo era, Maybe (UtxoEntry era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genUTxO"><span class="hs-identifier hs-var">genUTxO</span></a></span><span>
</span><span id="line-849"></span><span>
</span><span id="line-850"></span><span>  </span><span class="hs-comment">-- 2. Generate UTxO for spending and reference inputs</span><span>
</span><span id="line-851"></span><span>  </span><span class="hs-comment">--    Note the spending inputs and the reference inputs may overlap.</span><span>
</span><span id="line-852"></span><span>  </span><span class="hs-comment">--    feeKey is one of the inputs from the spending inputs, safe to pay the fee with.</span><span>
</span><span id="line-853"></span><span>  </span><span class="hs-special">(</span><span> </span><span id="local-6989586621682743781"><span class="annot"><span class="annottext">feepair :: UtxoEntry era
</span><a href="#local-6989586621682743781"><span class="hs-identifier hs-var">feepair</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621682743782"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621682743782"><span class="hs-identifier hs-var">feeKey</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- One of the spending inputs, to be used to pay the fee</span><span>
</span><span id="line-854"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682743783"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682743783"><span class="hs-identifier hs-var">toSpendNoCollateral</span></a></span></span><span> </span><span class="hs-comment">-- All of the spending inputs</span><span>
</span><span id="line-855"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682743784"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682743784"><span class="hs-identifier hs-var">refInputsUtxo</span></a></span></span><span> </span><span class="hs-comment">-- All the reference inputs</span><span>
</span><span id="line-856"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682743785"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682743785"><span class="hs-identifier hs-var">utxoNoCollateral</span></a></span></span><span> </span><span class="hs-comment">-- Union of all the above</span><span>
</span><span id="line-857"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-858"></span><span>    </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (UtxoEntry era, Map TxIn (TxOut era), Map TxIn (TxOut era),
      Map TxIn (TxOut era))
forall era.
Map TxIn (TxOut era)
-&gt; GenRS
     era
     (UtxoEntry era, Map TxIn (TxOut era), Map TxIn (TxOut era),
      Map TxIn (TxOut era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genSpendReferenceInputs"><span class="hs-identifier hs-var">genSpendReferenceInputs</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682743779"><span class="hs-identifier hs-var">utxoChoices</span></a></span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span>  </span><span class="hs-comment">-- 3. Check if all Plutus scripts are valid</span><span>
</span><span id="line-861"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621682743786"><span class="hs-identifier hs-type">toSpendNoCollateralTxOuts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-862"></span><span>      </span><span id="local-6989586621682743786"><span class="annot"><span class="annottext">toSpendNoCollateralTxOuts :: [TxOut era]
</span><a href="#local-6989586621682743786"><span class="hs-identifier hs-var hs-var">toSpendNoCollateralTxOuts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; [TxOut era]
forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682743783"><span class="hs-identifier hs-var">toSpendNoCollateral</span></a></span><span>
</span><span id="line-863"></span><span>      </span><span class="hs-comment">-- We use maxBound to ensure the serialized size overestimation</span><span>
</span><span id="line-864"></span><span>      </span><span id="local-6989586621682743791"><span class="annot"><span class="annottext">maxCoin :: Coin
</span><a href="#local-6989586621682743791"><span class="hs-identifier hs-var hs-var">maxCoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-865"></span><span>  </span><span class="hs-comment">-- 4. Generate all recipients and witnesses needed for spending Plutus scripts</span><span>
</span><span id="line-866"></span><span>  </span><span id="local-6989586621682743793"><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682743793"><span class="hs-identifier hs-var">recipients</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; RWST (GenEnv era) () (GenState era) Gen [TxOut era]
forall era.
EraGenericGen era =&gt;
[TxOut era] -&gt; GenRS era [TxOut era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genRecipientsFrom"><span class="hs-identifier hs-var">genRecipientsFrom</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682743786"><span class="hs-identifier hs-var">toSpendNoCollateralTxOuts</span></a></span><span>
</span><span id="line-867"></span><span>
</span><span id="line-868"></span><span>  </span><span class="hs-comment">-- mkPaymentWits :: ExUnits -&gt; TxWits era -&gt; TxWits era</span><span>
</span><span id="line-869"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#IsValid"><span class="hs-identifier hs-type">IsValid</span></a></span><span> </span><span id="local-6989586621682743794"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682743794"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682743795"><span class="annot"><span class="annottext">[ExUnits -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743795"><span class="hs-identifier hs-var">mkPaymentWits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-870"></span><span>    </span><span class="annot"><span class="annottext">PlutusPurposeTag
-&gt; [Maybe (GenRS era (Data era), Credential 'Payment)]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era])
forall era (k :: KeyRole).
EraGenericGen era =&gt;
PlutusPurposeTag
-&gt; [Maybe (GenRS era (Data era), Credential k)]
-&gt; GenRS era (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#redeemerWitnessMaker"><span class="hs-identifier hs-var">redeemerWitnessMaker</span></a></span><span>
</span><span id="line-871"></span><span>      </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span>
</span><span id="line-872"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682743796"><span class="annot"><span class="annottext">DataHash
</span><a href="#local-6989586621682743796"><span class="hs-identifier hs-var">dh</span></a></span></span><span> </span><span id="local-6989586621682743797"><span class="annot"><span class="annottext">Credential 'Payment
</span><a href="#local-6989586621682743797"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
-&gt; DataHash
-&gt; (GenState era -&gt; Map DataHash (Data era))
-&gt; GenRS era (Data era)
forall k era v.
(Ord k, Show k, HasCallStack) =&gt;
[Char] -&gt; k -&gt; (GenState era -&gt; Map k v) -&gt; GenRS era v
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#lookupByKeyM"><span class="hs-identifier hs-var">lookupByKeyM</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;datum&quot;</span></span><span> </span><span class="annot"><span class="annottext">DataHash
</span><a href="#local-6989586621682743796"><span class="hs-identifier hs-var">dh</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Map DataHash (Data era)
forall era. GenState era -&gt; Map DataHash (Data era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsDatums"><span class="hs-identifier hs-var">gsDatums</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Credential 'Payment
</span><a href="#local-6989586621682743797"><span class="hs-identifier hs-var">cred</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-873"></span><span>          </span><span class="annot"><span class="annottext">(DataHash
 -&gt; Credential 'Payment
 -&gt; (GenRS era (Data era), Credential 'Payment))
-&gt; Maybe DataHash
-&gt; Maybe
     (Credential 'Payment
      -&gt; (GenRS era (Data era), Credential 'Payment))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe DataHash
</span><a href="#local-6989586621682743798"><span class="hs-identifier hs-var">mDatumHash</span></a></span><span>
</span><span id="line-874"></span><span>          </span><span class="annot"><span class="annottext">Maybe
  (Credential 'Payment
   -&gt; (GenRS era (Data era), Credential 'Payment))
-&gt; Maybe (Credential 'Payment)
-&gt; Maybe (GenRS era (Data era), Credential 'Payment)
forall a b. Maybe (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Payment -&gt; Maybe (Credential 'Payment)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Credential 'Payment
</span><a href="#local-6989586621682743799"><span class="hs-identifier hs-var">credential</span></a></span><span>
</span><span id="line-875"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682743800"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682743800"><span class="hs-identifier hs-var">coretxout</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; [UtxoEntry era]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toAscList</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682743783"><span class="hs-identifier hs-var">toSpendNoCollateral</span></a></span><span>
</span><span id="line-876"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682743802"><span class="annot"><span class="annottext">[Credential 'Payment]
</span><a href="#local-6989586621682743802"><span class="hs-identifier hs-var">credentials</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682743798"><span class="annot"><span class="annottext">Maybe DataHash
</span><a href="#local-6989586621682743798"><span class="hs-identifier hs-var">mDatumHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proof era -&gt; TxOut era -&gt; ([Credential 'Payment], Maybe DataHash)
forall era.
Proof era -&gt; TxOut era -&gt; ([Credential 'Payment], Maybe DataHash)
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#txoutEvidence"><span class="hs-identifier hs-var">txoutEvidence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682743800"><span class="hs-identifier hs-var">coretxout</span></a></span><span>
</span><span id="line-877"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682743799"><span class="annot"><span class="annottext">Credential 'Payment
</span><a href="#local-6989586621682743799"><span class="hs-identifier hs-var">credential</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Credential 'Payment]
</span><a href="#local-6989586621682743802"><span class="hs-identifier hs-var">credentials</span></a></span><span>
</span><span id="line-878"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-879"></span><span>
</span><span id="line-880"></span><span>  </span><span class="hs-comment">-- generate Withdrawals before TxCerts, as Rewards are populated in the Model here,</span><span>
</span><span id="line-881"></span><span>  </span><span class="hs-comment">-- and we need to avoid certain TxCerts if they conflict with existing Rewards</span><span>
</span><span id="line-882"></span><span>  </span><span id="local-6989586621682743804"><span class="annot"><span class="annottext">withdrawals :: Withdrawals
</span><a href="#local-6989586621682743804"><span class="hs-identifier hs-var">withdrawals</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#Withdrawals"><span class="hs-identifier hs-type">Withdrawals</span></a></span><span> </span><span id="local-6989586621682743805"><span class="annot"><span class="annottext">Map RewardAccount Coin
</span><a href="#local-6989586621682743805"><span class="hs-identifier hs-var">wdrlMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; GenRS era Withdrawals
forall era. Reflect era =&gt; SlotNo -&gt; GenRS era Withdrawals
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genWithdrawals"><span class="hs-identifier hs-var">genWithdrawals</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682743774"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-883"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682743806"><span class="annot"><span class="annottext">withdrawalAmount :: Coin
</span><a href="#local-6989586621682743806"><span class="hs-identifier hs-var hs-var">withdrawalAmount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map RewardAccount Coin -&gt; Coin
forall m. Monoid m =&gt; Map RewardAccount m -&gt; m
forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><span class="hs-identifier hs-var">F.fold</span></span><span> </span><span class="annot"><span class="annottext">Map RewardAccount Coin
</span><a href="#local-6989586621682743805"><span class="hs-identifier hs-var">wdrlMap</span></a></span><span>
</span><span id="line-884"></span><span>
</span><span id="line-885"></span><span>  </span><span id="local-6989586621682743808"><span class="annot"><span class="annottext">Maybe (TxOut era)
</span><a href="#local-6989586621682743808"><span class="hs-identifier hs-var">rewardsWithdrawalTxOut</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-886"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682743806"><span class="hs-identifier hs-var">withdrawalAmount</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-887"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (TxOut era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Maybe (TxOut era))
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (TxOut era)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-888"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; Maybe (TxOut era)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(TxOut era -&gt; Maybe (TxOut era))
-&gt; RWST (GenEnv era) () (GenState era) Gen (TxOut era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Maybe (TxOut era))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value era -&gt; RWST (GenEnv era) () (GenState era) Gen (TxOut era)
forall era. Reflect era =&gt; Value era -&gt; GenRS era (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOut"><span class="hs-identifier hs-var">genTxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin -&gt; Value era
forall t s. Inject t s =&gt; t -&gt; s
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682743806"><span class="hs-identifier hs-var">withdrawalAmount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-889"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682743809"><span class="annot"><span class="annottext">wdrlCreds :: [Credential 'Staking]
</span><a href="#local-6989586621682743809"><span class="hs-identifier hs-var hs-var">wdrlCreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((RewardAccount, Coin) -&gt; Credential 'Staking)
-&gt; [(RewardAccount, Coin)] -&gt; [Credential 'Staking]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RewardAccount -&gt; Credential 'Staking
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#raCredential"><span class="hs-identifier hs-var">raCredential</span></a></span><span> </span><span class="annot"><span class="annottext">(RewardAccount -&gt; Credential 'Staking)
-&gt; ((RewardAccount, Coin) -&gt; RewardAccount)
-&gt; (RewardAccount, Coin)
-&gt; Credential 'Staking
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(RewardAccount, Coin) -&gt; RewardAccount
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(RewardAccount, Coin)] -&gt; [Credential 'Staking])
-&gt; [(RewardAccount, Coin)] -&gt; [Credential 'Staking]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map RewardAccount Coin -&gt; [(RewardAccount, Coin)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toAscList</span></span><span> </span><span class="annot"><span class="annottext">Map RewardAccount Coin
</span><a href="#local-6989586621682743805"><span class="hs-identifier hs-var">wdrlMap</span></a></span><span>
</span><span id="line-890"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#IsValid"><span class="hs-identifier hs-type">IsValid</span></a></span><span> </span><span id="local-6989586621682743811"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682743811"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682743812"><span class="annot"><span class="annottext">[ExUnits -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743812"><span class="hs-identifier hs-var">mkWithdrawalsWits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-891"></span><span>    </span><span class="annot"><span class="annottext">PlutusPurposeTag
-&gt; [Maybe (GenRS era (Data era), Credential 'Staking)]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era])
forall era (k :: KeyRole).
EraGenericGen era =&gt;
PlutusPurposeTag
-&gt; [Maybe (GenRS era (Data era), Credential k)]
-&gt; GenRS era (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#redeemerWitnessMaker"><span class="hs-identifier hs-var">redeemerWitnessMaker</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe (GenRS era (Data era), Credential 'Staking)]
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era]))
-&gt; [Maybe (GenRS era (Data era), Credential 'Staking)]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Credential 'Staking
 -&gt; Maybe (GenRS era (Data era), Credential 'Staking))
-&gt; [Credential 'Staking]
-&gt; [Maybe (GenRS era (Data era), Credential 'Staking)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(GenRS era (Data era), Credential 'Staking)
-&gt; Maybe (GenRS era (Data era), Credential 'Staking)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((GenRS era (Data era), Credential 'Staking)
 -&gt; Maybe (GenRS era (Data era), Credential 'Staking))
-&gt; (Credential 'Staking
    -&gt; (GenRS era (Data era), Credential 'Staking))
-&gt; Credential 'Staking
-&gt; Maybe (GenRS era (Data era), Credential 'Staking)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenRS era (Data era)
forall era. Era era =&gt; GenRS era (Data era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genDatum"><span class="hs-identifier hs-var">genDatum</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Credential 'Staking]
</span><a href="#local-6989586621682743809"><span class="hs-identifier hs-var">wdrlCreds</span></a></span><span>
</span><span id="line-892"></span><span>
</span><span id="line-893"></span><span>  </span><span id="local-6989586621682743813"><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682743813"><span class="hs-identifier hs-var">dcerts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; RWST (GenEnv era) () (GenState era) Gen [TxCert era]
forall era. Reflect era =&gt; SlotNo -&gt; GenRS era [TxCert era]
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxCerts"><span class="hs-identifier hs-var">genTxCerts</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682743774"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-894"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682743814"><span class="annot"><span class="annottext">dcertCreds :: [Maybe (Credential 'Staking)]
</span><a href="#local-6989586621682743814"><span class="hs-identifier hs-var hs-var">dcertCreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxCert era -&gt; Maybe (Credential 'Staking))
-&gt; [TxCert era] -&gt; [Maybe (Credential 'Staking)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TxCert era -&gt; Maybe (Credential 'Staking)
forall era.
Reflect era =&gt;
TxCert era -&gt; Maybe (Credential 'Staking)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#getTxCertCredential"><span class="hs-identifier hs-var">getTxCertCredential</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682743813"><span class="hs-identifier hs-var">dcerts</span></a></span><span>
</span><span id="line-895"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#IsValid"><span class="hs-identifier hs-type">IsValid</span></a></span><span> </span><span id="local-6989586621682743815"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682743815"><span class="hs-identifier hs-var">v3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682743816"><span class="annot"><span class="annottext">[ExUnits -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743816"><span class="hs-identifier hs-var">mkCertsWits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-896"></span><span>    </span><span class="annot"><span class="annottext">PlutusPurposeTag
-&gt; [Maybe (GenRS era (Data era), Credential 'Staking)]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era])
forall era (k :: KeyRole).
EraGenericGen era =&gt;
PlutusPurposeTag
-&gt; [Maybe (GenRS era (Data era), Credential k)]
-&gt; GenRS era (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era])
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#redeemerWitnessMaker"><span class="hs-identifier hs-var">redeemerWitnessMaker</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Certifying"><span class="hs-identifier hs-var">Certifying</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe (GenRS era (Data era), Credential 'Staking)]
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era]))
-&gt; [Maybe (GenRS era (Data era), Credential 'Staking)]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (IsValid, [ExUnits -&gt; TxWits era -&gt; TxWits era])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Credential 'Staking)
 -&gt; Maybe (GenRS era (Data era), Credential 'Staking))
-&gt; [Maybe (Credential 'Staking)]
-&gt; [Maybe (GenRS era (Data era), Credential 'Staking)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenRS era (Data era)
forall era. Era era =&gt; GenRS era (Data era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genDatum"><span class="hs-identifier hs-var">genDatum</span></a></span><span> </span><span class="annot"><span class="annottext">(Credential 'Staking
 -&gt; (GenRS era (Data era), Credential 'Staking))
-&gt; Maybe (Credential 'Staking)
-&gt; Maybe (GenRS era (Data era), Credential 'Staking)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe (Credential 'Staking)]
</span><a href="#local-6989586621682743814"><span class="hs-identifier hs-var">dcertCreds</span></a></span><span>
</span><span id="line-897"></span><span>
</span><span id="line-898"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682743817"><span class="annot"><span class="annottext">isValid :: IsValid
</span><a href="#local-6989586621682743817"><span class="hs-identifier hs-var hs-var">isValid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IsValid
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Tx.html#IsValid"><span class="hs-identifier hs-var">IsValid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682743794"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682743811"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682743815"><span class="hs-identifier hs-var">v3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-899"></span><span>      </span><span class="annot"><a href="#local-6989586621682743819"><span class="hs-identifier hs-type">mkWits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Plutus.ExUnits.html#ExUnits"><span class="hs-identifier hs-type">ExUnits</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-900"></span><span>      </span><span id="local-6989586621682743819"><span class="annot"><span class="annottext">mkWits :: [ExUnits -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743819"><span class="hs-identifier hs-var hs-var">mkWits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ExUnits -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743795"><span class="hs-identifier hs-var">mkPaymentWits</span></a></span><span> </span><span class="annot"><span class="annottext">[ExUnits -&gt; TxWits era -&gt; TxWits era]
-&gt; [ExUnits -&gt; TxWits era -&gt; TxWits era]
-&gt; [ExUnits -&gt; TxWits era -&gt; TxWits era]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ExUnits -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743816"><span class="hs-identifier hs-var">mkCertsWits</span></a></span><span> </span><span class="annot"><span class="annottext">[ExUnits -&gt; TxWits era -&gt; TxWits era]
-&gt; [ExUnits -&gt; TxWits era -&gt; TxWits era]
-&gt; [ExUnits -&gt; TxWits era -&gt; TxWits era]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ExUnits -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743812"><span class="hs-identifier hs-var">mkWithdrawalsWits</span></a></span><span>
</span><span id="line-901"></span><span>  </span><span id="local-6989586621682743820"><span class="annot"><span class="annottext">[ExUnits]
</span><a href="#local-6989586621682743820"><span class="hs-identifier hs-var">exUnits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; GenRS era [ExUnits]
forall era. EraGenericGen era =&gt; Int -&gt; GenRS era [ExUnits]
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#genExUnits"><span class="hs-identifier hs-var">genExUnits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ExUnits -&gt; TxWits era -&gt; TxWits era] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ExUnits -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743819"><span class="hs-identifier hs-var">mkWits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-902"></span><span>
</span><span id="line-903"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-904"></span><span>    </span><span class="annot"><a href="#local-6989586621682743822"><span class="hs-identifier hs-type">redeemerWitsList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-905"></span><span>    </span><span id="local-6989586621682743822"><span class="annot"><span class="annottext">redeemerWitsList :: TxWits era -&gt; TxWits era
</span><a href="#local-6989586621682743822"><span class="hs-identifier hs-var hs-var">redeemerWitsList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxWits era -&gt; TxWits era] -&gt; TxWits era -&gt; TxWits era
forall a. [a -&gt; a] -&gt; a -&gt; a
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#foldFn"><span class="hs-identifier hs-var">foldFn</span></a></span><span> </span><span class="annot"><span class="annottext">([TxWits era -&gt; TxWits era] -&gt; TxWits era -&gt; TxWits era)
-&gt; [TxWits era -&gt; TxWits era] -&gt; TxWits era -&gt; TxWits era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((ExUnits -&gt; TxWits era -&gt; TxWits era)
 -&gt; ExUnits -&gt; TxWits era -&gt; TxWits era)
-&gt; [ExUnits -&gt; TxWits era -&gt; TxWits era]
-&gt; [ExUnits]
-&gt; [TxWits era -&gt; TxWits era]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">(ExUnits -&gt; TxWits era -&gt; TxWits era)
-&gt; ExUnits -&gt; TxWits era -&gt; TxWits era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">($)</span></span><span> </span><span class="annot"><span class="annottext">[ExUnits -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743819"><span class="hs-identifier hs-var">mkWits</span></a></span><span> </span><span class="annot"><span class="annottext">[ExUnits]
</span><a href="#local-6989586621682743820"><span class="hs-identifier hs-var">exUnits</span></a></span><span>
</span><span id="line-906"></span><span>  </span><span id="local-6989586621682743825"><span class="annot"><span class="annottext">TxWits era -&gt; TxWits era
</span><a href="#local-6989586621682743825"><span class="hs-identifier hs-var">datumWitsList</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TxWits era -&gt; TxWits era] -&gt; TxWits era -&gt; TxWits era
forall a. [a -&gt; a] -&gt; a -&gt; a
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#foldFn"><span class="hs-identifier hs-var">foldFn</span></a></span><span> </span><span class="annot"><span class="annottext">([TxWits era -&gt; TxWits era] -&gt; TxWits era -&gt; TxWits era)
-&gt; RWST
     (GenEnv era) () (GenState era) Gen [TxWits era -&gt; TxWits era]
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (TxWits era -&gt; TxWits era)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TxOut era
 -&gt; RWST
      (GenEnv era) () (GenState era) Gen (TxWits era -&gt; TxWits era))
-&gt; [TxOut era]
-&gt; RWST
     (GenEnv era) () (GenState era) Gen [TxWits era -&gt; TxWits era]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TxOut era
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (TxWits era -&gt; TxWits era)
forall era.
Reflect era =&gt;
TxOut era -&gt; GenRS era (TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#makeDatumWitness"><span class="hs-identifier hs-var">makeDatumWitness</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; [TxOut era]
forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682743783"><span class="hs-identifier hs-var">toSpendNoCollateral</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-907"></span><span>  </span><span id="local-6989586621682743826"><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743826"><span class="hs-identifier hs-var">keyWitsMakers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-908"></span><span>    </span><span class="annot"><span class="annottext">(TxOut era
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era))
-&gt; [TxOut era]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span>
</span><span id="line-909"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; TxOut era
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
Reflect era =&gt;
Maybe PlutusPurposeTag
-&gt; TxOut era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOutKeyWitness"><span class="hs-identifier hs-var">genTxOutKeyWitness</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlutusPurposeTag -&gt; Maybe PlutusPurposeTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Spending"><span class="hs-identifier hs-var">Spending</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-910"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682743786"><span class="hs-identifier hs-var">toSpendNoCollateralTxOuts</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; [TxOut era] -&gt; [TxOut era]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; [TxOut era]
forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682743784"><span class="hs-identifier hs-var">refInputsUtxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-911"></span><span>  </span><span id="local-6989586621682743827"><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743827"><span class="hs-identifier hs-var">dcertWitsMakers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Credential 'Staking
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era))
-&gt; [Credential 'Staking]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; Credential 'Staking
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era (kr :: KeyRole).
Reflect era =&gt;
Maybe PlutusPurposeTag
-&gt; Credential kr
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-var">mkWitVKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlutusPurposeTag -&gt; Maybe PlutusPurposeTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Certifying"><span class="hs-identifier hs-var">Certifying</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Credential 'Staking]
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era])
-&gt; [Credential 'Staking]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (Credential 'Staking)] -&gt; [Credential 'Staking]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (Credential 'Staking)]
</span><a href="#local-6989586621682743814"><span class="hs-identifier hs-var">dcertCreds</span></a></span><span>
</span><span id="line-912"></span><span>  </span><span id="local-6989586621682743828"><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743828"><span class="hs-identifier hs-var">rewardsWitsMakers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Credential 'Staking
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era))
-&gt; [Credential 'Staking]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; Credential 'Staking
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era (kr :: KeyRole).
Reflect era =&gt;
Maybe PlutusPurposeTag
-&gt; Credential kr
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#mkWitVKey"><span class="hs-identifier hs-var">mkWitVKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlutusPurposeTag -&gt; Maybe PlutusPurposeTag
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PlutusPurposeTag
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#Rewarding"><span class="hs-identifier hs-var">Rewarding</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Credential 'Staking]
</span><a href="#local-6989586621682743809"><span class="hs-identifier hs-var">wdrlCreds</span></a></span><span>
</span><span id="line-913"></span><span>
</span><span id="line-914"></span><span>  </span><span class="hs-comment">-- 5. Estimate inputs that will be used as collateral</span><span>
</span><span id="line-915"></span><span>  </span><span id="local-6989586621682743829"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682743829"><span class="hs-identifier hs-var">maxCollateralCount</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-916"></span><span>    </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int)
-&gt; Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#chooseInt"><span class="hs-identifier hs-var">chooseInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682743775"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; Getting Nat (PParams era) Nat -&gt; Nat
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Nat (PParams era) Nat
forall era. EraGenericGen era =&gt; Lens' (PParams era) Nat
Lens' (PParams era) Nat
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#ppMaxCollateralInputsT"><span class="hs-identifier hs-var">ppMaxCollateralInputsT</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-917"></span><span>  </span><span id="local-6989586621682743831"><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621682743831"><span class="hs-identifier hs-var">bogusCollateralTxId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen TxId -&gt; RWST (GenEnv era) () (GenState era) Gen TxId
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gen TxId
forall a. Arbitrary a =&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxId"><span class="hs-identifier hs-type">TxId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-918"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682743832"><span class="annot"><span class="annottext">bogusCollateralTxIns :: Set TxIn
</span><a href="#local-6989586621682743832"><span class="hs-identifier hs-var hs-var">bogusCollateralTxIns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-919"></span><span>        </span><span class="annot"><span class="annottext">[TxIn] -&gt; Set TxIn
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span>
</span><span id="line-920"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TxId -&gt; TxIx -&gt; TxIn
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-var">TxIn</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621682743831"><span class="hs-identifier hs-var">bogusCollateralTxId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; Integer -&gt; TxIx
Integer -&gt; TxIx
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#mkTxIxPartial"><span class="hs-identifier hs-var">mkTxIxPartial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682743833"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-921"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682743833"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621682743833"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word16
Item [Word16]
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word16
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Word16
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682743829"><span class="hs-identifier hs-var">maxCollateralCount</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">]</span><span>
</span><span id="line-922"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-923"></span><span>  </span><span id="local-6989586621682743834"><span class="annot"><span class="annottext">[Addr]
</span><a href="#local-6989586621682743834"><span class="hs-identifier hs-var">collateralAddresses</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; RWST (GenEnv era) () (GenState era) Gen Addr
-&gt; RWST (GenEnv era) () (GenState era) Gen [Addr]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682743829"><span class="hs-identifier hs-var">maxCollateralCount</span></a></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen Addr
forall era. GenRS era Addr
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genNoScriptRecipient"><span class="hs-identifier hs-var">genNoScriptRecipient</span></a></span><span>
</span><span id="line-924"></span><span>  </span><span id="local-6989586621682743835"><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743835"><span class="hs-identifier hs-var">bogusCollateralKeyWitsMakers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]]
 -&gt; [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era])
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall a b.
(a -&gt; b)
-&gt; RWST (GenEnv era) () (GenState era) Gen a
-&gt; RWST (GenEnv era) () (GenState era) Gen b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]]
-&gt; [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">(RWST
   (GenEnv era)
   ()
   (GenState era)
   Gen
   [[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]]
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era])
-&gt; ((Addr
     -&gt; RWST
          (GenEnv era)
          ()
          (GenState era)
          Gen
          [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era])
    -&gt; RWST
         (GenEnv era)
         ()
         (GenState era)
         Gen
         [[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]])
-&gt; (Addr
    -&gt; RWST
         (GenEnv era)
         ()
         (GenState era)
         Gen
         [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era])
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Addr]
-&gt; (Addr
    -&gt; RWST
         (GenEnv era)
         ()
         (GenState era)
         Gen
         [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era])
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">[Addr]
</span><a href="#local-6989586621682743834"><span class="hs-identifier hs-var">collateralAddresses</span></a></span><span> </span><span class="annot"><span class="annottext">((Addr
  -&gt; RWST
       (GenEnv era)
       ()
       (GenState era)
       Gen
       [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era])
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era])
-&gt; (Addr
    -&gt; RWST
         (GenEnv era)
         ()
         (GenState era)
         Gen
         [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era])
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682743837"><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621682743837"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-925"></span><span>    </span><span class="annot"><span class="annottext">((SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
 -&gt; [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era])
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall a b.
(a -&gt; b)
-&gt; RWST (GenEnv era) () (GenState era) Gen a
-&gt; RWST (GenEnv era) () (GenState era) Gen b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
-&gt; [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">List.singleton</span></span><span> </span><span class="annot"><span class="annottext">(RWST
   (GenEnv era)
   ()
   (GenState era)
   Gen
   (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era])
-&gt; (TxOut era
    -&gt; RWST
         (GenEnv era)
         ()
         (GenState era)
         Gen
         (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era))
-&gt; TxOut era
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; TxOut era
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
Reflect era =&gt;
Maybe PlutusPurposeTag
-&gt; TxOut era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOutKeyWitness"><span class="hs-identifier hs-var">genTxOutKeyWitness</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">(TxOut era
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era])
-&gt; TxOut era
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Addr -&gt; Value era -&gt; TxOut era
forall era.
(EraTxOut era, HasCallStack) =&gt;
Addr -&gt; Value era -&gt; TxOut era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#mkBasicTxOut"><span class="hs-identifier hs-var">mkBasicTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621682743837"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin -&gt; Value era
forall t s. Inject t s =&gt; t -&gt; s
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682743791"><span class="hs-identifier hs-var">maxCoin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-926"></span><span>  </span><span id="local-6989586621682743839"><span class="annot"><span class="annottext">StrictMaybe Network
</span><a href="#local-6989586621682743839"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (StrictMaybe Network)
-&gt; RWST (GenEnv era) () (GenState era) Gen (StrictMaybe Network)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen (StrictMaybe Network)
 -&gt; RWST (GenEnv era) () (GenState era) Gen (StrictMaybe Network))
-&gt; Gen (StrictMaybe Network)
-&gt; RWST (GenEnv era) () (GenState era) Gen (StrictMaybe Network)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[StrictMaybe Network] -&gt; Gen (StrictMaybe Network)
forall a. HasCallStack =&gt; [a] -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#elements"><span class="hs-identifier hs-var">elements</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Item [StrictMaybe Network]
StrictMaybe Network
forall a. StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Network -&gt; StrictMaybe Network
forall a. a -&gt; StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#Testnet"><span class="hs-identifier hs-var">Testnet</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-927"></span><span>
</span><span id="line-928"></span><span>  </span><span class="hs-comment">-- 6. Generate bogus collateral fields, and functions for updating them when we know their real values</span><span>
</span><span id="line-929"></span><span>  </span><span class="hs-comment">-- Add a stub for the TotalCol field</span><span>
</span><span id="line-930"></span><span>  </span><span id="local-6989586621682743840"><span class="annot"><span class="annottext">StrictMaybe Coin
</span><a href="#local-6989586621682743840"><span class="hs-identifier hs-var">bogusTotalCol</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Int, RWST (GenEnv era) () (GenState era) Gen (StrictMaybe Coin))]
-&gt; RWST (GenEnv era) () (GenState era) Gen (StrictMaybe Coin)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StrictMaybe Coin
-&gt; RWST (GenEnv era) () (GenState era) Gen (StrictMaybe Coin)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Coin
forall a. StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StrictMaybe Coin
-&gt; RWST (GenEnv era) () (GenState era) Gen (StrictMaybe Coin)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin -&gt; StrictMaybe Coin
forall a. a -&gt; StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- generate a bogus Coin, fill it in later</span><span>
</span><span id="line-931"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682743842"><span class="annot"><span class="annottext">updateTotalColl :: StrictMaybe Coin -&gt; Coin -&gt; StrictMaybe Coin
</span><a href="#local-6989586621682743842"><span class="hs-identifier hs-var hs-var">updateTotalColl</span></a></span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Coin
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictMaybe Coin
forall a. StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-932"></span><span>      </span><span class="annot"><a href="#local-6989586621682743842"><span class="hs-identifier hs-var">updateTotalColl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-type">SJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span id="local-6989586621682743843"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682743843"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span> </span><span id="local-6989586621682743844"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682743844"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; StrictMaybe Coin
forall a. a -&gt; StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682743843"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682743844"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-933"></span><span>  </span><span class="hs-comment">-- If Babbage era, or greater, add a stub for a CollateralReturn TxOut</span><span>
</span><span id="line-934"></span><span>  </span><span id="local-6989586621682743845"><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
</span><a href="#local-6989586621682743845"><span class="hs-identifier hs-var">bogusCollReturn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-935"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Proof era -&gt; Some Proof
forall {k} (t :: k -&gt; *) (i :: k). Singleton t =&gt; t i -&gt; Some t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.Universe.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Some Proof -&gt; Some Proof -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Proof BabbageEra -&gt; Some Proof
forall {k} (t :: k -&gt; *) (i :: k). Singleton t =&gt; t i -&gt; Some t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.Universe.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">Proof BabbageEra
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span>
</span><span id="line-936"></span><span>      </span><span class="hs-keyword">then</span><span>
</span><span id="line-937"></span><span>        </span><span class="annot"><span class="annottext">[(Int,
  RWST (GenEnv era) () (GenState era) Gen (StrictMaybe (TxOut era)))]
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (StrictMaybe (TxOut era))
forall (t :: (* -&gt; *) -&gt; * -&gt; *) b.
(Monad (t Gen), MonadTrans t) =&gt;
[(Int, t Gen b)] -&gt; t Gen b
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#frequencyT"><span class="hs-identifier hs-var">frequencyT</span></a></span><span>
</span><span id="line-938"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (StrictMaybe (TxOut era))
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
forall a. StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-939"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; StrictMaybe (TxOut era)
forall a. a -&gt; StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut era -&gt; StrictMaybe (TxOut era))
-&gt; RWST (GenEnv era) () (GenState era) Gen (TxOut era)
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (StrictMaybe (TxOut era))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value era -&gt; RWST (GenEnv era) () (GenState era) Gen (TxOut era)
forall era. Reflect era =&gt; Value era -&gt; GenRS era (TxOut era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOut"><span class="hs-identifier hs-var">genTxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin -&gt; Value era
forall t s. Inject t s =&gt; t -&gt; s
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-940"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-941"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
-&gt; RWST
     (GenEnv era) () (GenState era) Gen (StrictMaybe (TxOut era))
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
forall a. StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-942"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682743982"><span class="annot"><span class="annottext">updateCollReturn :: StrictMaybe (TxOut era) -&gt; Coin -&gt; StrictMaybe (TxOut era)
</span><a href="#local-6989586621682743982"><span class="hs-identifier hs-var hs-var">updateCollReturn</span></a></span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
forall a. StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-943"></span><span>      </span><span class="annot"><a href="#local-6989586621682743982"><span class="hs-identifier hs-var">updateCollReturn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-type">SJust</span></a></span><span> </span><span id="local-6989586621682743983"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682743983"><span class="hs-identifier hs-var">txout</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682743984"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682743984"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; StrictMaybe (TxOut era)
forall a. a -&gt; StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-var">SJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin -&gt; TxOut era -&gt; TxOut era
forall era. EraTxOut era =&gt; Coin -&gt; TxOut era -&gt; TxOut era
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#injectFee"><span class="hs-identifier hs-var">injectFee</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682743984"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682743983"><span class="hs-identifier hs-var">txout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-944"></span><span>
</span><span id="line-945"></span><span>  </span><span class="hs-comment">-- 7. Estimate the fee</span><span>
</span><span id="line-946"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621682743986"><span class="hs-identifier hs-type">redeemerDatumWits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-947"></span><span>      </span><span id="local-6989586621682743986"><span class="annot"><span class="annottext">redeemerDatumWits :: TxWits era
</span><a href="#local-6989586621682743986"><span class="hs-identifier hs-var hs-var">redeemerDatumWits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxWits era -&gt; TxWits era
</span><a href="#local-6989586621682743822"><span class="hs-identifier hs-var">redeemerWitsList</span></a></span><span> </span><span class="annot"><span class="annottext">(TxWits era -&gt; TxWits era) -&gt; TxWits era -&gt; TxWits era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TxWits era -&gt; TxWits era
</span><a href="#local-6989586621682743825"><span class="hs-identifier hs-var">datumWitsList</span></a></span><span> </span><span class="annot"><span class="annottext">TxWits era
forall era. EraTxWits era =&gt; TxWits era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#mkBasicTxWits"><span class="hs-identifier hs-var">mkBasicTxWits</span></a></span><span>
</span><span id="line-948"></span><span>      </span><span id="local-6989586621682743988"><span class="annot"><span class="annottext">bogusIntegrityHash :: StrictMaybe ScriptIntegrityHash
</span><a href="#local-6989586621682743988"><span class="hs-identifier hs-var hs-var">bogusIntegrityHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era
-&gt; [Language]
-&gt; Redeemers era
-&gt; TxDats era
-&gt; StrictMaybe ScriptIntegrityHash
forall era.
EraModel era =&gt;
PParams era
-&gt; [Language]
-&gt; Redeemers era
-&gt; TxDats era
-&gt; StrictMaybe ScriptIntegrityHash
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#newScriptIntegrityHash"><span class="hs-identifier hs-var">newScriptIntegrityHash</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682743775"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="annot"><span class="annottext">[Language]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(PlutusPurpose AsIx era, (Data era, ExUnits))] -&gt; Redeemers era
forall era.
EraModel era =&gt;
[(PlutusPurpose AsIx era, (Data era, ExUnits))] -&gt; Redeemers era
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#mkRedeemers"><span class="hs-identifier hs-var">mkRedeemers</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxDats era
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-949"></span><span>      </span><span id="local-6989586621682743991"><span class="annot"><span class="annottext">inputSet :: Set TxIn
</span><a href="#local-6989586621682743991"><span class="hs-identifier hs-var hs-var">inputSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; Set TxIn
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682743783"><span class="hs-identifier hs-var">toSpendNoCollateral</span></a></span><span>
</span><span id="line-950"></span><span>      </span><span id="local-6989586621682743992"><span class="annot"><span class="annottext">outputList :: [TxOut era]
</span><a href="#local-6989586621682743992"><span class="hs-identifier hs-var hs-var">outputList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxOut era]
-&gt; (TxOut era -&gt; [TxOut era]) -&gt; Maybe (TxOut era) -&gt; [TxOut era]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682743793"><span class="hs-identifier hs-var">recipients</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut era -&gt; [TxOut era] -&gt; [TxOut era]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682743793"><span class="hs-identifier hs-var">recipients</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (TxOut era)
</span><a href="#local-6989586621682743808"><span class="hs-identifier hs-var">rewardsWithdrawalTxOut</span></a></span><span>
</span><span id="line-951"></span><span>      </span><span id="local-6989586621682743993"><span class="annot"><span class="annottext">txBodyNoFee :: TxBody era
</span><a href="#local-6989586621682743993"><span class="hs-identifier hs-var hs-var">txBodyNoFee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-952"></span><span>        </span><span class="annot"><span class="annottext">TxBody era
forall era. EraTxBody era =&gt; TxBody era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#mkBasicTxBody"><span class="hs-identifier hs-var">mkBasicTxBody</span></a></span><span>
</span><span id="line-953"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Set TxIn -&gt; Identity (Set TxIn))
-&gt; TxBody era -&gt; Identity (TxBody era)
forall era. EraTxBody era =&gt; Lens' (TxBody era) (Set TxIn)
Lens' (TxBody era) (Set TxIn)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#inputsTxBodyL"><span class="hs-identifier hs-var">inputsTxBodyL</span></a></span><span> </span><span class="annot"><span class="annottext">((Set TxIn -&gt; Identity (Set TxIn))
 -&gt; TxBody era -&gt; Identity (TxBody era))
-&gt; Set TxIn -&gt; TxBody era -&gt; TxBody era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Set TxIn
</span><a href="#local-6989586621682743991"><span class="hs-identifier hs-var">inputSet</span></a></span><span>
</span><span id="line-954"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Set TxIn -&gt; TxBody era -&gt; TxBody era
forall era.
EraGenericGen era =&gt;
Set TxIn -&gt; TxBody era -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#setCollateralInputs"><span class="hs-identifier hs-var">setCollateralInputs</span></a></span><span> </span><span class="annot"><span class="annottext">Set TxIn
</span><a href="#local-6989586621682743832"><span class="hs-identifier hs-var">bogusCollateralTxIns</span></a></span><span>
</span><span id="line-955"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Set TxIn -&gt; TxBody era -&gt; TxBody era
forall era.
EraGenericGen era =&gt;
Set TxIn -&gt; TxBody era -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#setReferenceInputs"><span class="hs-identifier hs-var">setReferenceInputs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; Set TxIn
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682743784"><span class="hs-identifier hs-var">refInputsUtxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-956"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Coin -&gt; TxBody era -&gt; TxBody era
forall era.
EraGenericGen era =&gt;
StrictMaybe Coin -&gt; TxBody era -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#setTotalCollateral"><span class="hs-identifier hs-var">setTotalCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Coin
</span><a href="#local-6989586621682743840"><span class="hs-identifier hs-var">bogusTotalCol</span></a></span><span>
</span><span id="line-957"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(StrictSeq (TxOut era) -&gt; Identity (StrictSeq (TxOut era)))
-&gt; TxBody era -&gt; Identity (TxBody era)
forall era.
EraTxBody era =&gt;
Lens' (TxBody era) (StrictSeq (TxOut era))
Lens' (TxBody era) (StrictSeq (TxOut era))
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#outputsTxBodyL"><span class="hs-identifier hs-var">outputsTxBodyL</span></a></span><span> </span><span class="annot"><span class="annottext">((StrictSeq (TxOut era) -&gt; Identity (StrictSeq (TxOut era)))
 -&gt; TxBody era -&gt; Identity (TxBody era))
-&gt; StrictSeq (TxOut era) -&gt; TxBody era -&gt; TxBody era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era] -&gt; StrictSeq (TxOut era)
forall a. [a] -&gt; StrictSeq a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html#fromList"><span class="hs-identifier hs-var">SSeq.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut era]
</span><a href="#local-6989586621682743992"><span class="hs-identifier hs-var">outputList</span></a></span><span>
</span><span id="line-958"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era) -&gt; TxBody era -&gt; TxBody era
forall era.
EraGenericGen era =&gt;
StrictMaybe (TxOut era) -&gt; TxBody era -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#setCollateralReturn"><span class="hs-identifier hs-var">setCollateralReturn</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
</span><a href="#local-6989586621682743845"><span class="hs-identifier hs-var">bogusCollReturn</span></a></span><span>
</span><span id="line-959"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(StrictSeq (TxCert era) -&gt; Identity (StrictSeq (TxCert era)))
-&gt; TxBody era -&gt; Identity (TxBody era)
forall era.
EraTxBody era =&gt;
Lens' (TxBody era) (StrictSeq (TxCert era))
Lens' (TxBody era) (StrictSeq (TxCert era))
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#certsTxBodyL"><span class="hs-identifier hs-var">certsTxBodyL</span></a></span><span> </span><span class="annot"><span class="annottext">((StrictSeq (TxCert era) -&gt; Identity (StrictSeq (TxCert era)))
 -&gt; TxBody era -&gt; Identity (TxBody era))
-&gt; StrictSeq (TxCert era) -&gt; TxBody era -&gt; TxBody era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era] -&gt; StrictSeq (TxCert era)
forall a. [a] -&gt; StrictSeq a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html#fromList"><span class="hs-identifier hs-var">SSeq.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682743813"><span class="hs-identifier hs-var">dcerts</span></a></span><span>
</span><span id="line-960"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Withdrawals -&gt; Identity Withdrawals)
-&gt; TxBody era -&gt; Identity (TxBody era)
forall era. EraTxBody era =&gt; Lens' (TxBody era) Withdrawals
Lens' (TxBody era) Withdrawals
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#withdrawalsTxBodyL"><span class="hs-identifier hs-var">withdrawalsTxBodyL</span></a></span><span> </span><span class="annot"><span class="annottext">((Withdrawals -&gt; Identity Withdrawals)
 -&gt; TxBody era -&gt; Identity (TxBody era))
-&gt; Withdrawals -&gt; TxBody era -&gt; TxBody era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Withdrawals
</span><a href="#local-6989586621682743804"><span class="hs-identifier hs-var">withdrawals</span></a></span><span>
</span><span id="line-961"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Identity Coin) -&gt; TxBody era -&gt; Identity (TxBody era)
forall era. EraTxBody era =&gt; Lens' (TxBody era) Coin
Lens' (TxBody era) Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#feeTxBodyL"><span class="hs-identifier hs-var">feeTxBodyL</span></a></span><span> </span><span class="annot"><span class="annottext">((Coin -&gt; Identity Coin) -&gt; TxBody era -&gt; Identity (TxBody era))
-&gt; Coin -&gt; TxBody era -&gt; TxBody era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682743791"><span class="hs-identifier hs-var">maxCoin</span></a></span><span>
</span><span id="line-962"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">ValidityInterval -&gt; TxBody era -&gt; TxBody era
forall era.
EraGenericGen era =&gt;
ValidityInterval -&gt; TxBody era -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#setValidity"><span class="hs-identifier hs-var">setValidity</span></a></span><span> </span><span class="annot"><span class="annottext">ValidityInterval
</span><a href="#local-6989586621682743776"><span class="hs-identifier hs-var">validityInterval</span></a></span><span>
</span><span id="line-963"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe ScriptIntegrityHash -&gt; TxBody era -&gt; TxBody era
forall era.
EraGenericGen era =&gt;
StrictMaybe ScriptIntegrityHash -&gt; TxBody era -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#setScriptIntegrityHash"><span class="hs-identifier hs-var">setScriptIntegrityHash</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe ScriptIntegrityHash
</span><a href="#local-6989586621682743988"><span class="hs-identifier hs-var">bogusIntegrityHash</span></a></span><span>
</span><span id="line-964"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Network -&gt; TxBody era -&gt; TxBody era
forall era.
EraGenericGen era =&gt;
StrictMaybe Network -&gt; TxBody era -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#setNetworkIdTxBody"><span class="hs-identifier hs-var">setNetworkIdTxBody</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Network
</span><a href="#local-6989586621682743839"><span class="hs-identifier hs-var">networkId</span></a></span><span>
</span><span id="line-965"></span><span>      </span><span id="local-6989586621682744008"><span class="annot"><span class="annottext">txBodyNoFeeHash :: SafeHash EraIndependentTxBody
</span><a href="#local-6989586621682744008"><span class="hs-identifier hs-var hs-var">txBodyNoFeeHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; SafeHash EraIndependentTxBody
forall x i. HashAnnotated x i =&gt; x -&gt; SafeHash i
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#hashAnnotated"><span class="hs-identifier hs-var">hashAnnotated</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621682743993"><span class="hs-identifier hs-var">txBodyNoFee</span></a></span><span>
</span><span id="line-966"></span><span>      </span><span class="annot"><a href="#local-6989586621682744010"><span class="hs-identifier hs-type">witsMakers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#SafeHash"><span class="hs-identifier hs-type">SafeHash</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#EraIndependentTxBody"><span class="hs-identifier hs-type">EraIndependentTxBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-967"></span><span>      </span><span id="local-6989586621682744010"><span class="annot"><span class="annottext">witsMakers :: [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682744010"><span class="hs-identifier hs-var hs-var">witsMakers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743826"><span class="hs-identifier hs-var">keyWitsMakers</span></a></span><span> </span><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743827"><span class="hs-identifier hs-var">dcertWitsMakers</span></a></span><span> </span><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743828"><span class="hs-identifier hs-var">rewardsWitsMakers</span></a></span><span>
</span><span id="line-968"></span><span>      </span><span id="local-6989586621682744011"><span class="annot"><span class="annottext">bogusNeededScripts :: Set ScriptHash
</span><a href="#local-6989586621682744011"><span class="hs-identifier hs-var hs-var">bogusNeededScripts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proof era -&gt; Map TxIn (TxOut era) -&gt; TxBody era -&gt; Set ScriptHash
forall era. Proof era -&gt; MUtxo era -&gt; TxBody era -&gt; Set ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#scriptWitsNeeded%27"><span class="hs-identifier hs-var">scriptWitsNeeded'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682743785"><span class="hs-identifier hs-var">utxoNoCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621682743993"><span class="hs-identifier hs-var">txBodyNoFee</span></a></span><span>
</span><span id="line-969"></span><span>      </span><span class="annot"><a href="#local-6989586621682744013"><span class="hs-identifier hs-type">noFeeWitsUnfiltered</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-970"></span><span>      </span><span id="local-6989586621682744013"><span class="annot"><span class="annottext">noFeeWitsUnfiltered :: TxWits era
</span><a href="#local-6989586621682744013"><span class="hs-identifier hs-var hs-var">noFeeWitsUnfiltered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-971"></span><span>        </span><span class="annot"><span class="annottext">[TxWits era -&gt; TxWits era] -&gt; TxWits era -&gt; TxWits era
forall a. [a -&gt; a] -&gt; a -&gt; a
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#foldFn"><span class="hs-identifier hs-var">foldFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
 -&gt; TxWits era -&gt; TxWits era)
-&gt; [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; [TxWits era -&gt; TxWits era]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
-&gt; SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody
</span><a href="#local-6989586621682744008"><span class="hs-identifier hs-var">txBodyNoFeeHash</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682744010"><span class="hs-identifier hs-var">witsMakers</span></a></span><span> </span><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682743835"><span class="hs-identifier hs-var">bogusCollateralKeyWitsMakers</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxWits era
</span><a href="#local-6989586621682743986"><span class="hs-identifier hs-var">redeemerDatumWits</span></a></span><span>
</span><span id="line-972"></span><span>      </span><span class="annot"><a href="#local-6989586621682744014"><span class="hs-identifier hs-type">noFeeWits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-973"></span><span>      </span><span id="local-6989586621682744014"><span class="annot"><span class="annottext">noFeeWits :: TxWits era
</span><a href="#local-6989586621682744014"><span class="hs-identifier hs-var hs-var">noFeeWits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set ScriptHash -&gt; TxWits era -&gt; TxWits era
forall era.
EraTxWits era =&gt;
Set ScriptHash -&gt; TxWits era -&gt; TxWits era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#onlyNecessaryScripts"><span class="hs-identifier hs-var">onlyNecessaryScripts</span></a></span><span> </span><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682744011"><span class="hs-identifier hs-var">bogusNeededScripts</span></a></span><span> </span><span class="annot"><span class="annottext">TxWits era
</span><a href="#local-6989586621682744013"><span class="hs-identifier hs-var">noFeeWitsUnfiltered</span></a></span><span>
</span><span id="line-974"></span><span>      </span><span id="local-6989586621682744016"><span class="annot"><span class="annottext">bogusTxForFeeCalc :: Tx era
</span><a href="#local-6989586621682744016"><span class="hs-identifier hs-var hs-var">bogusTxForFeeCalc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-975"></span><span>        </span><span class="annot"><span class="annottext">IsValid -&gt; Tx era -&gt; Tx era
forall era. Reflect era =&gt; IsValid -&gt; Tx era -&gt; Tx era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#applyIsValid"><span class="hs-identifier hs-var">applyIsValid</span></a></span><span> </span><span class="annot"><span class="annottext">IsValid
</span><a href="#local-6989586621682743817"><span class="hs-identifier hs-var">isValid</span></a></span><span> </span><span class="annot"><span class="annottext">(Tx era -&gt; Tx era) -&gt; Tx era -&gt; Tx era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-976"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; Tx era
forall era. EraTx era =&gt; TxBody era -&gt; Tx era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#mkBasicTx"><span class="hs-identifier hs-var">mkBasicTx</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621682743993"><span class="hs-identifier hs-var">txBodyNoFee</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era -&gt; (Tx era -&gt; Tx era) -&gt; Tx era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TxWits era -&gt; Identity (TxWits era))
-&gt; Tx era -&gt; Identity (Tx era)
forall era. EraTx era =&gt; Lens' (Tx era) (TxWits era)
Lens' (Tx era) (TxWits era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#witsTxL"><span class="hs-identifier hs-var">witsTxL</span></a></span><span> </span><span class="annot"><span class="annottext">((TxWits era -&gt; Identity (TxWits era))
 -&gt; Tx era -&gt; Identity (Tx era))
-&gt; TxWits era -&gt; Tx era -&gt; Tx era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">TxWits era
</span><a href="#local-6989586621682744014"><span class="hs-identifier hs-var">noFeeWits</span></a></span><span>
</span><span id="line-977"></span><span>      </span><span id="local-6989586621682744019"><span class="annot"><span class="annottext">fee :: Coin
</span><a href="#local-6989586621682744019"><span class="hs-identifier hs-var hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; Tx era -&gt; UTxO era -&gt; Coin
forall era.
EraUTxO era =&gt;
PParams era -&gt; Tx era -&gt; UTxO era -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#getMinFeeTxUtxo"><span class="hs-identifier hs-var">getMinFeeTxUtxo</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682743775"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621682744016"><span class="hs-identifier hs-var">bogusTxForFeeCalc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; UTxO era
forall era. Map TxIn (TxOut era) -&gt; UTxO era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682743784"><span class="hs-identifier hs-var">refInputsUtxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-978"></span><span>  </span><span class="hs-comment">-- traceM $ &quot;noFeeWits:\n&quot; &lt;&gt; showExpr noFeeWits</span><span>
</span><span id="line-979"></span><span>
</span><span id="line-980"></span><span>  </span><span id="local-6989586621682744022"><span class="annot"><span class="annottext">Accounts era
</span><a href="#local-6989586621682744022"><span class="hs-identifier hs-var">accounts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Accounts era)
-&gt; RWST (GenEnv era) () (GenState era) Gen (Accounts era)
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; Accounts era
forall era. ModelNewEpochState era -&gt; Accounts era
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mAccounts"><span class="hs-identifier hs-var">mAccounts</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; Accounts era)
-&gt; (GenState era -&gt; ModelNewEpochState era)
-&gt; GenState era
-&gt; Accounts era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; ModelNewEpochState era
forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-981"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682744023"><span class="annot"><span class="annottext">deposits :: Coin
</span><a href="#local-6989586621682744023"><span class="hs-identifier hs-var hs-var">deposits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era -&gt; [TxCert era] -&gt; Accounts era -&gt; Coin
forall era.
(EraAccounts era, EraPParams era, ShelleyEraTxCert era) =&gt;
PParams era -&gt; [TxCert era] -&gt; Accounts era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#depositsAndRefunds"><span class="hs-identifier hs-var">depositsAndRefunds</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682743775"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="annot"><span class="annottext">[TxCert era]
</span><a href="#local-6989586621682743813"><span class="hs-identifier hs-var">dcerts</span></a></span><span> </span><span class="annot"><span class="annottext">Accounts era
</span><a href="#local-6989586621682744022"><span class="hs-identifier hs-var">accounts</span></a></span><span>
</span><span id="line-982"></span><span>
</span><span id="line-983"></span><span>  </span><span class="hs-comment">-- 8. Crank up the amount in one of outputs to account for the fee and deposits. Note</span><span>
</span><span id="line-984"></span><span>  </span><span class="hs-comment">-- this is a hack that is not possible in a real life, but in the end it does produce</span><span>
</span><span id="line-985"></span><span>  </span><span class="hs-comment">-- real life like setup. We use the entry with TxIn feeKey, which we can safely overwrite.</span><span>
</span><span id="line-986"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682744025"><span class="annot"><span class="annottext">utxoFeeAdjusted :: Map TxIn (TxOut era)
</span><a href="#local-6989586621682744025"><span class="hs-identifier hs-var hs-var">utxoFeeAdjusted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxOut era -&gt; TxOut era)
-&gt; TxIn -&gt; Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.adjust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin -&gt; TxOut era -&gt; TxOut era
forall era. EraTxOut era =&gt; Coin -&gt; TxOut era -&gt; TxOut era
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#injectFee"><span class="hs-identifier hs-var">injectFee</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682744019"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682744023"><span class="hs-identifier hs-var">deposits</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621682743782"><span class="hs-identifier hs-var">feeKey</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682743785"><span class="hs-identifier hs-var">utxoNoCollateral</span></a></span><span>
</span><span id="line-987"></span><span>
</span><span id="line-988"></span><span>  </span><span class="hs-comment">-- 9. Generate utxos that will be used as collateral</span><span>
</span><span id="line-989"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682744027"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682744027"><span class="hs-identifier hs-var">utxo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682744028"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682744028"><span class="hs-identifier hs-var">collMap</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682744029"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682744029"><span class="hs-identifier hs-var">excessColCoin</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Addr]
-&gt; Coin
-&gt; Map TxIn (TxOut era)
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (Map TxIn (TxOut era), Map TxIn (TxOut era), Coin)
forall era.
(HasCallStack, EraGenericGen era) =&gt;
[Addr]
-&gt; Coin -&gt; MUtxo era -&gt; GenRS era (MUtxo era, MUtxo era, Coin)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genCollateralUTxO"><span class="hs-identifier hs-var">genCollateralUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">[Addr]
</span><a href="#local-6989586621682743834"><span class="hs-identifier hs-var">collateralAddresses</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682744019"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682744025"><span class="hs-identifier hs-var">utxoFeeAdjusted</span></a></span><span>
</span><span id="line-990"></span><span>  </span><span id="local-6989586621682744030"><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682744030"><span class="hs-identifier hs-var">collateralKeyWitsMakers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-991"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxOut era
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era))
-&gt; [TxOut era]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
-&gt; TxOut era
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
forall era.
Reflect era =&gt;
Maybe PlutusPurposeTag
-&gt; TxOut era
-&gt; GenRS
     era (SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genTxOutKeyWitness"><span class="hs-identifier hs-var">genTxOutKeyWitness</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PlutusPurposeTag
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([TxOut era]
 -&gt; RWST
      (GenEnv era)
      ()
      (GenState era)
      Gen
      [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era])
-&gt; [TxOut era]
-&gt; RWST
     (GenEnv era)
     ()
     (GenState era)
     Gen
     [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; [TxOut era]
forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682744028"><span class="hs-identifier hs-var">collMap</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-992"></span><span>      </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#SafeHash"><span class="hs-identifier hs-type">SafeHash</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#EraIndependentTxBody"><span class="hs-identifier hs-type">EraIndependentTxBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-993"></span><span>
</span><span id="line-994"></span><span>  </span><span class="hs-comment">-- 10. Construct the correct Tx with valid fee and collaterals</span><span>
</span><span id="line-995"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682744031"><span class="annot"><span class="annottext">sNeeded :: Set ScriptHash
</span><a href="#local-6989586621682744031"><span class="hs-identifier hs-var hs-var">sNeeded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; TxBody era -&gt; Set ScriptHash
forall era.
EraUTxO era =&gt;
MUtxo era -&gt; TxBody era -&gt; Set ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#scriptsNeeded%27"><span class="hs-identifier hs-var">scriptsNeeded'</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682744027"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621682743993"><span class="hs-identifier hs-var">txBodyNoFee</span></a></span><span>
</span><span id="line-996"></span><span>      </span><span id="local-6989586621682744033"><span class="annot"><span class="annottext">langs :: [Language]
</span><a href="#local-6989586621682744033"><span class="hs-identifier hs-var hs-var">langs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Language -&gt; [Language]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">(Set Language -&gt; [Language]) -&gt; Set Language -&gt; [Language]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proof era -&gt; Tx era -&gt; UTxO era -&gt; Set ScriptHash -&gt; Set Language
forall era.
Proof era -&gt; Tx era -&gt; UTxO era -&gt; Set ScriptHash -&gt; Set Language
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#languagesUsed"><span class="hs-identifier hs-var">languagesUsed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621682744016"><span class="hs-identifier hs-var">bogusTxForFeeCalc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; UTxO era
forall era. Map TxIn (TxOut era) -&gt; UTxO era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682743785"><span class="hs-identifier hs-var">utxoNoCollateral</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682744031"><span class="hs-identifier hs-var">sNeeded</span></a></span><span>
</span><span id="line-997"></span><span>      </span><span id="local-6989586621682744036"><span class="annot"><span class="annottext">mIntegrityHash :: StrictMaybe ScriptIntegrityHash
</span><a href="#local-6989586621682744036"><span class="hs-identifier hs-var hs-var">mIntegrityHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PParams era
-&gt; [Language] -&gt; TxWits era -&gt; StrictMaybe ScriptIntegrityHash
forall era.
EraGenericGen era =&gt;
PParams era
-&gt; [Language] -&gt; TxWits era -&gt; StrictMaybe ScriptIntegrityHash
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#mkScriptIntegrityHash"><span class="hs-identifier hs-var">mkScriptIntegrityHash</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621682743775"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="annot"><span class="annottext">[Language]
</span><a href="#local-6989586621682744033"><span class="hs-identifier hs-var">langs</span></a></span><span> </span><span class="annot"><span class="annottext">TxWits era
</span><a href="#local-6989586621682743986"><span class="hs-identifier hs-var">redeemerDatumWits</span></a></span><span>
</span><span id="line-998"></span><span>      </span><span id="local-6989586621682744038"><span class="annot"><span class="annottext">balance :: Coin
</span><a href="#local-6989586621682744038"><span class="hs-identifier hs-var hs-var">balance</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-999"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
</span><a href="#local-6989586621682743845"><span class="hs-identifier hs-var">bogusCollReturn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1000"></span><span>          </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set TxIn -&gt; Map TxIn (TxOut era) -&gt; Coin
forall era. EraTxOut era =&gt; Set TxIn -&gt; MUtxo era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#txInBalance"><span class="hs-identifier hs-var">txInBalance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; Set TxIn
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682744028"><span class="hs-identifier hs-var">collMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682744027"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-1001"></span><span>          </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SJust"><span class="hs-identifier hs-type">SJust</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set TxIn -&gt; Map TxIn (TxOut era) -&gt; Coin
forall era. EraTxOut era =&gt; Set TxIn -&gt; MUtxo era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#txInBalance"><span class="hs-identifier hs-var">txInBalance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; Set TxIn
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682744028"><span class="hs-identifier hs-var">collMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682744027"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682744029"><span class="hs-identifier hs-var">excessColCoin</span></a></span><span>
</span><span id="line-1002"></span><span>      </span><span id="local-6989586621682744040"><span class="annot"><span class="annottext">txBody :: TxBody era
</span><a href="#local-6989586621682744040"><span class="hs-identifier hs-var hs-var">txBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1003"></span><span>        </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621682743993"><span class="hs-identifier hs-var">txBodyNoFee</span></a></span><span>
</span><span id="line-1004"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Identity Coin) -&gt; TxBody era -&gt; Identity (TxBody era)
forall era. EraTxBody era =&gt; Lens' (TxBody era) Coin
Lens' (TxBody era) Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#feeTxBodyL"><span class="hs-identifier hs-var">feeTxBodyL</span></a></span><span> </span><span class="annot"><span class="annottext">((Coin -&gt; Identity Coin) -&gt; TxBody era -&gt; Identity (TxBody era))
-&gt; Coin -&gt; TxBody era -&gt; TxBody era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682744019"><span class="hs-identifier hs-var">fee</span></a></span><span>
</span><span id="line-1005"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Set TxIn -&gt; TxBody era -&gt; TxBody era
forall era.
EraGenericGen era =&gt;
Set TxIn -&gt; TxBody era -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#setCollateralInputs"><span class="hs-identifier hs-var">setCollateralInputs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; Set TxIn
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682744028"><span class="hs-identifier hs-var">collMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1006"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era) -&gt; TxBody era -&gt; TxBody era
forall era.
EraGenericGen era =&gt;
StrictMaybe (TxOut era) -&gt; TxBody era -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#setCollateralReturn"><span class="hs-identifier hs-var">setCollateralReturn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictMaybe (TxOut era) -&gt; Coin -&gt; StrictMaybe (TxOut era)
forall {era}.
(Assert
   (OrdCond
      (CmpNat (ProtVerLow era) (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat MinVersion (ProtVerLow era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat MinVersion (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 EraTxOut era) =&gt;
StrictMaybe (TxOut era) -&gt; Coin -&gt; StrictMaybe (TxOut era)
</span><a href="#local-6989586621682743982"><span class="hs-identifier hs-var">updateCollReturn</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe (TxOut era)
</span><a href="#local-6989586621682743845"><span class="hs-identifier hs-var">bogusCollReturn</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682744029"><span class="hs-identifier hs-var">excessColCoin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1007"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Coin -&gt; TxBody era -&gt; TxBody era
forall era.
EraGenericGen era =&gt;
StrictMaybe Coin -&gt; TxBody era -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#setTotalCollateral"><span class="hs-identifier hs-var">setTotalCollateral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StrictMaybe Coin -&gt; Coin -&gt; StrictMaybe Coin
</span><a href="#local-6989586621682743842"><span class="hs-identifier hs-var">updateTotalColl</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe Coin
</span><a href="#local-6989586621682743840"><span class="hs-identifier hs-var">bogusTotalCol</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682744038"><span class="hs-identifier hs-var">balance</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1008"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; (TxBody era -&gt; TxBody era) -&gt; TxBody era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe ScriptIntegrityHash -&gt; TxBody era -&gt; TxBody era
forall era.
EraGenericGen era =&gt;
StrictMaybe ScriptIntegrityHash -&gt; TxBody era -&gt; TxBody era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#setScriptIntegrityHash"><span class="hs-identifier hs-var">setScriptIntegrityHash</span></a></span><span> </span><span class="annot"><span class="annottext">StrictMaybe ScriptIntegrityHash
</span><a href="#local-6989586621682744036"><span class="hs-identifier hs-var">mIntegrityHash</span></a></span><span>
</span><span id="line-1009"></span><span>      </span><span id="local-6989586621682744041"><span class="annot"><span class="annottext">txBodyHash :: SafeHash EraIndependentTxBody
</span><a href="#local-6989586621682744041"><span class="hs-identifier hs-var hs-var">txBodyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; SafeHash EraIndependentTxBody
forall x i. HashAnnotated x i =&gt; x -&gt; SafeHash i
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#hashAnnotated"><span class="hs-identifier hs-var">hashAnnotated</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621682744040"><span class="hs-identifier hs-var">txBody</span></a></span><span>
</span><span id="line-1010"></span><span>      </span><span id="local-6989586621682744042"><span class="annot"><span class="annottext">neededScripts :: Set ScriptHash
</span><a href="#local-6989586621682744042"><span class="hs-identifier hs-var hs-var">neededScripts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proof era -&gt; Map TxIn (TxOut era) -&gt; TxBody era -&gt; Set ScriptHash
forall era. Proof era -&gt; MUtxo era -&gt; TxBody era -&gt; Set ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#scriptWitsNeeded%27"><span class="hs-identifier hs-var">scriptWitsNeeded'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682744027"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621682744040"><span class="hs-identifier hs-var">txBody</span></a></span><span>
</span><span id="line-1011"></span><span>      </span><span class="annot"><a href="#local-6989586621682744043"><span class="hs-identifier hs-type">wits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729445"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-1012"></span><span>      </span><span id="local-6989586621682744043"><span class="annot"><span class="annottext">wits :: TxWits era
</span><a href="#local-6989586621682744043"><span class="hs-identifier hs-var hs-var">wits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1013"></span><span>        </span><span class="annot"><span class="annottext">Set ScriptHash -&gt; TxWits era -&gt; TxWits era
forall era.
EraTxWits era =&gt;
Set ScriptHash -&gt; TxWits era -&gt; TxWits era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#onlyNecessaryScripts"><span class="hs-identifier hs-var">onlyNecessaryScripts</span></a></span><span> </span><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682744042"><span class="hs-identifier hs-var">neededScripts</span></a></span><span> </span><span class="annot"><span class="annottext">(TxWits era -&gt; TxWits era) -&gt; TxWits era -&gt; TxWits era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1014"></span><span>          </span><span class="annot"><span class="annottext">[TxWits era -&gt; TxWits era] -&gt; TxWits era -&gt; TxWits era
forall a. [a -&gt; a] -&gt; a -&gt; a
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#foldFn"><span class="hs-identifier hs-var">foldFn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
-&gt; SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody
</span><a href="#local-6989586621682744041"><span class="hs-identifier hs-var">txBodyHash</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era)
 -&gt; TxWits era -&gt; TxWits era)
-&gt; [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; [TxWits era -&gt; TxWits era]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682744030"><span class="hs-identifier hs-var">collateralKeyWitsMakers</span></a></span><span> </span><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
-&gt; [SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[SafeHash EraIndependentTxBody -&gt; TxWits era -&gt; TxWits era]
</span><a href="#local-6989586621682744010"><span class="hs-identifier hs-var">witsMakers</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxWits era
</span><a href="#local-6989586621682743986"><span class="hs-identifier hs-var">redeemerDatumWits</span></a></span><span>
</span><span id="line-1015"></span><span>      </span><span id="local-6989586621682744044"><span class="annot"><span class="annottext">validTx :: Tx era
</span><a href="#local-6989586621682744044"><span class="hs-identifier hs-var hs-var">validTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1016"></span><span>        </span><span class="annot"><span class="annottext">IsValid -&gt; Tx era -&gt; Tx era
forall era. Reflect era =&gt; IsValid -&gt; Tx era -&gt; Tx era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#applyIsValid"><span class="hs-identifier hs-var">applyIsValid</span></a></span><span> </span><span class="annot"><span class="annottext">IsValid
</span><a href="#local-6989586621682743817"><span class="hs-identifier hs-var">isValid</span></a></span><span> </span><span class="annot"><span class="annottext">(Tx era -&gt; Tx era) -&gt; Tx era -&gt; Tx era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1017"></span><span>          </span><span class="annot"><span class="annottext">TxBody era -&gt; Tx era
forall era. EraTx era =&gt; TxBody era -&gt; Tx era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#mkBasicTx"><span class="hs-identifier hs-var">mkBasicTx</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621682744040"><span class="hs-identifier hs-var">txBody</span></a></span><span>
</span><span id="line-1018"></span><span>            </span><span class="annot"><span class="annottext">Tx era -&gt; (Tx era -&gt; Tx era) -&gt; Tx era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(TxWits era -&gt; Identity (TxWits era))
-&gt; Tx era -&gt; Identity (Tx era)
forall era. EraTx era =&gt; Lens' (Tx era) (TxWits era)
Lens' (Tx era) (TxWits era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#witsTxL"><span class="hs-identifier hs-var">witsTxL</span></a></span><span> </span><span class="annot"><span class="annottext">((TxWits era -&gt; Identity (TxWits era))
 -&gt; Tx era -&gt; Identity (Tx era))
-&gt; TxWits era -&gt; Tx era -&gt; Tx era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">TxWits era
</span><a href="#local-6989586621682744043"><span class="hs-identifier hs-var">wits</span></a></span><span>
</span><span id="line-1019"></span><span>  </span><span id="local-6989586621682744045"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682744045"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Int)
-&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelNewEpochState era -&gt; Int
forall era. ModelNewEpochState era -&gt; Int
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#mCount"><span class="hs-identifier hs-var">mCount</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; Int)
-&gt; (GenState era -&gt; ModelNewEpochState era) -&gt; GenState era -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; ModelNewEpochState era
forall era. GenState era -&gt; ModelNewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsModel"><span class="hs-identifier hs-var">gsModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1020"></span><span>  </span><span class="annot"><span class="annottext">(Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era))
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall era.
(Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyGenStateInitialUtxo"><span class="hs-identifier hs-var">modifyGenStateInitialUtxo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
-&gt; Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-operator hs-var">`Map.union`</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
-&gt; Maybe (UtxoEntry era) -&gt; Map TxIn (TxOut era)
forall era. MUtxo era -&gt; Maybe (UtxoEntry era) -&gt; MUtxo era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#minus"><span class="hs-identifier hs-var">minus</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682744027"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (UtxoEntry era)
</span><a href="#local-6989586621682743780"><span class="hs-identifier hs-var">maybeoldpair</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1021"></span><span>  </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall era. (Int -&gt; Int) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelCount"><span class="hs-identifier hs-var">modifyModelCount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682744045"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1022"></span><span>  </span><span class="annot"><span class="annottext">(Map Int TxId -&gt; Map Int TxId)
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall era. (Map Int TxId -&gt; Map Int TxId) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelIndex"><span class="hs-identifier hs-var">modifyModelIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; TxId -&gt; Map Int TxId -&gt; Map Int TxId
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682744045"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody -&gt; TxId
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.TxIn.html#TxId"><span class="hs-identifier hs-var">TxId</span></a></span><span> </span><span class="annot"><span class="annottext">SafeHash EraIndependentTxBody
</span><a href="#local-6989586621682744041"><span class="hs-identifier hs-var">txBodyHash</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1023"></span><span>  </span><span class="annot"><span class="annottext">(Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era))
-&gt; RWST (GenEnv era) () (GenState era) Gen ()
forall era.
(Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModelUTxO"><span class="hs-identifier hs-var">modifyModelUTxO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
-&gt; Map TxIn (TxOut era) -&gt; Map TxIn (TxOut era)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682744027"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1024"></span><span>
</span><span id="line-1025"></span><span>  </span><span class="annot"><span class="annottext">(UTxO era, Tx era, UtxoEntry era, Maybe (UtxoEntry era))
-&gt; GenRS
     era (UTxO era, Tx era, UtxoEntry era, Maybe (UtxoEntry era))
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; UTxO era
forall era. Map TxIn (TxOut era) -&gt; UTxO era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682744027"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621682744044"><span class="hs-identifier hs-var">validTx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UtxoEntry era
</span><a href="#local-6989586621682743781"><span class="hs-identifier hs-var">feepair</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (UtxoEntry era)
</span><a href="#local-6989586621682743780"><span class="hs-identifier hs-var">maybeoldpair</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1026"></span><span>
</span><span id="line-1027"></span><span class="annot"><span class="hs-comment">-- | Keep only Script witnesses that are neccessary in 'era',</span></span><span>
</span><span id="line-1028"></span><span id="local-6989586621682729487"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#onlyNecessaryScripts"><span class="hs-identifier hs-type">onlyNecessaryScripts</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1029"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#EraTxWits"><span class="hs-identifier hs-type">EraTxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729487"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729487"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxWits"><span class="hs-identifier hs-type">TxWits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682729487"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-1030"></span><span id="onlyNecessaryScripts"><span class="annot"><span class="annottext">onlyNecessaryScripts :: forall era.
EraTxWits era =&gt;
Set ScriptHash -&gt; TxWits era -&gt; TxWits era
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#onlyNecessaryScripts"><span class="hs-identifier hs-var hs-var">onlyNecessaryScripts</span></a></span></span><span> </span><span id="local-6989586621682744052"><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682744052"><span class="hs-identifier hs-var">necessary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map ScriptHash (Script era)
 -&gt; Identity (Map ScriptHash (Script era)))
-&gt; TxWits era -&gt; Identity (TxWits era)
forall era.
EraTxWits era =&gt;
Lens' (TxWits era) (Map ScriptHash (Script era))
Lens' (TxWits era) (Map ScriptHash (Script era))
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#scriptTxWitsL"><span class="hs-identifier hs-var">scriptTxWitsL</span></a></span><span> </span><span class="annot"><span class="annottext">((Map ScriptHash (Script era)
  -&gt; Identity (Map ScriptHash (Script era)))
 -&gt; TxWits era -&gt; Identity (TxWits era))
-&gt; (Map ScriptHash (Script era) -&gt; Map ScriptHash (Script era))
-&gt; TxWits era
-&gt; TxWits era
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%25~"><span class="hs-operator hs-var">%~</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682744053"><span class="annot"><span class="annottext">Map ScriptHash (Script era)
</span><a href="#local-6989586621682744053"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map ScriptHash (Script era)
-&gt; Set ScriptHash -&gt; Map ScriptHash (Script era)
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.restrictKeys</span></span><span> </span><span class="annot"><span class="annottext">Map ScriptHash (Script era)
</span><a href="#local-6989586621682744053"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682744052"><span class="hs-identifier hs-var">necessary</span></a></span><span>
</span><span id="line-1031"></span><span>
</span><span id="line-1032"></span><span class="hs-comment">-- ==============================================================================</span><span>
</span><span id="line-1033"></span><span class="hs-comment">-- How we take the generated stuff and put it through the STS rule mechanism</span><span>
</span><span id="line-1034"></span><span class="hs-comment">-- in a way that is Era Agnostic</span><span>
</span><span id="line-1035"></span><span>
</span><span id="line-1036"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#runSTSWithContext"><span class="hs-identifier hs-type">runSTSWithContext</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1037"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682729501"><span class="annot"><a href="#local-6989586621682729501"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1038"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#BaseM"><span class="hs-identifier hs-type">BaseM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Era.html#EraRule"><span class="hs-identifier hs-type">EraRule</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;LEDGER&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621682729501"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#ShelleyBase"><span class="hs-identifier hs-type">ShelleyBase</span></a></span><span>
</span><span id="line-1039"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#STS"><span class="hs-identifier hs-type">STS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Era.html#EraRule"><span class="hs-identifier hs-type">EraRule</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;LEDGER&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621682729501"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1040"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1041"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#RuleContext"><span class="hs-identifier hs-type">RuleContext</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#Transition"><span class="hs-identifier hs-type">Transition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Era.html#EraRule"><span class="hs-identifier hs-type">EraRule</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;LEDGER&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621682729501"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1042"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#PredicateFailure"><span class="hs-identifier hs-type">PredicateFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Era.html#EraRule"><span class="hs-identifier hs-type">EraRule</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;LEDGER&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621682729501"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Era.html#EraRule"><span class="hs-identifier hs-type">EraRule</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;LEDGER&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621682729501"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1043"></span><span id="runSTSWithContext"><span class="annot"><span class="annottext">runSTSWithContext :: forall era.
(BaseM (EraRule &quot;LEDGER&quot; era) ~ ShelleyBase,
 STS (EraRule &quot;LEDGER&quot; era)) =&gt;
RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
-&gt; Either
     (NonEmpty (PredicateFailure (EraRule &quot;LEDGER&quot; era)))
     (State (EraRule &quot;LEDGER&quot; era))
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#runSTSWithContext"><span class="hs-identifier hs-var hs-var">runSTSWithContext</span></a></span></span><span> </span><span id="local-6989586621682744061"><span class="annot"><span class="annottext">RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621682744061"><span class="hs-identifier hs-var">trc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyBase
  (Either
     (NonEmpty (PredicateFailure (EraRule &quot;LEDGER&quot; era)))
     (State (EraRule &quot;LEDGER&quot; era)))
-&gt; Either
     (NonEmpty (PredicateFailure (EraRule &quot;LEDGER&quot; era)))
     (State (EraRule &quot;LEDGER&quot; era))
forall a. ShelleyBase a -&gt; a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-test-1.7.0.0/doc/html/cardano-ledger-shelley-test/src/Test.Cardano.Ledger.Shelley.Utils.html#runShelleyBase"><span class="hs-identifier hs-var">runShelleyBase</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyBase
   (Either
      (NonEmpty (PredicateFailure (EraRule &quot;LEDGER&quot; era)))
      (State (EraRule &quot;LEDGER&quot; era)))
 -&gt; Either
      (NonEmpty (PredicateFailure (EraRule &quot;LEDGER&quot; era)))
      (State (EraRule &quot;LEDGER&quot; era)))
-&gt; ShelleyBase
     (Either
        (NonEmpty (PredicateFailure (EraRule &quot;LEDGER&quot; era)))
        (State (EraRule &quot;LEDGER&quot; era)))
-&gt; Either
     (NonEmpty (PredicateFailure (EraRule &quot;LEDGER&quot; era)))
     (State (EraRule &quot;LEDGER&quot; era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
-&gt; ShelleyBase
     (Either
        (NonEmpty (PredicateFailure (EraRule &quot;LEDGER&quot; era)))
        (State (EraRule &quot;LEDGER&quot; era)))
forall s (m :: * -&gt; *) (rtype :: RuleType).
(STS s, RuleTypeRep rtype, m ~ BaseM s) =&gt;
RuleContext rtype s
-&gt; m (Either (NonEmpty (PredicateFailure s)) (State s))
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#applySTS"><span class="hs-identifier hs-var">applySTS</span></a></span><span> </span><span class="annot"><span class="annottext">RuleContext 'Transition (EraRule &quot;LEDGER&quot; era)
</span><a href="#local-6989586621682744061"><span class="hs-identifier hs-var">trc</span></a></span><span>
</span><span id="line-1044"></span><span>
</span><span id="line-1045"></span><span id="local-6989586621682729470"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#foldFn"><span class="hs-identifier hs-type">foldFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682729470"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682729470"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682729470"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682729470"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1046"></span><span id="foldFn"><span class="annot"><span class="annottext">foldFn :: forall a. [a -&gt; a] -&gt; a -&gt; a
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#foldFn"><span class="hs-identifier hs-var hs-var">foldFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a -&gt; a) -&gt; (a -&gt; a) -&gt; a -&gt; a) -&gt; (a -&gt; a) -&gt; [a -&gt; a] -&gt; a -&gt; a
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (a -&gt; a) -&gt; a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-1047"></span><span>
</span><span id="line-1048"></span><span id="local-6989586621682729043"><span id="local-6989586621682729044"><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#foldFn%27"><span class="hs-identifier hs-type">foldFn'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682729043"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682729044"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682729044"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682729043"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682729044"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682729044"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-1049"></span><span id="foldFn%27"><span class="annot"><span class="annottext">foldFn' :: forall a b. [a -&gt; b -&gt; b] -&gt; a -&gt; b -&gt; b
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#foldFn%27"><span class="hs-identifier hs-var hs-var">foldFn'</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682744066"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682744066"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682744066"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1050"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#foldFn%27"><span class="hs-identifier hs-var">foldFn'</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682744067"><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682744067"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682744068"><span class="annot"><span class="annottext">[a -&gt; b -&gt; b]
</span><a href="#local-6989586621682744068"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682744069"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682744069"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682744070"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682744070"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621682744067"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682744069"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; b -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a -&gt; b -&gt; b] -&gt; a -&gt; b -&gt; b
forall a b. [a -&gt; b -&gt; b] -&gt; a -&gt; b -&gt; b
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#foldFn%27"><span class="hs-identifier hs-var">foldFn'</span></a></span><span> </span><span class="annot"><span class="annottext">[a -&gt; b -&gt; b]
</span><a href="#local-6989586621682744068"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682744069"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682744070"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1051"></span></pre></body></html>