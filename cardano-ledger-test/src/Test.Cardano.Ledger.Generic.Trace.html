<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Cardano.Ledger.Generic.Trace</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-comment">-- =========================================================================</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html"><span class="hs-identifier">Cardano.Ledger.Address</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#Addr"><span class="hs-identifier">Addr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Rules.html"><span class="hs-identifier">Cardano.Ledger.Alonzo.Rules</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Rules.Utxow.html#AlonzoUtxowPredFailure"><span class="hs-identifier">AlonzoUtxowPredFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-babbage-1.12.1.0/doc/html/cardano-ledger-babbage/src/Cardano.Ledger.Babbage.Rules.html"><span class="hs-identifier">Cardano.Ledger.Babbage.Rules</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-babbage-1.12.1.0/doc/html/cardano-ledger-babbage/src/Cardano.Ledger.Babbage.Rules.Utxow.html#BabbageUtxowPredFailure"><span class="hs-identifier">BabbageUtxowPredFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html"><span class="hs-identifier">Cardano.Ledger.BaseTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#BlocksMade"><span class="hs-identifier">BlocksMade</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#Globals"><span class="hs-identifier">Globals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html"><span class="hs-identifier">Cardano.Ledger.Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Compactible.html#CompactForm"><span class="hs-identifier">CompactForm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#CompactCoin"><span class="hs-identifier">CompactCoin</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Core.html"><span class="hs-identifier">Cardano.Ledger.Shelley.Core</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.html"><span class="hs-identifier">Cardano.Ledger.Shelley.LedgerState</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#EpochState"><span class="hs-identifier">EpochState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#LedgerState"><span class="hs-identifier">LedgerState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier">NewEpochState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#StashedAVVMAddresses"><span class="hs-identifier">StashedAVVMAddresses</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#UTxOState"><span class="hs-identifier">UTxOState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#curPParamsEpochStateL"><span class="hs-identifier">curPParamsEpochStateL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier">esLStateL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier">lsCertStateL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#prevPParamsEpochStateL"><span class="hs-identifier">prevPParamsEpochStateL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.html"><span class="hs-identifier">Cardano.Ledger.Shelley.Rules</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.Ledger.html#ShelleyLedgerPredFailure"><span class="hs-identifier">ShelleyLedgerPredFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.Ledgers.html#ShelleyLedgersPredFailure"><span class="hs-identifier">ShelleyLedgersPredFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.Utxow.html#ShelleyUtxowPredFailure"><span class="hs-identifier">ShelleyUtxowPredFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.Utxow.html#ScriptWitnessNotValidatingUTXOW"><span class="hs-identifier">ScriptWitnessNotValidatingUTXOW</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.State.html"><span class="hs-identifier">Cardano.Ledger.Shelley.State</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html"><span class="hs-identifier">Cardano.Slotting.Slot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier">EpochNo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier">SlotNo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadTrans</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.RWS.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">gets</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.html"><span class="hs-identifier">Control.State.Transition</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">STS</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html"><span class="hs-identifier">Control.State.Transition.Extended</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#IRC"><span class="hs-identifier">IRC</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#STS"><span class="hs-identifier">STS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#TRC"><span class="hs-identifier">TRC</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/data-default-0.8.0.1-9291b190c5bc542cf17f99ce44e9365d143d76b9889465ad3d362701e6cc609e/share/doc/html/src/Data.Default.html"><span class="hs-identifier">Data.Default</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/data-default-0.8.0.1-9291b190c5bc542cf17f99ce44e9365d143d76b9889465ad3d362701e6cc609e/share/doc/html/src/Data.Default.Internal.html#Default"><span class="hs-identifier">Default</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/data-default-0.8.0.1-9291b190c5bc542cf17f99ce44e9365d143d76b9889465ad3d362701e6cc609e/share/doc/html/src/Data.Default.Internal.html#def"><span class="hs-identifier">def</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Foldable</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fold</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Identity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Identity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runIdentity</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html"><span class="hs-identifier">Data.Maybe.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#StrictMaybe"><span class="hs-identifier">StrictMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html"><span class="hs-identifier">Data.Sequence.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html#StrictSeq"><span class="hs-identifier">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html"><span class="hs-identifier">Data.Sequence.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SS</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.html"><span class="hs-identifier">Data.TreeDiff</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/vector-0.13.2.0-15435dd5a5c5a17cbf505ae33b795526bd282aac3fd70b1e0e6fd56344cf8f72/share/doc/html/src/Data.Vector.html"><span class="hs-identifier">Data.Vector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/vector-0.13.2.0-15435dd5a5c5a17cbf505ae33b795526bd282aac3fd70b1e0e6fd56344cf8f72/share/doc/html/src/Data.Vector.html#Vector"><span class="hs-identifier">Vector</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/vector-0.13.2.0-15435dd5a5c5a17cbf505ae33b795526bd282aac3fd70b1e0e6fd56344cf8f72/share/doc/html/src/Data.Vector.html#%21"><span class="hs-operator">(!)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/vector-0.13.2.0-15435dd5a5c5a17cbf505ae33b795526bd282aac3fd70b1e0e6fd56344cf8f72/share/doc/html/src/Data.Vector.html"><span class="hs-identifier">Data.Vector</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Vector</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Debug</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Word</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word64</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html"><span class="hs-identifier">Lens.Micro</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&amp;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator">(.~)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator">(^.)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/l/testlib/doc/html/cardano-ledger-alonzo/src/Test.Cardano.Ledger.Alonzo.Era.html"><span class="hs-identifier">Test.Cardano.Ledger.Alonzo.Era</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html"><span class="hs-identifier">Test.Cardano.Ledger.Examples.STSTestUtils</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#EraModel"><span class="hs-identifier">EraModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Functions</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#adaPots"><span class="hs-identifier">adaPots</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Functions.html#totalAda"><span class="hs-identifier">totalAda</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.GenState</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier">EraGenericGen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenEnv"><span class="hs-identifier">GenEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier">GenRS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier">GenSize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier">GenState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#defaultGenSize"><span class="hs-identifier">defaultGenSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getBlocksizeMax"><span class="hs-identifier">getBlocksizeMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getReserves"><span class="hs-identifier">getReserves</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlot"><span class="hs-identifier">getSlot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlotDelta"><span class="hs-identifier">getSlotDelta</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#getTreasury"><span class="hs-identifier">getTreasury</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier">initStableFields</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#initialLedgerState"><span class="hs-identifier">initialLedgerState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier">modifyModel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#runGenRS"><span class="hs-identifier">runGenRS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Instances.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Instances</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.MockChain</span></a></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.ModelState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier">MUtxo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#stashedAVVMAddressesZero"><span class="hs-identifier">stashedAVVMAddressesZero</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.Proof</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#lift"><span class="hs-identifier">lift</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html"><span class="hs-identifier">Test.Cardano.Ledger.Generic.TxGen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.TxGen.html#genAlonzoTx"><span class="hs-identifier">genAlonzoTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-test-1.7.0.0/doc/html/cardano-ledger-shelley-test/src/Test.Cardano.Ledger.Shelley.Rules.IncrementalStake.html"><span class="hs-identifier">Test.Cardano.Ledger.Shelley.Rules.IncrementalStake</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-test-1.7.0.0/doc/html/cardano-ledger-shelley-test/src/Test.Cardano.Ledger.Shelley.Rules.IncrementalStake.html#stakeDistr"><span class="hs-identifier">stakeDistr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/l/testlib/doc/html/cardano-ledger-shelley/src/Test.Cardano.Ledger.Shelley.TreeDiff.html"><span class="hs-identifier">Test.Cardano.Ledger.Shelley.TreeDiff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/l/testlib/doc/html/cardano-ledger-binary/src/Test.Cardano.Ledger.Binary.TreeDiff.html#showExpr"><span class="hs-identifier">showExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-test-1.7.0.0/doc/html/cardano-ledger-shelley-test/src/Test.Cardano.Ledger.Shelley.Utils.html"><span class="hs-identifier">Test.Cardano.Ledger.Shelley.Utils</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#applySTSTest"><span class="hs-identifier">applySTSTest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-test-1.7.0.0/doc/html/cardano-ledger-shelley-test/src/Test.Cardano.Ledger.Shelley.Utils.html#runShelleyBase"><span class="hs-identifier">runShelleyBase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Core.Utils.html#testGlobals"><span class="hs-identifier">testGlobals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html"><span class="hs-identifier">Test.Control.State.Transition.Trace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#Trace"><span class="hs-identifier">Trace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#lastState"><span class="hs-identifier">lastState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#splitTrace"><span class="hs-identifier">splitTrace</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.Generator.QuickCheck.html"><span class="hs-identifier">Test.Control.State.Transition.Trace.Generator.QuickCheck</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.Generator.QuickCheck.html#HasTrace"><span class="hs-identifier">HasTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.Generator.QuickCheck.html#traceFromInitState"><span class="hs-identifier">traceFromInitState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.html"><span class="hs-identifier">Test.QuickCheck</span></a></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tasty-1.5.3-88586983451851d5d35dd67c2a04aba64f40e4837f8fdc734bac69f324c5798f/share/doc/html/src/Test.Tasty.html"><span class="hs-identifier">Test.Tasty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tasty-1.5.3-88586983451851d5d35dd67c2a04aba64f40e4837f8fdc734bac69f324c5798f/share/doc/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier">TestTree</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tasty-1.5.3-88586983451851d5d35dd67c2a04aba64f40e4837f8fdc734bac69f324c5798f/share/doc/html/src/Test.Tasty.Core.html#testGroup"><span class="hs-identifier">testGroup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tasty-quickcheck-0.11.1-a6e9951148459b597606684bef39d5db052b5c7504d645a5ed13f64b535ff547/share/doc/html/src/Test.Tasty.QuickCheck.html"><span class="hs-identifier">Test.Tasty.QuickCheck</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tasty-quickcheck-0.11.1-a6e9951148459b597606684bef39d5db052b5c7504d645a5ed13f64b535ff547/share/doc/html/src/Test.Tasty.QuickCheck.html#testProperty"><span class="hs-identifier">testProperty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- ===========================================</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | Generate a Tx and an internal Model of the state after the tx</span><span>
</span><span id="line-106"></span><span class="hs-comment">--   has been applied. That model can be used to generate the next Tx</span><span>
</span><span id="line-107"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#genRsTxAndModel"><span class="hs-identifier hs-type">genRsTxAndModel</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682747253"><span class="annot"><a href="#local-6989586621682747253"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747253"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747253"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747253"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span id="genRsTxAndModel"><span class="annot"><span class="annottext">genRsTxAndModel :: forall era.
EraGenericGen era =&gt;
Int -&gt; SlotNo -&gt; GenRS era (Tx era)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genRsTxAndModel"><span class="hs-identifier hs-var hs-var">genRsTxAndModel</span></a></span></span><span> </span><span id="local-6989586621682749982"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682749982"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682749983"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682749983"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO era
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682749984"><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621682749984"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; GenRS era (UTxO era, Tx era)
forall era.
EraGenericGen era =&gt;
SlotNo -&gt; GenRS era (UTxO era, Tx era)
</span><a href="Test.Cardano.Ledger.Generic.TxGen.html#genAlonzoTx"><span class="hs-identifier hs-var">genAlonzoTx</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682749983"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="annottext">(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
forall era.
(ModelNewEpochState era -&gt; ModelNewEpochState era) -&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#modifyModel"><span class="hs-identifier hs-var">modifyModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682749985"><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682749985"><span class="hs-identifier hs-var">model</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; SlotNo
-&gt; ModelNewEpochState era
-&gt; Tx era
-&gt; ModelNewEpochState era
forall era.
EraModel era =&gt;
Int -&gt; SlotNo -&gt; Model era -&gt; Tx era -&gt; Model era
</span><a href="Test.Cardano.Ledger.Examples.STSTestUtils.html#applyTx"><span class="hs-identifier hs-var">applyTx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682749982"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682749983"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">ModelNewEpochState era
</span><a href="#local-6989586621682749985"><span class="hs-identifier hs-var">model</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621682749984"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><span class="annottext">Tx era -&gt; GenRS era (Tx era)
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Tx era
</span><a href="#local-6989586621682749984"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><span class="hs-comment">-- | Generate a Vector of (StrictSeq (Tx era))  representing a (Vector Block)</span></span><span>
</span><span id="line-117"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#genRsTxSeq"><span class="hs-identifier hs-type">genRsTxSeq</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682747269"><span class="annot"><a href="#local-6989586621682747269"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747269"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html#StrictSeq"><span class="hs-identifier hs-type">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747269"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-123"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747269"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/vector-0.13.2.0-15435dd5a5c5a17cbf505ae33b795526bd282aac3fd70b1e0e6fd56344cf8f72/share/doc/html/src/Data.Vector.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html#StrictSeq"><span class="hs-identifier hs-type">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747269"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span id="genRsTxSeq"><span class="annot"><span class="annottext">genRsTxSeq :: forall era.
EraGenericGen era =&gt;
Int
-&gt; Int
-&gt; [(StrictSeq (Tx era), SlotNo)]
-&gt; SlotNo
-&gt; GenRS era (Vector (StrictSeq (Tx era), SlotNo))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genRsTxSeq"><span class="hs-identifier hs-var hs-var">genRsTxSeq</span></a></span></span><span> </span><span id="local-6989586621682750031"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750031"><span class="hs-identifier hs-var">this</span></a></span></span><span> </span><span id="local-6989586621682750032"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750032"><span class="hs-identifier hs-var">lastN</span></a></span></span><span> </span><span id="local-6989586621682750033"><span class="annot"><span class="annottext">[(StrictSeq (Tx era), SlotNo)]
</span><a href="#local-6989586621682750033"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621682750034"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682750034"><span class="hs-identifier hs-var">_slot</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750031"><span class="hs-identifier hs-var">this</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750032"><span class="hs-identifier hs-var">lastN</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
-&gt; GenRS era (Vector (StrictSeq (Tx era), SlotNo))
forall a. a -&gt; RWST (GenEnv era) () (GenState era) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(StrictSeq (Tx era), SlotNo)]
-&gt; Vector (StrictSeq (Tx era), SlotNo)
forall a. [a] -&gt; Vector a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/vector-0.13.2.0-15435dd5a5c5a17cbf505ae33b795526bd282aac3fd70b1e0e6fd56344cf8f72/share/doc/html/src/Data.Vector.html#fromList"><span class="hs-identifier hs-var">Vector.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(StrictSeq (Tx era), SlotNo)] -&gt; [(StrictSeq (Tx era), SlotNo)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[(StrictSeq (Tx era), SlotNo)]
</span><a href="#local-6989586621682750033"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#genRsTxSeq"><span class="hs-identifier hs-var">genRsTxSeq</span></a></span><span> </span><span id="local-6989586621682750037"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750037"><span class="hs-identifier hs-var">this</span></a></span></span><span> </span><span id="local-6989586621682750038"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750038"><span class="hs-identifier hs-var">lastN</span></a></span></span><span> </span><span id="local-6989586621682750039"><span class="annot"><span class="annottext">[(StrictSeq (Tx era), SlotNo)]
</span><a href="#local-6989586621682750039"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621682750040"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682750040"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-128"></span><span>  </span><span id="local-6989586621682750041"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682750041"><span class="hs-identifier hs-var">maxBlockSize</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Integer
forall era. GenState era -&gt; Integer
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getBlocksizeMax"><span class="hs-identifier hs-var">getBlocksizeMax</span></a></span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; Integer)
-&gt; RWST (GenEnv era) () (GenState era) Gen (GenState era)
-&gt; RWST (GenEnv era) () (GenState era) Gen Integer
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RWST (GenEnv era) () (GenState era) Gen (GenState era)
forall w (m :: * -&gt; *) r s. (Monoid w, Monad m) =&gt; RWST r w s m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621682750043"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750043"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int)
-&gt; Gen Int -&gt; RWST (GenEnv era) () (GenState era) Gen Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Gen Int
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682750041"><span class="hs-identifier hs-var">maxBlockSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621682750045"><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621682750045"><span class="hs-identifier hs-var">txs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int]
-&gt; (Int -&gt; RWST (GenEnv era) () (GenState era) Gen (Tx era))
-&gt; RWST (GenEnv era) () (GenState era) Gen [Tx era]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750043"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682750046"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750046"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SlotNo -&gt; RWST (GenEnv era) () (GenState era) Gen (Tx era)
forall era.
EraGenericGen era =&gt;
Int -&gt; SlotNo -&gt; GenRS era (Tx era)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genRsTxAndModel"><span class="hs-identifier hs-var">genRsTxAndModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750037"><span class="hs-identifier hs-var">this</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750046"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682750040"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>  </span><span id="local-6989586621682750048"><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621682750048"><span class="hs-identifier hs-var">newSlotRange</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenState era -&gt; (Word64, Word64))
-&gt; RWST (GenEnv era) () (GenState era) Gen (Word64, Word64)
forall w (m :: * -&gt; *) s a r.
(Monoid w, Monad m) =&gt;
(s -&gt; a) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; (Word64, Word64)
forall era. GenState era -&gt; (Word64, Word64)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlotDelta"><span class="hs-identifier hs-var">getSlotDelta</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span id="local-6989586621682750049"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682750049"><span class="hs-identifier hs-var">nextSlotNo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen SlotNo -&gt; RWST (GenEnv era) () (GenState era) Gen SlotNo
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; RWST (GenEnv era) () (GenState era) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Gen SlotNo -&gt; RWST (GenEnv era) () (GenState era) Gen SlotNo)
-&gt; Gen SlotNo -&gt; RWST (GenEnv era) () (GenState era) Gen SlotNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; SlotNo) -&gt; (Word64 -&gt; Word64) -&gt; Word64 -&gt; SlotNo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Word64
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#unSlotNo"><span class="hs-identifier hs-var">unSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682750040"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; SlotNo) -&gt; Gen Word64 -&gt; Gen SlotNo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Gen Word64
forall a. Random a =&gt; (a, a) -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#choose"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621682750048"><span class="hs-identifier hs-var">newSlotRange</span></a></span><span>
</span><span id="line-133"></span><span>  </span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; [(StrictSeq (Tx era), SlotNo)]
-&gt; SlotNo
-&gt; GenRS era (Vector (StrictSeq (Tx era), SlotNo))
forall era.
EraGenericGen era =&gt;
Int
-&gt; Int
-&gt; [(StrictSeq (Tx era), SlotNo)]
-&gt; SlotNo
-&gt; GenRS era (Vector (StrictSeq (Tx era), SlotNo))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genRsTxSeq"><span class="hs-identifier hs-var">genRsTxSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750037"><span class="hs-identifier hs-var">this</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750043"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750038"><span class="hs-identifier hs-var">lastN</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Tx era] -&gt; StrictSeq (Tx era)
forall a. [a] -&gt; StrictSeq a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html#fromList"><span class="hs-identifier hs-var">SS.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621682750045"><span class="hs-identifier hs-var">txs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682750040"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StrictSeq (Tx era), SlotNo)
-&gt; [(StrictSeq (Tx era), SlotNo)] -&gt; [(StrictSeq (Tx era), SlotNo)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(StrictSeq (Tx era), SlotNo)]
</span><a href="#local-6989586621682750039"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682750049"><span class="hs-identifier hs-var">nextSlotNo</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="annot"><span class="hs-comment">-- | Generate a Vector of Blocks, and an initial LedgerState</span></span><span>
</span><span id="line-136"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#genTxSeq"><span class="hs-identifier hs-type">genTxSeq</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682747317"><span class="annot"><a href="#local-6989586621682747317"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-138"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747317"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- Size of things the generated code should adhere to</span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- The number of Tx in the sequence</span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747317"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- An arbitrary 'initialization action', to run before we generate the sequence</span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-comment">-- use (pure ()) if you don't want or need initialization</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/vector-0.13.2.0-15435dd5a5c5a17cbf505ae33b795526bd282aac3fd70b1e0e6fd56344cf8f72/share/doc/html/src/Data.Vector.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html#StrictSeq"><span class="hs-identifier hs-type">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747317"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747317"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span id="genTxSeq"><span class="annot"><span class="annottext">genTxSeq :: forall era.
EraGenericGen era =&gt;
GenSize
-&gt; Int
-&gt; GenRS era ()
-&gt; Gen (Vector (StrictSeq (Tx era), SlotNo), GenState era)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTxSeq"><span class="hs-identifier hs-var hs-var">genTxSeq</span></a></span></span><span> </span><span id="local-6989586621682750060"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682750060"><span class="hs-identifier hs-var">gensize</span></a></span></span><span> </span><span id="local-6989586621682750061"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750061"><span class="hs-identifier hs-var">numTx</span></a></span></span><span> </span><span id="local-6989586621682750062"><span class="annot"><span class="annottext">GenRS era ()
</span><a href="#local-6989586621682750062"><span class="hs-identifier hs-var">initialize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><span class="annottext">GenSize
-&gt; GenRS era (Vector (StrictSeq (Tx era), SlotNo))
-&gt; Gen (Vector (StrictSeq (Tx era), SlotNo), GenState era)
forall era a.
EraGenericGen era =&gt;
GenSize -&gt; GenRS era a -&gt; Gen (a, GenState era)
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#runGenRS"><span class="hs-identifier hs-var">runGenRS</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682750060"><span class="hs-identifier hs-var">gensize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenRS era ()
</span><a href="#local-6989586621682750062"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">GenRS era ()
-&gt; GenRS era (Vector (StrictSeq (Tx era), SlotNo))
-&gt; GenRS era (Vector (StrictSeq (Tx era), SlotNo))
forall a b.
RWST (GenEnv era) () (GenState era) Gen a
-&gt; RWST (GenEnv era) () (GenState era) Gen b
-&gt; RWST (GenEnv era) () (GenState era) Gen b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; [(StrictSeq (Tx era), SlotNo)]
-&gt; SlotNo
-&gt; GenRS era (Vector (StrictSeq (Tx era), SlotNo))
forall era.
EraGenericGen era =&gt;
Int
-&gt; Int
-&gt; [(StrictSeq (Tx era), SlotNo)]
-&gt; SlotNo
-&gt; GenRS era (Vector (StrictSeq (Tx era), SlotNo))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genRsTxSeq"><span class="hs-identifier hs-var">genRsTxSeq</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750061"><span class="hs-identifier hs-var">numTx</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; SlotNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-var">SlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#runTest"><span class="hs-identifier hs-type">runTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span id="runTest"><span class="annot"><span class="annottext">runTest :: IO ()
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#runTest"><span class="hs-identifier hs-var hs-var">runTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682750064"><span class="annot"><span class="annottext">Vector (StrictSeq (Tx BabbageEra), SlotNo)
</span><a href="#local-6989586621682750064"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenState BabbageEra
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen
  (Vector (StrictSeq (Tx BabbageEra), SlotNo), GenState BabbageEra)
-&gt; IO
     (Vector (StrictSeq (Tx BabbageEra), SlotNo), GenState BabbageEra)
forall a. Gen a -&gt; IO a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#generate"><span class="hs-identifier hs-var">generate</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen
   (Vector (StrictSeq (Tx BabbageEra), SlotNo), GenState BabbageEra)
 -&gt; IO
      (Vector (StrictSeq (Tx BabbageEra), SlotNo), GenState BabbageEra))
-&gt; Gen
     (Vector (StrictSeq (Tx BabbageEra), SlotNo), GenState BabbageEra)
-&gt; IO
     (Vector (StrictSeq (Tx BabbageEra), SlotNo), GenState BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall era.
EraGenericGen era =&gt;
GenSize
-&gt; Int
-&gt; GenRS era ()
-&gt; Gen (Vector (StrictSeq (Tx era), SlotNo), GenState era)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTxSeq"><span class="hs-identifier hs-var">genTxSeq</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#BabbageEra"><span class="hs-identifier hs-type">BabbageEra</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#defaultGenSize"><span class="hs-identifier hs-var">defaultGenSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; GenRS BabbageEra ()
forall a.
a -&gt; RWST (GenEnv BabbageEra) () (GenState BabbageEra) Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx BabbageEra), SlotNo) -&gt; Int
forall a. Vector a -&gt; Int
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/vector-0.13.2.0-15435dd5a5c5a17cbf505ae33b795526bd282aac3fd70b1e0e6fd56344cf8f72/share/doc/html/src/Data.Vector.html#length"><span class="hs-identifier hs-var">Vector.length</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx BabbageEra), SlotNo)
</span><a href="#local-6989586621682750064"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- ==================================================================</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- Constructing the &quot;real&quot;, initial NewEpochState, from the GenState</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#initialMockChainState"><span class="hs-identifier hs-type">initialMockChainState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682747328"><span class="annot"><a href="#local-6989586621682747328"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747328"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.State.Account.html#ShelleyEraAccounts"><span class="hs-identifier hs-type">ShelleyEraAccounts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747328"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747328"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainState"><span class="hs-identifier hs-type">MockChainState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747328"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-160"></span><span id="initialMockChainState"><span class="annot"><span class="annottext">initialMockChainState :: forall era.
(Reflect era, ShelleyEraAccounts era) =&gt;
GenState era -&gt; MockChainState era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#initialMockChainState"><span class="hs-identifier hs-var hs-var">initialMockChainState</span></a></span></span><span> </span><span id="local-6989586621682750076"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750076"><span class="hs-identifier hs-var">gstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; NewEpochState era -&gt; SlotNo -&gt; Int -&gt; MockChainState era
forall era.
NewEpochState era
-&gt; NewEpochState era -&gt; SlotNo -&gt; Int -&gt; MockChainState era
</span><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainState"><span class="hs-identifier hs-var">MockChainState</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621682750078"><span class="hs-identifier hs-var">newepochstate</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621682750078"><span class="hs-identifier hs-var">newepochstate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenState era -&gt; SlotNo
forall era. GenState era -&gt; SlotNo
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getSlot"><span class="hs-identifier hs-var">getSlot</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750076"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>    </span><span id="local-6989586621682750079"><span class="annot"><span class="annottext">ledgerstate :: LedgerState era
</span><a href="#local-6989586621682750079"><span class="hs-identifier hs-var hs-var">ledgerstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; LedgerState era
forall era. Reflect era =&gt; GenState era -&gt; LedgerState era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initialLedgerState"><span class="hs-identifier hs-var">initialLedgerState</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750076"><span class="hs-identifier hs-var">gstate</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621682750078"><span class="annot"><span class="annottext">newepochstate :: NewEpochState era
</span><a href="#local-6989586621682750078"><span class="hs-identifier hs-var hs-var">newepochstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-165"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">nesEL :: EpochNo
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEL"><span class="hs-identifier hs-var">nesEL</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; EpochNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-var">EpochNo</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nesBprev :: BlocksMade
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesBprev"><span class="hs-identifier hs-var">nesBprev</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) Natural -&gt; BlocksMade
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#BlocksMade"><span class="hs-identifier hs-var">BlocksMade</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) Natural
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nesBcur :: BlocksMade
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesBcur"><span class="hs-identifier hs-var">nesBcur</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) Natural -&gt; BlocksMade
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#BlocksMade"><span class="hs-identifier hs-var">BlocksMade</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) Natural
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-169"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nesEs :: EpochState era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEs"><span class="hs-identifier hs-var">nesEs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; LedgerState era -&gt; EpochState era
forall era.
(Reflect era, ShelleyEraAccounts era) =&gt;
GenState era -&gt; LedgerState era -&gt; EpochState era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#makeEpochState"><span class="hs-identifier hs-var">makeEpochState</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750076"><span class="hs-identifier hs-var">gstate</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState era
</span><a href="#local-6989586621682750079"><span class="hs-identifier hs-var">ledgerstate</span></a></span><span>
</span><span id="line-170"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nesRu :: StrictMaybe PulsingRewUpdate
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesRu"><span class="hs-identifier hs-var">nesRu</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictMaybe PulsingRewUpdate
forall a. StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-171"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nesPd :: PoolDistr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesPd"><span class="hs-identifier hs-var">nesPd</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) IndividualPoolStake
-&gt; CompactForm Coin -&gt; PoolDistr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#PoolDistr"><span class="hs-identifier hs-var">PoolDistr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenState era -&gt; Map (KeyHash 'StakePool) IndividualPoolStake
forall era.
GenState era -&gt; Map (KeyHash 'StakePool) IndividualPoolStake
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsInitialPoolDistr"><span class="hs-identifier hs-var">gsInitialPoolDistr</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750076"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; CompactForm Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#CompactCoin"><span class="hs-identifier hs-var">CompactCoin</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stashedAVVMAddresses :: StashedAVVMAddresses era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#stashedAVVMAddresses"><span class="hs-identifier hs-var">stashedAVVMAddresses</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proof era -&gt; StashedAVVMAddresses era
forall era. Proof era -&gt; StashedAVVMAddresses era
</span><a href="Test.Cardano.Ledger.Generic.ModelState.html#stashedAVVMAddressesZero"><span class="hs-identifier hs-var">stashedAVVMAddressesZero</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682747328"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span id="local-6989586621682747338"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#makeEpochState"><span class="hs-identifier hs-type">makeEpochState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747338"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.State.Account.html#ShelleyEraAccounts"><span class="hs-identifier hs-type">ShelleyEraAccounts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747338"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747338"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#LedgerState"><span class="hs-identifier hs-type">LedgerState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747338"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#EpochState"><span class="hs-identifier hs-type">EpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747338"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-177"></span><span id="makeEpochState"><span class="annot"><span class="annottext">makeEpochState :: forall era.
(Reflect era, ShelleyEraAccounts era) =&gt;
GenState era -&gt; LedgerState era -&gt; EpochState era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#makeEpochState"><span class="hs-identifier hs-var hs-var">makeEpochState</span></a></span></span><span> </span><span id="local-6989586621682750116"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750116"><span class="hs-identifier hs-var">gstate</span></a></span></span><span> </span><span id="local-6989586621682750117"><span class="annot"><span class="annottext">LedgerState era
</span><a href="#local-6989586621682750117"><span class="hs-identifier hs-var">ledgerstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-178"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#EpochState"><span class="hs-identifier hs-type">EpochState</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">esChainAccountState :: ChainAccountState
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esChainAccountState"><span class="hs-identifier hs-var">esChainAccountState</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.ChainAccount.html#ChainAccountState"><span class="hs-identifier hs-type">ChainAccountState</span></a></span><span>
</span><span id="line-181"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">casTreasury :: Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.ChainAccount.html#casTreasury"><span class="hs-identifier hs-var">casTreasury</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Coin
forall era. GenState era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getTreasury"><span class="hs-identifier hs-var">getTreasury</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750116"><span class="hs-identifier hs-var">gstate</span></a></span><span>
</span><span id="line-182"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">casReserves :: Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.ChainAccount.html#casReserves"><span class="hs-identifier hs-var">casReserves</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; Coin
forall era. GenState era -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#getReserves"><span class="hs-identifier hs-var">getReserves</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750116"><span class="hs-identifier hs-var">gstate</span></a></span><span>
</span><span id="line-183"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">esSnapshots :: SnapShots
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esSnapshots"><span class="hs-identifier hs-var">esSnapshots</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LedgerState era -&gt; SnapShots
forall era.
(EraTxOut era, EraCertState era, ShelleyEraAccounts era) =&gt;
LedgerState era -&gt; SnapShots
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#snaps"><span class="hs-identifier hs-var">snaps</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState era
</span><a href="#local-6989586621682750117"><span class="hs-identifier hs-var">ledgerstate</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">esLState :: LedgerState era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esLState"><span class="hs-identifier hs-var">esLState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LedgerState era
</span><a href="#local-6989586621682750117"><span class="hs-identifier hs-var">ledgerstate</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">esNonMyopic :: NonMyopic
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esNonMyopic"><span class="hs-identifier hs-var">esNonMyopic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonMyopic
forall a. Default a =&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/data-default-0.8.0.1-9291b190c5bc542cf17f99ce44e9365d143d76b9889465ad3d362701e6cc609e/share/doc/html/src/Data.Default.Internal.html#def"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><span class="annottext">EpochState era
-&gt; (EpochState era -&gt; EpochState era) -&gt; EpochState era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(PParams era -&gt; Identity (PParams era))
-&gt; EpochState era -&gt; Identity (EpochState era)
forall era. EraGov era =&gt; Lens' (EpochState era) (PParams era)
Lens' (EpochState era) (PParams era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#prevPParamsEpochStateL"><span class="hs-identifier hs-var">prevPParamsEpochStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((PParams era -&gt; Identity (PParams era))
 -&gt; EpochState era -&gt; Identity (EpochState era))
-&gt; PParams era -&gt; EpochState era -&gt; EpochState era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; PParams era
forall era. GenEnv era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenState era -&gt; GenEnv era
forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750116"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="annottext">EpochState era
-&gt; (EpochState era -&gt; EpochState era) -&gt; EpochState era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(PParams era -&gt; Identity (PParams era))
-&gt; EpochState era -&gt; Identity (EpochState era)
forall era. EraGov era =&gt; Lens' (EpochState era) (PParams era)
Lens' (EpochState era) (PParams era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#curPParamsEpochStateL"><span class="hs-identifier hs-var">curPParamsEpochStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((PParams era -&gt; Identity (PParams era))
 -&gt; EpochState era -&gt; Identity (EpochState era))
-&gt; PParams era -&gt; EpochState era -&gt; EpochState era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">GenEnv era -&gt; PParams era
forall era. GenEnv era -&gt; PParams era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gePParams"><span class="hs-identifier hs-var">gePParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenState era -&gt; GenEnv era
forall era. GenState era -&gt; GenEnv era
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#gsGenEnv"><span class="hs-identifier hs-var">gsGenEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750116"><span class="hs-identifier hs-var">gstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span id="local-6989586621682747350"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#snaps"><span class="hs-identifier hs-type">snaps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#EraTxOut"><span class="hs-identifier hs-type">EraTxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747350"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#EraCertState"><span class="hs-identifier hs-type">EraCertState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747350"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.State.Account.html#ShelleyEraAccounts"><span class="hs-identifier hs-type">ShelleyEraAccounts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747350"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#LedgerState"><span class="hs-identifier hs-type">LedgerState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747350"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.SnapShots.html#SnapShots"><span class="hs-identifier hs-type">SnapShots</span></a></span></span><span>
</span><span id="line-192"></span><span id="snaps"><span class="annot"><span class="annottext">snaps :: forall era.
(EraTxOut era, EraCertState era, ShelleyEraAccounts era) =&gt;
LedgerState era -&gt; SnapShots
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#snaps"><span class="hs-identifier hs-var hs-var">snaps</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#LedgerState"><span class="hs-identifier hs-type">LedgerState</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#UTxOState"><span class="hs-identifier hs-type">UTxOState</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">utxosUtxo :: forall era. UTxOState era -&gt; UTxO era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#utxosUtxo"><span class="hs-identifier hs-var">utxosUtxo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682750142"><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621682750142"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">utxosFees :: forall era. UTxOState era -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#utxosFees"><span class="hs-identifier hs-var">utxosFees</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621682750144"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682750144"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621682750145"><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621682750145"><span class="hs-identifier hs-var">certState</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>  </span><span class="annot"><span class="annottext">SnapShot -&gt; PoolDistr -&gt; SnapShot -&gt; SnapShot -&gt; Coin -&gt; SnapShots
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.SnapShots.html#SnapShots"><span class="hs-identifier hs-var">SnapShots</span></a></span><span> </span><span class="annot"><span class="annottext">SnapShot
</span><a href="#local-6989586621682750147"><span class="hs-identifier hs-var">snap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SnapShot -&gt; PoolDistr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.SnapShots.html#calculatePoolDistr"><span class="hs-identifier hs-var">calculatePoolDistr</span></a></span><span> </span><span class="annot"><span class="annottext">SnapShot
</span><a href="#local-6989586621682750147"><span class="hs-identifier hs-var">snap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SnapShot
</span><a href="#local-6989586621682750147"><span class="hs-identifier hs-var">snap</span></a></span><span> </span><span class="annot"><span class="annottext">SnapShot
</span><a href="#local-6989586621682750147"><span class="hs-identifier hs-var">snap</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682750144"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-195"></span><span>    </span><span id="local-6989586621682750149"><span class="annot"><span class="annottext">pstate :: PState era
</span><a href="#local-6989586621682750149"><span class="hs-identifier hs-var hs-var">pstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621682750145"><span class="hs-identifier hs-var">certState</span></a></span><span> </span><span class="annot"><span class="annottext">CertState era
-&gt; Getting (PState era) (CertState era) (PState era) -&gt; PState era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (PState era) (CertState era) (PState era)
forall era. EraCertState era =&gt; Lens' (CertState era) (PState era)
Lens' (CertState era) (PState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#certPStateL"><span class="hs-identifier hs-var">certPStateL</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span id="local-6989586621682750151"><span class="annot"><span class="annottext">dstate :: DState era
</span><a href="#local-6989586621682750151"><span class="hs-identifier hs-var hs-var">dstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertState era
</span><a href="#local-6989586621682750145"><span class="hs-identifier hs-var">certState</span></a></span><span> </span><span class="annot"><span class="annottext">CertState era
-&gt; Getting (DState era) (CertState era) (DState era) -&gt; DState era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (DState era) (CertState era) (DState era)
forall era. EraCertState era =&gt; Lens' (CertState era) (DState era)
Lens' (CertState era) (DState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#certDStateL"><span class="hs-identifier hs-var">certDStateL</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span id="local-6989586621682750147"><span class="annot"><span class="annottext">snap :: SnapShot
</span><a href="#local-6989586621682750147"><span class="hs-identifier hs-var hs-var">snap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTxO era -&gt; DState era -&gt; PState era -&gt; SnapShot
forall era.
(EraTxOut era, ShelleyEraAccounts era) =&gt;
UTxO era -&gt; DState era -&gt; PState era -&gt; SnapShot
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-test-1.7.0.0/doc/html/cardano-ledger-shelley-test/src/Test.Cardano.Ledger.Shelley.Rules.IncrementalStake.html#stakeDistr"><span class="hs-identifier hs-var">stakeDistr</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621682750142"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">DState era
</span><a href="#local-6989586621682750151"><span class="hs-identifier hs-var">dstate</span></a></span><span> </span><span class="annot"><span class="annottext">PState era
</span><a href="#local-6989586621682750149"><span class="hs-identifier hs-var">pstate</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- ==============================================================================</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#raiseMockError"><span class="hs-identifier hs-type">raiseMockError</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682747374"><span class="annot"><a href="#local-6989586621682747374"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747374"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#EpochState"><span class="hs-identifier hs-type">EpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747374"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainFailure"><span class="hs-identifier hs-type">MockChainFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747374"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747374"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747374"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-211"></span><span id="raiseMockError"><span class="annot"><span class="annottext">raiseMockError :: forall era.
Reflect era =&gt;
Word64
-&gt; SlotNo
-&gt; EpochState era
-&gt; NonEmpty (MockChainFailure era)
-&gt; [Tx era]
-&gt; GenState era
-&gt; String
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#raiseMockError"><span class="hs-identifier hs-var hs-var">raiseMockError</span></a></span></span><span> </span><span id="local-6989586621682750179"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682750179"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span id="local-6989586621682750180"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682750180"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682750181"><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621682750181"><span class="hs-identifier hs-var">epochstate</span></a></span></span><span> </span><span id="local-6989586621682750182"><span class="annot"><span class="annottext">NonEmpty (MockChainFailure era)
</span><a href="#local-6989586621682750182"><span class="hs-identifier hs-var">_pdfs</span></a></span></span><span> </span><span id="local-6989586621682750183"><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621682750183"><span class="hs-identifier hs-var">_txs</span></a></span></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682750184"><span class="annot"><span class="annottext">_ssPoolParams :: Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621682750184"><span class="hs-identifier hs-var hs-var">_ssPoolParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621682750181"><span class="hs-identifier hs-var">epochstate</span></a></span><span> </span><span class="annot"><span class="annottext">EpochState era
-&gt; Getting
     (Map (KeyHash 'StakePool) StakePoolState)
     (EpochState era)
     (Map (KeyHash 'StakePool) StakePoolState)
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(LedgerState era
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era))
-&gt; EpochState era
-&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">esLStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LedgerState era
  -&gt; Const
       (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era))
 -&gt; EpochState era
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState) (EpochState era))
-&gt; ((Map (KeyHash 'StakePool) StakePoolState
     -&gt; Const
          (Map (KeyHash 'StakePool) StakePoolState)
          (Map (KeyHash 'StakePool) StakePoolState))
    -&gt; LedgerState era
    -&gt; Const
         (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era))
-&gt; Getting
     (Map (KeyHash 'StakePool) StakePoolState)
     (EpochState era)
     (Map (KeyHash 'StakePool) StakePoolState)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CertState era
 -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era))
-&gt; LedgerState era
-&gt; Const
     (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">lsCertStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CertState era
  -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era))
 -&gt; LedgerState era
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era))
-&gt; ((Map (KeyHash 'StakePool) StakePoolState
     -&gt; Const
          (Map (KeyHash 'StakePool) StakePoolState)
          (Map (KeyHash 'StakePool) StakePoolState))
    -&gt; CertState era
    -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era))
-&gt; (Map (KeyHash 'StakePool) StakePoolState
    -&gt; Const
         (Map (KeyHash 'StakePool) StakePoolState)
         (Map (KeyHash 'StakePool) StakePoolState))
-&gt; LedgerState era
-&gt; Const
     (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PState era
 -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (PState era))
-&gt; CertState era
-&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era)
forall era. EraCertState era =&gt; Lens' (CertState era) (PState era)
Lens' (CertState era) (PState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#certPStateL"><span class="hs-identifier hs-var">certPStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((PState era
  -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (PState era))
 -&gt; CertState era
 -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era))
-&gt; ((Map (KeyHash 'StakePool) StakePoolState
     -&gt; Const
          (Map (KeyHash 'StakePool) StakePoolState)
          (Map (KeyHash 'StakePool) StakePoolState))
    -&gt; PState era
    -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (PState era))
-&gt; (Map (KeyHash 'StakePool) StakePoolState
    -&gt; Const
         (Map (KeyHash 'StakePool) StakePoolState)
         (Map (KeyHash 'StakePool) StakePoolState))
-&gt; CertState era
-&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) StakePoolState
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState)
      (Map (KeyHash 'StakePool) StakePoolState))
-&gt; PState era
-&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (PState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(Map (KeyHash 'StakePool) StakePoolState
 -&gt; f (Map (KeyHash 'StakePool) StakePoolState))
-&gt; PState era -&gt; f (PState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#psStakePoolsL"><span class="hs-identifier hs-var">psStakePoolsL</span></a></span><span>
</span><span id="line-213"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-214"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">AdaPots -&gt; Expr
forall a. ToExpr a =&gt; a -&gt; Expr
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Class.html#toExpr"><span class="hs-identifier hs-var">toExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(AdaPots -&gt; Expr) -&gt; AdaPots -&gt; Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proof era -&gt; EpochState era -&gt; AdaPots
forall era. Proof era -&gt; EpochState era -&gt; AdaPots
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#adaPots"><span class="hs-identifier hs-var">adaPots</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
forall era. Reflect era =&gt; Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#reify"><span class="hs-identifier hs-var">reify</span></a></span><span> </span><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621682750181"><span class="hs-identifier hs-var">epochstate</span></a></span><span>
</span><span id="line-215"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Expr
forall a. ToExpr a =&gt; a -&gt; Expr
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Class.html#toExpr"><span class="hs-identifier hs-var">toExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682750179"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-216"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Expr
forall a. ToExpr a =&gt; a -&gt; Expr
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Class.html#toExpr"><span class="hs-identifier hs-var">toExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682750180"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-217"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ppString &quot;===================================&quot;,</span><span>
</span><span id="line-218"></span><span>          </span><span class="hs-comment">-- ppString &quot;Real Pool Params\n&quot; &lt;&gt; ppMap pcKeyHash pcPoolParams poolParams,</span><span>
</span><span id="line-219"></span><span>          </span><span class="annot"><span class="annottext">PParams era -&gt; Expr
forall a. ToExpr a =&gt; a -&gt; Expr
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Class.html#toExpr"><span class="hs-identifier hs-var">toExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621682750181"><span class="hs-identifier hs-var">epochstate</span></a></span><span> </span><span class="annot"><span class="annottext">EpochState era
-&gt; Getting (PParams era) (EpochState era) (PParams era)
-&gt; PParams era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (PParams era) (EpochState era) (PParams era)
forall era. EraGov era =&gt; Lens' (EpochState era) (PParams era)
Lens' (EpochState era) (PParams era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#curPParamsEpochStateL"><span class="hs-identifier hs-var">curPParamsEpochStateL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span id="local-6989586621682747391"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#badScripts"><span class="hs-identifier hs-type">badScripts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747391"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainFailure"><span class="hs-identifier hs-type">MockChainFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747391"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span></span><span>
</span><span id="line-223"></span><span id="badScripts"><span class="annot"><span class="annottext">badScripts :: forall era. Proof era -&gt; [MockChainFailure era] -&gt; Set ScriptHash
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#badScripts"><span class="hs-identifier hs-var hs-var">badScripts</span></a></span></span><span> </span><span id="local-6989586621682750193"><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621682750193"><span class="hs-identifier hs-var">proof</span></a></span></span><span> </span><span id="local-6989586621682750194"><span class="annot"><span class="annottext">[MockChainFailure era]
</span><a href="#local-6989586621682750194"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set ScriptHash -&gt; MockChainFailure era -&gt; Set ScriptHash)
-&gt; Set ScriptHash -&gt; [MockChainFailure era] -&gt; Set ScriptHash
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">Fold.foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682750196"><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682750196"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621682750197"><span class="annot"><span class="annottext">MockChainFailure era
</span><a href="#local-6989586621682750197"><span class="hs-identifier hs-var">mcf</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set ScriptHash -&gt; Set ScriptHash -&gt; Set ScriptHash
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.union</span></span><span> </span><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682750196"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proof era -&gt; MockChainFailure era -&gt; Set ScriptHash
forall era. Proof era -&gt; MockChainFailure era -&gt; Set ScriptHash
</span><a href="#local-6989586621682750199"><span class="hs-identifier hs-var">getw</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><a href="#local-6989586621682750193"><span class="hs-identifier hs-var">proof</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainFailure era
</span><a href="#local-6989586621682750197"><span class="hs-identifier hs-var">mcf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set ScriptHash
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">[MockChainFailure era]
</span><a href="#local-6989586621682750194"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>    </span><span id="local-6989586621682747399"><span class="annot"><a href="#local-6989586621682750199"><span class="hs-identifier hs-type">getw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747399"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainFailure"><span class="hs-identifier hs-type">MockChainFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747399"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span></span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621682750199"><span class="annot"><span class="annottext">getw :: forall era. Proof era -&gt; MockChainFailure era -&gt; Set ScriptHash
</span><a href="#local-6989586621682750199"><span class="hs-identifier hs-var hs-var">getw</span></a></span></span><span>
</span><span id="line-227"></span><span>      </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Babbage"><span class="hs-identifier hs-var">Babbage</span></a></span><span>
</span><span id="line-228"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainFromLedgersFailure"><span class="hs-identifier hs-type">MockChainFromLedgersFailure</span></a></span><span>
</span><span id="line-229"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.Ledgers.html#LedgerFailure"><span class="hs-identifier hs-type">LedgerFailure</span></a></span><span>
</span><span id="line-230"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.Ledger.html#UtxowFailure"><span class="hs-identifier hs-type">UtxowFailure</span></a></span><span>
</span><span id="line-231"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-babbage-1.12.1.0/doc/html/cardano-ledger-babbage/src/Cardano.Ledger.Babbage.Rules.Utxow.html#AlonzoInBabbageUtxowPredFailure"><span class="hs-identifier hs-type">AlonzoInBabbageUtxowPredFailure</span></a></span><span>
</span><span id="line-232"></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Rules.Utxow.html#ShelleyInAlonzoUtxowPredFailure"><span class="hs-identifier hs-type">ShelleyInAlonzoUtxowPredFailure</span></a></span><span>
</span><span id="line-233"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.Utxow.html#ScriptWitnessNotValidatingUTXOW"><span class="hs-identifier hs-type">ScriptWitnessNotValidatingUTXOW</span></a></span><span> </span><span id="local-6989586621682750208"><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682750208"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>                    </span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682750208"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><a href="#local-6989586621682750199"><span class="hs-identifier hs-var">getw</span></a></span><span>
</span><span id="line-240"></span><span>      </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Alonzo"><span class="hs-identifier hs-var">Alonzo</span></a></span><span>
</span><span id="line-241"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainFromLedgersFailure"><span class="hs-identifier hs-type">MockChainFromLedgersFailure</span></a></span><span>
</span><span id="line-242"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.Ledgers.html#LedgerFailure"><span class="hs-identifier hs-type">LedgerFailure</span></a></span><span>
</span><span id="line-243"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.Ledger.html#UtxowFailure"><span class="hs-identifier hs-type">UtxowFailure</span></a></span><span>
</span><span id="line-244"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-alonzo-1.15.0.0/doc/html/cardano-ledger-alonzo/src/Cardano.Ledger.Alonzo.Rules.Utxow.html#ShelleyInAlonzoUtxowPredFailure"><span class="hs-identifier hs-type">ShelleyInAlonzoUtxowPredFailure</span></a></span><span>
</span><span id="line-245"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.Utxow.html#ScriptWitnessNotValidatingUTXOW"><span class="hs-identifier hs-type">ScriptWitnessNotValidatingUTXOW</span></a></span><span> </span><span id="local-6989586621682750211"><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682750211"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>                    </span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682750211"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><a href="#local-6989586621682750199"><span class="hs-identifier hs-var">getw</span></a></span><span>
</span><span id="line-251"></span><span>      </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Mary"><span class="hs-identifier hs-var">Mary</span></a></span><span>
</span><span id="line-252"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainFromLedgersFailure"><span class="hs-identifier hs-type">MockChainFromLedgersFailure</span></a></span><span>
</span><span id="line-253"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.Ledgers.html#LedgerFailure"><span class="hs-identifier hs-type">LedgerFailure</span></a></span><span>
</span><span id="line-254"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.Ledger.html#UtxowFailure"><span class="hs-identifier hs-type">UtxowFailure</span></a></span><span>
</span><span id="line-255"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.Utxow.html#ScriptWitnessNotValidatingUTXOW"><span class="hs-identifier hs-type">ScriptWitnessNotValidatingUTXOW</span></a></span><span> </span><span id="local-6989586621682750214"><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682750214"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682750214"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><a href="#local-6989586621682750199"><span class="hs-identifier hs-var">getw</span></a></span><span>
</span><span id="line-260"></span><span>      </span><span class="annot"><span class="annottext">Proof era
</span><a href="Test.Cardano.Ledger.Generic.Proof.html#Allegra"><span class="hs-identifier hs-var">Allegra</span></a></span><span>
</span><span id="line-261"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainFromLedgersFailure"><span class="hs-identifier hs-type">MockChainFromLedgersFailure</span></a></span><span>
</span><span id="line-262"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.Ledgers.html#LedgerFailure"><span class="hs-identifier hs-type">LedgerFailure</span></a></span><span>
</span><span id="line-263"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.Ledger.html#UtxowFailure"><span class="hs-identifier hs-type">UtxowFailure</span></a></span><span>
</span><span id="line-264"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.Rules.Utxow.html#ScriptWitnessNotValidatingUTXOW"><span class="hs-identifier hs-type">ScriptWitnessNotValidatingUTXOW</span></a></span><span> </span><span id="local-6989586621682750217"><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682750217"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set ScriptHash
</span><a href="#local-6989586621682750217"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><a href="#local-6989586621682750199"><span class="hs-identifier hs-var">getw</span></a></span><span> </span><span class="annot"><span class="annottext">Proof era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MockChainFailure era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set ScriptHash
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span id="local-6989586621682747403"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#shortTxOut"><span class="hs-identifier hs-type">shortTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#EraTxOut"><span class="hs-identifier hs-type">EraTxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747403"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747403"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span></span><span>
</span><span id="line-271"></span><span id="shortTxOut"><span class="annot"><span class="annottext">shortTxOut :: forall era. EraTxOut era =&gt; TxOut era -&gt; Expr
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#shortTxOut"><span class="hs-identifier hs-var hs-var">shortTxOut</span></a></span></span><span> </span><span id="local-6989586621682750232"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682750232"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682750232"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; Getting Addr (TxOut era) Addr -&gt; Addr
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Addr (TxOut era) Addr
forall era. EraTxOut era =&gt; Lens' (TxOut era) Addr
Lens' (TxOut era) Addr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#addrTxOutL"><span class="hs-identifier hs-var">addrTxOutL</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682750235"><span class="annot"><span class="annottext">PaymentCredential
</span><a href="#local-6989586621682750235"><span class="hs-identifier hs-var">pay</span></a></span></span><span> </span><span class="annot"><span class="annottext">StakeReference
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PaymentCredential, Coin) -&gt; Expr
forall a. ToExpr a =&gt; a -&gt; Expr
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Class.html#toExpr"><span class="hs-identifier hs-var">toExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PaymentCredential
</span><a href="#local-6989586621682750235"><span class="hs-identifier hs-var">pay</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621682750232"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; Getting Coin (TxOut era) Coin -&gt; Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Coin (TxOut era) Coin
forall era. (HasCallStack, EraTxOut era) =&gt; Lens' (TxOut era) Coin
Lens' (TxOut era) Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#coinTxOutL"><span class="hs-identifier hs-var">coinTxOutL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>  </span><span class="annot"><span class="annottext">Addr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Expr
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Bootstrap Address in shortTxOut&quot;</span></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span id="local-6989586621682747419"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#smartTxBody"><span class="hs-identifier hs-type">smartTxBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Era.html#EraTest"><span class="hs-identifier hs-type">EraTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747419"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.ModelState.html#MUtxo"><span class="hs-identifier hs-type">MUtxo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747419"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747419"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span></span><span>
</span><span id="line-276"></span><span id="smartTxBody"><span class="annot"><span class="annottext">smartTxBody :: forall era. EraTest era =&gt; MUtxo era -&gt; TxBody era -&gt; Expr
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#smartTxBody"><span class="hs-identifier hs-var hs-var">smartTxBody</span></a></span></span><span> </span><span id="local-6989586621682750249"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682750249"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621682750250"><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621682750250"><span class="hs-identifier hs-var">txbody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map TxIn (TxOut era), TxBody era) -&gt; Expr
forall a. ToExpr a =&gt; a -&gt; Expr
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Class.html#toExpr"><span class="hs-identifier hs-var">toExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621682750249"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621682750250"><span class="hs-identifier hs-var">txbody</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-- =====================================================================</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- HasTrace instance of MOCKCHAIN depends on STS(MOCKCHAIN era) instance</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- We show the type family instances here for reference.</span><span>
</span><span id="line-281"></span><span class="hs-comment">{-
instance STS (MOCKCHAIN era)
  where
  type State (MOCKCHAIN era) = MockChainState era
  type Signal (MOCKCHAIN era) = (MockBlock era)
  type Environment (MOCKCHAIN era) = ()
-}</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- ==============================================================</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-keyword">data</span><span> </span><span id="Gen1"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a></span></span><span> </span><span id="local-6989586621682747486"><span class="annot"><a href="#local-6989586621682747486"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Gen1"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/vector-0.13.2.0-15435dd5a5c5a17cbf505ae33b795526bd282aac3fd70b1e0e6fd56344cf8f72/share/doc/html/src/Data.Vector.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Sequence.Strict.html#StrictSeq"><span class="hs-identifier hs-type">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747486"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenState"><span class="hs-identifier hs-type">GenState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747486"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-293"></span><span>  </span><span id="local-6989586621682747252"><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#STS"><span class="hs-identifier hs-type">STS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747252"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Proof.html#Reflect"><span class="hs-identifier hs-type">Reflect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747252"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Era.html#EraTest"><span class="hs-identifier hs-type">EraTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747252"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tree-diff-0.3.4-ef016b9048a98243efba583942a384684f7a662dffbb0844de08f7ab79f0b6af/share/doc/html/src/Data.TreeDiff.Class.html#ToExpr"><span class="hs-identifier hs-type">ToExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#PredicateFailure"><span class="hs-identifier hs-type">PredicateFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Era.html#EraRule"><span class="hs-identifier hs-type">EraRule</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;LEDGER&quot;</span></span><span> </span><span class="annot"><a href="#local-6989586621682747252"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-298"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.Generator.QuickCheck.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747252"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-type">Gen1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747252"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="BaseEnv"><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.Generator.QuickCheck.html#BaseEnv"><span class="hs-identifier hs-var">BaseEnv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747252"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#Globals"><span class="hs-identifier hs-type">Globals</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>  </span><span id="local-6989586621682750274"><span class="annot"><span class="annottext">interpretSTS :: forall a.
HasCallStack =&gt;
BaseEnv (MOCKCHAIN era) -&gt; BaseM (MOCKCHAIN era) a -&gt; a
</span><a href="#local-6989586621682750274"><span class="hs-identifier hs-var hs-var hs-var hs-var">interpretSTS</span></a></span></span><span> </span><span id="local-6989586621682750276"><span class="annot"><span class="annottext">BaseEnv (MOCKCHAIN era)
</span><a href="#local-6989586621682750276"><span class="hs-identifier hs-var">globals</span></a></span></span><span> </span><span id="local-6989586621682750277"><span class="annot"><span class="annottext">BaseM (MOCKCHAIN era) a
</span><a href="#local-6989586621682750277"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity a -&gt; a
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity a -&gt; a) -&gt; Identity a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ReaderT Globals Identity a -&gt; Globals -&gt; Identity a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">ReaderT Globals Identity a
BaseM (MOCKCHAIN era) a
</span><a href="#local-6989586621682750277"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">Globals
BaseEnv (MOCKCHAIN era)
</span><a href="#local-6989586621682750276"><span class="hs-identifier hs-var">globals</span></a></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span>  </span><span id="local-6989586621682750282"><span class="annot"><span class="annottext">envGen :: HasCallStack =&gt; Gen1 era -&gt; Gen (Environment (MOCKCHAIN era))
</span><a href="#local-6989586621682750282"><span class="hs-identifier hs-var hs-var hs-var hs-var">envGen</span></a></span></span><span> </span><span id="local-6989586621682750284"><span class="annot"><span class="annottext">Gen1 era
</span><a href="#local-6989586621682750284"><span class="hs-identifier hs-var">_gstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Gen ()
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span>  </span><span id="local-6989586621682750314"><span class="annot"><span class="annottext">sigGen :: HasCallStack =&gt;
Gen1 era
-&gt; Environment (MOCKCHAIN era)
-&gt; State (MOCKCHAIN era)
-&gt; Gen (Signal (MOCKCHAIN era))
</span><a href="#local-6989586621682750314"><span class="hs-identifier hs-var hs-var hs-var hs-var">sigGen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-type">Gen1</span></a></span><span> </span><span id="local-6989586621682750316"><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621682750316"><span class="hs-identifier hs-var">txss</span></a></span></span><span> </span><span id="local-6989586621682750317"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750317"><span class="hs-identifier hs-var">gs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682750318"><span class="annot"><span class="annottext">mcs :: State (MOCKCHAIN era)
</span><a href="#local-6989586621682750318"><span class="hs-identifier hs-var">mcs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainState"><span class="hs-identifier hs-type">MockChainState</span></a></span><span> </span><span id="local-6989586621682750319"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621682750319"><span class="hs-identifier hs-var">newepoch</span></a></span></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#SlotNo"><span class="hs-identifier hs-type">SlotNo</span></a></span><span> </span><span id="local-6989586621682750320"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682750320"><span class="hs-identifier hs-var">lastSlot</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682750321"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750321"><span class="hs-identifier hs-var">count</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span id="local-6989586621682750322"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621682750322"><span class="hs-identifier hs-var">epochnum</span></a></span></span><span> </span><span class="annot"><span class="annottext">BlocksMade
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BlocksMade
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682750323"><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621682750323"><span class="hs-identifier hs-var">epochstate</span></a></span></span><span> </span><span class="annot"><span class="annottext">StrictMaybe PulsingRewUpdate
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682750324"><span class="annot"><span class="annottext">PoolDistr
</span><a href="#local-6989586621682750324"><span class="hs-identifier hs-var">pooldistr</span></a></span></span><span> </span><span class="annot"><span class="annottext">StashedAVVMAddresses era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621682750319"><span class="hs-identifier hs-var">newepoch</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span id="local-6989586621682750325"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682750325"><span class="hs-identifier hs-var">issuerkey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; Word64 -&gt; Int -&gt; PoolDistr -&gt; Gen (KeyHash 'StakePool)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#chooseIssuer"><span class="hs-identifier hs-var">chooseIssuer</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621682750322"><span class="hs-identifier hs-var">epochnum</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682750320"><span class="hs-identifier hs-var">lastSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750321"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">PoolDistr
</span><a href="#local-6989586621682750324"><span class="hs-identifier hs-var">pooldistr</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682750327"><span class="annot"><span class="annottext">StrictSeq (Tx era)
</span><a href="#local-6989586621682750327"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682750328"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682750328"><span class="hs-identifier hs-var">nextSlotNo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621682750316"><span class="hs-identifier hs-var">txss</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
-&gt; Int -&gt; (StrictSeq (Tx era), SlotNo)
forall a. Vector a -&gt; Int -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/vector-0.13.2.0-15435dd5a5c5a17cbf505ae33b795526bd282aac3fd70b1e0e6fd56344cf8f72/share/doc/html/src/Data.Vector.html#%21"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750321"><span class="hs-identifier hs-var">count</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-comment">-- Assmble it into a MockBlock</span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682750329"><span class="annot"><span class="annottext">mockblock :: MockBlock era
</span><a href="#local-6989586621682750329"><span class="hs-identifier hs-var hs-var">mockblock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; SlotNo -&gt; StrictSeq (Tx era) -&gt; MockBlock era
forall era.
KeyHash 'StakePool -&gt; SlotNo -&gt; StrictSeq (Tx era) -&gt; MockBlock era
</span><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockBlock"><span class="hs-identifier hs-var">MockBlock</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621682750325"><span class="hs-identifier hs-var">issuerkey</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682750328"><span class="hs-identifier hs-var">nextSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">StrictSeq (Tx era)
</span><a href="#local-6989586621682750327"><span class="hs-identifier hs-var">txs</span></a></span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-comment">-- Run the STS Rules for MOCKCHAIN with generated signal</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ShelleyBase
  (Either (NonEmpty (MockChainFailure era)) (State (MOCKCHAIN era)))
-&gt; Either (NonEmpty (MockChainFailure era)) (State (MOCKCHAIN era))
forall a. ShelleyBase a -&gt; a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-test-1.7.0.0/doc/html/cardano-ledger-shelley-test/src/Test.Cardano.Ledger.Shelley.Utils.html#runShelleyBase"><span class="hs-identifier hs-var">runShelleyBase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleContext 'Transition (MOCKCHAIN era)
-&gt; ReaderT
     Globals
     Identity
     (Either
        (NonEmpty (PredicateFailure (MOCKCHAIN era)))
        (State (MOCKCHAIN era)))
forall s (m :: * -&gt; *) (rtype :: RuleType).
(STS s, RuleTypeRep rtype, m ~ BaseM s) =&gt;
RuleContext rtype s
-&gt; m (Either (NonEmpty (PredicateFailure s)) (State s))
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#applySTSTest"><span class="hs-identifier hs-var">applySTSTest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall sts. (Environment sts, State sts, Signal sts) -&gt; TRC sts
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#TRC"><span class="hs-identifier hs-var">TRC</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747252"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State (MOCKCHAIN era)
</span><a href="#local-6989586621682750318"><span class="hs-identifier hs-var">mcs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Signal (MOCKCHAIN era)
MockBlock era
</span><a href="#local-6989586621682750329"><span class="hs-identifier hs-var">mockblock</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-315"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621682750332"><span class="annot"><span class="annottext">NonEmpty (MockChainFailure era)
</span><a href="#local-6989586621682750332"><span class="hs-identifier hs-var">pdfs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-316"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682750333"><span class="annot"><span class="annottext">txsl :: [Tx era]
</span><a href="#local-6989586621682750333"><span class="hs-identifier hs-var hs-var">txsl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictSeq (Tx era) -&gt; [Tx era]
forall a. StrictSeq a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">Fold.toList</span></span><span> </span><span class="annot"><span class="annottext">StrictSeq (Tx era)
</span><a href="#local-6989586621682750327"><span class="hs-identifier hs-var">txs</span></a></span><span>
</span><span id="line-317"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; Gen (MockBlock era) -&gt; Gen (MockBlock era)
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">Debug.trace</span></span><span>
</span><span id="line-318"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
-&gt; SlotNo
-&gt; EpochState era
-&gt; NonEmpty (MockChainFailure era)
-&gt; [Tx era]
-&gt; GenState era
-&gt; String
forall era.
Reflect era =&gt;
Word64
-&gt; SlotNo
-&gt; EpochState era
-&gt; NonEmpty (MockChainFailure era)
-&gt; [Tx era]
-&gt; GenState era
-&gt; String
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#raiseMockError"><span class="hs-identifier hs-var">raiseMockError</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682750320"><span class="hs-identifier hs-var">lastSlot</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621682750328"><span class="hs-identifier hs-var">nextSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621682750323"><span class="hs-identifier hs-var">epochstate</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (MockChainFailure era)
</span><a href="#local-6989586621682750332"><span class="hs-identifier hs-var">pdfs</span></a></span><span> </span><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621682750333"><span class="hs-identifier hs-var">txsl</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750317"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">String -&gt; Gen (MockBlock era)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Gen (MockBlock era))
-&gt; ([String] -&gt; String) -&gt; [String] -&gt; Gen (MockBlock era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; Gen (MockBlock era))
-&gt; [String] -&gt; Gen (MockBlock era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-320"></span><span>                  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EpochState:&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-321"></span><span>                    </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">EpochState era -&gt; String
forall a. ToExpr a =&gt; a -&gt; String
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/l/testlib/doc/html/cardano-ledger-binary/src/Test.Cardano.Ledger.Binary.TreeDiff.html#showExpr"><span class="hs-identifier hs-var">showExpr</span></a></span><span> </span><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621682750323"><span class="hs-identifier hs-var">epochstate</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-322"></span><span>                    </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Tx:&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-323"></span><span>                    </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StrictSeq String -&gt; [String]
forall a. StrictSeq a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tx era -&gt; String
forall a. ToExpr a =&gt; a -&gt; String
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/l/testlib/doc/html/cardano-ledger-binary/src/Test.Cardano.Ledger.Binary.TreeDiff.html#showExpr"><span class="hs-identifier hs-var">showExpr</span></a></span><span> </span><span class="annot"><span class="annottext">(Tx era -&gt; String) -&gt; StrictSeq (Tx era) -&gt; StrictSeq String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StrictSeq (Tx era)
</span><a href="#local-6989586621682750327"><span class="hs-identifier hs-var">txs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>                    </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sigGen in (HasTrace (MOCKCHAIN era) (Gen1 era)) FAILS&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-325"></span><span>                    </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(MockChainFailure era -&gt; String)
-&gt; [MockChainFailure era] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">MockChainFailure era -&gt; String
forall a. ToExpr a =&gt; a -&gt; String
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-binary-1.7.0.1/l/testlib/doc/html/cardano-ledger-binary/src/Test.Cardano.Ledger.Binary.TreeDiff.html#showExpr"><span class="hs-identifier hs-var">showExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty (MockChainFailure era) -&gt; [MockChainFailure era]
forall a. NonEmpty a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">Fold.toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (MockChainFailure era)
</span><a href="#local-6989586621682750332"><span class="hs-identifier hs-var">pdfs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621682750336"><span class="annot"><span class="annottext">State (MOCKCHAIN era)
</span><a href="#local-6989586621682750336"><span class="hs-identifier hs-var">mcs2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State (MOCKCHAIN era) -&gt; Gen (MockBlock era) -&gt; Gen (MockBlock era)
forall a b. a -&gt; b -&gt; b
</span><span class="hs-identifier hs-var">seq</span></span><span> </span><span class="annot"><span class="annottext">State (MOCKCHAIN era)
</span><a href="#local-6989586621682750336"><span class="hs-identifier hs-var">mcs2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockBlock era -&gt; Gen (MockBlock era)
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">MockBlock era
</span><a href="#local-6989586621682750329"><span class="hs-identifier hs-var">mockblock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span>  </span><span id="local-6989586621682750338"><span class="annot"><span class="annottext">shrinkSignal :: HasCallStack =&gt; Signal (MOCKCHAIN era) -&gt; [Signal (MOCKCHAIN era)]
</span><a href="#local-6989586621682750338"><span class="hs-identifier hs-var hs-var hs-var hs-var">shrinkSignal</span></a></span></span><span> </span><span class="annot"><span class="annottext">Signal (MOCKCHAIN era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="hs-comment">-- TODO, perhaps we might add shrinking like this. Just a thought. Failure is usually caused by just one Tx</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- in the Block. If the first or last Tx, is independent of the failing Tx, we can probably throw them away.</span><span>
</span><span id="line-333"></span><span class="hs-comment">--  shrinkSignal (MockBlock _ _ xs) | SS.null xs = []</span><span>
</span><span id="line-334"></span><span class="hs-comment">--  shrinkSignal (MockBlock i s xs) = [MockBlock i s (SS.drop 1 xs), MockBlock i s (SS.take (SS.length xs - 1) xs)]</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span id="local-6989586621682747459"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#mapProportion"><span class="hs-identifier hs-type">mapProportion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-type">EpochNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621682747459"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747459"><span class="hs-identifier hs-type">k</span></a></span></span><span>
</span><span id="line-337"></span><span id="mapProportion"><span class="annot"><span class="annottext">mapProportion :: forall k. EpochNo -&gt; Word64 -&gt; Int -&gt; Map k Int -&gt; Gen k
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#mapProportion"><span class="hs-identifier hs-var hs-var">mapProportion</span></a></span></span><span> </span><span id="local-6989586621682750359"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621682750359"><span class="hs-identifier hs-var">epochnum</span></a></span></span><span> </span><span id="local-6989586621682750360"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682750360"><span class="hs-identifier hs-var">lastSlot</span></a></span></span><span> </span><span id="local-6989586621682750361"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750361"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span id="local-6989586621682750362"><span class="annot"><span class="annottext">Map k Int
</span><a href="#local-6989586621682750362"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Int, Gen k)]
</span><a href="#local-6989586621682750363"><span class="hs-identifier hs-var">pairs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-340"></span><span>      </span><span class="hs-comment">-- TODO, we need to figure out why this occurs. It always occurs near SlotNo 300, So I am assuming that</span><span>
</span><span id="line-341"></span><span>      </span><span class="hs-comment">-- sometimes as we move into the 3rd epoch, however stakeDistr is computed becomes empty. This is probably</span><span>
</span><span id="line-342"></span><span>      </span><span class="hs-comment">-- because there is no action in Test.Cardano.Ledger.Constrained.Trace.Actions for the epoch boundary.</span><span>
</span><span id="line-343"></span><span>      </span><span class="hs-comment">-- This temporary fix is good enough for now. But the annoying trace message reminds us to fix this.</span><span>
</span><span id="line-344"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Gen k -&gt; Gen k
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">Debug.trace</span></span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;There are no stakepools to choose an issuer from&quot;</span></span><span>
</span><span id="line-346"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, epoch=&quot;</span></span><span>
</span><span id="line-347"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621682750359"><span class="hs-identifier hs-var">epochnum</span></a></span><span>
</span><span id="line-348"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, last slot=&quot;</span></span><span>
</span><span id="line-349"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682750360"><span class="hs-identifier hs-var">lastSlot</span></a></span><span>
</span><span id="line-350"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, index of Tx=&quot;</span></span><span>
</span><span id="line-351"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750361"><span class="hs-identifier hs-var">count</span></a></span><span>
</span><span id="line-352"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>        </span><span class="annot"><span class="annottext">Gen k
forall a. a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Exception.html#discard"><span class="hs-identifier hs-var">discard</span></a></span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682750365"><span class="annot"><span class="annottext">(Int, Gen k)
</span><a href="#local-6989586621682750365"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[(Int, Gen k)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">((Int, Gen k) -&gt; Bool) -&gt; [(Int, Gen k)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621682750367"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750367"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682750368"><span class="annot"><span class="annottext">Gen k
</span><a href="#local-6989586621682750368"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750367"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, Gen k)]
</span><a href="#local-6989586621682750363"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-356"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(Int, Gen k) -&gt; Gen k
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Int, Gen k)
</span><a href="#local-6989586621682750365"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-comment">-- All stakepools have zero Stake, choose issuer arbitrarily. possible, but rare.</span><span>
</span><span id="line-357"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[(Int, Gen k)] -&gt; Gen k
forall a. HasCallStack =&gt; [(Int, Gen a)] -&gt; Gen a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#frequency"><span class="hs-identifier hs-var">frequency</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Gen k)]
</span><a href="#local-6989586621682750363"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-359"></span><span>    </span><span id="local-6989586621682750363"><span class="annot"><span class="annottext">pairs :: [(Int, Gen k)]
</span><a href="#local-6989586621682750363"><span class="hs-identifier hs-var hs-var">pairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750371"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">k -&gt; Gen k
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621682750372"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682750372"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621682750372"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682750371"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750371"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map k Int -&gt; [(k, Int)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map k Int
</span><a href="#local-6989586621682750362"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#chooseIssuer"><span class="hs-identifier hs-type">chooseIssuer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-type">EpochNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#PoolDistr"><span class="hs-identifier hs-type">PoolDistr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#KeyHash"><span class="hs-identifier hs-type">KeyHash</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.Internal.html#StakePool"><span class="hs-identifier hs-type">StakePool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span id="chooseIssuer"><span class="annot"><span class="annottext">chooseIssuer :: EpochNo -&gt; Word64 -&gt; Int -&gt; PoolDistr -&gt; Gen (KeyHash 'StakePool)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#chooseIssuer"><span class="hs-identifier hs-var hs-var">chooseIssuer</span></a></span></span><span> </span><span id="local-6989586621682750374"><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621682750374"><span class="hs-identifier hs-var">epochnum</span></a></span></span><span> </span><span id="local-6989586621682750375"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682750375"><span class="hs-identifier hs-var">lastSlot</span></a></span></span><span> </span><span id="local-6989586621682750376"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750376"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#PoolDistr"><span class="hs-identifier hs-type">PoolDistr</span></a></span><span> </span><span id="local-6989586621682750377"><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) IndividualPoolStake
</span><a href="#local-6989586621682750377"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochNo
-&gt; Word64
-&gt; Int
-&gt; Map (KeyHash 'StakePool) Int
-&gt; Gen (KeyHash 'StakePool)
forall k. EpochNo -&gt; Word64 -&gt; Int -&gt; Map k Int -&gt; Gen k
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#mapProportion"><span class="hs-identifier hs-var">mapProportion</span></a></span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621682750374"><span class="hs-identifier hs-var">epochnum</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682750375"><span class="hs-identifier hs-var">lastSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750376"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IndividualPoolStake -&gt; Int
forall {b}. Integral b =&gt; IndividualPoolStake -&gt; b
</span><a href="#local-6989586621682750378"><span class="hs-identifier hs-var">getInt</span></a></span><span> </span><span class="annot"><span class="annottext">(IndividualPoolStake -&gt; Int)
-&gt; Map (KeyHash 'StakePool) IndividualPoolStake
-&gt; Map (KeyHash 'StakePool) Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) IndividualPoolStake
</span><a href="#local-6989586621682750377"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-364"></span><span>    </span><span id="local-6989586621682750378"><span class="annot"><span class="annottext">getInt :: IndividualPoolStake -&gt; b
</span><a href="#local-6989586621682750378"><span class="hs-identifier hs-var hs-var">getInt</span></a></span></span><span> </span><span id="local-6989586621682750402"><span class="annot"><span class="annottext">IndividualPoolStake
</span><a href="#local-6989586621682750402"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; b
forall b. Integral b =&gt; Rational -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IndividualPoolStake -&gt; Rational
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#individualPoolStake"><span class="hs-identifier hs-var">individualPoolStake</span></a></span><span> </span><span class="annot"><span class="annottext">IndividualPoolStake
</span><a href="#local-6989586621682750402"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1000</span></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">-- ===================================================================================</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-comment">-- Generating Traces, and making properties out of a Trace</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- =========================================================================</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#genTrace"><span class="hs-identifier hs-type">genTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682747479"><span class="annot"><a href="#local-6989586621682747479"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.Generator.QuickCheck.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747479"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-type">Gen1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747479"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747479"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.State.Account.html#ShelleyEraAccounts"><span class="hs-identifier hs-type">ShelleyEraAccounts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747479"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-377"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-378"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-379"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenRS"><span class="hs-identifier hs-type">GenRS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747479"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- An arbitrary 'initialization action', to run before we generate the sequence</span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-comment">-- use (pure ()) if you don't want or need initialization</span><span>
</span><span id="line-381"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747479"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span id="genTrace"><span class="annot"><span class="annottext">genTrace :: forall era.
(HasTrace (MOCKCHAIN era) (Gen1 era), EraGenericGen era,
 ShelleyEraAccounts era) =&gt;
Int -&gt; GenSize -&gt; GenRS era () -&gt; Gen (Trace (MOCKCHAIN era))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTrace"><span class="hs-identifier hs-var hs-var">genTrace</span></a></span></span><span> </span><span id="local-6989586621682750427"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750427"><span class="hs-identifier hs-var">numTxInTrace</span></a></span></span><span> </span><span id="local-6989586621682750428"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682750428"><span class="hs-identifier hs-var">gsize</span></a></span></span><span> </span><span id="local-6989586621682750429"><span class="annot"><span class="annottext">GenRS era ()
</span><a href="#local-6989586621682750429"><span class="hs-identifier hs-var">initialize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-383"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682750430"><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621682750430"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682750431"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750431"><span class="hs-identifier hs-var">genstate</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenSize
-&gt; Int
-&gt; GenRS era ()
-&gt; Gen (Vector (StrictSeq (Tx era), SlotNo), GenState era)
forall era.
EraGenericGen era =&gt;
GenSize
-&gt; Int
-&gt; GenRS era ()
-&gt; Gen (Vector (StrictSeq (Tx era), SlotNo), GenState era)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTxSeq"><span class="hs-identifier hs-var">genTxSeq</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682750428"><span class="hs-identifier hs-var">gsize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750427"><span class="hs-identifier hs-var">numTxInTrace</span></a></span><span> </span><span class="annot"><span class="annottext">GenRS era ()
</span><a href="#local-6989586621682750429"><span class="hs-identifier hs-var">initialize</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682750432"><span class="annot"><span class="annottext">initState :: MockChainState era
</span><a href="#local-6989586621682750432"><span class="hs-identifier hs-var hs-var">initState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; MockChainState era
forall era.
(Reflect era, ShelleyEraAccounts era) =&gt;
GenState era -&gt; MockChainState era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#initialMockChainState"><span class="hs-identifier hs-var">initialMockChainState</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750431"><span class="hs-identifier hs-var">genstate</span></a></span><span>
</span><span id="line-385"></span><span>  </span><span class="annot"><span class="annottext">forall sts traceGenEnv.
(HasTrace sts traceGenEnv, Show (Environment sts), HasCallStack) =&gt;
BaseEnv sts
-&gt; Word64
-&gt; traceGenEnv
-&gt; Maybe
     (IRC sts
      -&gt; Gen (Either (NonEmpty (PredicateFailure sts)) (State sts)))
-&gt; Gen (Trace sts)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.Generator.QuickCheck.html#traceFromInitState"><span class="hs-identifier hs-var">traceFromInitState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747479"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>    </span><span class="annot"><span class="annottext">Globals
BaseEnv (MOCKCHAIN era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Core.Utils.html#testGlobals"><span class="hs-identifier hs-var">testGlobals</span></a></span><span>
</span><span id="line-387"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo) -&gt; Int
forall a. Vector a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621682750430"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo) -&gt; GenState era -&gt; Gen1 era
forall era.
Vector (StrictSeq (Tx era), SlotNo) -&gt; GenState era -&gt; Gen1 era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621682750430"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750431"><span class="hs-identifier hs-var">genstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(IRC (MOCKCHAIN era)
 -&gt; Gen
      (Either (NonEmpty (MockChainFailure era)) (MockChainState era)))
-&gt; Maybe
     (IRC (MOCKCHAIN era)
      -&gt; Gen
           (Either (NonEmpty (MockChainFailure era)) (MockChainState era)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">IRC (MOCKCHAIN era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (NonEmpty (MockChainFailure era)) (MockChainState era)
-&gt; Gen
     (Either (NonEmpty (MockChainFailure era)) (MockChainState era))
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either (NonEmpty (MockChainFailure era)) (MockChainState era)
 -&gt; Gen
      (Either (NonEmpty (MockChainFailure era)) (MockChainState era)))
-&gt; Either (NonEmpty (MockChainFailure era)) (MockChainState era)
-&gt; Gen
     (Either (NonEmpty (MockChainFailure era)) (MockChainState era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MockChainState era
-&gt; Either (NonEmpty (MockChainFailure era)) (MockChainState era)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621682750432"><span class="hs-identifier hs-var">initState</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#traceProp"><span class="hs-identifier hs-type">traceProp</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682747489"><span class="annot"><a href="#local-6989586621682747489"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621682747490"><span class="annot"><a href="#local-6989586621682747490"><span class="hs-identifier hs-type">prop</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.Generator.QuickCheck.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747489"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-type">Gen1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747489"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747489"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.State.Account.html#ShelleyEraAccounts"><span class="hs-identifier hs-type">ShelleyEraAccounts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747489"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-397"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-398"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainState"><span class="hs-identifier hs-type">MockChainState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747489"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MockChainState"><span class="hs-identifier hs-type">MockChainState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747489"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682747490"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-400"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747490"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-401"></span><span id="traceProp"><span class="annot"><span class="annottext">traceProp :: forall era prop.
(HasTrace (MOCKCHAIN era) (Gen1 era), EraGenericGen era,
 ShelleyEraAccounts era) =&gt;
Int
-&gt; GenSize
-&gt; (MockChainState era -&gt; MockChainState era -&gt; prop)
-&gt; Gen prop
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#traceProp"><span class="hs-identifier hs-var hs-var">traceProp</span></a></span></span><span> </span><span id="local-6989586621682750445"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750445"><span class="hs-identifier hs-var">numTxInTrace</span></a></span></span><span> </span><span id="local-6989586621682750446"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682750446"><span class="hs-identifier hs-var">gsize</span></a></span></span><span> </span><span id="local-6989586621682750447"><span class="annot"><span class="annottext">MockChainState era -&gt; MockChainState era -&gt; prop
</span><a href="#local-6989586621682750447"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-402"></span><span>  </span><span id="local-6989586621682750448"><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621682750448"><span class="hs-identifier hs-var">trace1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; GenSize -&gt; GenRS era () -&gt; Gen (Trace (MOCKCHAIN era))
forall era.
(HasTrace (MOCKCHAIN era) (Gen1 era), EraGenericGen era,
 ShelleyEraAccounts era) =&gt;
Int -&gt; GenSize -&gt; GenRS era () -&gt; Gen (Trace (MOCKCHAIN era))
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTrace"><span class="hs-identifier hs-var">genTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750445"><span class="hs-identifier hs-var">numTxInTrace</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682750446"><span class="hs-identifier hs-var">gsize</span></a></span><span> </span><span class="annot"><span class="annottext">GenRS era ()
forall era. Reflect era =&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier hs-var">initStableFields</span></a></span><span>
</span><span id="line-403"></span><span>  </span><span class="annot"><span class="annottext">prop -&gt; Gen prop
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockChainState era -&gt; MockChainState era -&gt; prop
</span><a href="#local-6989586621682750447"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era) -&gt; State (MOCKCHAIN era)
forall s. Trace s -&gt; State s
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#_traceInitState"><span class="hs-identifier hs-var">_traceInitState</span></a></span><span> </span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621682750448"><span class="hs-identifier hs-var">trace1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era) -&gt; State (MOCKCHAIN era)
forall s. Trace s -&gt; State s
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#lastState"><span class="hs-identifier hs-var">lastState</span></a></span><span> </span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621682750448"><span class="hs-identifier hs-var">trace1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#forEachEpochTrace"><span class="hs-identifier hs-type">forEachEpochTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682747497"><span class="annot"><a href="#local-6989586621682747497"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621682747495"><span class="annot"><a href="#local-6989586621682747495"><span class="hs-identifier hs-type">prop</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747495"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.Generator.QuickCheck.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747497"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-type">Gen1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747497"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747497"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.State.Account.html#ShelleyEraAccounts"><span class="hs-identifier hs-type">ShelleyEraAccounts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747497"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-412"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-413"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747497"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682747495"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-415"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-416"></span><span id="forEachEpochTrace"><span class="annot"><span class="annottext">forEachEpochTrace :: forall era prop.
(Testable prop, HasTrace (MOCKCHAIN era) (Gen1 era),
 EraGenericGen era, ShelleyEraAccounts era) =&gt;
Int -&gt; GenSize -&gt; (Trace (MOCKCHAIN era) -&gt; prop) -&gt; Gen Property
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#forEachEpochTrace"><span class="hs-identifier hs-var hs-var">forEachEpochTrace</span></a></span></span><span> </span><span id="local-6989586621682750485"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750485"><span class="hs-identifier hs-var">tracelen</span></a></span></span><span> </span><span id="local-6989586621682750486"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682750486"><span class="hs-identifier hs-var">genSize</span></a></span></span><span> </span><span id="local-6989586621682750487"><span class="annot"><span class="annottext">Trace (MOCKCHAIN era) -&gt; prop
</span><a href="#local-6989586621682750487"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-417"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682750490"><span class="annot"><span class="annottext">newEpoch :: MockChainState era -&gt; MockChainState era -&gt; Bool
</span><a href="#local-6989586621682750490"><span class="hs-identifier hs-var hs-var">newEpoch</span></a></span></span><span> </span><span id="local-6989586621682750491"><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621682750491"><span class="hs-identifier hs-var">tr1</span></a></span></span><span> </span><span id="local-6989586621682750492"><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621682750492"><span class="hs-identifier hs-var">tr2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era -&gt; EpochNo
forall era. NewEpochState era -&gt; EpochNo
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEL"><span class="hs-identifier hs-var">nesEL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockChainState era -&gt; NewEpochState era
forall era. MockChainState era -&gt; NewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.MockChain.html#mcsNes"><span class="hs-identifier hs-var">mcsNes</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621682750491"><span class="hs-identifier hs-var">tr1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EpochNo -&gt; EpochNo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">NewEpochState era -&gt; EpochNo
forall era. NewEpochState era -&gt; EpochNo
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEL"><span class="hs-identifier hs-var">nesEL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockChainState era -&gt; NewEpochState era
forall era. MockChainState era -&gt; NewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.MockChain.html#mcsNes"><span class="hs-identifier hs-var">mcsNes</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621682750492"><span class="hs-identifier hs-var">tr2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>  </span><span id="local-6989586621682750495"><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621682750495"><span class="hs-identifier hs-var">trc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-419"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682750496"><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621682750496"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682750497"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750497"><span class="hs-identifier hs-var">genstate</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenSize
-&gt; Int
-&gt; GenRS era ()
-&gt; Gen (Vector (StrictSeq (Tx era), SlotNo), GenState era)
forall era.
EraGenericGen era =&gt;
GenSize
-&gt; Int
-&gt; GenRS era ()
-&gt; Gen (Vector (StrictSeq (Tx era), SlotNo), GenState era)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTxSeq"><span class="hs-identifier hs-var">genTxSeq</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682750486"><span class="hs-identifier hs-var">genSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750485"><span class="hs-identifier hs-var">tracelen</span></a></span><span> </span><span class="annot"><span class="annottext">GenRS era ()
forall era. Reflect era =&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier hs-var">initStableFields</span></a></span><span>
</span><span id="line-420"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682750498"><span class="annot"><span class="annottext">initState :: MockChainState era
</span><a href="#local-6989586621682750498"><span class="hs-identifier hs-var hs-var">initState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; MockChainState era
forall era.
(Reflect era, ShelleyEraAccounts era) =&gt;
GenState era -&gt; MockChainState era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#initialMockChainState"><span class="hs-identifier hs-var">initialMockChainState</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750497"><span class="hs-identifier hs-var">genstate</span></a></span><span>
</span><span id="line-421"></span><span>    </span><span class="annot"><span class="annottext">forall sts traceGenEnv.
(HasTrace sts traceGenEnv, Show (Environment sts), HasCallStack) =&gt;
BaseEnv sts
-&gt; Word64
-&gt; traceGenEnv
-&gt; Maybe
     (IRC sts
      -&gt; Gen (Either (NonEmpty (PredicateFailure sts)) (State sts)))
-&gt; Gen (Trace sts)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.Generator.QuickCheck.html#traceFromInitState"><span class="hs-identifier hs-var">traceFromInitState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747497"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>      </span><span class="annot"><span class="annottext">Globals
BaseEnv (MOCKCHAIN era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Core.Utils.html#testGlobals"><span class="hs-identifier hs-var">testGlobals</span></a></span><span>
</span><span id="line-423"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo) -&gt; Int
forall a. Vector a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621682750496"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo) -&gt; GenState era -&gt; Gen1 era
forall era.
Vector (StrictSeq (Tx era), SlotNo) -&gt; GenState era -&gt; Gen1 era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621682750496"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750497"><span class="hs-identifier hs-var">genstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(IRC (MOCKCHAIN era)
 -&gt; Gen
      (Either (NonEmpty (MockChainFailure era)) (MockChainState era)))
-&gt; Maybe
     (IRC (MOCKCHAIN era)
      -&gt; Gen
           (Either (NonEmpty (MockChainFailure era)) (MockChainState era)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">IRC (MOCKCHAIN era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (NonEmpty (MockChainFailure era)) (MockChainState era)
-&gt; Gen
     (Either (NonEmpty (MockChainFailure era)) (MockChainState era))
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either (NonEmpty (MockChainFailure era)) (MockChainState era)
 -&gt; Gen
      (Either (NonEmpty (MockChainFailure era)) (MockChainState era)))
-&gt; Either (NonEmpty (MockChainFailure era)) (MockChainState era)
-&gt; Gen
     (Either (NonEmpty (MockChainFailure era)) (MockChainState era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MockChainState era
-&gt; Either (NonEmpty (MockChainFailure era)) (MockChainState era)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621682750498"><span class="hs-identifier hs-var">initState</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682750499"><span class="annot"><span class="annottext">propf :: (Trace (MOCKCHAIN era), Int) -&gt; Property
</span><a href="#local-6989586621682750499"><span class="hs-identifier hs-var hs-var">propf</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682750500"><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621682750500"><span class="hs-identifier hs-var">subtrace</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682750501"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750501"><span class="hs-identifier hs-var">index</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#counterexample"><span class="hs-identifier hs-var">counterexample</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Subtrace of EpochNo &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750501"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; fails.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era) -&gt; prop
</span><a href="#local-6989586621682750487"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621682750500"><span class="hs-identifier hs-var">subtrace</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-comment">-- The very last sub-trace may not be a full epoch, so we throw it away.</span><span>
</span><span id="line-428"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Trace (MOCKCHAIN era)] -&gt; [Trace (MOCKCHAIN era)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(State (MOCKCHAIN era) -&gt; State (MOCKCHAIN era) -&gt; Bool)
-&gt; Trace (MOCKCHAIN era) -&gt; [Trace (MOCKCHAIN era)]
forall s. (State s -&gt; State s -&gt; Bool) -&gt; Trace s -&gt; [Trace s]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#splitTrace"><span class="hs-identifier hs-var">splitTrace</span></a></span><span> </span><span class="annot"><span class="annottext">State (MOCKCHAIN era) -&gt; State (MOCKCHAIN era) -&gt; Bool
MockChainState era -&gt; MockChainState era -&gt; Bool
forall {era} {era}.
MockChainState era -&gt; MockChainState era -&gt; Bool
</span><a href="#local-6989586621682750490"><span class="hs-identifier hs-var">newEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621682750495"><span class="hs-identifier hs-var">trc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-429"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Property -&gt; Gen Property
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>    </span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682750504"><span class="annot"><span class="annottext">[Trace (MOCKCHAIN era)]
</span><a href="#local-6989586621682750504"><span class="hs-identifier hs-var">revSplits</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Property -&gt; Gen Property
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Property] -&gt; Property
forall prop. Testable prop =&gt; [prop] -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#conjoin"><span class="hs-identifier hs-var">conjoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Trace (MOCKCHAIN era), Int) -&gt; Property
</span><a href="#local-6989586621682750499"><span class="hs-identifier hs-var">propf</span></a></span><span> </span><span class="annot"><span class="annottext">((Trace (MOCKCHAIN era), Int) -&gt; Property)
-&gt; [(Trace (MOCKCHAIN era), Int)] -&gt; [Property]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Trace (MOCKCHAIN era)] -&gt; [Int] -&gt; [(Trace (MOCKCHAIN era), Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Trace (MOCKCHAIN era)] -&gt; [Trace (MOCKCHAIN era)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Trace (MOCKCHAIN era)]
</span><a href="#local-6989586621682750504"><span class="hs-identifier hs-var">revSplits</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="hs-comment">-- | Check a property on the 'sts' traces.</span><span>
</span><span id="line-433"></span><span class="hs-comment">--</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- Takes an optional generator for initial state of the STS.</span><span>
</span><span id="line-435"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#forAllTraceFromInitState"><span class="hs-identifier hs-type">forAllTraceFromInitState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682747511"><span class="annot"><a href="#local-6989586621682747511"><span class="hs-identifier hs-type">sts</span></a></span></span><span> </span><span id="local-6989586621682747512"><span class="annot"><a href="#local-6989586621682747512"><span class="hs-identifier hs-type">traceGenEnv</span></a></span></span><span> </span><span id="local-6989586621682747513"><span class="annot"><a href="#local-6989586621682747513"><span class="hs-identifier hs-type">prop</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.Generator.QuickCheck.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747511"><span class="hs-identifier hs-type">sts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747512"><span class="hs-identifier hs-type">traceGenEnv</span></a></span><span>
</span><span id="line-438"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747513"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-439"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#Environment"><span class="hs-identifier hs-type">Environment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747511"><span class="hs-identifier hs-type">sts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-441"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.Generator.QuickCheck.html#BaseEnv"><span class="hs-identifier hs-type">BaseEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747511"><span class="hs-identifier hs-type">sts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-442"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Maximum trace length.</span></span><span>
</span><span id="line-443"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-444"></span><span>  </span><span class="annot"><a href="#local-6989586621682747512"><span class="hs-identifier hs-type">traceGenEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-445"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Optional generator of STS initial state</span></span><span>
</span><span id="line-446"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#IRC"><span class="hs-identifier hs-type">IRC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747511"><span class="hs-identifier hs-type">sts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#PredicateFailure"><span class="hs-identifier hs-type">STS.PredicateFailure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747511"><span class="hs-identifier hs-type">sts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747511"><span class="hs-identifier hs-type">sts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747511"><span class="hs-identifier hs-type">sts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682747513"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-448"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-449"></span><span id="forAllTraceFromInitState"><span class="annot"><span class="annottext">forAllTraceFromInitState :: forall sts traceGenEnv prop.
(HasTrace sts traceGenEnv, Testable prop,
 Show (Environment sts)) =&gt;
BaseEnv sts
-&gt; Word64
-&gt; traceGenEnv
-&gt; Maybe
     (IRC sts
      -&gt; Gen (Either (NonEmpty (PredicateFailure sts)) (State sts)))
-&gt; (Trace sts -&gt; prop)
-&gt; Property
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#forAllTraceFromInitState"><span class="hs-identifier hs-var hs-var">forAllTraceFromInitState</span></a></span></span><span> </span><span id="local-6989586621682750515"><span class="annot"><span class="annottext">BaseEnv sts
</span><a href="#local-6989586621682750515"><span class="hs-identifier hs-var">baseEnv</span></a></span></span><span> </span><span id="local-6989586621682750516"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682750516"><span class="hs-identifier hs-var">maxTraceLength</span></a></span></span><span> </span><span id="local-6989586621682750517"><span class="annot"><span class="annottext">traceGenEnv
</span><a href="#local-6989586621682750517"><span class="hs-identifier hs-var">traceGenEnv</span></a></span></span><span> </span><span id="local-6989586621682750518"><span class="annot"><span class="annottext">Maybe
  (IRC sts
   -&gt; Gen (Either (NonEmpty (PredicateFailure sts)) (State sts)))
</span><a href="#local-6989586621682750518"><span class="hs-identifier hs-var">genSt0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-450"></span><span>  </span><span class="annot"><span class="annottext">Gen (Trace sts)
-&gt; (Trace sts -&gt; [Trace sts]) -&gt; (Trace sts -&gt; prop) -&gt; Property
forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; prop) -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#forAllShrinkBlind"><span class="hs-identifier hs-var">forAllShrinkBlind</span></a></span><span>
</span><span id="line-451"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall sts traceGenEnv.
(HasTrace sts traceGenEnv, Show (Environment sts), HasCallStack) =&gt;
BaseEnv sts
-&gt; Word64
-&gt; traceGenEnv
-&gt; Maybe
     (IRC sts
      -&gt; Gen (Either (NonEmpty (PredicateFailure sts)) (State sts)))
-&gt; Gen (Trace sts)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.Generator.QuickCheck.html#traceFromInitState"><span class="hs-identifier hs-var">traceFromInitState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682747511"><span class="hs-identifier hs-type">sts</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682747512"><span class="hs-identifier hs-type">traceGenEnv</span></a></span><span> </span><span class="annot"><span class="annottext">BaseEnv sts
</span><a href="#local-6989586621682750515"><span class="hs-identifier hs-var">baseEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621682750516"><span class="hs-identifier hs-var">maxTraceLength</span></a></span><span> </span><span class="annot"><span class="annottext">traceGenEnv
</span><a href="#local-6989586621682750517"><span class="hs-identifier hs-var">traceGenEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe
  (IRC sts
   -&gt; Gen (Either (NonEmpty (PredicateFailure sts)) (State sts)))
</span><a href="#local-6989586621682750518"><span class="hs-identifier hs-var">genSt0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Trace sts] -&gt; Trace sts -&gt; [Trace sts]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="hs-comment">-- =========================================================================</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- Test for just making a trace</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="hs-comment">-- | We are making 'smoke' tests, testing for smoke rather than fire.</span><span>
</span><span id="line-458"></span><span class="hs-comment">--   Under the assumption that shorter tests have advantages</span><span>
</span><span id="line-459"></span><span class="hs-comment">--   like not getting turned off because the tests take too long. A glaring failure is</span><span>
</span><span id="line-460"></span><span class="hs-comment">--   likely to be caught in 'n' tests, rather than the standard '100'</span><span>
</span><span id="line-461"></span><span id="local-6989586621682747521"><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#testPropMax"><span class="hs-identifier hs-type">testPropMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747521"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682747521"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tasty-1.5.3-88586983451851d5d35dd67c2a04aba64f40e4837f8fdc734bac69f324c5798f/share/doc/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span></span><span>
</span><span id="line-462"></span><span id="testPropMax"><span class="annot"><span class="annottext">testPropMax :: forall prop. Testable prop =&gt; Int -&gt; String -&gt; prop -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#testPropMax"><span class="hs-identifier hs-var hs-var">testPropMax</span></a></span></span><span> </span><span id="local-6989586621682750525"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750525"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682750526"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682750526"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682750527"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621682750527"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; TestTree
forall a. Testable a =&gt; String -&gt; a -&gt; TestTree
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tasty-quickcheck-0.11.1-a6e9951148459b597606684bef39d5db052b5c7504d645a5ed13f64b535ff547/share/doc/html/src/Test.Tasty.QuickCheck.html#testProperty"><span class="hs-identifier hs-var">testProperty</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682750526"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; prop -&gt; Property
forall prop. Testable prop =&gt; Int -&gt; prop -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#withMaxSuccess"><span class="hs-identifier hs-var">withMaxSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750525"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621682750527"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#chainTest"><span class="hs-identifier hs-type">chainTest</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682747526"><span class="annot"><a href="#local-6989586621682747526"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.Generator.QuickCheck.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747526"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-type">Gen1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747526"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#StashedAVVMAddresses"><span class="hs-identifier hs-type">StashedAVVMAddresses</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747526"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747526"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.State.Account.html#ShelleyEraAccounts"><span class="hs-identifier hs-type">ShelleyEraAccounts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747526"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-470"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-471"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-472"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-473"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tasty-1.5.3-88586983451851d5d35dd67c2a04aba64f40e4837f8fdc734bac69f324c5798f/share/doc/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-474"></span><span id="chainTest"><span class="annot"><span class="annottext">chainTest :: forall era.
(HasTrace (MOCKCHAIN era) (Gen1 era),
 Eq (StashedAVVMAddresses era), EraGenericGen era,
 ShelleyEraAccounts era) =&gt;
Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#chainTest"><span class="hs-identifier hs-var hs-var">chainTest</span></a></span></span><span> </span><span id="local-6989586621682750576"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750576"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682750577"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682750577"><span class="hs-identifier hs-var">gsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; Gen Property -&gt; TestTree
forall prop. Testable prop =&gt; Int -&gt; String -&gt; prop -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#testPropMax"><span class="hs-identifier hs-var">testPropMax</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">30</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Era era =&gt; String
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#eraName"><span class="hs-identifier hs-var">eraName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682747526"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Gen Property
</span><a href="#local-6989586621682750579"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-476"></span><span>    </span><span id="local-6989586621682750579"><span class="annot"><span class="annottext">action :: Gen Property
</span><a href="#local-6989586621682750579"><span class="hs-identifier hs-var hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-477"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682750580"><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621682750580"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682750581"><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750581"><span class="hs-identifier hs-var">genstate</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era.
EraGenericGen era =&gt;
GenSize
-&gt; Int
-&gt; GenRS era ()
-&gt; Gen (Vector (StrictSeq (Tx era), SlotNo), GenState era)
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#genTxSeq"><span class="hs-identifier hs-var">genTxSeq</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682747526"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682750577"><span class="hs-identifier hs-var">gsize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750576"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">GenRS era ()
forall era. Reflect era =&gt; GenRS era ()
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#initStableFields"><span class="hs-identifier hs-var">initStableFields</span></a></span><span>
</span><span id="line-478"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682750582"><span class="annot"><span class="annottext">initState :: MockChainState era
</span><a href="#local-6989586621682750582"><span class="hs-identifier hs-var hs-var">initState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenState era -&gt; MockChainState era
forall era.
(Reflect era, ShelleyEraAccounts era) =&gt;
GenState era -&gt; MockChainState era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#initialMockChainState"><span class="hs-identifier hs-var">initialMockChainState</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750581"><span class="hs-identifier hs-var">genstate</span></a></span><span>
</span><span id="line-479"></span><span>      </span><span id="local-6989586621682750583"><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621682750583"><span class="hs-identifier hs-var">trace1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-480"></span><span>        </span><span class="annot"><span class="annottext">forall sts traceGenEnv.
(HasTrace sts traceGenEnv, Show (Environment sts), HasCallStack) =&gt;
BaseEnv sts
-&gt; Word64
-&gt; traceGenEnv
-&gt; Maybe
     (IRC sts
      -&gt; Gen (Either (NonEmpty (PredicateFailure sts)) (State sts)))
-&gt; Gen (Trace sts)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.Generator.QuickCheck.html#traceFromInitState"><span class="hs-identifier hs-var">traceFromInitState</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747526"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>          </span><span class="annot"><span class="annottext">Globals
BaseEnv (MOCKCHAIN era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/testlib/doc/html/cardano-ledger-core/src/Test.Cardano.Ledger.Core.Utils.html#testGlobals"><span class="hs-identifier hs-var">testGlobals</span></a></span><span>
</span><span id="line-482"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo) -&gt; Int
forall a. Vector a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621682750580"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo) -&gt; GenState era -&gt; Gen1 era
forall era.
Vector (StrictSeq (Tx era), SlotNo) -&gt; GenState era -&gt; Gen1 era
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-var">Gen1</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (StrictSeq (Tx era), SlotNo)
</span><a href="#local-6989586621682750580"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">GenState era
</span><a href="#local-6989586621682750581"><span class="hs-identifier hs-var">genstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(IRC (MOCKCHAIN era)
 -&gt; Gen
      (Either (NonEmpty (MockChainFailure era)) (MockChainState era)))
-&gt; Maybe
     (IRC (MOCKCHAIN era)
      -&gt; Gen
           (Either (NonEmpty (MockChainFailure era)) (MockChainState era)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">IRC (MOCKCHAIN era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (NonEmpty (MockChainFailure era)) (MockChainState era)
-&gt; Gen
     (Either (NonEmpty (MockChainFailure era)) (MockChainState era))
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either (NonEmpty (MockChainFailure era)) (MockChainState era)
 -&gt; Gen
      (Either (NonEmpty (MockChainFailure era)) (MockChainState era)))
-&gt; Either (NonEmpty (MockChainFailure era)) (MockChainState era)
-&gt; Gen
     (Either (NonEmpty (MockChainFailure era)) (MockChainState era))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MockChainState era
-&gt; Either (NonEmpty (MockChainFailure era)) (MockChainState era)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621682750582"><span class="hs-identifier hs-var">initState</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>      </span><span class="hs-comment">-- Here is where we can add some properties for traces:</span><span>
</span><span id="line-486"></span><span>      </span><span class="annot"><span class="annottext">Property -&gt; Gen Property
forall a. a -&gt; Gen a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era) -&gt; State (MOCKCHAIN era)
forall s. Trace s -&gt; State s
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#_traceInitState"><span class="hs-identifier hs-var">_traceInitState</span></a></span><span> </span><span class="annot"><span class="annottext">Trace (MOCKCHAIN era)
</span><a href="#local-6989586621682750583"><span class="hs-identifier hs-var">trace1</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState era -&gt; MockChainState era -&gt; Property
forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621682750582"><span class="hs-identifier hs-var">initState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#testTraces"><span class="hs-identifier hs-type">testTraces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tasty-1.5.3-88586983451851d5d35dd67c2a04aba64f40e4837f8fdc734bac69f324c5798f/share/doc/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-489"></span><span id="testTraces"><span class="annot"><span class="annottext">testTraces :: Int -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#testTraces"><span class="hs-identifier hs-var hs-var">testTraces</span></a></span></span><span> </span><span id="local-6989586621682750586"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750586"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-490"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; [TestTree] -&gt; TestTree
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tasty-1.5.3-88586983451851d5d35dd67c2a04aba64f40e4837f8fdc734bac69f324c5798f/share/doc/html/src/Test.Tasty.Core.html#testGroup"><span class="hs-identifier hs-var">testGroup</span></a></span><span>
</span><span id="line-491"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MockChainTrace&quot;</span></span><span>
</span><span id="line-492"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall era.
(HasTrace (MOCKCHAIN era) (Gen1 era),
 Eq (StashedAVVMAddresses era), EraGenericGen era,
 ShelleyEraAccounts era) =&gt;
Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#chainTest"><span class="hs-identifier hs-var">chainTest</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#BabbageEra"><span class="hs-identifier hs-type">BabbageEra</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750586"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#defaultGenSize"><span class="hs-identifier hs-var">defaultGenSize</span></a></span><span>
</span><span id="line-493"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
(HasTrace (MOCKCHAIN era) (Gen1 era),
 Eq (StashedAVVMAddresses era), EraGenericGen era,
 ShelleyEraAccounts era) =&gt;
Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#chainTest"><span class="hs-identifier hs-var">chainTest</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#AlonzoEra"><span class="hs-identifier hs-type">AlonzoEra</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750586"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#defaultGenSize"><span class="hs-identifier hs-var">defaultGenSize</span></a></span><span>
</span><span id="line-494"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
(HasTrace (MOCKCHAIN era) (Gen1 era),
 Eq (StashedAVVMAddresses era), EraGenericGen era,
 ShelleyEraAccounts era) =&gt;
Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#chainTest"><span class="hs-identifier hs-var">chainTest</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#MaryEra"><span class="hs-identifier hs-type">MaryEra</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750586"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#defaultGenSize"><span class="hs-identifier hs-var">defaultGenSize</span></a></span><span>
</span><span id="line-495"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
(HasTrace (MOCKCHAIN era) (Gen1 era),
 Eq (StashedAVVMAddresses era), EraGenericGen era,
 ShelleyEraAccounts era) =&gt;
Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#chainTest"><span class="hs-identifier hs-var">chainTest</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#AllegraEra"><span class="hs-identifier hs-type">AllegraEra</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750586"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#defaultGenSize"><span class="hs-identifier hs-var">defaultGenSize</span></a></span><span>
</span><span id="line-496"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
(HasTrace (MOCKCHAIN era) (Gen1 era), EraGenericGen era,
 ShelleyEraAccounts era) =&gt;
Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#multiEpochTest"><span class="hs-identifier hs-var">multiEpochTest</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#BabbageEra"><span class="hs-identifier hs-type">BabbageEra</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">225</span></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#defaultGenSize"><span class="hs-identifier hs-var">defaultGenSize</span></a></span><span>
</span><span id="line-497"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall era.
(HasTrace (MOCKCHAIN era) (Gen1 era), EraGenericGen era,
 ShelleyEraAccounts era) =&gt;
Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#multiEpochTest"><span class="hs-identifier hs-var">multiEpochTest</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">225</span></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="Test.Cardano.Ledger.Generic.GenState.html#defaultGenSize"><span class="hs-identifier hs-var">defaultGenSize</span></a></span><span>
</span><span id="line-498"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span class="annot"><span class="hs-comment">-- | Show that Ada is preserved across multiple Epochs</span></span><span>
</span><span id="line-501"></span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#multiEpochTest"><span class="hs-identifier hs-type">multiEpochTest</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682747538"><span class="annot"><a href="#local-6989586621682747538"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-503"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.Generator.QuickCheck.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.MockChain.html#MOCKCHAIN"><span class="hs-identifier hs-type">MOCKCHAIN</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747538"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.Trace.html#Gen1"><span class="hs-identifier hs-type">Gen1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747538"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#EraGenericGen"><span class="hs-identifier hs-type">EraGenericGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747538"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.State.Account.html#ShelleyEraAccounts"><span class="hs-identifier hs-type">ShelleyEraAccounts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682747538"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-506"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-507"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-508"></span><span>  </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#GenSize"><span class="hs-identifier hs-type">GenSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-509"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/tasty-1.5.3-88586983451851d5d35dd67c2a04aba64f40e4837f8fdc734bac69f324c5798f/share/doc/html/src/Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span>
</span><span id="line-510"></span><span id="multiEpochTest"><span class="annot"><span class="annottext">multiEpochTest :: forall era.
(HasTrace (MOCKCHAIN era) (Gen1 era), EraGenericGen era,
 ShelleyEraAccounts era) =&gt;
Int -&gt; GenSize -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#multiEpochTest"><span class="hs-identifier hs-var hs-var">multiEpochTest</span></a></span></span><span> </span><span id="local-6989586621682750623"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750623"><span class="hs-identifier hs-var">numTx</span></a></span></span><span> </span><span id="local-6989586621682750624"><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682750624"><span class="hs-identifier hs-var">gsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-511"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682750625"><span class="annot"><span class="annottext">gensize :: GenSize
</span><a href="#local-6989586621682750625"><span class="hs-identifier hs-var hs-var">gensize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682750624"><span class="hs-identifier hs-var">gsize</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#blocksizeMax"><span class="hs-identifier hs-var">blocksizeMax</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Cardano.Ledger.Generic.GenState.html#slotDelta"><span class="hs-identifier hs-var">slotDelta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">6</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">12</span></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-512"></span><span>      </span><span id="local-6989586621682750628"><span class="annot"><span class="annottext">getEpoch :: MockChainState era -&gt; EpochNo
</span><a href="#local-6989586621682750628"><span class="hs-identifier hs-var hs-var">getEpoch</span></a></span></span><span> </span><span id="local-6989586621682750629"><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621682750629"><span class="hs-identifier hs-var">mockchainstate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era -&gt; EpochNo
forall era. NewEpochState era -&gt; EpochNo
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-shelley-1.17.2.0/doc/html/cardano-ledger-shelley/src/Cardano.Ledger.Shelley.LedgerState.Types.html#nesEL"><span class="hs-identifier hs-var">nesEL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockChainState era -&gt; NewEpochState era
forall era. MockChainState era -&gt; NewEpochState era
</span><a href="Test.Cardano.Ledger.Generic.MockChain.html#mcsNes"><span class="hs-identifier hs-var">mcsNes</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621682750629"><span class="hs-identifier hs-var">mockchainstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>      </span><span id="local-6989586621682753320"><span class="annot"><span class="annottext">propf :: t -&gt; MockChainState era -&gt; Property
</span><a href="#local-6989586621682753320"><span class="hs-identifier hs-var hs-var">propf</span></a></span></span><span> </span><span id="local-6989586621682753321"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682753321"><span class="hs-identifier hs-var">firstSt</span></a></span></span><span> </span><span id="local-6989586621682753322"><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621682753322"><span class="hs-identifier hs-var">lastSt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-514"></span><span>        </span><span class="annot"><span class="annottext">EpochNo -&gt; Property -&gt; Property
forall a prop. (Show a, Testable prop) =&gt; a -&gt; prop -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#collect"><span class="hs-identifier hs-var">collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockChainState era -&gt; EpochNo
forall {era}. MockChainState era -&gt; EpochNo
</span><a href="#local-6989586621682750628"><span class="hs-identifier hs-var">getEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621682753322"><span class="hs-identifier hs-var">lastSt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Coin
forall t. TotalAda t =&gt; t -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#totalAda"><span class="hs-identifier hs-var">totalAda</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682753321"><span class="hs-identifier hs-var">firstSt</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Property
forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/QuickCheck-2.15.0.1-db6b992e5543937dfb08677d3de2c6cdff04a2cc45767828f7dbc5be2917a404/share/doc/html/src/Test.QuickCheck.Property.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState era -&gt; Coin
forall t. TotalAda t =&gt; t -&gt; Coin
</span><a href="Test.Cardano.Ledger.Generic.Functions.html#totalAda"><span class="hs-identifier hs-var">totalAda</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState era
</span><a href="#local-6989586621682753322"><span class="hs-identifier hs-var">lastSt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; Gen Property -&gt; TestTree
forall prop. Testable prop =&gt; Int -&gt; String -&gt; prop -&gt; TestTree
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#testPropMax"><span class="hs-identifier hs-var">testPropMax</span></a></span><span>
</span><span id="line-516"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">30</span></span><span>
</span><span id="line-517"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Multi epoch. Ada is preserved. &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Era era =&gt; String
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#eraName"><span class="hs-identifier hs-var">eraName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682747538"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;. Trace length = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750623"><span class="hs-identifier hs-var">numTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era prop.
(HasTrace (MOCKCHAIN era) (Gen1 era), EraGenericGen era,
 ShelleyEraAccounts era) =&gt;
Int
-&gt; GenSize
-&gt; (MockChainState era -&gt; MockChainState era -&gt; prop)
-&gt; Gen prop
</span><a href="Test.Cardano.Ledger.Generic.Trace.html#traceProp"><span class="hs-identifier hs-var">traceProp</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682747538"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682750623"><span class="hs-identifier hs-var">numTx</span></a></span><span> </span><span class="annot"><span class="annottext">GenSize
</span><a href="#local-6989586621682750625"><span class="hs-identifier hs-var">gensize</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainState era -&gt; MockChainState era -&gt; Property
forall {era} {t}.
(Assert
   (OrdCond
      (CmpNat (ProtVerLow era) (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 0 (ProtVerLow era)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 0 (ProtVerHigh era)) 'True 'True 'False)
   (TypeError ...),
 TotalAda t, Reflect era) =&gt;
t -&gt; MockChainState era -&gt; Property
</span><a href="#local-6989586621682753320"><span class="hs-identifier hs-var">propf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-519"></span></pre></body></html>