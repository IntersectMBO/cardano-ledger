<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ConstrainedClassMethods #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DefaultSignatures #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE UndecidableSuperClasses #-}</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-comment">-- | Besides capturing all configuration that is necessary to progress to a specific era,</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- this interface also provides fast forward functionality that is used in testing and</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- benchmarking in order to initilize a chain in a particular era without going through</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- the trouble of generating all the history for preceeding eras.</span><span>
</span><span id="line-27"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Ledger.Shelley.Transition</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier">EraTransition</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier">TransitionConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#mkTransitionConfig"><span class="hs-identifier">mkTransitionConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#injectIntoTestState"><span class="hs-identifier">injectIntoTestState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcPreviousEraConfigL"><span class="hs-identifier">tcPreviousEraConfigL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcTranslationContextL"><span class="hs-identifier">tcTranslationContextL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcShelleyGenesisL"><span class="hs-identifier">tcShelleyGenesisL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcInitialPParamsG"><span class="hs-identifier">tcInitialPParamsG</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#ShelleyTransitionConfig"><span class="hs-identifier">ShelleyTransitionConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcInitialFundsL"><span class="hs-identifier">tcInitialFundsL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcInitialStakingL"><span class="hs-identifier">tcInitialStakingL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#mkShelleyTransitionConfig"><span class="hs-identifier">mkShelleyTransitionConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#createInitialState"><span class="hs-identifier">createInitialState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#shelleyRegisterInitialFundsThenStaking"><span class="hs-identifier">shelleyRegisterInitialFundsThenStaking</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#shelleyRegisterInitialAccounts"><span class="hs-identifier">shelleyRegisterInitialAccounts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#registerInitialStakePools"><span class="hs-identifier">registerInitialStakePools</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#registerInitialFunds"><span class="hs-identifier">registerInitialFunds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#resetStakeDistribution"><span class="hs-identifier">resetStakeDistribution</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#toShelleyTransitionConfigPairs"><span class="hs-identifier">toShelleyTransitionConfigPairs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#protectMainnet"><span class="hs-identifier">protectMainnet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#protectMainnetLens"><span class="hs-identifier">protectMainnetLens</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html"><span class="hs-identifier">Cardano.Ledger.Address</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html"><span class="hs-identifier">Cardano.Ledger.BaseTypes</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html"><span class="hs-identifier">Cardano.Ledger.Coin</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html"><span class="hs-identifier">Cardano.Ledger.Core</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html"><span class="hs-identifier">Cardano.Ledger.Credential</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Genesis.html"><span class="hs-identifier">Cardano.Ledger.Genesis</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Keys.html"><span class="hs-identifier">Cardano.Ledger.Keys</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Era.html"><span class="hs-identifier">Cardano.Ledger.Shelley.Era</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Genesis.html"><span class="hs-identifier">Cardano.Ledger.Shelley.Genesis</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Governance.html"><span class="hs-identifier">Cardano.Ledger.Shelley.Governance</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.html"><span class="hs-identifier">Cardano.Ledger.Shelley.LedgerState</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.State.html"><span class="hs-identifier">Cardano.Ledger.Shelley.State</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Translation.html"><span class="hs-identifier">Cardano.Ledger.Shelley.Translation</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Translation.html#FromByronTranslationContext"><span class="hs-identifier">FromByronTranslationContext</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Translation.html#toFromByronTranslationContext"><span class="hs-identifier">toFromByronTranslationContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html"><span class="hs-identifier">Cardano.Ledger.Val</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier">FromJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.ToJSON.html#KeyValue"><span class="hs-identifier">KeyValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.ToJSON.html#ToJSON"><span class="hs-identifier">ToJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier">object</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.FromJSON.html#withObject"><span class="hs-identifier">withObject</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.FromJSON.html#.%3A"><span class="hs-operator">(.:)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier">Value</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Key.html"><span class="hs-identifier">Data.Aeson.Key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Key.html#Key"><span class="hs-identifier">Key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Key.html#fromString"><span class="hs-identifier">fromString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.html"><span class="hs-identifier">Data.Aeson.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier">Parser</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toLower</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/data-default-0.8.0.1-9291b190c5bc542cf17f99ce44e9365d143d76b9889465ad3d362701e6cc609e/share/doc/html/src/Data.Default.html"><span class="hs-identifier">Data.Default</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.ListMap.html"><span class="hs-identifier">Data.ListMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ListMap</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Void</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Stack</span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html"><span class="hs-identifier">Lens.Micro</span></a></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/nothunks-0.2.1.1-0663c3283fb5dee9e67d41860072fab0227b6d69ef882303baddf309058f8618/share/doc/html/src/NoThunks.Class.html"><span class="hs-identifier">NoThunks.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/nothunks-0.2.1.1-0663c3283fb5dee9e67d41860072fab0227b6d69ef882303baddf309058f8618/share/doc/html/src/NoThunks.Class.html#NoThunks"><span class="hs-identifier">NoThunks</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | Register the initial information in the 'NewEpochState'.</span><span>
</span><span id="line-86"></span><span class="hs-comment">--</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- HERE BE DRAGONS! This interfaced is intended to help in testing.</span><span>
</span><span id="line-88"></span><span class="hs-comment">--</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- In production, the genesis should /not/ contain any initial information about accounts, stake</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- pools or dreps.</span><span>
</span><span id="line-91"></span><span class="hs-comment">--</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- /Warning/ - Should only be used in testing and benchmarking. Will result in an error</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- when NetworkId is set to Mainnet</span><span>
</span><span id="line-94"></span><span class="hs-keyword">class</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#EraTxOut"><span class="hs-identifier hs-type">EraTxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Governance.html#EraGov"><span class="hs-identifier hs-type">EraGov</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Stake.html#EraStake"><span class="hs-identifier hs-type">EraStake</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Genesis.html#EraGenesis"><span class="hs-identifier hs-type">EraGenesis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#EraCertState"><span class="hs-identifier hs-type">EraCertState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/data-default-0.8.0.1-9291b190c5bc542cf17f99ce44e9365d143d76b9889465ad3d362701e6cc609e/share/doc/html/src/Data.Default.Internal.html#Default"><span class="hs-identifier hs-type">Default</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#StashedAVVMAddresses"><span class="hs-identifier hs-type">StashedAVVMAddresses</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-105"></span><span>  </span><span id="EraTransition"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier hs-var">EraTransition</span></a></span></span><span> </span><span id="local-6989586621679522889"><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-comment">-- | Cumulative configuration that is needed to be able to start in a current era</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-keyword">data</span><span> </span><span id="TransitionConfig"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-var">TransitionConfig</span></a></span></span><span> </span><span id="local-6989586621679522889"><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>  </span><span id="mkTransitionConfig"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#mkTransitionConfig"><span class="hs-identifier hs-type">mkTransitionConfig</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-comment">-- | Translation context necessary for advancing from previous era into the current</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-comment">-- one. This will usually be the contents of genesis file, if one exists for the</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">-- current era</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Translation.html#TranslationContext"><span class="hs-identifier hs-type">TranslationContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Transition configuration for the previous era.</span></span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#PreviousEra"><span class="hs-identifier hs-type">PreviousEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span>  </span><span id="injectIntoTestState"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#injectIntoTestState"><span class="hs-identifier hs-type">injectIntoTestState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-comment">-- | Extract data from the given transition configuration and store it in the given state.</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-comment">-- /Warning/ - Should only be used in testing and benchmarking. Will result in an error</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-comment">-- when 'NetworkId' is set to 'Mainnet'.</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-comment">-- | In case when a previous era is available, we should always be able to access</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-comment">-- `TransitionConfig` for the previous era, from within the current era's</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-comment">-- `TransitionConfig`</span><span>
</span><span id="line-131"></span><span>  </span><span id="tcPreviousEraConfigL"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcPreviousEraConfigL"><span class="hs-identifier hs-type">tcPreviousEraConfigL</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier hs-type">EraTransition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#PreviousEra"><span class="hs-identifier hs-type">PreviousEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#PreviousEra"><span class="hs-identifier hs-type">PreviousEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-comment">-- | Lens for the `TranslationContext` for the current era from the `TransitionConfig`</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-comment">-- Translation context is a different name for the Genesis type for each era, they are</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-comment">-- one and the same concept.</span><span>
</span><span id="line-138"></span><span>  </span><span id="tcTranslationContextL"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcTranslationContextL"><span class="hs-identifier hs-type">tcTranslationContextL</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Translation.html#TranslationContext"><span class="hs-identifier hs-type">TranslationContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-comment">-- | Lens for the `ShelleyGenesis` from the `TransitionConfig`. Default implementation</span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-comment">-- looks in the previous era's config</span><span>
</span><span id="line-143"></span><span>  </span><span id="tcShelleyGenesisL"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcShelleyGenesisL"><span class="hs-identifier hs-type">tcShelleyGenesisL</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Genesis.html#ShelleyGenesis"><span class="hs-identifier hs-type">ShelleyGenesis</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="tcShelleyGenesisL"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcShelleyGenesisL"><span class="hs-identifier hs-type">tcShelleyGenesisL</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier hs-type">EraTransition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#PreviousEra"><span class="hs-identifier hs-type">PreviousEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Genesis.html#ShelleyGenesis"><span class="hs-identifier hs-type">ShelleyGenesis</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span id="local-6989586621679523223"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcShelleyGenesisL"><span class="hs-identifier hs-var hs-var">tcShelleyGenesisL</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TransitionConfig (PreviousEra era)
 -&gt; f (TransitionConfig (PreviousEra era)))
-&gt; TransitionConfig era -&gt; f (TransitionConfig era)
forall era.
(EraTransition era, EraTransition (PreviousEra era)) =&gt;
Lens' (TransitionConfig era) (TransitionConfig (PreviousEra era))
Lens' (TransitionConfig era) (TransitionConfig (PreviousEra era))
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcPreviousEraConfigL"><span class="hs-identifier hs-var">tcPreviousEraConfigL</span></a></span><span> </span><span class="annot"><span class="annottext">((TransitionConfig (PreviousEra era)
  -&gt; f (TransitionConfig (PreviousEra era)))
 -&gt; TransitionConfig era -&gt; f (TransitionConfig era))
-&gt; ((ShelleyGenesis -&gt; f ShelleyGenesis)
    -&gt; TransitionConfig (PreviousEra era)
    -&gt; f (TransitionConfig (PreviousEra era)))
-&gt; (ShelleyGenesis -&gt; f ShelleyGenesis)
-&gt; TransitionConfig era
-&gt; f (TransitionConfig era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ShelleyGenesis -&gt; f ShelleyGenesis)
-&gt; TransitionConfig (PreviousEra era)
-&gt; f (TransitionConfig (PreviousEra era))
forall era.
EraTransition era =&gt;
Lens' (TransitionConfig era) ShelleyGenesis
Lens' (TransitionConfig (PreviousEra era)) ShelleyGenesis
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcShelleyGenesisL"><span class="hs-identifier hs-var">tcShelleyGenesisL</span></a></span></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-comment">-- | Get the initial PParams for the current era from the `TransitionConfig`. Note that</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-comment">-- this is only useful for testing and fast forward functionality, because this function</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-comment">-- assumes no on-chain changes to PParams through PParamsUpdate functionality.</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-comment">-- Default implementation will use the PParams from the Previous era and the current</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-comment">-- `TranslationContext` to construct PParams for the current era.</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-comment">-- /Warning/ - Should only be used in testing and benchmarking</span><span>
</span><span id="line-157"></span><span>  </span><span id="tcInitialPParamsG"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcInitialPParamsG"><span class="hs-identifier hs-type">tcInitialPParamsG</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#SimpleGetter"><span class="hs-identifier hs-type">SimpleGetter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="tcInitialPParamsG"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcInitialPParamsG"><span class="hs-identifier hs-type">tcInitialPParamsG</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier hs-type">EraTransition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#PreviousEra"><span class="hs-identifier hs-type">PreviousEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Translation.html#TranslateEra"><span class="hs-identifier hs-type">TranslateEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Translation.html#TranslationError"><span class="hs-identifier hs-type">TranslationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#SimpleGetter"><span class="hs-identifier hs-type">SimpleGetter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679523232"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcInitialPParamsG"><span class="hs-identifier hs-var hs-var">tcInitialPParamsG</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><span class="annottext">(TransitionConfig era -&gt; PParams era)
-&gt; SimpleGetter (TransitionConfig era) (PParams era)
forall s a. (s -&gt; a) -&gt; SimpleGetter s a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#to"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">((TransitionConfig era -&gt; PParams era)
 -&gt; SimpleGetter (TransitionConfig era) (PParams era))
-&gt; (TransitionConfig era -&gt; PParams era)
-&gt; SimpleGetter (TransitionConfig era) (PParams era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679523248"><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523248"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-166"></span><span>      </span><span class="annot"><span class="annottext">TranslationContext era -&gt; PParams (PreviousEra era) -&gt; PParams era
forall era (f :: * -&gt; *).
(TranslateEra era f, TranslationError era f ~ Void) =&gt;
TranslationContext era -&gt; f (PreviousEra era) -&gt; f era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Translation.html#translateEra%27"><span class="hs-identifier hs-var">translateEra'</span></a></span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523248"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
-&gt; Getting
     (TranslationContext era)
     (TransitionConfig era)
     (TranslationContext era)
-&gt; TranslationContext era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (TranslationContext era)
  (TransitionConfig era)
  (TranslationContext era)
forall era.
EraTransition era =&gt;
Lens' (TransitionConfig era) (TranslationContext era)
Lens' (TransitionConfig era) (TranslationContext era)
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcTranslationContextL"><span class="hs-identifier hs-var">tcTranslationContextL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523248"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
-&gt; Getting
     (PParams (PreviousEra era))
     (TransitionConfig era)
     (PParams (PreviousEra era))
-&gt; PParams (PreviousEra era)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(TransitionConfig (PreviousEra era)
 -&gt; Const
      (PParams (PreviousEra era)) (TransitionConfig (PreviousEra era)))
-&gt; TransitionConfig era
-&gt; Const (PParams (PreviousEra era)) (TransitionConfig era)
forall era.
(EraTransition era, EraTransition (PreviousEra era)) =&gt;
Lens' (TransitionConfig era) (TransitionConfig (PreviousEra era))
Lens' (TransitionConfig era) (TransitionConfig (PreviousEra era))
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcPreviousEraConfigL"><span class="hs-identifier hs-var">tcPreviousEraConfigL</span></a></span><span> </span><span class="annot"><span class="annottext">((TransitionConfig (PreviousEra era)
  -&gt; Const
       (PParams (PreviousEra era)) (TransitionConfig (PreviousEra era)))
 -&gt; TransitionConfig era
 -&gt; Const (PParams (PreviousEra era)) (TransitionConfig era))
-&gt; ((PParams (PreviousEra era)
     -&gt; Const (PParams (PreviousEra era)) (PParams (PreviousEra era)))
    -&gt; TransitionConfig (PreviousEra era)
    -&gt; Const
         (PParams (PreviousEra era)) (TransitionConfig (PreviousEra era)))
-&gt; Getting
     (PParams (PreviousEra era))
     (TransitionConfig era)
     (PParams (PreviousEra era))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PParams (PreviousEra era)
 -&gt; Const (PParams (PreviousEra era)) (PParams (PreviousEra era)))
-&gt; TransitionConfig (PreviousEra era)
-&gt; Const
     (PParams (PreviousEra era)) (TransitionConfig (PreviousEra era))
forall era.
EraTransition era =&gt;
SimpleGetter (TransitionConfig era) (PParams era)
SimpleGetter
  (TransitionConfig (PreviousEra era)) (PParams (PreviousEra era))
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcInitialPParamsG"><span class="hs-identifier hs-var">tcInitialPParamsG</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span>  </span><span id="toTransitionConfigKeyValuePairs"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#toTransitionConfigKeyValuePairs"><span class="hs-identifier hs-type">toTransitionConfigKeyValuePairs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621679522999"><span id="local-6989586621679523000"><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.ToJSON.html#KeyValue"><span class="hs-identifier hs-type">KeyValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522999"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523000"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679523000"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="toTransitionConfigKeyValuePairs"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#toTransitionConfigKeyValuePairs"><span class="hs-identifier hs-type">toTransitionConfigKeyValuePairs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621679522929"><span id="local-6989586621679522930"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier hs-type">EraTransition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#PreviousEra"><span class="hs-identifier hs-type">PreviousEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#ToKeyValuePairs"><span class="hs-identifier hs-type">ToKeyValuePairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Translation.html#TranslationContext"><span class="hs-identifier hs-type">TranslationContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#ToKeyValuePairs"><span class="hs-identifier hs-type">ToKeyValuePairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#PreviousEra"><span class="hs-identifier hs-type">PreviousEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Translation.html#TranslationContext"><span class="hs-identifier hs-type">TranslationContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.ToJSON.html#KeyValue"><span class="hs-identifier hs-type">KeyValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522929"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522930"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679522930"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621679523252"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#toTransitionConfigKeyValuePairs"><span class="hs-identifier hs-var hs-var">toTransitionConfigKeyValuePairs</span></a></span><span> </span><span id="local-6989586621679523282"><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523282"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><span class="annottext">TransitionConfig (PreviousEra era) -&gt; [a]
forall a e kv. (ToKeyValuePairs a, KeyValue e kv) =&gt; a -&gt; [kv]
forall e kv.
KeyValue e kv =&gt;
TransitionConfig (PreviousEra era) -&gt; [kv]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#toKeyValuePairs"><span class="hs-identifier hs-var">toKeyValuePairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523282"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
-&gt; Getting
     (TransitionConfig (PreviousEra era))
     (TransitionConfig era)
     (TransitionConfig (PreviousEra era))
-&gt; TransitionConfig (PreviousEra era)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (TransitionConfig (PreviousEra era))
  (TransitionConfig era)
  (TransitionConfig (PreviousEra era))
forall era.
(EraTransition era, EraTransition (PreviousEra era)) =&gt;
Lens' (TransitionConfig era) (TransitionConfig (PreviousEra era))
Lens' (TransitionConfig era) (TransitionConfig (PreviousEra era))
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcPreviousEraConfigL"><span class="hs-identifier hs-var">tcPreviousEraConfigL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679523284"><span class="hs-identifier hs-var">translationContextPairs</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>      </span><span id="local-6989586621679523284"><span class="annot"><span class="annottext">translationContextPairs :: [a]
</span><a href="#local-6989586621679523284"><span class="hs-identifier hs-var hs-var">translationContextPairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-187"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (TranslationContext era :~: NoGenesis era)
forall {k} (a :: k) (b :: k).
(Typeable a, Typeable b) =&gt;
Maybe (a :~: b)
</span><span class="hs-identifier hs-var">eqT</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Translation.html#TranslationContext"><span class="hs-identifier hs-type">TranslationContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:~:</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Genesis.html#NoGenesis"><span class="hs-identifier hs-type">NoGenesis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-188"></span><span>          </span><span class="annot"><span class="annottext">Maybe (TranslationContext era :~: NoGenesis era)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-189"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall era. Era era =&gt; Key
</span><a href="Cardano.Ledger.Shelley.Transition.html#eraNameKey"><span class="hs-identifier hs-var">eraNameKey</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; a
forall v. ToJSON v =&gt; Key -&gt; v -&gt; a
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">object</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TranslationContext era -&gt; [Pair]
forall a e kv. (ToKeyValuePairs a, KeyValue e kv) =&gt; a -&gt; [kv]
forall e kv. KeyValue e kv =&gt; TranslationContext era -&gt; [kv]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#toKeyValuePairs"><span class="hs-identifier hs-var">toKeyValuePairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523282"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
-&gt; Getting
     (TranslationContext era)
     (TransitionConfig era)
     (TranslationContext era)
-&gt; TranslationContext era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (TranslationContext era)
  (TransitionConfig era)
  (TranslationContext era)
forall era.
EraTransition era =&gt;
Lens' (TransitionConfig era) (TranslationContext era)
Lens' (TransitionConfig era) (TranslationContext era)
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcTranslationContextL"><span class="hs-identifier hs-var">tcTranslationContextL</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">TranslationContext era :~: NoGenesis era
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>  </span><span id="parseTransitionConfigJSON"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#parseTransitionConfigJSON"><span class="hs-identifier hs-type">parseTransitionConfigJSON</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Aeson.Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="parseTransitionConfigJSON"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#parseTransitionConfigJSON"><span class="hs-identifier hs-type">parseTransitionConfigJSON</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Translation.html#TranslationContext"><span class="hs-identifier hs-type">TranslationContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Translation.html#TranslationContext"><span class="hs-identifier hs-type">TranslationContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#PreviousEra"><span class="hs-identifier hs-type">PreviousEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Aeson.Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.Internal.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>  </span><span id="local-6989586621679523291"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#parseTransitionConfigJSON"><span class="hs-identifier hs-var hs-var">parseTransitionConfigJSON</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser (TransitionConfig era))
-&gt; Value
-&gt; Parser (TransitionConfig era)
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.FromJSON.html#withObject"><span class="hs-identifier hs-var">withObject</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Era era =&gt; String
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#eraName"><span class="hs-identifier hs-var">eraName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TransitionConfig&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser (TransitionConfig era))
 -&gt; Value -&gt; Parser (TransitionConfig era))
-&gt; (Object -&gt; Parser (TransitionConfig era))
-&gt; Value
-&gt; Parser (TransitionConfig era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679523317"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679523317"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621679523318"><span class="annot"><span class="annottext">TransitionConfig (PreviousEra era)
</span><a href="#local-6989586621679523318"><span class="hs-identifier hs-var">prevTransitionConfig</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#PreviousEra"><span class="hs-identifier hs-type">PreviousEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser (TransitionConfig (PreviousEra era))
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.FromJSON.html#parseJSON"><span class="hs-identifier hs-var">parseJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Value
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-var">Aeson.Object</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679523317"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621679523321"><span class="annot"><span class="annottext">TranslationContext era
</span><a href="#local-6989586621679523321"><span class="hs-identifier hs-var">genesis</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall era g (m :: * -&gt; *).
(Typeable era, Typeable g, Monad m) =&gt;
m g -&gt; m g
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Genesis.html#mkGenesisWith"><span class="hs-identifier hs-var">mkGenesisWith</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679523317"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (TranslationContext era)
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.FromJSON.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">forall era. Era era =&gt; Key
</span><a href="Cardano.Ledger.Shelley.Transition.html#eraNameKey"><span class="hs-identifier hs-var">eraNameKey</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679522889"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><span class="annottext">TransitionConfig era -&gt; Parser (TransitionConfig era)
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(TransitionConfig era -&gt; Parser (TransitionConfig era))
-&gt; TransitionConfig era -&gt; Parser (TransitionConfig era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TranslationContext era
-&gt; TransitionConfig (PreviousEra era) -&gt; TransitionConfig era
forall era.
EraTransition era =&gt;
TranslationContext era
-&gt; TransitionConfig (PreviousEra era) -&gt; TransitionConfig era
</span><a href="Cardano.Ledger.Shelley.Transition.html#mkTransitionConfig"><span class="hs-identifier hs-var">mkTransitionConfig</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext era
</span><a href="#local-6989586621679523321"><span class="hs-identifier hs-var">genesis</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig (PreviousEra era)
</span><a href="#local-6989586621679523318"><span class="hs-identifier hs-var">prevTransitionConfig</span></a></span></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#eraNameKey"><span class="hs-identifier hs-type">eraNameKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679522952"><span class="annot"><a href="#local-6989586621679522952"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522952"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span>
</span><span id="line-207"></span><span id="eraNameKey"><span class="annot"><span class="annottext">eraNameKey :: forall era. Era era =&gt; Key
</span><a href="Cardano.Ledger.Shelley.Transition.html#eraNameKey"><span class="hs-identifier hs-var hs-var">eraNameKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Key
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Key.html#fromString"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall era. Era era =&gt; String
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#eraName"><span class="hs-identifier hs-var">eraName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679522952"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679522973"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier hs-type">EraTransition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522973"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#ToKeyValuePairs"><span class="hs-identifier hs-type">ToKeyValuePairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522973"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-210"></span><span>  </span><span id="local-6989586621679523332"><span class="annot"><span class="annottext">toKeyValuePairs :: forall e kv. KeyValue e kv =&gt; TransitionConfig era -&gt; [kv]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#toKeyValuePairs"><span class="hs-identifier hs-var hs-var hs-var hs-var">toKeyValuePairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TransitionConfig era -&gt; [kv]
forall era e kv.
(EraTransition era, KeyValue e kv) =&gt;
TransitionConfig era -&gt; [kv]
forall e kv. KeyValue e kv =&gt; TransitionConfig era -&gt; [kv]
</span><a href="Cardano.Ledger.Shelley.Transition.html#toTransitionConfigKeyValuePairs"><span class="hs-identifier hs-var">toTransitionConfigKeyValuePairs</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span id="local-6989586621679523335"><span id="local-6989586621679523340"><span id="local-6989586621679523344"><span id="local-6989586621679523348"><span id="local-6989586621679523352"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621679522981"><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#KeyValuePairs"><span class="hs-identifier hs-type">KeyValuePairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522981"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-keyword">instance</span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#ToKeyValuePairs"><span class="hs-identifier hs-type">ToKeyValuePairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522981"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.ToJSON.html#ToJSON"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522981"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679523357"><span id="local-6989586621679523361"><span id="local-6989586621679523365"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier hs-type">EraTransition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523357"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523357"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621679523370"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (TransitionConfig era)
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.FromJSON.html#parseJSON"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser (TransitionConfig era)
forall era.
EraTransition era =&gt;
Value -&gt; Parser (TransitionConfig era)
</span><a href="Cardano.Ledger.Shelley.Transition.html#parseTransitionConfigJSON"><span class="hs-identifier hs-var">parseTransitionConfigJSON</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span id="local-6989586621679522983"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcNetworkIDG"><span class="hs-identifier hs-type">tcNetworkIDG</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier hs-type">EraTransition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522983"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#SimpleGetter"><span class="hs-identifier hs-type">SimpleGetter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522983"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#Network"><span class="hs-identifier hs-type">Network</span></a></span></span><span>
</span><span id="line-221"></span><span id="tcNetworkIDG"><span class="annot"><span class="annottext">tcNetworkIDG :: forall era.
EraTransition era =&gt;
SimpleGetter (TransitionConfig era) Network
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcNetworkIDG"><span class="hs-identifier hs-var hs-var">tcNetworkIDG</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ShelleyGenesis -&gt; Const r ShelleyGenesis)
-&gt; TransitionConfig era -&gt; Const r (TransitionConfig era)
forall era.
EraTransition era =&gt;
Lens' (TransitionConfig era) ShelleyGenesis
Lens' (TransitionConfig era) ShelleyGenesis
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcShelleyGenesisL"><span class="hs-identifier hs-var">tcShelleyGenesisL</span></a></span><span> </span><span class="annot"><span class="annottext">((ShelleyGenesis -&gt; Const r ShelleyGenesis)
 -&gt; TransitionConfig era -&gt; Const r (TransitionConfig era))
-&gt; ((Network -&gt; Const r Network)
    -&gt; ShelleyGenesis -&gt; Const r ShelleyGenesis)
-&gt; (Network -&gt; Const r Network)
-&gt; TransitionConfig era
-&gt; Const r (TransitionConfig era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ShelleyGenesis -&gt; Network) -&gt; SimpleGetter ShelleyGenesis Network
forall s a. (s -&gt; a) -&gt; SimpleGetter s a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#to"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis -&gt; Network
</span><a href="Cardano.Ledger.Shelley.Genesis.html#sgNetworkId"><span class="hs-identifier hs-var">sgNetworkId</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span id="local-6989586621679522987"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#shelleyRegisterInitialFundsThenStaking"><span class="hs-identifier hs-type">shelleyRegisterInitialFundsThenStaking</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier hs-type">EraTransition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522987"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.State.Account.html#ShelleyEraAccounts"><span class="hs-identifier hs-type">ShelleyEraAccounts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522987"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522987"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522987"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522987"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-228"></span><span id="shelleyRegisterInitialFundsThenStaking"><span class="annot"><span class="annottext">shelleyRegisterInitialFundsThenStaking :: forall era.
(EraTransition era, ShelleyEraAccounts era) =&gt;
TransitionConfig era -&gt; NewEpochState era -&gt; NewEpochState era
</span><a href="Cardano.Ledger.Shelley.Transition.html#shelleyRegisterInitialFundsThenStaking"><span class="hs-identifier hs-var hs-var">shelleyRegisterInitialFundsThenStaking</span></a></span></span><span> </span><span id="local-6989586621679523401"><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523401"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-comment">-- We must first register the initial funds, because the stake</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-comment">-- information depends on it.</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="annottext">NewEpochState era -&gt; NewEpochState era
forall era.
(EraCertState era, EraStake era) =&gt;
NewEpochState era -&gt; NewEpochState era
</span><a href="Cardano.Ledger.Shelley.Transition.html#resetStakeDistribution"><span class="hs-identifier hs-var">resetStakeDistribution</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><span class="annottext">(NewEpochState era -&gt; NewEpochState era)
-&gt; (NewEpochState era -&gt; NewEpochState era)
-&gt; NewEpochState era
-&gt; NewEpochState era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesisStaking -&gt; NewEpochState era -&gt; NewEpochState era
forall era.
(HasCallStack, ShelleyEraAccounts era, EraCertState era,
 EraGov era) =&gt;
ShelleyGenesisStaking -&gt; NewEpochState era -&gt; NewEpochState era
</span><a href="Cardano.Ledger.Shelley.Transition.html#shelleyRegisterInitialAccounts"><span class="hs-identifier hs-var">shelleyRegisterInitialAccounts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523401"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
-&gt; Getting
     ShelleyGenesisStaking (TransitionConfig era) ShelleyGenesisStaking
-&gt; ShelleyGenesisStaking
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  ShelleyGenesisStaking (TransitionConfig era) ShelleyGenesisStaking
forall era.
(HasCallStack, EraTransition era) =&gt;
Lens' (TransitionConfig era) ShelleyGenesisStaking
Lens' (TransitionConfig era) ShelleyGenesisStaking
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcInitialStakingL"><span class="hs-identifier hs-var">tcInitialStakingL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><span class="annottext">(NewEpochState era -&gt; NewEpochState era)
-&gt; (NewEpochState era -&gt; NewEpochState era)
-&gt; NewEpochState era
-&gt; NewEpochState era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesisStaking -&gt; NewEpochState era -&gt; NewEpochState era
forall era.
(EraCertState era, EraGov era) =&gt;
ShelleyGenesisStaking -&gt; NewEpochState era -&gt; NewEpochState era
</span><a href="Cardano.Ledger.Shelley.Transition.html#registerInitialStakePools"><span class="hs-identifier hs-var">registerInitialStakePools</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523401"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
-&gt; Getting
     ShelleyGenesisStaking (TransitionConfig era) ShelleyGenesisStaking
-&gt; ShelleyGenesisStaking
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  ShelleyGenesisStaking (TransitionConfig era) ShelleyGenesisStaking
forall era.
(HasCallStack, EraTransition era) =&gt;
Lens' (TransitionConfig era) ShelleyGenesisStaking
Lens' (TransitionConfig era) ShelleyGenesisStaking
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcInitialStakingL"><span class="hs-identifier hs-var">tcInitialStakingL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><span class="annottext">(NewEpochState era -&gt; NewEpochState era)
-&gt; (NewEpochState era -&gt; NewEpochState era)
-&gt; NewEpochState era
-&gt; NewEpochState era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TransitionConfig era -&gt; NewEpochState era -&gt; NewEpochState era
forall era.
(EraTransition era, HasCallStack) =&gt;
TransitionConfig era -&gt; NewEpochState era -&gt; NewEpochState era
</span><a href="Cardano.Ledger.Shelley.Transition.html#registerInitialFunds"><span class="hs-identifier hs-var">registerInitialFunds</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523401"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier hs-type">EraTransition</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span id="TransitionConfig"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-var">TransitionConfig</span></a></span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ShelleyTransitionConfig"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#ShelleyTransitionConfig"><span class="hs-identifier hs-var">ShelleyTransitionConfig</span></a></span></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="stcShelleyGenesis"><span class="annot"><span class="annottext">TransitionConfig ShelleyEra -&gt; ShelleyGenesis
</span><a href="Cardano.Ledger.Shelley.Transition.html#stcShelleyGenesis"><span class="hs-identifier hs-var hs-var">stcShelleyGenesis</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Genesis.html#ShelleyGenesis"><span class="hs-identifier hs-type">ShelleyGenesis</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679523442"><span id="local-6989586621679523447"><span class="annot"><span class="annottext">TransitionConfig ShelleyEra -&gt; TransitionConfig ShelleyEra -&gt; Bool
(TransitionConfig ShelleyEra
 -&gt; TransitionConfig ShelleyEra -&gt; Bool)
-&gt; (TransitionConfig ShelleyEra
    -&gt; TransitionConfig ShelleyEra -&gt; Bool)
-&gt; Eq (TransitionConfig ShelleyEra)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: TransitionConfig ShelleyEra -&gt; TransitionConfig ShelleyEra -&gt; Bool
== :: TransitionConfig ShelleyEra -&gt; TransitionConfig ShelleyEra -&gt; Bool
$c/= :: TransitionConfig ShelleyEra -&gt; TransitionConfig ShelleyEra -&gt; Bool
/= :: TransitionConfig ShelleyEra -&gt; TransitionConfig ShelleyEra -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679523452"><span id="local-6989586621679523458"><span id="local-6989586621679523461"><span class="annot"><span class="annottext">Int -&gt; TransitionConfig ShelleyEra -&gt; String -&gt; String
[TransitionConfig ShelleyEra] -&gt; String -&gt; String
TransitionConfig ShelleyEra -&gt; String
(Int -&gt; TransitionConfig ShelleyEra -&gt; String -&gt; String)
-&gt; (TransitionConfig ShelleyEra -&gt; String)
-&gt; ([TransitionConfig ShelleyEra] -&gt; String -&gt; String)
-&gt; Show (TransitionConfig ShelleyEra)
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
$cshowsPrec :: Int -&gt; TransitionConfig ShelleyEra -&gt; String -&gt; String
showsPrec :: Int -&gt; TransitionConfig ShelleyEra -&gt; String -&gt; String
$cshow :: TransitionConfig ShelleyEra -&gt; String
show :: TransitionConfig ShelleyEra -&gt; String
$cshowList :: [TransitionConfig ShelleyEra] -&gt; String -&gt; String
showList :: [TransitionConfig ShelleyEra] -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679523465"><span id="local-6989586621679523467"><span class="annot"><span class="annottext">(forall x.
 TransitionConfig ShelleyEra -&gt; Rep (TransitionConfig ShelleyEra) x)
-&gt; (forall x.
    Rep (TransitionConfig ShelleyEra) x -&gt; TransitionConfig ShelleyEra)
-&gt; Generic (TransitionConfig ShelleyEra)
forall x.
Rep (TransitionConfig ShelleyEra) x -&gt; TransitionConfig ShelleyEra
forall x.
TransitionConfig ShelleyEra -&gt; Rep (TransitionConfig ShelleyEra) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x.
TransitionConfig ShelleyEra -&gt; Rep (TransitionConfig ShelleyEra) x
from :: forall x.
TransitionConfig ShelleyEra -&gt; Rep (TransitionConfig ShelleyEra) x
$cto :: forall x.
Rep (TransitionConfig ShelleyEra) x -&gt; TransitionConfig ShelleyEra
to :: forall x.
Rep (TransitionConfig ShelleyEra) x -&gt; TransitionConfig ShelleyEra
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span>  </span><span id="local-6989586621679523472"><span class="annot"><span class="annottext">mkTransitionConfig :: TranslationContext ShelleyEra
-&gt; TransitionConfig (PreviousEra ShelleyEra)
-&gt; TransitionConfig ShelleyEra
</span><a href="Cardano.Ledger.Shelley.Transition.html#mkTransitionConfig"><span class="hs-identifier hs-var hs-var hs-var hs-var">mkTransitionConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><span class="annottext">String
-&gt; FromByronTranslationContext
-&gt; TransitionConfig ByronEra
-&gt; TransitionConfig ShelleyEra
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Impossible: There is no EraTransition instance for ByronEra&quot;</span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>  </span><span id="local-6989586621679523477"><span class="annot"><span class="annottext">injectIntoTestState :: TransitionConfig ShelleyEra
-&gt; NewEpochState ShelleyEra -&gt; NewEpochState ShelleyEra
</span><a href="Cardano.Ledger.Shelley.Transition.html#injectIntoTestState"><span class="hs-identifier hs-var hs-var hs-var hs-var">injectIntoTestState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TransitionConfig ShelleyEra
-&gt; NewEpochState ShelleyEra -&gt; NewEpochState ShelleyEra
forall era.
(EraTransition era, ShelleyEraAccounts era) =&gt;
TransitionConfig era -&gt; NewEpochState era -&gt; NewEpochState era
</span><a href="Cardano.Ledger.Shelley.Transition.html#shelleyRegisterInitialFundsThenStaking"><span class="hs-identifier hs-var">shelleyRegisterInitialFundsThenStaking</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621679523483"><span class="annot"><span class="annottext">tcPreviousEraConfigL :: EraTransition (PreviousEra ShelleyEra) =&gt;
Lens'
  (TransitionConfig ShelleyEra)
  (TransitionConfig (PreviousEra ShelleyEra))
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcPreviousEraConfigL"><span class="hs-identifier hs-var hs-var hs-var hs-var">tcPreviousEraConfigL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TransitionConfig ByronEra -&gt; f (TransitionConfig ByronEra))
-&gt; TransitionConfig ShelleyEra -&gt; f (TransitionConfig ShelleyEra)
(TransitionConfig (PreviousEra ShelleyEra)
 -&gt; f (TransitionConfig (PreviousEra ShelleyEra)))
-&gt; TransitionConfig ShelleyEra -&gt; f (TransitionConfig ShelleyEra)
forall a b. HasCallStack =&gt; Lens' a b
Lens' (TransitionConfig ShelleyEra) (TransitionConfig ByronEra)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.Era.html#notSupportedInThisEraL"><span class="hs-identifier hs-var">notSupportedInThisEraL</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span>  </span><span id="local-6989586621679523489"><span class="annot"><span class="annottext">tcTranslationContextL :: Lens' (TransitionConfig ShelleyEra) (TranslationContext ShelleyEra)
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcTranslationContextL"><span class="hs-identifier hs-var hs-var hs-var hs-var">tcTranslationContextL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><span class="annottext">(ShelleyGenesis -&gt; f ShelleyGenesis)
-&gt; TransitionConfig ShelleyEra -&gt; f (TransitionConfig ShelleyEra)
forall era.
EraTransition era =&gt;
Lens' (TransitionConfig era) ShelleyGenesis
Lens' (TransitionConfig ShelleyEra) ShelleyGenesis
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcShelleyGenesisL"><span class="hs-identifier hs-var">tcShelleyGenesisL</span></a></span><span> </span><span class="annot"><span class="annottext">((ShelleyGenesis -&gt; f ShelleyGenesis)
 -&gt; TransitionConfig ShelleyEra -&gt; f (TransitionConfig ShelleyEra))
-&gt; ((FromByronTranslationContext -&gt; f FromByronTranslationContext)
    -&gt; ShelleyGenesis -&gt; f ShelleyGenesis)
-&gt; (FromByronTranslationContext -&gt; f FromByronTranslationContext)
-&gt; TransitionConfig ShelleyEra
-&gt; f (TransitionConfig ShelleyEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ShelleyGenesis -&gt; FromByronTranslationContext)
-&gt; (ShelleyGenesis
    -&gt; FromByronTranslationContext -&gt; ShelleyGenesis)
-&gt; Lens
     ShelleyGenesis
     ShelleyGenesis
     FromByronTranslationContext
     FromByronTranslationContext
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis -&gt; FromByronTranslationContext
</span><a href="Cardano.Ledger.Shelley.Translation.html#toFromByronTranslationContext"><span class="hs-identifier hs-var">toFromByronTranslationContext</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis -&gt; FromByronTranslationContext -&gt; ShelleyGenesis
</span><a href="#local-6989586621679523491"><span class="hs-identifier hs-var">setFBTC</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>      </span><span id="local-6989586621679523491"><span class="annot"><span class="annottext">setFBTC :: ShelleyGenesis -&gt; FromByronTranslationContext -&gt; ShelleyGenesis
</span><a href="#local-6989586621679523491"><span class="hs-identifier hs-var hs-var">setFBTC</span></a></span></span><span> </span><span id="local-6989586621679523492"><span class="annot"><span class="annottext">ShelleyGenesis
</span><a href="#local-6989586621679523492"><span class="hs-identifier hs-var">shelleyGenesis</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Translation.html#FromByronTranslationContext"><span class="hs-identifier hs-type">FromByronTranslationContext</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679523494"><span id="local-6989586621679523495"><span id="local-6989586621679523496"><span class="annot"><span class="annottext">Word64
Map (KeyHash 'Genesis) GenDelegPair
PParams ShelleyEra
fbtcGenDelegs :: Map (KeyHash 'Genesis) GenDelegPair
fbtcProtocolParams :: PParams ShelleyEra
fbtcMaxLovelaceSupply :: Word64
fbtcGenDelegs :: FromByronTranslationContext -&gt; Map (KeyHash 'Genesis) GenDelegPair
fbtcProtocolParams :: FromByronTranslationContext -&gt; PParams ShelleyEra
fbtcMaxLovelaceSupply :: FromByronTranslationContext -&gt; Word64
</span><a href="#local-6989586621679523494"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-253"></span><span>        </span><span class="annot"><span class="annottext">ShelleyGenesis
</span><a href="#local-6989586621679523492"><span class="hs-identifier hs-var">shelleyGenesis</span></a></span><span>
</span><span id="line-254"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Genesis.html#sgGenDelegs"><span class="hs-identifier hs-var">sgGenDelegs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679523494"><span class="hs-identifier hs-type">fbtcGenDelegs</span></a></span><span>
</span><span id="line-255"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Genesis.html#sgProtocolParams"><span class="hs-identifier hs-var">sgProtocolParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679523495"><span class="hs-identifier hs-type">fbtcProtocolParams</span></a></span><span>
</span><span id="line-256"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Genesis.html#sgMaxLovelaceSupply"><span class="hs-identifier hs-var">sgMaxLovelaceSupply</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679523496"><span class="hs-identifier hs-type">fbtcMaxLovelaceSupply</span></a></span><span>
</span><span id="line-257"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621679523505"><span class="annot"><span class="annottext">tcShelleyGenesisL :: Lens' (TransitionConfig ShelleyEra) ShelleyGenesis
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcShelleyGenesisL"><span class="hs-identifier hs-var hs-var hs-var hs-var">tcShelleyGenesisL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TransitionConfig ShelleyEra -&gt; ShelleyGenesis)
-&gt; (TransitionConfig ShelleyEra
    -&gt; ShelleyGenesis -&gt; TransitionConfig ShelleyEra)
-&gt; Lens' (TransitionConfig ShelleyEra) ShelleyGenesis
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig ShelleyEra -&gt; ShelleyGenesis
</span><a href="Cardano.Ledger.Shelley.Transition.html#stcShelleyGenesis"><span class="hs-identifier hs-var">stcShelleyGenesis</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679523506"><span class="annot"><span class="annottext">TransitionConfig ShelleyEra
</span><a href="#local-6989586621679523506"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621679523507"><span class="annot"><span class="annottext">ShelleyGenesis
</span><a href="#local-6989586621679523507"><span class="hs-identifier hs-var">sg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TransitionConfig ShelleyEra
</span><a href="#local-6989586621679523506"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#stcShelleyGenesis"><span class="hs-identifier hs-var">stcShelleyGenesis</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679523507"><span class="hs-identifier hs-type">sg</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679523508"><span class="annot"><span class="annottext">tcInitialPParamsG :: SimpleGetter (TransitionConfig ShelleyEra) (PParams ShelleyEra)
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcInitialPParamsG"><span class="hs-identifier hs-var hs-var hs-var hs-var">tcInitialPParamsG</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TransitionConfig ShelleyEra -&gt; PParams ShelleyEra)
-&gt; SimpleGetter (TransitionConfig ShelleyEra) (PParams ShelleyEra)
forall s a. (s -&gt; a) -&gt; SimpleGetter s a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#to"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyGenesis -&gt; PParams ShelleyEra
</span><a href="Cardano.Ledger.Shelley.Genesis.html#sgProtocolParams"><span class="hs-identifier hs-var">sgProtocolParams</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyGenesis -&gt; PParams ShelleyEra)
-&gt; (TransitionConfig ShelleyEra -&gt; ShelleyGenesis)
-&gt; TransitionConfig ShelleyEra
-&gt; PParams ShelleyEra
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TransitionConfig ShelleyEra -&gt; ShelleyGenesis
</span><a href="Cardano.Ledger.Shelley.Transition.html#stcShelleyGenesis"><span class="hs-identifier hs-var">stcShelleyGenesis</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span>  </span><span id="local-6989586621679523519"><span class="annot"><span class="annottext">toTransitionConfigKeyValuePairs :: forall e a. KeyValue e a =&gt; TransitionConfig ShelleyEra -&gt; [a]
</span><a href="Cardano.Ledger.Shelley.Transition.html#toTransitionConfigKeyValuePairs"><span class="hs-identifier hs-var hs-var hs-var hs-var">toTransitionConfigKeyValuePairs</span></a></span></span><span> </span><span id="local-6989586621679523520"><span class="annot"><span class="annottext">stc :: TransitionConfig ShelleyEra
</span><a href="#local-6989586621679523520"><span class="hs-identifier hs-var">stc</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#ShelleyTransitionConfig"><span class="hs-identifier hs-type">ShelleyTransitionConfig</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;shelley&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; a
forall v. ToJSON v =&gt; Key -&gt; v -&gt; a
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">object</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyGenesis -&gt; [Pair]
forall a e kv. (ToKeyValuePairs a, KeyValue e kv) =&gt; a -&gt; [kv]
forall e kv. KeyValue e kv =&gt; ShelleyGenesis -&gt; [kv]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#toKeyValuePairs"><span class="hs-identifier hs-var">toKeyValuePairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TransitionConfig ShelleyEra -&gt; ShelleyGenesis
</span><a href="Cardano.Ledger.Shelley.Transition.html#stcShelleyGenesis"><span class="hs-identifier hs-var">stcShelleyGenesis</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig ShelleyEra
</span><a href="#local-6989586621679523520"><span class="hs-identifier hs-var">stc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span>  </span><span id="local-6989586621679523526"><span class="annot"><span class="annottext">parseTransitionConfigJSON :: Value -&gt; Parser (TransitionConfig ShelleyEra)
</span><a href="Cardano.Ledger.Shelley.Transition.html#parseTransitionConfigJSON"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseTransitionConfigJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser (TransitionConfig ShelleyEra))
-&gt; Value
-&gt; Parser (TransitionConfig ShelleyEra)
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.FromJSON.html#withObject"><span class="hs-identifier hs-var">withObject</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ShelleyTransitionConfig&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser (TransitionConfig ShelleyEra))
 -&gt; Value -&gt; Parser (TransitionConfig ShelleyEra))
-&gt; (Object -&gt; Parser (TransitionConfig ShelleyEra))
-&gt; Value
-&gt; Parser (TransitionConfig ShelleyEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679523527"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679523527"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-267"></span><span>    </span><span id="local-6989586621679523528"><span class="annot"><span class="annottext">ShelleyGenesis
</span><a href="#local-6989586621679523528"><span class="hs-identifier hs-var">sg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679523527"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser ShelleyGenesis
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.FromJSON.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;shelley&quot;</span></span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><span class="annottext">TransitionConfig ShelleyEra -&gt; Parser (TransitionConfig ShelleyEra)
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(TransitionConfig ShelleyEra
 -&gt; Parser (TransitionConfig ShelleyEra))
-&gt; TransitionConfig ShelleyEra
-&gt; Parser (TransitionConfig ShelleyEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#ShelleyTransitionConfig"><span class="hs-identifier hs-type">ShelleyTransitionConfig</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">stcShelleyGenesis :: ShelleyGenesis
</span><a href="Cardano.Ledger.Shelley.Transition.html#stcShelleyGenesis"><span class="hs-identifier hs-var">stcShelleyGenesis</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis
</span><a href="#local-6989586621679523528"><span class="hs-identifier hs-var">sg</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-comment">-- | Get the initial funds from the `TransitionConfig`. This value must be non-empty</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- only during testing and benchmarking, it must never contain anything on a real system.</span><span>
</span><span id="line-272"></span><span class="hs-comment">--</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- /Warning/ - Should only be used in testing and benchmarking. Will result in an error</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- when NetworkId is set to Mainnet</span><span>
</span><span id="line-275"></span><span id="local-6989586621679523030"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcInitialFundsL"><span class="hs-identifier hs-type">tcInitialFundsL</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier hs-type">EraTransition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523030"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523030"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.ListMap.html#ListMap"><span class="hs-identifier hs-type">ListMap.ListMap</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Address.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-278"></span><span id="tcInitialFundsL"><span class="annot"><span class="annottext">tcInitialFundsL :: forall era.
(HasCallStack, EraTransition era) =&gt;
Lens' (TransitionConfig era) (ListMap Addr Coin)
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcInitialFundsL"><span class="hs-identifier hs-var hs-var">tcInitialFundsL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-279"></span><span>  </span><span class="annot"><span class="annottext">String
-&gt; (ListMap Addr Coin -&gt; Bool)
-&gt; (forall {f :: * -&gt; *}.
    Functor f =&gt;
    (ListMap Addr Coin -&gt; f (ListMap Addr Coin))
    -&gt; TransitionConfig era -&gt; f (TransitionConfig era))
-&gt; forall {f :: * -&gt; *}.
   Functor f =&gt;
   (ListMap Addr Coin -&gt; f (ListMap Addr Coin))
   -&gt; TransitionConfig era -&gt; f (TransitionConfig era)
forall era a.
(HasCallStack, EraTransition era) =&gt;
String
-&gt; (a -&gt; Bool)
-&gt; Lens' (TransitionConfig era) a
-&gt; Lens' (TransitionConfig era) a
</span><a href="Cardano.Ledger.Shelley.Transition.html#protectMainnetLens"><span class="hs-identifier hs-var">protectMainnetLens</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;InitialFunds&quot;</span></span><span> </span><span class="annot"><span class="annottext">ListMap Addr Coin -&gt; Bool
forall a. ListMap Addr a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">((forall {f :: * -&gt; *}.
  Functor f =&gt;
  (ListMap Addr Coin -&gt; f (ListMap Addr Coin))
  -&gt; TransitionConfig era -&gt; f (TransitionConfig era))
 -&gt; forall {f :: * -&gt; *}.
    Functor f =&gt;
    (ListMap Addr Coin -&gt; f (ListMap Addr Coin))
    -&gt; TransitionConfig era -&gt; f (TransitionConfig era))
-&gt; (forall {f :: * -&gt; *}.
    Functor f =&gt;
    (ListMap Addr Coin -&gt; f (ListMap Addr Coin))
    -&gt; TransitionConfig era -&gt; f (TransitionConfig era))
-&gt; forall {f :: * -&gt; *}.
   Functor f =&gt;
   (ListMap Addr Coin -&gt; f (ListMap Addr Coin))
   -&gt; TransitionConfig era -&gt; f (TransitionConfig era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><span class="annottext">(ShelleyGenesis -&gt; f ShelleyGenesis)
-&gt; TransitionConfig era -&gt; f (TransitionConfig era)
forall era.
EraTransition era =&gt;
Lens' (TransitionConfig era) ShelleyGenesis
Lens' (TransitionConfig era) ShelleyGenesis
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcShelleyGenesisL"><span class="hs-identifier hs-var">tcShelleyGenesisL</span></a></span><span> </span><span class="annot"><span class="annottext">((ShelleyGenesis -&gt; f ShelleyGenesis)
 -&gt; TransitionConfig era -&gt; f (TransitionConfig era))
-&gt; ((ListMap Addr Coin -&gt; f (ListMap Addr Coin))
    -&gt; ShelleyGenesis -&gt; f ShelleyGenesis)
-&gt; (ListMap Addr Coin -&gt; f (ListMap Addr Coin))
-&gt; TransitionConfig era
-&gt; f (TransitionConfig era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ListMap Addr Coin -&gt; f (ListMap Addr Coin))
-&gt; ShelleyGenesis -&gt; f ShelleyGenesis
Lens' ShelleyGenesis (ListMap Addr Coin)
</span><a href="Cardano.Ledger.Shelley.Genesis.html#sgInitialFundsL"><span class="hs-identifier hs-var">sgInitialFundsL</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-comment">-- | Get the initial staking from the `TransitionConfig`. This value must be non-empty</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- only during testing and benchmarking, it must never contain anything on a real system.</span><span>
</span><span id="line-284"></span><span class="hs-comment">--</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- /Warning/ - Should only be used in testing and benchmarking. Will result in an error</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- when NetworkId is set to Mainnet</span><span>
</span><span id="line-287"></span><span id="local-6989586621679522995"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#tcInitialStakingL"><span class="hs-identifier hs-type">tcInitialStakingL</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier hs-type">EraTransition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522995"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-289"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522995"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Genesis.html#ShelleyGenesisStaking"><span class="hs-identifier hs-type">ShelleyGenesisStaking</span></a></span></span><span>
</span><span id="line-290"></span><span id="tcInitialStakingL"><span class="annot"><span class="annottext">tcInitialStakingL :: forall era.
(HasCallStack, EraTransition era) =&gt;
Lens' (TransitionConfig era) ShelleyGenesisStaking
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcInitialStakingL"><span class="hs-identifier hs-var hs-var">tcInitialStakingL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-291"></span><span>  </span><span class="annot"><span class="annottext">String
-&gt; (ShelleyGenesisStaking -&gt; Bool)
-&gt; (forall {f :: * -&gt; *}.
    Functor f =&gt;
    (ShelleyGenesisStaking -&gt; f ShelleyGenesisStaking)
    -&gt; TransitionConfig era -&gt; f (TransitionConfig era))
-&gt; forall {f :: * -&gt; *}.
   Functor f =&gt;
   (ShelleyGenesisStaking -&gt; f ShelleyGenesisStaking)
   -&gt; TransitionConfig era -&gt; f (TransitionConfig era)
forall era a.
(HasCallStack, EraTransition era) =&gt;
String
-&gt; (a -&gt; Bool)
-&gt; Lens' (TransitionConfig era) a
-&gt; Lens' (TransitionConfig era) a
</span><a href="Cardano.Ledger.Shelley.Transition.html#protectMainnetLens"><span class="hs-identifier hs-var">protectMainnetLens</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;InitialStaking&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyGenesisStaking -&gt; ShelleyGenesisStaking -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesisStaking
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((forall {f :: * -&gt; *}.
  Functor f =&gt;
  (ShelleyGenesisStaking -&gt; f ShelleyGenesisStaking)
  -&gt; TransitionConfig era -&gt; f (TransitionConfig era))
 -&gt; forall {f :: * -&gt; *}.
    Functor f =&gt;
    (ShelleyGenesisStaking -&gt; f ShelleyGenesisStaking)
    -&gt; TransitionConfig era -&gt; f (TransitionConfig era))
-&gt; (forall {f :: * -&gt; *}.
    Functor f =&gt;
    (ShelleyGenesisStaking -&gt; f ShelleyGenesisStaking)
    -&gt; TransitionConfig era -&gt; f (TransitionConfig era))
-&gt; forall {f :: * -&gt; *}.
   Functor f =&gt;
   (ShelleyGenesisStaking -&gt; f ShelleyGenesisStaking)
   -&gt; TransitionConfig era -&gt; f (TransitionConfig era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-292"></span><span>    </span><span class="annot"><span class="annottext">(ShelleyGenesis -&gt; f ShelleyGenesis)
-&gt; TransitionConfig era -&gt; f (TransitionConfig era)
forall era.
EraTransition era =&gt;
Lens' (TransitionConfig era) ShelleyGenesis
Lens' (TransitionConfig era) ShelleyGenesis
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcShelleyGenesisL"><span class="hs-identifier hs-var">tcShelleyGenesisL</span></a></span><span> </span><span class="annot"><span class="annottext">((ShelleyGenesis -&gt; f ShelleyGenesis)
 -&gt; TransitionConfig era -&gt; f (TransitionConfig era))
-&gt; ((ShelleyGenesisStaking -&gt; f ShelleyGenesisStaking)
    -&gt; ShelleyGenesis -&gt; f ShelleyGenesis)
-&gt; (ShelleyGenesisStaking -&gt; f ShelleyGenesisStaking)
-&gt; TransitionConfig era
-&gt; f (TransitionConfig era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ShelleyGenesisStaking -&gt; f ShelleyGenesisStaking)
-&gt; ShelleyGenesis -&gt; f ShelleyGenesis
Lens' ShelleyGenesis ShelleyGenesisStaking
</span><a href="Cardano.Ledger.Shelley.Genesis.html#sgStakingL"><span class="hs-identifier hs-var">sgStakingL</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="annot"><span class="hs-comment">-- | Constructor for the base Shelley `TransitionConfig`</span></span><span>
</span><span id="line-295"></span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#mkShelleyTransitionConfig"><span class="hs-identifier hs-type">mkShelleyTransitionConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Genesis.html#ShelleyGenesis"><span class="hs-identifier hs-type">ShelleyGenesis</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span>
</span><span id="line-296"></span><span id="mkShelleyTransitionConfig"><span class="annot"><span class="annottext">mkShelleyTransitionConfig :: ShelleyGenesis -&gt; TransitionConfig ShelleyEra
</span><a href="Cardano.Ledger.Shelley.Transition.html#mkShelleyTransitionConfig"><span class="hs-identifier hs-var hs-var">mkShelleyTransitionConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis -&gt; TransitionConfig ShelleyEra
</span><a href="Cardano.Ledger.Shelley.Transition.html#ShelleyTransitionConfig"><span class="hs-identifier hs-var">ShelleyTransitionConfig</span></a></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span id="local-6989586621679523038"><span id="local-6989586621679523039"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#protectMainnetLens"><span class="hs-identifier hs-type">protectMainnetLens</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier hs-type">EraTransition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523038"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-300"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679523039"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523038"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679523039"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523038"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679523039"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-304"></span><span id="protectMainnetLens"><span class="annot"><span class="annottext">protectMainnetLens :: forall era a.
(HasCallStack, EraTransition era) =&gt;
String
-&gt; (a -&gt; Bool)
-&gt; Lens' (TransitionConfig era) a
-&gt; Lens' (TransitionConfig era) a
</span><a href="Cardano.Ledger.Shelley.Transition.html#protectMainnetLens"><span class="hs-identifier hs-var hs-var">protectMainnetLens</span></a></span></span><span> </span><span id="local-6989586621679523570"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679523570"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679523571"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679523571"><span class="hs-identifier hs-var">isMainnetSafe</span></a></span></span><span> </span><span id="local-6989586621679523572"><span class="annot"><span class="annottext">Lens' (TransitionConfig era) a
</span><a href="#local-6989586621679523572"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-305"></span><span>  </span><span class="annot"><span class="annottext">(TransitionConfig era -&gt; a)
-&gt; (TransitionConfig era -&gt; a -&gt; TransitionConfig era)
-&gt; Lens' (TransitionConfig era) a
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679523573"><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523573"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TransitionConfig era -&gt; (a -&gt; Bool) -&gt; a -&gt; a
forall era a.
(HasCallStack, EraTransition era) =&gt;
String -&gt; TransitionConfig era -&gt; (a -&gt; Bool) -&gt; a -&gt; a
</span><a href="Cardano.Ledger.Shelley.Transition.html#protectMainnet"><span class="hs-identifier hs-var">protectMainnet</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679523570"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523573"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679523571"><span class="hs-identifier hs-var">isMainnetSafe</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523573"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig era -&gt; Getting a (TransitionConfig era) a -&gt; a
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting a (TransitionConfig era) a
Lens' (TransitionConfig era) a
</span><a href="#local-6989586621679523572"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679523574"><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523574"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679523575"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679523575"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523574"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
-&gt; (TransitionConfig era -&gt; TransitionConfig era)
-&gt; TransitionConfig era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Identity a)
-&gt; TransitionConfig era -&gt; Identity (TransitionConfig era)
Lens' (TransitionConfig era) a
</span><a href="#local-6989586621679523572"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Identity a)
 -&gt; TransitionConfig era -&gt; Identity (TransitionConfig era))
-&gt; a -&gt; TransitionConfig era -&gt; TransitionConfig era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679523575"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span id="local-6989586621679523052"><span id="local-6989586621679523053"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#protectMainnet"><span class="hs-identifier hs-type">protectMainnet</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier hs-type">EraTransition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523052"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-311"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-312"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523052"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679523053"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-314"></span><span>  </span><span class="annot"><a href="#local-6989586621679523053"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-315"></span><span>  </span><span class="annot"><a href="#local-6989586621679523053"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-316"></span><span id="protectMainnet"><span class="annot"><span class="annottext">protectMainnet :: forall era a.
(HasCallStack, EraTransition era) =&gt;
String -&gt; TransitionConfig era -&gt; (a -&gt; Bool) -&gt; a -&gt; a
</span><a href="Cardano.Ledger.Shelley.Transition.html#protectMainnet"><span class="hs-identifier hs-var hs-var">protectMainnet</span></a></span></span><span> </span><span id="local-6989586621679523588"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679523588"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679523589"><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523589"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679523590"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679523590"><span class="hs-identifier hs-var">isMainnetSafe</span></a></span></span><span> </span><span id="local-6989586621679523591"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679523591"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523589"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
-&gt; Getting Network (TransitionConfig era) Network -&gt; Network
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Network (TransitionConfig era) Network
forall era.
EraTransition era =&gt;
SimpleGetter (TransitionConfig era) Network
SimpleGetter (TransitionConfig era) Network
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcNetworkIDG"><span class="hs-identifier hs-var">tcNetworkIDG</span></a></span><span> </span><span class="annot"><span class="annottext">Network -&gt; Network -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#Mainnet"><span class="hs-identifier hs-var">Mainnet</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679523590"><span class="hs-identifier hs-var">isMainnetSafe</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679523591"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; a) -&gt; String -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Injection of &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679523588"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; is not possible on Mainnet&quot;</span></span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679523591"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span id="local-6989586621679523595"><span id="local-6989586621679523600"><span id="local-6989586621679523604"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/nothunks-0.2.1.1-0663c3283fb5dee9e67d41860072fab0227b6d69ef882303baddf309058f8618/share/doc/html/src/NoThunks.Class.html#NoThunks"><span class="hs-identifier hs-type">NoThunks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span id="local-6989586621679523609"><span id="local-6989586621679523610"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#toShelleyTransitionConfigPairs"><span class="hs-identifier hs-type">toShelleyTransitionConfigPairs</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/aeson-2.2.3.0-86b3ded2a2a93d56f93497d21d3bbbb23e8718e44c9fa876ad561a4cceac08c1/share/doc/html/src/Data.Aeson.Types.ToJSON.html#KeyValue"><span class="hs-identifier hs-type">KeyValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523609"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523610"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-325"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/l/internal/doc/html/cardano-ledger-core/src/Cardano.Ledger.Internal.Definition.Era.html#ShelleyEra"><span class="hs-identifier hs-type">ShelleyEra</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679523610"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-327"></span><span id="toShelleyTransitionConfigPairs"><span class="annot"><span class="annottext">toShelleyTransitionConfigPairs :: forall e a. KeyValue e a =&gt; TransitionConfig ShelleyEra -&gt; [a]
</span><a href="Cardano.Ledger.Shelley.Transition.html#toShelleyTransitionConfigPairs"><span class="hs-identifier hs-var hs-var">toShelleyTransitionConfigPairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TransitionConfig ShelleyEra -&gt; [a]
forall a e kv. (ToKeyValuePairs a, KeyValue e kv) =&gt; a -&gt; [kv]
forall e a. KeyValue e a =&gt; TransitionConfig ShelleyEra -&gt; [a]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#toKeyValuePairs"><span class="hs-identifier hs-var">toKeyValuePairs</span></a></span><span>
</span><span id="line-328"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">toShelleyTransitionConfigPairs</span><span> </span><span class="hs-pragma">&quot;In favor of `toKeyValuePairs`&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="hs-comment">-- | Helper function for constructing the initial state for any era</span><span>
</span><span id="line-331"></span><span class="hs-comment">--</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- /Warning/ - Should only be used in testing and benchmarking. Will result in an error</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- when NetworkId is set to Mainnet</span><span>
</span><span id="line-334"></span><span class="hs-comment">--</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- This function does not register any initial funds or delegates.</span><span>
</span><span id="line-336"></span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#createInitialState"><span class="hs-identifier hs-type">createInitialState</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679523070"><span class="annot"><a href="#local-6989586621679523070"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier hs-type">EraTransition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523070"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-339"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523070"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-340"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523070"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-341"></span><span id="createInitialState"><span class="annot"><span class="annottext">createInitialState :: forall era.
(EraTransition era, HasCallStack) =&gt;
TransitionConfig era -&gt; NewEpochState era
</span><a href="Cardano.Ledger.Shelley.Transition.html#createInitialState"><span class="hs-identifier hs-var hs-var">createInitialState</span></a></span></span><span> </span><span id="local-6989586621679523658"><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523658"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-342"></span><span>  </span><span class="annot"><span class="annottext">String
-&gt; TransitionConfig era
-&gt; (NewEpochState era -&gt; Bool)
-&gt; NewEpochState era
-&gt; NewEpochState era
forall era a.
(HasCallStack, EraTransition era) =&gt;
String -&gt; TransitionConfig era -&gt; (a -&gt; Bool) -&gt; a -&gt; a
</span><a href="Cardano.Ledger.Shelley.Transition.html#protectMainnet"><span class="hs-identifier hs-var">protectMainnet</span></a></span><span>
</span><span id="line-343"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;InitialState&quot;</span></span><span>
</span><span id="line-344"></span><span>    </span><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523658"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; NewEpochState era -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span>
</span><span id="line-347"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">nesEL :: EpochNo
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesEL"><span class="hs-identifier hs-var">nesEL</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochNo
</span><a href="#local-6989586621679523661"><span class="hs-identifier hs-var">initialEpochNo</span></a></span><span>
</span><span id="line-348"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nesBprev :: BlocksMade
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesBprev"><span class="hs-identifier hs-var">nesBprev</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) Natural -&gt; BlocksMade
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#BlocksMade"><span class="hs-identifier hs-var">BlocksMade</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) Natural
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-349"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nesBcur :: BlocksMade
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesBcur"><span class="hs-identifier hs-var">nesBcur</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) Natural -&gt; BlocksMade
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#BlocksMade"><span class="hs-identifier hs-var">BlocksMade</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) Natural
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-350"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nesEs :: EpochState era
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesEs"><span class="hs-identifier hs-var">nesEs</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-351"></span><span>          </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#EpochState"><span class="hs-identifier hs-type">EpochState</span></a></span><span>
</span><span id="line-352"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">esChainAccountState :: ChainAccountState
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#esChainAccountState"><span class="hs-identifier hs-var">esChainAccountState</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-353"></span><span>                </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.ChainAccount.html#ChainAccountState"><span class="hs-identifier hs-type">ChainAccountState</span></a></span><span>
</span><span id="line-354"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">casTreasury :: Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.ChainAccount.html#casTreasury"><span class="hs-identifier hs-var">casTreasury</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin
forall t. Val t =&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span>
</span><span id="line-355"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">casReserves :: Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.ChainAccount.html#casReserves"><span class="hs-identifier hs-var">casReserves</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679523673"><span class="hs-identifier hs-var">reserves</span></a></span><span>
</span><span id="line-356"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-357"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">esSnapshots :: SnapShots
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#esSnapshots"><span class="hs-identifier hs-var">esSnapshots</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SnapShots
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.SnapShots.html#emptySnapShots"><span class="hs-identifier hs-var">emptySnapShots</span></a></span><span>
</span><span id="line-358"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">esLState :: LedgerState era
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#esLState"><span class="hs-identifier hs-var">esLState</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-359"></span><span>                </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#LedgerState"><span class="hs-identifier hs-type">LedgerState</span></a></span><span>
</span><span id="line-360"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">lsUTxOState :: UTxOState era
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#lsUTxOState"><span class="hs-identifier hs-var">lsUTxOState</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-361"></span><span>                      </span><span class="annot"><span class="annottext">PParams era
-&gt; UTxO era
-&gt; Coin
-&gt; Coin
-&gt; GovState era
-&gt; Coin
-&gt; UTxOState era
forall era.
EraStake era =&gt;
PParams era
-&gt; UTxO era
-&gt; Coin
-&gt; Coin
-&gt; GovState era
-&gt; Coin
-&gt; UTxOState era
</span><a href="Cardano.Ledger.Shelley.LedgerState.IncrementalStake.html#smartUTxOState"><span class="hs-identifier hs-var">smartUTxOState</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679523680"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679523681"><span class="hs-identifier hs-var">initialUtxo</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
forall t. Val t =&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
forall t. Val t =&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="annot"><span class="annottext">GovState era
</span><a href="#local-6989586621679523682"><span class="hs-identifier hs-var">govState</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
forall t. Val t =&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span>
</span><span id="line-362"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">lsCertState :: CertState era
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertState"><span class="hs-identifier hs-var">lsCertState</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-363"></span><span>                      </span><span class="annot"><span class="annottext">CertState era
forall a. Default a =&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/data-default-0.8.0.1-9291b190c5bc542cf17f99ce44e9365d143d76b9889465ad3d362701e6cc609e/share/doc/html/src/Data.Default.Internal.html#def"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">CertState era -&gt; (CertState era -&gt; CertState era) -&gt; CertState era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(DState era -&gt; Identity (DState era))
-&gt; CertState era -&gt; Identity (CertState era)
forall era. EraCertState era =&gt; Lens' (CertState era) (DState era)
Lens' (CertState era) (DState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#certDStateL"><span class="hs-identifier hs-var">certDStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((DState era -&gt; Identity (DState era))
 -&gt; CertState era -&gt; Identity (CertState era))
-&gt; ((GenDelegs -&gt; Identity GenDelegs)
    -&gt; DState era -&gt; Identity (DState era))
-&gt; (GenDelegs -&gt; Identity GenDelegs)
-&gt; CertState era
-&gt; Identity (CertState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(GenDelegs -&gt; Identity GenDelegs)
-&gt; DState era -&gt; Identity (DState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(GenDelegs -&gt; f GenDelegs) -&gt; DState era -&gt; f (DState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#dsGenDelegsL"><span class="hs-identifier hs-var">dsGenDelegsL</span></a></span><span> </span><span class="annot"><span class="annottext">((GenDelegs -&gt; Identity GenDelegs)
 -&gt; CertState era -&gt; Identity (CertState era))
-&gt; GenDelegs -&gt; CertState era -&gt; CertState era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'Genesis) GenDelegPair -&gt; GenDelegs
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Hashes.html#GenDelegs"><span class="hs-identifier hs-var">GenDelegs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyGenesis -&gt; Map (KeyHash 'Genesis) GenDelegPair
</span><a href="Cardano.Ledger.Shelley.Genesis.html#sgGenDelegs"><span class="hs-identifier hs-var">sgGenDelegs</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis
</span><a href="#local-6989586621679523688"><span class="hs-identifier hs-var">sg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-365"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">esNonMyopic :: NonMyopic
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#esNonMyopic"><span class="hs-identifier hs-var">esNonMyopic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonMyopic
forall a. Default a =&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/data-default-0.8.0.1-9291b190c5bc542cf17f99ce44e9365d143d76b9889465ad3d362701e6cc609e/share/doc/html/src/Data.Default.Internal.html#def"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-366"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-367"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nesRu :: StrictMaybe PulsingRewUpdate
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesRu"><span class="hs-identifier hs-var">nesRu</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StrictMaybe PulsingRewUpdate
forall a. StrictMaybe a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-strict-containers-0.1.5.0-d2741b9ef9564f4a1a3151d17a0f69b9663f5795dd47dab0bbd6117738fcce96/share/doc/html/src/Data.Maybe.Strict.html#SNothing"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-368"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nesPd :: PoolDistr
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesPd"><span class="hs-identifier hs-var">nesPd</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) IndividualPoolStake
-&gt; CompactForm Coin -&gt; PoolDistr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.PoolDistr.html#PoolDistr"><span class="hs-identifier hs-var">PoolDistr</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) IndividualPoolStake
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-369"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stashedAVVMAddresses :: StashedAVVMAddresses era
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#stashedAVVMAddresses"><span class="hs-identifier hs-var">stashedAVVMAddresses</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StashedAVVMAddresses era
forall a. Default a =&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/data-default-0.8.0.1-9291b190c5bc542cf17f99ce44e9365d143d76b9889465ad3d362701e6cc609e/share/doc/html/src/Data.Default.Internal.html#def"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-370"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-372"></span><span>    </span><span class="annot"><a href="#local-6989586621679523682"><span class="hs-identifier hs-type">govState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Governance.html#GovState"><span class="hs-identifier hs-type">GovState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523070"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span id="local-6989586621679523682"><span class="annot"><span class="annottext">govState :: GovState era
</span><a href="#local-6989586621679523682"><span class="hs-identifier hs-var hs-var">govState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-374"></span><span>      </span><span class="annot"><span class="annottext">GovState era
forall era. EraGov era =&gt; GovState era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Governance.html#emptyGovState"><span class="hs-identifier hs-var">emptyGovState</span></a></span><span>
</span><span id="line-375"></span><span>        </span><span class="annot"><span class="annottext">GovState era -&gt; (GovState era -&gt; GovState era) -&gt; GovState era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(PParams era -&gt; Identity (PParams era))
-&gt; GovState era -&gt; Identity (GovState era)
forall era. EraGov era =&gt; Lens' (GovState era) (PParams era)
Lens' (GovState era) (PParams era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Governance.html#curPParamsGovStateL"><span class="hs-identifier hs-var">curPParamsGovStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((PParams era -&gt; Identity (PParams era))
 -&gt; GovState era -&gt; Identity (GovState era))
-&gt; PParams era -&gt; GovState era -&gt; GovState era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679523680"><span class="hs-identifier hs-var">pp</span></a></span><span>
</span><span id="line-376"></span><span>        </span><span class="annot"><span class="annottext">GovState era -&gt; (GovState era -&gt; GovState era) -&gt; GovState era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(PParams era -&gt; Identity (PParams era))
-&gt; GovState era -&gt; Identity (GovState era)
forall era. EraGov era =&gt; Lens' (GovState era) (PParams era)
Lens' (GovState era) (PParams era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Governance.html#prevPParamsGovStateL"><span class="hs-identifier hs-var">prevPParamsGovStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((PParams era -&gt; Identity (PParams era))
 -&gt; GovState era -&gt; Identity (GovState era))
-&gt; PParams era -&gt; GovState era -&gt; GovState era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">PParams era
</span><a href="#local-6989586621679523680"><span class="hs-identifier hs-var">pp</span></a></span><span>
</span><span id="line-377"></span><span>    </span><span class="annot"><a href="#local-6989586621679523680"><span class="hs-identifier hs-type">pp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#PParams"><span class="hs-identifier hs-type">PParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523070"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-378"></span><span>    </span><span id="local-6989586621679523680"><span class="annot"><span class="annottext">pp :: PParams era
</span><a href="#local-6989586621679523680"><span class="hs-identifier hs-var hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523658"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
-&gt; Getting (PParams era) (TransitionConfig era) (PParams era)
-&gt; PParams era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (PParams era) (TransitionConfig era) (PParams era)
forall era.
EraTransition era =&gt;
SimpleGetter (TransitionConfig era) (PParams era)
SimpleGetter (TransitionConfig era) (PParams era)
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcInitialPParamsG"><span class="hs-identifier hs-var">tcInitialPParamsG</span></a></span><span>
</span><span id="line-379"></span><span>    </span><span class="annot"><a href="#local-6989586621679523688"><span class="hs-identifier hs-type">sg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Genesis.html#ShelleyGenesis"><span class="hs-identifier hs-type">ShelleyGenesis</span></a></span><span>
</span><span id="line-380"></span><span>    </span><span id="local-6989586621679523688"><span class="annot"><span class="annottext">sg :: ShelleyGenesis
</span><a href="#local-6989586621679523688"><span class="hs-identifier hs-var hs-var">sg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523658"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
-&gt; Getting ShelleyGenesis (TransitionConfig era) ShelleyGenesis
-&gt; ShelleyGenesis
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting ShelleyGenesis (TransitionConfig era) ShelleyGenesis
forall era.
EraTransition era =&gt;
Lens' (TransitionConfig era) ShelleyGenesis
Lens' (TransitionConfig era) ShelleyGenesis
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcShelleyGenesisL"><span class="hs-identifier hs-var">tcShelleyGenesisL</span></a></span><span>
</span><span id="line-381"></span><span>    </span><span class="annot"><a href="#local-6989586621679523661"><span class="hs-identifier hs-type">initialEpochNo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-type">EpochNo</span></a></span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621679523661"><span class="annot"><span class="annottext">initialEpochNo :: EpochNo
</span><a href="#local-6989586621679523661"><span class="hs-identifier hs-var hs-var">initialEpochNo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; EpochNo
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/cardano-slotting-0.2.0.1-cbaa0d455a08b054bafb132b87b34221d87bbbacf98d60661b1ed3cfc20b13c4/share/doc/html/src/Cardano.Slotting.Slot.html#EpochNo"><span class="hs-identifier hs-var">EpochNo</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><a href="#local-6989586621679523681"><span class="hs-identifier hs-type">initialUtxo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523070"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-384"></span><span>    </span><span id="local-6989586621679523681"><span class="annot"><span class="annottext">initialUtxo :: UTxO era
</span><a href="#local-6989586621679523681"><span class="hs-identifier hs-var hs-var">initialUtxo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTxO era
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><a href="#local-6989586621679523673"><span class="hs-identifier hs-type">reserves</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-386"></span><span>    </span><span id="local-6989586621679523673"><span class="annot"><span class="annottext">reserves :: Coin
</span><a href="#local-6989586621679523673"><span class="hs-identifier hs-var hs-var">reserves</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#word64ToCoin"><span class="hs-identifier hs-var">word64ToCoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyGenesis -&gt; Word64
</span><a href="Cardano.Ledger.Shelley.Genesis.html#sgMaxLovelaceSupply"><span class="hs-identifier hs-var">sgMaxLovelaceSupply</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyGenesis
</span><a href="#local-6989586621679523688"><span class="hs-identifier hs-var">sg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall t. Val t =&gt; t -&gt; t -&gt; t
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era -&gt; Coin
forall era. EraTxOut era =&gt; UTxO era -&gt; Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#sumCoinUTxO"><span class="hs-identifier hs-var">sumCoinUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679523681"><span class="hs-identifier hs-var">initialUtxo</span></a></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="annot"><span class="hs-comment">-- | Register initial stake pools from the `ShelleyGenesisStaking`</span></span><span>
</span><span id="line-389"></span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#registerInitialStakePools"><span class="hs-identifier hs-type">registerInitialStakePools</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679522996"><span class="annot"><a href="#local-6989586621679522996"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#EraCertState"><span class="hs-identifier hs-type">EraCertState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522996"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Governance.html#EraGov"><span class="hs-identifier hs-type">EraGov</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522996"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-392"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Genesis.html#ShelleyGenesisStaking"><span class="hs-identifier hs-type">ShelleyGenesisStaking</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-393"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522996"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-394"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522996"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-395"></span><span id="registerInitialStakePools"><span class="annot"><span class="annottext">registerInitialStakePools :: forall era.
(EraCertState era, EraGov era) =&gt;
ShelleyGenesisStaking -&gt; NewEpochState era -&gt; NewEpochState era
</span><a href="Cardano.Ledger.Shelley.Transition.html#registerInitialStakePools"><span class="hs-identifier hs-var hs-var">registerInitialStakePools</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Genesis.html#ShelleyGenesisStaking"><span class="hs-identifier hs-type">ShelleyGenesisStaking</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679523722"><span class="annot"><span class="annottext">ListMap (KeyHash 'StakePool) PoolParams
sgsPools :: ListMap (KeyHash 'StakePool) PoolParams
sgsPools :: ShelleyGenesisStaking -&gt; ListMap (KeyHash 'StakePool) PoolParams
</span><a href="#local-6989586621679523722"><span class="hs-identifier hs-var hs-var">sgsPools</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679523724"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679523724"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679523724"><span class="hs-identifier hs-var">nes</span></a></span><span>
</span><span id="line-397"></span><span>    </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; (NewEpochState era -&gt; NewEpochState era) -&gt; NewEpochState era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(EpochState era -&gt; Identity (EpochState era))
-&gt; NewEpochState era -&gt; Identity (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era -&gt; Identity (EpochState era))
 -&gt; NewEpochState era -&gt; Identity (NewEpochState era))
-&gt; ((Map (KeyHash 'StakePool) StakePoolState
     -&gt; Identity (Map (KeyHash 'StakePool) StakePoolState))
    -&gt; EpochState era -&gt; Identity (EpochState era))
-&gt; (Map (KeyHash 'StakePool) StakePoolState
    -&gt; Identity (Map (KeyHash 'StakePool) StakePoolState))
-&gt; NewEpochState era
-&gt; Identity (NewEpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LedgerState era -&gt; Identity (LedgerState era))
-&gt; EpochState era -&gt; Identity (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">esLStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LedgerState era -&gt; Identity (LedgerState era))
 -&gt; EpochState era -&gt; Identity (EpochState era))
-&gt; ((Map (KeyHash 'StakePool) StakePoolState
     -&gt; Identity (Map (KeyHash 'StakePool) StakePoolState))
    -&gt; LedgerState era -&gt; Identity (LedgerState era))
-&gt; (Map (KeyHash 'StakePool) StakePoolState
    -&gt; Identity (Map (KeyHash 'StakePool) StakePoolState))
-&gt; EpochState era
-&gt; Identity (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CertState era -&gt; Identity (CertState era))
-&gt; LedgerState era -&gt; Identity (LedgerState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">lsCertStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CertState era -&gt; Identity (CertState era))
 -&gt; LedgerState era -&gt; Identity (LedgerState era))
-&gt; ((Map (KeyHash 'StakePool) StakePoolState
     -&gt; Identity (Map (KeyHash 'StakePool) StakePoolState))
    -&gt; CertState era -&gt; Identity (CertState era))
-&gt; (Map (KeyHash 'StakePool) StakePoolState
    -&gt; Identity (Map (KeyHash 'StakePool) StakePoolState))
-&gt; LedgerState era
-&gt; Identity (LedgerState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PState era -&gt; Identity (PState era))
-&gt; CertState era -&gt; Identity (CertState era)
forall era. EraCertState era =&gt; Lens' (CertState era) (PState era)
Lens' (CertState era) (PState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#certPStateL"><span class="hs-identifier hs-var">certPStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((PState era -&gt; Identity (PState era))
 -&gt; CertState era -&gt; Identity (CertState era))
-&gt; ((Map (KeyHash 'StakePool) StakePoolState
     -&gt; Identity (Map (KeyHash 'StakePool) StakePoolState))
    -&gt; PState era -&gt; Identity (PState era))
-&gt; (Map (KeyHash 'StakePool) StakePoolState
    -&gt; Identity (Map (KeyHash 'StakePool) StakePoolState))
-&gt; CertState era
-&gt; Identity (CertState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) StakePoolState
 -&gt; Identity (Map (KeyHash 'StakePool) StakePoolState))
-&gt; PState era -&gt; Identity (PState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(Map (KeyHash 'StakePool) StakePoolState
 -&gt; f (Map (KeyHash 'StakePool) StakePoolState))
-&gt; PState era -&gt; f (PState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#psStakePoolsL"><span class="hs-identifier hs-var">psStakePoolsL</span></a></span><span>
</span><span id="line-398"></span><span>      </span><span class="annot"><span class="annottext">((Map (KeyHash 'StakePool) StakePoolState
  -&gt; Identity (Map (KeyHash 'StakePool) StakePoolState))
 -&gt; NewEpochState era -&gt; Identity (NewEpochState era))
-&gt; Map (KeyHash 'StakePool) StakePoolState
-&gt; NewEpochState era
-&gt; NewEpochState era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">ListMap (KeyHash 'StakePool) StakePoolState
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall k v. Ord k =&gt; ListMap k v -&gt; Map k v
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.ListMap.html#toMap"><span class="hs-identifier hs-var">ListMap.toMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompactForm Coin -&gt; PoolParams -&gt; StakePoolState
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.StakePool.html#mkStakePoolState"><span class="hs-identifier hs-var">mkStakePoolState</span></a></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621679523732"><span class="hs-identifier hs-var">deposit</span></a></span><span> </span><span class="annot"><span class="annottext">(PoolParams -&gt; StakePoolState)
-&gt; ListMap (KeyHash 'StakePool) PoolParams
-&gt; ListMap (KeyHash 'StakePool) StakePoolState
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ListMap (KeyHash 'StakePool) PoolParams
</span><a href="#local-6989586621679523722"><span class="hs-identifier hs-var">sgsPools</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-400"></span><span>    </span><span id="local-6989586621679523732"><span class="annot"><span class="annottext">deposit :: CompactForm Coin
</span><a href="#local-6989586621679523732"><span class="hs-identifier hs-var hs-var">deposit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679523724"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting
     (CompactForm Coin) (NewEpochState era) (CompactForm Coin)
-&gt; CompactForm Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era -&gt; Const (CompactForm Coin) (EpochState era))
-&gt; NewEpochState era
-&gt; Const (CompactForm Coin) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era -&gt; Const (CompactForm Coin) (EpochState era))
 -&gt; NewEpochState era
 -&gt; Const (CompactForm Coin) (NewEpochState era))
-&gt; ((CompactForm Coin
     -&gt; Const (CompactForm Coin) (CompactForm Coin))
    -&gt; EpochState era -&gt; Const (CompactForm Coin) (EpochState era))
-&gt; Getting
     (CompactForm Coin) (NewEpochState era) (CompactForm Coin)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PParams era -&gt; Const (CompactForm Coin) (PParams era))
-&gt; EpochState era -&gt; Const (CompactForm Coin) (EpochState era)
forall era. EraGov era =&gt; Lens' (EpochState era) (PParams era)
Lens' (EpochState era) (PParams era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#curPParamsEpochStateL"><span class="hs-identifier hs-var">curPParamsEpochStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((PParams era -&gt; Const (CompactForm Coin) (PParams era))
 -&gt; EpochState era -&gt; Const (CompactForm Coin) (EpochState era))
-&gt; ((CompactForm Coin
     -&gt; Const (CompactForm Coin) (CompactForm Coin))
    -&gt; PParams era -&gt; Const (CompactForm Coin) (PParams era))
-&gt; (CompactForm Coin
    -&gt; Const (CompactForm Coin) (CompactForm Coin))
-&gt; EpochState era
-&gt; Const (CompactForm Coin) (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CompactForm Coin -&gt; Const (CompactForm Coin) (CompactForm Coin))
-&gt; PParams era -&gt; Const (CompactForm Coin) (PParams era)
forall era.
EraPParams era =&gt;
Lens' (PParams era) (CompactForm Coin)
Lens' (PParams era) (CompactForm Coin)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#ppPoolDepositCompactL"><span class="hs-identifier hs-var">ppPoolDepositCompactL</span></a></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="hs-comment">-- | Register all staking credentials and apply delegations. Make sure StakePools that are bing</span><span>
</span><span id="line-403"></span><span class="hs-comment">-- delegated to are already registered, which can be done with `registerInitialStakePools`.</span><span>
</span><span id="line-404"></span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#shelleyRegisterInitialAccounts"><span class="hs-identifier hs-type">shelleyRegisterInitialAccounts</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679522994"><span class="annot"><a href="#local-6989586621679522994"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.State.Account.html#ShelleyEraAccounts"><span class="hs-identifier hs-type">ShelleyEraAccounts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522994"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#EraCertState"><span class="hs-identifier hs-type">EraCertState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522994"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Governance.html#EraGov"><span class="hs-identifier hs-type">EraGov</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522994"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-407"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Genesis.html#ShelleyGenesisStaking"><span class="hs-identifier hs-type">ShelleyGenesisStaking</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-408"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522994"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-409"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522994"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-410"></span><span id="shelleyRegisterInitialAccounts"><span class="annot"><span class="annottext">shelleyRegisterInitialAccounts :: forall era.
(HasCallStack, ShelleyEraAccounts era, EraCertState era,
 EraGov era) =&gt;
ShelleyGenesisStaking -&gt; NewEpochState era -&gt; NewEpochState era
</span><a href="Cardano.Ledger.Shelley.Transition.html#shelleyRegisterInitialAccounts"><span class="hs-identifier hs-var hs-var">shelleyRegisterInitialAccounts</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Genesis.html#ShelleyGenesisStaking"><span class="hs-identifier hs-type">ShelleyGenesisStaking</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679523775"><span class="annot"><span class="annottext">ListMap (KeyHash 'Staking) (KeyHash 'StakePool)
sgsStake :: ListMap (KeyHash 'Staking) (KeyHash 'StakePool)
sgsStake :: ShelleyGenesisStaking
-&gt; ListMap (KeyHash 'Staking) (KeyHash 'StakePool)
</span><a href="#local-6989586621679523775"><span class="hs-identifier hs-var hs-var">sgsStake</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679523777"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679523777"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-411"></span><span>  </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679523777"><span class="hs-identifier hs-var">nes</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; (NewEpochState era -&gt; NewEpochState era) -&gt; NewEpochState era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(EpochState era -&gt; Identity (EpochState era))
-&gt; NewEpochState era -&gt; Identity (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era -&gt; Identity (EpochState era))
 -&gt; NewEpochState era -&gt; Identity (NewEpochState era))
-&gt; ((Accounts era -&gt; Identity (Accounts era))
    -&gt; EpochState era -&gt; Identity (EpochState era))
-&gt; (Accounts era -&gt; Identity (Accounts era))
-&gt; NewEpochState era
-&gt; Identity (NewEpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LedgerState era -&gt; Identity (LedgerState era))
-&gt; EpochState era -&gt; Identity (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">esLStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LedgerState era -&gt; Identity (LedgerState era))
 -&gt; EpochState era -&gt; Identity (EpochState era))
-&gt; ((Accounts era -&gt; Identity (Accounts era))
    -&gt; LedgerState era -&gt; Identity (LedgerState era))
-&gt; (Accounts era -&gt; Identity (Accounts era))
-&gt; EpochState era
-&gt; Identity (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CertState era -&gt; Identity (CertState era))
-&gt; LedgerState era -&gt; Identity (LedgerState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">lsCertStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CertState era -&gt; Identity (CertState era))
 -&gt; LedgerState era -&gt; Identity (LedgerState era))
-&gt; ((Accounts era -&gt; Identity (Accounts era))
    -&gt; CertState era -&gt; Identity (CertState era))
-&gt; (Accounts era -&gt; Identity (Accounts era))
-&gt; LedgerState era
-&gt; Identity (LedgerState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DState era -&gt; Identity (DState era))
-&gt; CertState era -&gt; Identity (CertState era)
forall era. EraCertState era =&gt; Lens' (CertState era) (DState era)
Lens' (CertState era) (DState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#certDStateL"><span class="hs-identifier hs-var">certDStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((DState era -&gt; Identity (DState era))
 -&gt; CertState era -&gt; Identity (CertState era))
-&gt; ((Accounts era -&gt; Identity (Accounts era))
    -&gt; DState era -&gt; Identity (DState era))
-&gt; (Accounts era -&gt; Identity (Accounts era))
-&gt; CertState era
-&gt; Identity (CertState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Accounts era -&gt; Identity (Accounts era))
-&gt; DState era -&gt; Identity (DState era)
forall era. Lens' (DState era) (Accounts era)
forall (t :: * -&gt; *) era.
CanSetAccounts t =&gt;
Lens' (t era) (Accounts era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Account.html#accountsL"><span class="hs-identifier hs-var">accountsL</span></a></span><span> </span><span class="annot"><span class="annottext">((Accounts era -&gt; Identity (Accounts era))
 -&gt; NewEpochState era -&gt; Identity (NewEpochState era))
-&gt; (Accounts era -&gt; Accounts era)
-&gt; NewEpochState era
-&gt; NewEpochState era
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%25~"><span class="hs-operator hs-var">%~</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679523780"><span class="annot"><span class="annottext">Accounts era
</span><a href="#local-6989586621679523780"><span class="hs-identifier hs-var">initAccounts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-413"></span><span>      </span><span class="annot"><span class="annottext">(((KeyHash 'Staking, KeyHash 'StakePool), Ptr)
 -&gt; Accounts era -&gt; Accounts era)
-&gt; Accounts era
-&gt; [((KeyHash 'Staking, KeyHash 'StakePool), Ptr)]
-&gt; Accounts era
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">((KeyHash 'Staking, KeyHash 'StakePool), Ptr)
-&gt; Accounts era -&gt; Accounts era
</span><a href="#local-6989586621679523782"><span class="hs-identifier hs-var">registerAndDelegate</span></a></span><span> </span><span class="annot"><span class="annottext">Accounts era
</span><a href="#local-6989586621679523780"><span class="hs-identifier hs-var">initAccounts</span></a></span><span> </span><span class="annot"><span class="annottext">([((KeyHash 'Staking, KeyHash 'StakePool), Ptr)] -&gt; Accounts era)
-&gt; [((KeyHash 'Staking, KeyHash 'StakePool), Ptr)] -&gt; Accounts era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(KeyHash 'Staking, KeyHash 'StakePool)]
-&gt; [Ptr] -&gt; [((KeyHash 'Staking, KeyHash 'StakePool), Ptr)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ListMap (KeyHash 'Staking) (KeyHash 'StakePool)
-&gt; [(KeyHash 'Staking, KeyHash 'StakePool)]
forall k v. ListMap k v -&gt; [(k, v)]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.ListMap.html#toList"><span class="hs-identifier hs-var">ListMap.toList</span></a></span><span> </span><span class="annot"><span class="annottext">ListMap (KeyHash 'Staking) (KeyHash 'StakePool)
</span><a href="#local-6989586621679523775"><span class="hs-identifier hs-var">sgsStake</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ptr]
</span><a href="#local-6989586621679523784"><span class="hs-identifier hs-var">ptrs</span></a></span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-415"></span><span>    </span><span id="local-6989586621679523785"><span class="annot"><span class="annottext">stakePools :: Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621679523785"><span class="hs-identifier hs-var hs-var">stakePools</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679523777"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting
     (Map (KeyHash 'StakePool) StakePoolState)
     (NewEpochState era)
     (Map (KeyHash 'StakePool) StakePoolState)
-&gt; Map (KeyHash 'StakePool) StakePoolState
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState) (EpochState era))
-&gt; NewEpochState era
-&gt; Const
     (Map (KeyHash 'StakePool) StakePoolState) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era
  -&gt; Const
       (Map (KeyHash 'StakePool) StakePoolState) (EpochState era))
 -&gt; NewEpochState era
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState) (NewEpochState era))
-&gt; ((Map (KeyHash 'StakePool) StakePoolState
     -&gt; Const
          (Map (KeyHash 'StakePool) StakePoolState)
          (Map (KeyHash 'StakePool) StakePoolState))
    -&gt; EpochState era
    -&gt; Const
         (Map (KeyHash 'StakePool) StakePoolState) (EpochState era))
-&gt; Getting
     (Map (KeyHash 'StakePool) StakePoolState)
     (NewEpochState era)
     (Map (KeyHash 'StakePool) StakePoolState)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LedgerState era
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era))
-&gt; EpochState era
-&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">esLStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LedgerState era
  -&gt; Const
       (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era))
 -&gt; EpochState era
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState) (EpochState era))
-&gt; ((Map (KeyHash 'StakePool) StakePoolState
     -&gt; Const
          (Map (KeyHash 'StakePool) StakePoolState)
          (Map (KeyHash 'StakePool) StakePoolState))
    -&gt; LedgerState era
    -&gt; Const
         (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era))
-&gt; (Map (KeyHash 'StakePool) StakePoolState
    -&gt; Const
         (Map (KeyHash 'StakePool) StakePoolState)
         (Map (KeyHash 'StakePool) StakePoolState))
-&gt; EpochState era
-&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CertState era
 -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era))
-&gt; LedgerState era
-&gt; Const
     (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">lsCertStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CertState era
  -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era))
 -&gt; LedgerState era
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era))
-&gt; ((Map (KeyHash 'StakePool) StakePoolState
     -&gt; Const
          (Map (KeyHash 'StakePool) StakePoolState)
          (Map (KeyHash 'StakePool) StakePoolState))
    -&gt; CertState era
    -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era))
-&gt; (Map (KeyHash 'StakePool) StakePoolState
    -&gt; Const
         (Map (KeyHash 'StakePool) StakePoolState)
         (Map (KeyHash 'StakePool) StakePoolState))
-&gt; LedgerState era
-&gt; Const
     (Map (KeyHash 'StakePool) StakePoolState) (LedgerState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PState era
 -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (PState era))
-&gt; CertState era
-&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era)
forall era. EraCertState era =&gt; Lens' (CertState era) (PState era)
Lens' (CertState era) (PState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#certPStateL"><span class="hs-identifier hs-var">certPStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((PState era
  -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (PState era))
 -&gt; CertState era
 -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era))
-&gt; ((Map (KeyHash 'StakePool) StakePoolState
     -&gt; Const
          (Map (KeyHash 'StakePool) StakePoolState)
          (Map (KeyHash 'StakePool) StakePoolState))
    -&gt; PState era
    -&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (PState era))
-&gt; (Map (KeyHash 'StakePool) StakePoolState
    -&gt; Const
         (Map (KeyHash 'StakePool) StakePoolState)
         (Map (KeyHash 'StakePool) StakePoolState))
-&gt; CertState era
-&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (CertState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map (KeyHash 'StakePool) StakePoolState
 -&gt; Const
      (Map (KeyHash 'StakePool) StakePoolState)
      (Map (KeyHash 'StakePool) StakePoolState))
-&gt; PState era
-&gt; Const (Map (KeyHash 'StakePool) StakePoolState) (PState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(Map (KeyHash 'StakePool) StakePoolState
 -&gt; f (Map (KeyHash 'StakePool) StakePoolState))
-&gt; PState era -&gt; f (PState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#psStakePoolsL"><span class="hs-identifier hs-var">psStakePoolsL</span></a></span><span>
</span><span id="line-416"></span><span>    </span><span id="local-6989586621679523786"><span class="annot"><span class="annottext">deposit :: CompactForm Coin
</span><a href="#local-6989586621679523786"><span class="hs-identifier hs-var hs-var">deposit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Coin -&gt; CompactForm Coin
Coin -&gt; CompactForm Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Coin.html#compactCoinOrError"><span class="hs-identifier hs-var">compactCoinOrError</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; CompactForm Coin) -&gt; Coin -&gt; CompactForm Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679523777"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era -&gt; Getting Coin (NewEpochState era) Coin -&gt; Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era -&gt; Const Coin (EpochState era))
-&gt; NewEpochState era -&gt; Const Coin (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era -&gt; Const Coin (EpochState era))
 -&gt; NewEpochState era -&gt; Const Coin (NewEpochState era))
-&gt; ((Coin -&gt; Const Coin Coin)
    -&gt; EpochState era -&gt; Const Coin (EpochState era))
-&gt; Getting Coin (NewEpochState era) Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PParams era -&gt; Const Coin (PParams era))
-&gt; EpochState era -&gt; Const Coin (EpochState era)
forall era. EraGov era =&gt; Lens' (EpochState era) (PParams era)
Lens' (EpochState era) (PParams era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#curPParamsEpochStateL"><span class="hs-identifier hs-var">curPParamsEpochStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((PParams era -&gt; Const Coin (PParams era))
 -&gt; EpochState era -&gt; Const Coin (EpochState era))
-&gt; ((Coin -&gt; Const Coin Coin)
    -&gt; PParams era -&gt; Const Coin (PParams era))
-&gt; (Coin -&gt; Const Coin Coin)
-&gt; EpochState era
-&gt; Const Coin (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Const Coin Coin)
-&gt; PParams era -&gt; Const Coin (PParams era)
forall era. EraPParams era =&gt; Lens' (PParams era) Coin
Lens' (PParams era) Coin
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.PParams.html#ppKeyDepositL"><span class="hs-identifier hs-var">ppKeyDepositL</span></a></span><span>
</span><span id="line-417"></span><span>    </span><span id="local-6989586621679523782"><span class="annot"><span class="annottext">registerAndDelegate :: ((KeyHash 'Staking, KeyHash 'StakePool), Ptr)
-&gt; Accounts era -&gt; Accounts era
</span><a href="#local-6989586621679523782"><span class="hs-identifier hs-var hs-var">registerAndDelegate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679523789"><span class="annot"><span class="annottext">KeyHash 'Staking
</span><a href="#local-6989586621679523789"><span class="hs-identifier hs-var">stakeKeyHash</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679523790"><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621679523790"><span class="hs-identifier hs-var">stakePool</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679523791"><span class="annot"><span class="annottext">Ptr
</span><a href="#local-6989586621679523791"><span class="hs-identifier hs-var">ptr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679523792"><span class="annot"><span class="annottext">Accounts era
</span><a href="#local-6989586621679523792"><span class="hs-identifier hs-var">accounts</span></a></span></span><span>
</span><span id="line-418"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621679523790"><span class="hs-identifier hs-var">stakePool</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
-&gt; Map (KeyHash 'StakePool) StakePoolState -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-operator hs-var">`Map.member`</span></span><span> </span><span class="annot"><span class="annottext">Map (KeyHash 'StakePool) StakePoolState
</span><a href="#local-6989586621679523785"><span class="hs-identifier hs-var">stakePools</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-419"></span><span>          </span><span class="annot"><span class="annottext">Credential 'Staking
-&gt; Ptr
-&gt; CompactForm Coin
-&gt; Maybe (KeyHash 'StakePool)
-&gt; Accounts era
-&gt; Accounts era
forall era.
ShelleyEraAccounts era =&gt;
Credential 'Staking
-&gt; Ptr
-&gt; CompactForm Coin
-&gt; Maybe (KeyHash 'StakePool)
-&gt; Accounts era
-&gt; Accounts era
</span><a href="Cardano.Ledger.Shelley.State.Account.html#registerShelleyAccount"><span class="hs-identifier hs-var">registerShelleyAccount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'Staking -&gt; Credential 'Staking
forall (kr :: KeyRole). KeyHash kr -&gt; Credential kr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#KeyHashObj"><span class="hs-identifier hs-var">KeyHashObj</span></a></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Staking
</span><a href="#local-6989586621679523789"><span class="hs-identifier hs-var">stakeKeyHash</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ptr
</span><a href="#local-6989586621679523791"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">CompactForm Coin
</span><a href="#local-6989586621679523786"><span class="hs-identifier hs-var">deposit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; Maybe (KeyHash 'StakePool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621679523790"><span class="hs-identifier hs-var">stakePool</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Accounts era
</span><a href="#local-6989586621679523792"><span class="hs-identifier hs-var">accounts</span></a></span><span>
</span><span id="line-420"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-421"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; Accounts era
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Accounts era) -&gt; String -&gt; Accounts era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-422"></span><span>            </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invariant of a delegation of &quot;</span></span><span>
</span><span id="line-423"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Staking -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'Staking
</span><a href="#local-6989586621679523789"><span class="hs-identifier hs-var">stakeKeyHash</span></a></span><span>
</span><span id="line-424"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; to an unregistered stake pool &quot;</span></span><span>
</span><span id="line-425"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">KeyHash 'StakePool
</span><a href="#local-6989586621679523790"><span class="hs-identifier hs-var">stakePool</span></a></span><span>
</span><span id="line-426"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; is being violated.&quot;</span></span><span>
</span><span id="line-427"></span><span>    </span><span id="local-6989586621679523784"><span class="annot"><span class="annottext">ptrs :: [Ptr]
</span><a href="#local-6989586621679523784"><span class="hs-identifier hs-var hs-var">ptrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-428"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SlotNo32 -&gt; TxIx -&gt; CertIx -&gt; Ptr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Credential.html#Ptr"><span class="hs-identifier hs-var">Ptr</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo32
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">minBound</span></span><span> </span><span class="annot"><span class="annottext">TxIx
</span><a href="#local-6989586621679523811"><span class="hs-identifier hs-var">txIx</span></a></span><span> </span><span class="annot"><span class="annottext">CertIx
</span><a href="#local-6989586621679523812"><span class="hs-identifier hs-var">certIx</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679523811"><span class="annot"><span class="annottext">TxIx
</span><a href="#local-6989586621679523811"><span class="hs-identifier hs-var">txIx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TxIx
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">minBound</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">TxIx
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679523812"><span class="annot"><span class="annottext">CertIx
</span><a href="#local-6989586621679523812"><span class="hs-identifier hs-var">certIx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CertIx
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">minBound</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">CertIx
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span class="hs-special">]</span><span>
</span><span id="line-429"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="hs-comment">-- | Having initial funds, stake pools and accounts with delegations, we need to reset the stake</span><span>
</span><span id="line-432"></span><span class="hs-comment">-- distribution, otherwise those initial stake pools will not be able to produce blocks</span><span>
</span><span id="line-433"></span><span id="local-6989586621679522993"><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#resetStakeDistribution"><span class="hs-identifier hs-type">resetStakeDistribution</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-434"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#EraCertState"><span class="hs-identifier hs-type">EraCertState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522993"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Stake.html#EraStake"><span class="hs-identifier hs-type">EraStake</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522993"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-435"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522993"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-436"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522993"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-437"></span><span id="resetStakeDistribution"><span class="annot"><span class="annottext">resetStakeDistribution :: forall era.
(EraCertState era, EraStake era) =&gt;
NewEpochState era -&gt; NewEpochState era
</span><a href="Cardano.Ledger.Shelley.Transition.html#resetStakeDistribution"><span class="hs-identifier hs-var hs-var">resetStakeDistribution</span></a></span></span><span> </span><span id="local-6989586621679523841"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679523841"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-438"></span><span>  </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679523841"><span class="hs-identifier hs-var">nes</span></a></span><span>
</span><span id="line-439"></span><span>    </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; (NewEpochState era -&gt; NewEpochState era) -&gt; NewEpochState era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(EpochState era -&gt; Identity (EpochState era))
-&gt; NewEpochState era -&gt; Identity (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era -&gt; Identity (EpochState era))
 -&gt; NewEpochState era -&gt; Identity (NewEpochState era))
-&gt; ((SnapShot -&gt; Identity SnapShot)
    -&gt; EpochState era -&gt; Identity (EpochState era))
-&gt; (SnapShot -&gt; Identity SnapShot)
-&gt; NewEpochState era
-&gt; Identity (NewEpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SnapShots -&gt; Identity SnapShots)
-&gt; EpochState era -&gt; Identity (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(SnapShots -&gt; f SnapShots) -&gt; EpochState era -&gt; f (EpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#esSnapshotsL"><span class="hs-identifier hs-var">esSnapshotsL</span></a></span><span> </span><span class="annot"><span class="annottext">((SnapShots -&gt; Identity SnapShots)
 -&gt; EpochState era -&gt; Identity (EpochState era))
-&gt; ((SnapShot -&gt; Identity SnapShot)
    -&gt; SnapShots -&gt; Identity SnapShots)
-&gt; (SnapShot -&gt; Identity SnapShot)
-&gt; EpochState era
-&gt; Identity (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SnapShot -&gt; Identity SnapShot) -&gt; SnapShots -&gt; Identity SnapShots
Lens' SnapShots SnapShot
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.SnapShots.html#ssStakeMarkL"><span class="hs-identifier hs-var">ssStakeMarkL</span></a></span><span> </span><span class="annot"><span class="annottext">((SnapShot -&gt; Identity SnapShot)
 -&gt; NewEpochState era -&gt; Identity (NewEpochState era))
-&gt; SnapShot -&gt; NewEpochState era -&gt; NewEpochState era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">SnapShot
</span><a href="#local-6989586621679523844"><span class="hs-identifier hs-var">initSnapShot</span></a></span><span>
</span><span id="line-440"></span><span>    </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; (NewEpochState era -&gt; NewEpochState era) -&gt; NewEpochState era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(EpochState era -&gt; Identity (EpochState era))
-&gt; NewEpochState era -&gt; Identity (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era -&gt; Identity (EpochState era))
 -&gt; NewEpochState era -&gt; Identity (NewEpochState era))
-&gt; ((PoolDistr -&gt; Identity PoolDistr)
    -&gt; EpochState era -&gt; Identity (EpochState era))
-&gt; (PoolDistr -&gt; Identity PoolDistr)
-&gt; NewEpochState era
-&gt; Identity (NewEpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SnapShots -&gt; Identity SnapShots)
-&gt; EpochState era -&gt; Identity (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(SnapShots -&gt; f SnapShots) -&gt; EpochState era -&gt; f (EpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#esSnapshotsL"><span class="hs-identifier hs-var">esSnapshotsL</span></a></span><span> </span><span class="annot"><span class="annottext">((SnapShots -&gt; Identity SnapShots)
 -&gt; EpochState era -&gt; Identity (EpochState era))
-&gt; ((PoolDistr -&gt; Identity PoolDistr)
    -&gt; SnapShots -&gt; Identity SnapShots)
-&gt; (PoolDistr -&gt; Identity PoolDistr)
-&gt; EpochState era
-&gt; Identity (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PoolDistr -&gt; Identity PoolDistr)
-&gt; SnapShots -&gt; Identity SnapShots
Lens' SnapShots PoolDistr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.SnapShots.html#ssStakeMarkPoolDistrL"><span class="hs-identifier hs-var">ssStakeMarkPoolDistrL</span></a></span><span> </span><span class="annot"><span class="annottext">((PoolDistr -&gt; Identity PoolDistr)
 -&gt; NewEpochState era -&gt; Identity (NewEpochState era))
-&gt; PoolDistr -&gt; NewEpochState era -&gt; NewEpochState era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">PoolDistr
</span><a href="#local-6989586621679523846"><span class="hs-identifier hs-var">poolDistr</span></a></span><span>
</span><span id="line-441"></span><span>    </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; (NewEpochState era -&gt; NewEpochState era) -&gt; NewEpochState era
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(PoolDistr -&gt; Identity PoolDistr)
-&gt; NewEpochState era -&gt; Identity (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(PoolDistr -&gt; f PoolDistr)
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesPdL"><span class="hs-identifier hs-var">nesPdL</span></a></span><span> </span><span class="annot"><span class="annottext">((PoolDistr -&gt; Identity PoolDistr)
 -&gt; NewEpochState era -&gt; Identity (NewEpochState era))
-&gt; PoolDistr -&gt; NewEpochState era -&gt; NewEpochState era
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">PoolDistr
</span><a href="#local-6989586621679523846"><span class="hs-identifier hs-var">poolDistr</span></a></span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-443"></span><span>    </span><span id="local-6989586621679523848"><span class="annot"><span class="annottext">dState :: DState era
</span><a href="#local-6989586621679523848"><span class="hs-identifier hs-var hs-var">dState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679523841"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting (DState era) (NewEpochState era) (DState era)
-&gt; DState era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era -&gt; Const (DState era) (EpochState era))
-&gt; NewEpochState era -&gt; Const (DState era) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era -&gt; Const (DState era) (EpochState era))
 -&gt; NewEpochState era -&gt; Const (DState era) (NewEpochState era))
-&gt; ((DState era -&gt; Const (DState era) (DState era))
    -&gt; EpochState era -&gt; Const (DState era) (EpochState era))
-&gt; Getting (DState era) (NewEpochState era) (DState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LedgerState era -&gt; Const (DState era) (LedgerState era))
-&gt; EpochState era -&gt; Const (DState era) (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">esLStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LedgerState era -&gt; Const (DState era) (LedgerState era))
 -&gt; EpochState era -&gt; Const (DState era) (EpochState era))
-&gt; ((DState era -&gt; Const (DState era) (DState era))
    -&gt; LedgerState era -&gt; Const (DState era) (LedgerState era))
-&gt; (DState era -&gt; Const (DState era) (DState era))
-&gt; EpochState era
-&gt; Const (DState era) (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CertState era -&gt; Const (DState era) (CertState era))
-&gt; LedgerState era -&gt; Const (DState era) (LedgerState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">lsCertStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CertState era -&gt; Const (DState era) (CertState era))
 -&gt; LedgerState era -&gt; Const (DState era) (LedgerState era))
-&gt; ((DState era -&gt; Const (DState era) (DState era))
    -&gt; CertState era -&gt; Const (DState era) (CertState era))
-&gt; (DState era -&gt; Const (DState era) (DState era))
-&gt; LedgerState era
-&gt; Const (DState era) (LedgerState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DState era -&gt; Const (DState era) (DState era))
-&gt; CertState era -&gt; Const (DState era) (CertState era)
forall era. EraCertState era =&gt; Lens' (CertState era) (DState era)
Lens' (CertState era) (DState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#certDStateL"><span class="hs-identifier hs-var">certDStateL</span></a></span><span>
</span><span id="line-444"></span><span>    </span><span id="local-6989586621679523849"><span class="annot"><span class="annottext">pState :: PState era
</span><a href="#local-6989586621679523849"><span class="hs-identifier hs-var hs-var">pState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679523841"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting (PState era) (NewEpochState era) (PState era)
-&gt; PState era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(EpochState era -&gt; Const (PState era) (EpochState era))
-&gt; NewEpochState era -&gt; Const (PState era) (NewEpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(EpochState era -&gt; f (EpochState era))
-&gt; NewEpochState era -&gt; f (NewEpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesEsL"><span class="hs-identifier hs-var">nesEsL</span></a></span><span> </span><span class="annot"><span class="annottext">((EpochState era -&gt; Const (PState era) (EpochState era))
 -&gt; NewEpochState era -&gt; Const (PState era) (NewEpochState era))
-&gt; ((PState era -&gt; Const (PState era) (PState era))
    -&gt; EpochState era -&gt; Const (PState era) (EpochState era))
-&gt; Getting (PState era) (NewEpochState era) (PState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LedgerState era -&gt; Const (PState era) (LedgerState era))
-&gt; EpochState era -&gt; Const (PState era) (EpochState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(LedgerState era -&gt; f (LedgerState era))
-&gt; EpochState era -&gt; f (EpochState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#esLStateL"><span class="hs-identifier hs-var">esLStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((LedgerState era -&gt; Const (PState era) (LedgerState era))
 -&gt; EpochState era -&gt; Const (PState era) (EpochState era))
-&gt; ((PState era -&gt; Const (PState era) (PState era))
    -&gt; LedgerState era -&gt; Const (PState era) (LedgerState era))
-&gt; (PState era -&gt; Const (PState era) (PState era))
-&gt; EpochState era
-&gt; Const (PState era) (EpochState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CertState era -&gt; Const (PState era) (CertState era))
-&gt; LedgerState era -&gt; Const (PState era) (LedgerState era)
forall era (f :: * -&gt; *).
Functor f =&gt;
(CertState era -&gt; f (CertState era))
-&gt; LedgerState era -&gt; f (LedgerState era)
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#lsCertStateL"><span class="hs-identifier hs-var">lsCertStateL</span></a></span><span> </span><span class="annot"><span class="annottext">((CertState era -&gt; Const (PState era) (CertState era))
 -&gt; LedgerState era -&gt; Const (PState era) (LedgerState era))
-&gt; ((PState era -&gt; Const (PState era) (PState era))
    -&gt; CertState era -&gt; Const (PState era) (CertState era))
-&gt; (PState era -&gt; Const (PState era) (PState era))
-&gt; LedgerState era
-&gt; Const (PState era) (LedgerState era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PState era -&gt; Const (PState era) (PState era))
-&gt; CertState era -&gt; Const (PState era) (CertState era)
forall era. EraCertState era =&gt; Lens' (CertState era) (PState era)
Lens' (CertState era) (PState era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.CertState.html#certPStateL"><span class="hs-identifier hs-var">certPStateL</span></a></span><span>
</span><span id="line-445"></span><span>    </span><span id="local-6989586621679523846"><span class="annot"><span class="annottext">poolDistr :: PoolDistr
</span><a href="#local-6989586621679523846"><span class="hs-identifier hs-var hs-var">poolDistr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SnapShot -&gt; PoolDistr
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.SnapShots.html#calculatePoolDistr"><span class="hs-identifier hs-var">calculatePoolDistr</span></a></span><span> </span><span class="annot"><span class="annottext">SnapShot
</span><a href="#local-6989586621679523844"><span class="hs-identifier hs-var">initSnapShot</span></a></span><span>
</span><span id="line-446"></span><span>    </span><span class="hs-comment">-- The new stake distribution is made on the basis of a snapshot taken</span><span>
</span><span id="line-447"></span><span>    </span><span class="hs-comment">-- during the previous epoch. We create a &quot;fake&quot; snapshot in order to</span><span>
</span><span id="line-448"></span><span>    </span><span class="hs-comment">-- establish an initial stake distribution.</span><span>
</span><span id="line-449"></span><span>    </span><span class="annot"><a href="#local-6989586621679523844"><span class="hs-identifier hs-type">initSnapShot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.SnapShots.html#SnapShot"><span class="hs-identifier hs-type">SnapShot</span></a></span><span>
</span><span id="line-450"></span><span>    </span><span id="local-6989586621679523844"><span class="annot"><span class="annottext">initSnapShot :: SnapShot
</span><a href="#local-6989586621679523844"><span class="hs-identifier hs-var hs-var">initSnapShot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-451"></span><span>      </span><span class="annot"><span class="annottext">InstantStake era -&gt; DState era -&gt; PState era -&gt; SnapShot
forall era.
EraStake era =&gt;
InstantStake era -&gt; DState era -&gt; PState era -&gt; SnapShot
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Stake.html#snapShotFromInstantStake"><span class="hs-identifier hs-var">snapShotFromInstantStake</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO era -&gt; InstantStake era -&gt; InstantStake era
forall era.
EraStake era =&gt;
UTxO era -&gt; InstantStake era -&gt; InstantStake era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Stake.html#addInstantStake"><span class="hs-identifier hs-var">addInstantStake</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679523841"><span class="hs-identifier hs-var">nes</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
-&gt; Getting (UTxO era) (NewEpochState era) (UTxO era) -&gt; UTxO era
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (UTxO era) (NewEpochState era) (UTxO era)
forall era. Lens' (NewEpochState era) (UTxO era)
forall (t :: * -&gt; *) era. CanSetUTxO t =&gt; Lens' (t era) (UTxO era)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#utxoL"><span class="hs-identifier hs-var">utxoL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InstantStake era
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DState era
</span><a href="#local-6989586621679523848"><span class="hs-identifier hs-var">dState</span></a></span><span> </span><span class="annot"><span class="annottext">PState era
</span><a href="#local-6989586621679523849"><span class="hs-identifier hs-var">pState</span></a></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-comment">-- | Register the initial funds in the 'NewEpochState'.</span><span>
</span><span id="line-454"></span><span class="hs-comment">--</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- HERE BE DRAGONS! This function is intended to help in testing.</span><span>
</span><span id="line-456"></span><span class="hs-comment">--</span><span>
</span><span id="line-457"></span><span class="hs-comment">-- In production, the genesis should /not/ contain any initial funds.</span><span>
</span><span id="line-458"></span><span class="hs-comment">--</span><span>
</span><span id="line-459"></span><span class="hs-comment">-- The given funds are /added/ to the existing UTxO.</span><span>
</span><span id="line-460"></span><span class="hs-comment">--</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- PRECONDITION: the given funds must not be part of the existing UTxO.</span><span>
</span><span id="line-462"></span><span class="hs-comment">-- &gt; forall (addr, _) in initialFunds.</span><span>
</span><span id="line-463"></span><span class="hs-comment">-- &gt;    Map.notElem (initialFundsPseudoTxIn addr) existingUTxO</span><span>
</span><span id="line-464"></span><span class="hs-comment">--</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- PROPERTY:</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- &gt;    genesisUTxO genesis</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- &gt; == &lt;genesisUTxO'&gt; (sgInitialFunds genesis)</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- &gt; == &lt;extractUTxO&gt; (registerInitialFunds (sgInitialFunds genesis)</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- &gt;                                        &lt;empty NewEpochState&gt;)</span><span>
</span><span id="line-470"></span><span class="hs-comment">--</span><span>
</span><span id="line-471"></span><span class="hs-comment">-- /Warning/ - Should only be used in testing and benchmarking. Will result in an error</span><span>
</span><span id="line-472"></span><span class="hs-comment">-- when NetworkId is set to Mainnet</span><span>
</span><span id="line-473"></span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#registerInitialFunds"><span class="hs-identifier hs-type">registerInitialFunds</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-474"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679522997"><span class="annot"><a href="#local-6989586621679522997"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#EraTransition"><span class="hs-identifier hs-type">EraTransition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522997"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-478"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.Transition.html#TransitionConfig"><span class="hs-identifier hs-type">TransitionConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522997"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-479"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522997"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-480"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#NewEpochState"><span class="hs-identifier hs-type">NewEpochState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522997"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-481"></span><span id="registerInitialFunds"><span class="annot"><span class="annottext">registerInitialFunds :: forall era.
(EraTransition era, HasCallStack) =&gt;
TransitionConfig era -&gt; NewEpochState era -&gt; NewEpochState era
</span><a href="Cardano.Ledger.Shelley.Transition.html#registerInitialFunds"><span class="hs-identifier hs-var hs-var">registerInitialFunds</span></a></span></span><span> </span><span id="local-6989586621679523879"><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523879"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621679523880"><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679523880"><span class="hs-identifier hs-var">nes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-482"></span><span>  </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679523880"><span class="hs-identifier hs-var">nes</span></a></span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesEs"><span class="hs-identifier hs-var">nesEs</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-484"></span><span>        </span><span class="annot"><a href="#local-6989586621679523881"><span class="hs-identifier hs-type">epochState</span></a></span><span>
</span><span id="line-485"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#esChainAccountState"><span class="hs-identifier hs-var">esChainAccountState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679523882"><span class="hs-identifier hs-type">accountState'</span></a></span><span>
</span><span id="line-486"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#esLState"><span class="hs-identifier hs-var">esLState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679523883"><span class="hs-identifier hs-type">ledgerState'</span></a></span><span>
</span><span id="line-487"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-488"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-489"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-490"></span><span>    </span><span id="local-6989586621679523881"><span class="annot"><span class="annottext">epochState :: EpochState era
</span><a href="#local-6989586621679523881"><span class="hs-identifier hs-var hs-var">epochState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NewEpochState era -&gt; EpochState era
forall era. NewEpochState era -&gt; EpochState era
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#nesEs"><span class="hs-identifier hs-var">nesEs</span></a></span><span> </span><span class="annot"><span class="annottext">NewEpochState era
</span><a href="#local-6989586621679523880"><span class="hs-identifier hs-var">nes</span></a></span><span>
</span><span id="line-491"></span><span>    </span><span id="local-6989586621679523884"><span class="annot"><span class="annottext">accountState :: ChainAccountState
</span><a href="#local-6989586621679523884"><span class="hs-identifier hs-var hs-var">accountState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochState era -&gt; ChainAccountState
forall era. EpochState era -&gt; ChainAccountState
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#esChainAccountState"><span class="hs-identifier hs-var">esChainAccountState</span></a></span><span> </span><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621679523881"><span class="hs-identifier hs-var">epochState</span></a></span><span>
</span><span id="line-492"></span><span>    </span><span id="local-6989586621679523885"><span class="annot"><span class="annottext">ledgerState :: LedgerState era
</span><a href="#local-6989586621679523885"><span class="hs-identifier hs-var hs-var">ledgerState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochState era -&gt; LedgerState era
forall era. EpochState era -&gt; LedgerState era
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#esLState"><span class="hs-identifier hs-var">esLState</span></a></span><span> </span><span class="annot"><span class="annottext">EpochState era
</span><a href="#local-6989586621679523881"><span class="hs-identifier hs-var">epochState</span></a></span><span>
</span><span id="line-493"></span><span>    </span><span id="local-6989586621679523886"><span class="annot"><span class="annottext">utxoState :: UTxOState era
</span><a href="#local-6989586621679523886"><span class="hs-identifier hs-var hs-var">utxoState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LedgerState era -&gt; UTxOState era
forall era. LedgerState era -&gt; UTxOState era
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#lsUTxOState"><span class="hs-identifier hs-var">lsUTxOState</span></a></span><span> </span><span class="annot"><span class="annottext">LedgerState era
</span><a href="#local-6989586621679523885"><span class="hs-identifier hs-var">ledgerState</span></a></span><span>
</span><span id="line-494"></span><span>    </span><span id="local-6989586621679523887"><span class="annot"><span class="annottext">utxo :: UTxO era
</span><a href="#local-6989586621679523887"><span class="hs-identifier hs-var hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTxOState era -&gt; UTxO era
forall era. UTxOState era -&gt; UTxO era
</span><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosUtxo"><span class="hs-identifier hs-var">utxosUtxo</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOState era
</span><a href="#local-6989586621679523886"><span class="hs-identifier hs-var">utxoState</span></a></span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span>    </span><span class="annot"><a href="#local-6989586621679523889"><span class="hs-identifier hs-type">initialFundsUtxo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522997"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-497"></span><span>    </span><span id="local-6989586621679523889"><span class="annot"><span class="annottext">initialFundsUtxo :: UTxO era
</span><a href="#local-6989586621679523889"><span class="hs-identifier hs-var hs-var">initialFundsUtxo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-498"></span><span>      </span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; UTxO era
forall era. Map TxIn (TxOut era) -&gt; UTxO era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a></span><span> </span><span class="annot"><span class="annottext">(Map TxIn (TxOut era) -&gt; UTxO era)
-&gt; Map TxIn (TxOut era) -&gt; UTxO era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-499"></span><span>        </span><span class="annot"><span class="annottext">[(TxIn, TxOut era)] -&gt; Map TxIn (TxOut era)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span>
</span><span id="line-500"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679523892"><span class="hs-identifier hs-var">txIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621679523893"><span class="hs-identifier hs-var">txOut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679523894"><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621679523894"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679523895"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679523895"><span class="hs-identifier hs-var">amount</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ListMap Addr Coin -&gt; [(Addr, Coin)]
forall k v. ListMap k v -&gt; [(k, v)]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-data-1.2.4.1/doc/html/cardano-data/src/Data.ListMap.html#toList"><span class="hs-identifier hs-var">ListMap.toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TransitionConfig era
</span><a href="#local-6989586621679523879"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">TransitionConfig era
-&gt; Getting
     (ListMap Addr Coin) (TransitionConfig era) (ListMap Addr Coin)
-&gt; ListMap Addr Coin
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (ListMap Addr Coin) (TransitionConfig era) (ListMap Addr Coin)
forall era.
(HasCallStack, EraTransition era) =&gt;
Lens' (TransitionConfig era) (ListMap Addr Coin)
Lens' (TransitionConfig era) (ListMap Addr Coin)
</span><a href="Cardano.Ledger.Shelley.Transition.html#tcInitialFundsL"><span class="hs-identifier hs-var">tcInitialFundsL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679523892"><span class="annot"><span class="annottext">txIn :: TxIn
</span><a href="#local-6989586621679523892"><span class="hs-identifier hs-var hs-var">txIn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr -&gt; TxIn
</span><a href="Cardano.Ledger.Shelley.Genesis.html#initialFundsPseudoTxIn"><span class="hs-identifier hs-var">initialFundsPseudoTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621679523894"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-503"></span><span>                </span><span id="local-6989586621679523893"><span class="annot"><span class="annottext">txOut :: TxOut era
</span><a href="#local-6989586621679523893"><span class="hs-identifier hs-var hs-var">txOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr -&gt; Value era -&gt; TxOut era
forall era.
(EraTxOut era, HasCallStack) =&gt;
Addr -&gt; Value era -&gt; TxOut era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Core.html#mkBasicTxOut"><span class="hs-identifier hs-var">mkBasicTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">Addr
</span><a href="#local-6989586621679523894"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin -&gt; Value era
forall t s. Inject t s =&gt; t -&gt; s
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.BaseTypes.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621679523895"><span class="hs-identifier hs-var">amount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span>    </span><span id="local-6989586621679523899"><span class="annot"><span class="annottext">utxo' :: UTxO era
</span><a href="#local-6989586621679523899"><span class="hs-identifier hs-var hs-var">utxo'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; UTxO era -&gt; UTxO era -&gt; UTxO era
UTxO era -&gt; UTxO era -&gt; UTxO era
</span><a href="#local-6989586621679523900"><span class="hs-identifier hs-var">mergeUtxoNoOverlap</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679523887"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO era
</span><a href="#local-6989586621679523889"><span class="hs-identifier hs-var">initialFundsUtxo</span></a></span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span>    </span><span class="hs-comment">-- Update the reserves</span><span>
</span><span id="line-509"></span><span>    </span><span id="local-6989586621679523882"><span class="annot"><span class="annottext">accountState' :: ChainAccountState
</span><a href="#local-6989586621679523882"><span class="hs-identifier hs-var hs-var">accountState'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-510"></span><span>      </span><span class="annot"><span class="annottext">ChainAccountState
</span><a href="#local-6989586621679523884"><span class="hs-identifier hs-var">accountState</span></a></span><span>
</span><span id="line-511"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.ChainAccount.html#casReserves"><span class="hs-identifier hs-var">casReserves</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.ChainAccount.html#casReserves"><span class="hs-identifier hs-var">casReserves</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523884"><span class="hs-identifier hs-type">accountState</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.Val.html#%3C-%3E"><span class="hs-operator hs-type">&lt;-&gt;</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#sumCoinUTxO"><span class="hs-identifier hs-type">sumCoinUTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523889"><span class="hs-identifier hs-type">initialFundsUtxo</span></a></span><span>
</span><span id="line-512"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span>    </span><span id="local-6989586621679523883"><span class="annot"><span class="annottext">ledgerState' :: LedgerState era
</span><a href="#local-6989586621679523883"><span class="hs-identifier hs-var hs-var">ledgerState'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-515"></span><span>      </span><span class="annot"><span class="annottext">LedgerState era
</span><a href="#local-6989586621679523885"><span class="hs-identifier hs-var">ledgerState</span></a></span><span>
</span><span id="line-516"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#lsUTxOState"><span class="hs-identifier hs-var">lsUTxOState</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-517"></span><span>            </span><span class="annot"><a href="#local-6989586621679523886"><span class="hs-identifier hs-type">utxoState</span></a></span><span>
</span><span id="line-518"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosUtxo"><span class="hs-identifier hs-var">utxosUtxo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679523899"><span class="hs-identifier hs-type">utxo'</span></a></span><span>
</span><span id="line-519"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Normally we would incrementally update here. But since we pass</span><span>
</span><span id="line-520"></span><span>                </span><span class="hs-comment">-- the full UTxO as &quot;toAdd&quot; rather than a delta, we simply</span><span>
</span><span id="line-521"></span><span>                </span><span class="hs-comment">-- reinitialise the full instant stake.</span><span>
</span><span id="line-522"></span><span>                </span><span class="annot"><a href="Cardano.Ledger.Shelley.LedgerState.Types.html#utxosInstantStake"><span class="hs-identifier hs-var">utxosInstantStake</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.Stake.html#addInstantStake"><span class="hs-identifier hs-type">addInstantStake</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679523899"><span class="hs-identifier hs-type">utxo'</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span>
</span><span id="line-523"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-524"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-525"></span><span>
</span><span id="line-526"></span><span>    </span><span class="hs-comment">-- Merge two UTxOs, throw an 'error' in case of overlap</span><span>
</span><span id="line-527"></span><span>    </span><span class="annot"><a href="#local-6989586621679523900"><span class="hs-identifier hs-type">mergeUtxoNoOverlap</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-528"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-529"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522997"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-530"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522997"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-531"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679522997"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-532"></span><span>    </span><span id="local-6989586621679523900"><span class="annot"><span class="annottext">mergeUtxoNoOverlap :: HasCallStack =&gt; UTxO era -&gt; UTxO era -&gt; UTxO era
</span><a href="#local-6989586621679523900"><span class="hs-identifier hs-var hs-var">mergeUtxoNoOverlap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span id="local-6989586621679523911"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621679523911"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span id="local-6989586621679523912"><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621679523912"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-533"></span><span>      </span><span class="annot"><span class="annottext">Map TxIn (TxOut era) -&gt; UTxO era
forall era. Map TxIn (TxOut era) -&gt; UTxO era
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/cardano-ledger-core-1.19.0.0/doc/html/cardano-ledger-core/src/Cardano.Ledger.State.UTxO.html#UTxO"><span class="hs-identifier hs-var">UTxO</span></a></span><span> </span><span class="annot"><span class="annottext">(Map TxIn (TxOut era) -&gt; UTxO era)
-&gt; Map TxIn (TxOut era) -&gt; UTxO era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-534"></span><span>        </span><span class="annot"><span class="annottext">(TxIn -&gt; TxOut era -&gt; TxOut era -&gt; TxOut era)
-&gt; Map TxIn (TxOut era)
-&gt; Map TxIn (TxOut era)
-&gt; Map TxIn (TxOut era)
forall k a.
Ord k =&gt;
(k -&gt; a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.unionWithKey</span></span><span>
</span><span id="line-535"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679523914"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679523914"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TxOut era
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TxOut era) -&gt; String -&gt; TxOut era
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;initial fund part of UTxO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679523914"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>          </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621679523911"><span class="hs-identifier hs-var">m1</span></a></span><span>
</span><span id="line-537"></span><span>          </span><span class="annot"><span class="annottext">Map TxIn (TxOut era)
</span><a href="#local-6989586621679523912"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-538"></span></pre></body></html>