<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621679189587"><span id="local-6989586621679189592"><span id="local-6989586621679189593"><span id="local-6989586621679189594"></span></span></span></span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-comment">-- | Properties of the delegation traces induced by the transition systems</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- associated with this aspect of the ledger.</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Byron.Spec.Ledger.Delegation.Properties</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#dcertsAreTriggered"><span class="hs-identifier">dcertsAreTriggered</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#rejectDupSchedDelegs"><span class="hs-identifier">rejectDupSchedDelegs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#tracesAreClassified"><span class="hs-identifier">tracesAreClassified</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#dblockTracesAreClassified"><span class="hs-identifier">dblockTracesAreClassified</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#relevantCasesAreCovered"><span class="hs-identifier">relevantCasesAreCovered</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#onlyValidSignalsAreGenerated"><span class="hs-identifier">onlyValidSignalsAreGenerated</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html"><span class="hs-identifier">Byron.Spec.Ledger.Core</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#Epoch"><span class="hs-identifier">Epoch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#Epoch"><span class="hs-identifier">Epoch</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#Sig"><span class="hs-identifier">Sig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#Sig"><span class="hs-identifier">Sig</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#Slot"><span class="hs-identifier">Slot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#SlotCount"><span class="hs-identifier">SlotCount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#SlotCount"><span class="hs-identifier">SlotCount</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#VKey"><span class="hs-identifier">VKey</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#VKeyGenesis"><span class="hs-identifier">VKeyGenesis</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#addSlot"><span class="hs-identifier">addSlot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#mkVKeyGenesis"><span class="hs-identifier">mkVKeyGenesis</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#owner"><span class="hs-identifier">owner</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#unSlot"><span class="hs-identifier">unSlot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#unSlotCount"><span class="hs-identifier">unSlotCount</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.Generators.html"><span class="hs-identifier">Byron.Spec.Ledger.Core.Generators</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.Generators.html#epochGen"><span class="hs-identifier">epochGen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.Generators.html#slotGen"><span class="hs-identifier">slotGen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.Generators.html#vkGen"><span class="hs-identifier">vkGen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.Generators.html"><span class="hs-identifier">Byron.Spec.Ledger.Core.Generators</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CoreGen</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html"><span class="hs-identifier">Byron.Spec.Ledger.Delegation</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.GlobalParams.html"><span class="hs-identifier">Byron.Spec.Ledger.GlobalParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.GlobalParams.html#slotsPerEpoch"><span class="hs-identifier">slotsPerEpoch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(***)</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.html"><span class="hs-identifier">Control.State.Transition</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#Embed"><span class="hs-identifier">Embed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#Environment"><span class="hs-identifier">Environment</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#IRC"><span class="hs-identifier">IRC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#IRC"><span class="hs-identifier">IRC</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#PredicateFailure"><span class="hs-identifier">PredicateFailure</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#STS"><span class="hs-identifier">STS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#Signal"><span class="hs-identifier">Signal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#State"><span class="hs-identifier">State</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#TRC"><span class="hs-identifier">TRC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#TRC"><span class="hs-identifier">TRC</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Simple.html#applySTS"><span class="hs-identifier">applySTS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#initialRules"><span class="hs-identifier">initialRules</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#judgmentContext"><span class="hs-identifier">judgmentContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#trans"><span class="hs-identifier">trans</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#transitionRules"><span class="hs-identifier">transitionRules</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#wrapFailed"><span class="hs-identifier">wrapFailed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#%3F%21"><span class="hs-operator">(?!)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/bimap-0.5.0-27098ee257ef2e554baff63313c57dc699014713bec5c50671e808ed86f54646/share/doc/html/src/Data.Bimap.html"><span class="hs-identifier">Data.Bimap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/bimap-0.5.0-27098ee257ef2e554baff63313c57dc699014713bec5c50671e808ed86f54646/share/doc/html/src/Data.Bimap.html#Bimap"><span class="hs-identifier">Bimap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/bimap-0.5.0-27098ee257ef2e554baff63313c57dc699014713bec5c50671e808ed86f54646/share/doc/html/src/Data.Bimap.html"><span class="hs-identifier">Data.Bimap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bimap</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Data</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.html"><span class="hs-identifier">Hedgehog</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-64"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Gen.html#Gen"><span class="hs-identifier">Gen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier">MonadTest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier">Property</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#assert"><span class="hs-identifier">assert</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#cover"><span class="hs-identifier">cover</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#forAll"><span class="hs-identifier">forAll</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#property"><span class="hs-identifier">property</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#success"><span class="hs-identifier">success</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#withTests"><span class="hs-identifier">withTests</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#%3D%3D%3D"><span class="hs-operator">(===)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Gen.html"><span class="hs-identifier">Hedgehog.Gen</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Gen</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Range.html"><span class="hs-identifier">Hedgehog.Range</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Range</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html"><span class="hs-identifier">Lens.Micro</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#to"><span class="hs-identifier">to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&amp;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator">(.~)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator">(^.)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Extras.html"><span class="hs-identifier">Lens.Micro.Extras</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Extras.html#view"><span class="hs-identifier">view</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-th-0.4.3.17-9681dc3403514867938a0ad4f1b940407e8027731e78ea981763e315e28d6408/share/doc/html/src/Lens.Micro.TH.html"><span class="hs-identifier">Lens.Micro.TH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-th-0.4.3.17-9681dc3403514867938a0ad4f1b940407e8027731e78ea981763e315e28d6408/share/doc/html/src/Lens.Micro.TH.html#makeLenses"><span class="hs-identifier">makeLenses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html"><span class="hs-identifier">Test.Control.State.Transition.Generator</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#HasSizeInfo"><span class="hs-identifier">HasSizeInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier">HasTrace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#classifySize"><span class="hs-identifier">classifySize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#classifyTraceLength"><span class="hs-identifier">classifyTraceLength</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#envGen"><span class="hs-identifier">envGen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#isTrivial"><span class="hs-identifier">isTrivial</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#nonTrivialTrace"><span class="hs-identifier">nonTrivialTrace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#sigGen"><span class="hs-identifier">sigGen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#suchThatLastState"><span class="hs-identifier">suchThatLastState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#trace"><span class="hs-identifier">trace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#traceLengthsAreClassified"><span class="hs-identifier">traceLengthsAreClassified</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html"><span class="hs-identifier">Test.Control.State.Transition.Generator</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Transition.Generator</span></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html"><span class="hs-identifier">Test.Control.State.Transition.Trace</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#Trace"><span class="hs-identifier">Trace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#TraceOrder"><span class="hs-identifier">TraceOrder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#OldestFirst"><span class="hs-identifier">OldestFirst</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#lastState"><span class="hs-identifier">lastState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#preStatesAndSignals"><span class="hs-identifier">preStatesAndSignals</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#traceEnv"><span class="hs-identifier">traceEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#traceLength"><span class="hs-identifier">traceLength</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#traceSignals"><span class="hs-identifier">traceSignals</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- Delegation certification triggering tests</span><span>
</span><span id="line-106"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="annot"><span class="hs-comment">-- | Initial state for the ADELEG and ADELEGS systems</span></span><span>
</span><span id="line-109"></span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#initADelegsState"><span class="hs-identifier hs-type">initADelegsState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DState"><span class="hs-identifier hs-type">DState</span></a></span><span>
</span><span id="line-110"></span><span id="initADelegsState"><span class="annot"><span class="annottext">initADelegsState :: DState
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#initADelegsState"><span class="hs-identifier hs-var hs-var">initADelegsState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DState"><span class="hs-identifier hs-type">DState</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_dStateDelegationMap :: Bimap VKeyGenesis VKey
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#_dStateDelegationMap"><span class="hs-identifier hs-var">_dStateDelegationMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bimap VKeyGenesis VKey
forall a b. Bimap a b
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/bimap-0.5.0-27098ee257ef2e554baff63313c57dc699014713bec5c50671e808ed86f54646/share/doc/html/src/Data.Bimap.html#empty"><span class="hs-identifier hs-var">Bimap.empty</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_dStateLastDelegation :: Map VKeyGenesis Slot
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#_dStateLastDelegation"><span class="hs-identifier hs-var">_dStateLastDelegation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map VKeyGenesis Slot
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><span class="hs-comment">-- | Initial state for the ADELEG and ADELEGS systems</span></span><span>
</span><span id="line-117"></span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#initSDelegsState"><span class="hs-identifier hs-type">initSDelegsState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DSState"><span class="hs-identifier hs-type">DSState</span></a></span><span>
</span><span id="line-118"></span><span id="initSDelegsState"><span class="annot"><span class="annottext">initSDelegsState :: DSState
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#initSDelegsState"><span class="hs-identifier hs-var hs-var">initSDelegsState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DSState"><span class="hs-identifier hs-type">DSState</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_dSStateScheduledDelegations :: [(Slot, (VKeyGenesis, VKey))]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#_dSStateScheduledDelegations"><span class="hs-identifier hs-var">_dSStateScheduledDelegations</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_dSStateKeyEpochDelegations :: Set (Epoch, VKeyGenesis)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#_dSStateKeyEpochDelegations"><span class="hs-identifier hs-var">_dSStateKeyEpochDelegations</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (Epoch, VKeyGenesis)
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="annot"><span class="hs-comment">-- | Initial state for the DELEG system</span></span><span>
</span><span id="line-125"></span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#initialDIState"><span class="hs-identifier hs-type">initialDIState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DIState"><span class="hs-identifier hs-type">DIState</span></a></span><span>
</span><span id="line-126"></span><span id="initialDIState"><span class="annot"><span class="annottext">initialDIState :: DIState
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#initialDIState"><span class="hs-identifier hs-var hs-var">initialDIState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DIState"><span class="hs-identifier hs-type">DIState</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_dIStateDelegationMap :: Bimap VKeyGenesis VKey
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#_dIStateDelegationMap"><span class="hs-identifier hs-var">_dIStateDelegationMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DState -&gt; Bimap VKeyGenesis VKey
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#_dStateDelegationMap"><span class="hs-identifier hs-var">_dStateDelegationMap</span></a></span><span> </span><span class="annot"><span class="annottext">DState
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#initADelegsState"><span class="hs-identifier hs-var">initADelegsState</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_dIStateLastDelegation :: Map VKeyGenesis Slot
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#_dIStateLastDelegation"><span class="hs-identifier hs-var">_dIStateLastDelegation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DState -&gt; Map VKeyGenesis Slot
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#_dStateLastDelegation"><span class="hs-identifier hs-var">_dStateLastDelegation</span></a></span><span> </span><span class="annot"><span class="annottext">DState
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#initADelegsState"><span class="hs-identifier hs-var">initADelegsState</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_dIStateScheduledDelegations :: [(Slot, (VKeyGenesis, VKey))]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#_dIStateScheduledDelegations"><span class="hs-identifier hs-var">_dIStateScheduledDelegations</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DSState
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#initSDelegsState"><span class="hs-identifier hs-var">initSDelegsState</span></a></span><span> </span><span class="annot"><span class="annottext">DSState
-&gt; Getting
     [(Slot, (VKeyGenesis, VKey))] DSState [(Slot, (VKeyGenesis, VKey))]
-&gt; [(Slot, (VKeyGenesis, VKey))]
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  [(Slot, (VKeyGenesis, VKey))] DSState [(Slot, (VKeyGenesis, VKey))]
forall s a. HasScheduledDelegations s a =&gt; Lens' s a
Lens' DSState [(Slot, (VKeyGenesis, VKey))]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#scheduledDelegations"><span class="hs-identifier hs-var">scheduledDelegations</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_dIStateKeyEpochDelegations :: Set (Epoch, VKeyGenesis)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#_dIStateKeyEpochDelegations"><span class="hs-identifier hs-var">_dIStateKeyEpochDelegations</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DSState -&gt; Set (Epoch, VKeyGenesis)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#_dSStateKeyEpochDelegations"><span class="hs-identifier hs-var">_dSStateKeyEpochDelegations</span></a></span><span> </span><span class="annot"><span class="annottext">DSState
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#initSDelegsState"><span class="hs-identifier hs-var">initSDelegsState</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="annot"><span class="hs-comment">-- | Delegation blocks. Simple blockchain to test delegation.</span></span><span>
</span><span id="line-135"></span><span class="hs-keyword">data</span><span> </span><span id="DBLOCK"><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBLOCK"><span class="hs-identifier hs-var">DBLOCK</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679189904"><span id="local-6989586621679189906"><span id="local-6989586621679189908"><span id="local-6989586621679189910"><span id="local-6989586621679189912"><span id="local-6989586621679189918"><span id="local-6989586621679189923"><span id="local-6989586621679189926"><span id="local-6989586621679189929"><span id="local-6989586621679189932"><span id="local-6989586621679189935"><span id="local-6989586621679189938"><span id="local-6989586621679189943"><span id="local-6989586621679189948"><span class="annot"><span class="annottext">Typeable DBLOCK
Typeable DBLOCK =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g) -&gt; DBLOCK -&gt; c DBLOCK)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DBLOCK)
-&gt; (DBLOCK -&gt; Constr)
-&gt; (DBLOCK -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DBLOCK))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DBLOCK))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; DBLOCK -&gt; DBLOCK)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DBLOCK -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DBLOCK -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DBLOCK -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DBLOCK -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; DBLOCK -&gt; m DBLOCK)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; DBLOCK -&gt; m DBLOCK)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; DBLOCK -&gt; m DBLOCK)
-&gt; Data DBLOCK
DBLOCK -&gt; Constr
DBLOCK -&gt; DataType
(forall b. Data b =&gt; b -&gt; b) -&gt; DBLOCK -&gt; DBLOCK
forall a.
Typeable a =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DBLOCK -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DBLOCK -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DBLOCK -&gt; r
forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DBLOCK -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DBLOCK -&gt; m DBLOCK
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DBLOCK -&gt; m DBLOCK
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DBLOCK
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DBLOCK -&gt; c DBLOCK
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DBLOCK)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DBLOCK)
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DBLOCK -&gt; c DBLOCK
gfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DBLOCK -&gt; c DBLOCK
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DBLOCK
gunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DBLOCK
$ctoConstr :: DBLOCK -&gt; Constr
toConstr :: DBLOCK -&gt; Constr
$cdataTypeOf :: DBLOCK -&gt; DataType
dataTypeOf :: DBLOCK -&gt; DataType
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DBLOCK)
dataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DBLOCK)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DBLOCK)
dataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DBLOCK)
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; DBLOCK -&gt; DBLOCK
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; DBLOCK -&gt; DBLOCK
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DBLOCK -&gt; r
gmapQl :: forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DBLOCK -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DBLOCK -&gt; r
gmapQr :: forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DBLOCK -&gt; r
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DBLOCK -&gt; [u]
gmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DBLOCK -&gt; [u]
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DBLOCK -&gt; u
gmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DBLOCK -&gt; u
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DBLOCK -&gt; m DBLOCK
gmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DBLOCK -&gt; m DBLOCK
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DBLOCK -&gt; m DBLOCK
gmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DBLOCK -&gt; m DBLOCK
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DBLOCK -&gt; m DBLOCK
gmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DBLOCK -&gt; m DBLOCK
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><span class="hs-comment">-- | A delegation block.</span></span><span>
</span><span id="line-138"></span><span class="hs-keyword">data</span><span> </span><span id="DBlock"><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBlock"><span class="hs-identifier hs-var">DBlock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DBlock"><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBlock"><span class="hs-identifier hs-var">DBlock</span></a></span></span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_blockSlot"><span class="annot"><span class="annottext">DBlock -&gt; Slot
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#_blockSlot"><span class="hs-identifier hs-var hs-var">_blockSlot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#Slot"><span class="hs-identifier hs-type">Slot</span></a></span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_blockCerts"><span class="annot"><span class="annottext">DBlock -&gt; [DCert]
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#_blockCerts"><span class="hs-identifier hs-var hs-var">_blockCerts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DCert"><span class="hs-identifier hs-type">DCert</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679189957"><span id="local-6989586621679189964"><span id="local-6989586621679189967"><span class="annot"><span class="annottext">Int -&gt; DBlock -&gt; ShowS
[DBlock] -&gt; ShowS
DBlock -&gt; [Char]
(Int -&gt; DBlock -&gt; ShowS)
-&gt; (DBlock -&gt; [Char]) -&gt; ([DBlock] -&gt; ShowS) -&gt; Show DBlock
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; DBlock -&gt; ShowS
showsPrec :: Int -&gt; DBlock -&gt; ShowS
$cshow :: DBlock -&gt; [Char]
show :: DBlock -&gt; [Char]
$cshowList :: [DBlock] -&gt; ShowS
showList :: [DBlock] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679189971"><span id="local-6989586621679189978"><span class="annot"><span class="annottext">DBlock -&gt; DBlock -&gt; Bool
(DBlock -&gt; DBlock -&gt; Bool)
-&gt; (DBlock -&gt; DBlock -&gt; Bool) -&gt; Eq DBlock
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: DBlock -&gt; DBlock -&gt; Bool
== :: DBlock -&gt; DBlock -&gt; Bool
$c/= :: DBlock -&gt; DBlock -&gt; Bool
/= :: DBlock -&gt; DBlock -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span id="blockCerts"><span id="blockSlot"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">DBlock</span></span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-keyword">data</span><span> </span><span id="DBlockPredicateFailure"><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBlockPredicateFailure"><span class="hs-identifier hs-var">DBlockPredicateFailure</span></a></span></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DPF"><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DPF"><span class="hs-identifier hs-var">DPF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#PredicateFailure"><span class="hs-identifier hs-type">PredicateFailure</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DELEG"><span class="hs-identifier hs-type">DELEG</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NotIncreasingBlockSlot"><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#NotIncreasingBlockSlot"><span class="hs-identifier hs-var">NotIncreasingBlockSlot</span></a></span></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679190000"><span id="local-6989586621679190003"><span class="annot"><span class="annottext">DBlockPredicateFailure -&gt; DBlockPredicateFailure -&gt; Bool
(DBlockPredicateFailure -&gt; DBlockPredicateFailure -&gt; Bool)
-&gt; (DBlockPredicateFailure -&gt; DBlockPredicateFailure -&gt; Bool)
-&gt; Eq DBlockPredicateFailure
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: DBlockPredicateFailure -&gt; DBlockPredicateFailure -&gt; Bool
== :: DBlockPredicateFailure -&gt; DBlockPredicateFailure -&gt; Bool
$c/= :: DBlockPredicateFailure -&gt; DBlockPredicateFailure -&gt; Bool
/= :: DBlockPredicateFailure -&gt; DBlockPredicateFailure -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679190007"><span id="local-6989586621679190012"><span id="local-6989586621679190016"><span class="annot"><span class="annottext">Int -&gt; DBlockPredicateFailure -&gt; ShowS
[DBlockPredicateFailure] -&gt; ShowS
DBlockPredicateFailure -&gt; [Char]
(Int -&gt; DBlockPredicateFailure -&gt; ShowS)
-&gt; (DBlockPredicateFailure -&gt; [Char])
-&gt; ([DBlockPredicateFailure] -&gt; ShowS)
-&gt; Show DBlockPredicateFailure
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; DBlockPredicateFailure -&gt; ShowS
showsPrec :: Int -&gt; DBlockPredicateFailure -&gt; ShowS
$cshow :: DBlockPredicateFailure -&gt; [Char]
show :: DBlockPredicateFailure -&gt; [Char]
$cshowList :: [DBlockPredicateFailure] -&gt; ShowS
showList :: [DBlockPredicateFailure] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679190021"><span id="local-6989586621679190025"><span id="local-6989586621679190028"><span id="local-6989586621679190030"><span id="local-6989586621679190032"><span id="local-6989586621679190038"><span id="local-6989586621679190043"><span id="local-6989586621679190046"><span id="local-6989586621679190049"><span id="local-6989586621679190052"><span id="local-6989586621679190055"><span id="local-6989586621679190058"><span id="local-6989586621679190063"><span id="local-6989586621679190068"><span class="annot"><span class="annottext">Typeable DBlockPredicateFailure
Typeable DBlockPredicateFailure =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g)
 -&gt; DBlockPredicateFailure
 -&gt; c DBlockPredicateFailure)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DBlockPredicateFailure)
-&gt; (DBlockPredicateFailure -&gt; Constr)
-&gt; (DBlockPredicateFailure -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DBlockPredicateFailure))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c DBlockPredicateFailure))
-&gt; ((forall b. Data b =&gt; b -&gt; b)
    -&gt; DBlockPredicateFailure -&gt; DBlockPredicateFailure)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r
    -&gt; (forall d. Data d =&gt; d -&gt; r')
    -&gt; DBlockPredicateFailure
    -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r
    -&gt; (forall d. Data d =&gt; d -&gt; r')
    -&gt; DBlockPredicateFailure
    -&gt; r)
-&gt; (forall u.
    (forall d. Data d =&gt; d -&gt; u) -&gt; DBlockPredicateFailure -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DBlockPredicateFailure -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d)
    -&gt; DBlockPredicateFailure -&gt; m DBlockPredicateFailure)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d)
    -&gt; DBlockPredicateFailure -&gt; m DBlockPredicateFailure)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d)
    -&gt; DBlockPredicateFailure -&gt; m DBlockPredicateFailure)
-&gt; Data DBlockPredicateFailure
DBlockPredicateFailure -&gt; Constr
DBlockPredicateFailure -&gt; DataType
(forall b. Data b =&gt; b -&gt; b)
-&gt; DBlockPredicateFailure -&gt; DBlockPredicateFailure
forall a.
Typeable a =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u.
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DBlockPredicateFailure -&gt; u
forall u.
(forall d. Data d =&gt; d -&gt; u) -&gt; DBlockPredicateFailure -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r
-&gt; (forall d. Data d =&gt; d -&gt; r')
-&gt; DBlockPredicateFailure
-&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r
-&gt; (forall d. Data d =&gt; d -&gt; r')
-&gt; DBlockPredicateFailure
-&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; DBlockPredicateFailure -&gt; m DBlockPredicateFailure
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; DBlockPredicateFailure -&gt; m DBlockPredicateFailure
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DBlockPredicateFailure
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g)
-&gt; DBlockPredicateFailure
-&gt; c DBlockPredicateFailure
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DBlockPredicateFailure)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c DBlockPredicateFailure)
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g)
-&gt; DBlockPredicateFailure
-&gt; c DBlockPredicateFailure
gfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g)
-&gt; DBlockPredicateFailure
-&gt; c DBlockPredicateFailure
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DBlockPredicateFailure
gunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DBlockPredicateFailure
$ctoConstr :: DBlockPredicateFailure -&gt; Constr
toConstr :: DBlockPredicateFailure -&gt; Constr
$cdataTypeOf :: DBlockPredicateFailure -&gt; DataType
dataTypeOf :: DBlockPredicateFailure -&gt; DataType
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DBlockPredicateFailure)
dataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DBlockPredicateFailure)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c DBlockPredicateFailure)
dataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c DBlockPredicateFailure)
$cgmapT :: (forall b. Data b =&gt; b -&gt; b)
-&gt; DBlockPredicateFailure -&gt; DBlockPredicateFailure
gmapT :: (forall b. Data b =&gt; b -&gt; b)
-&gt; DBlockPredicateFailure -&gt; DBlockPredicateFailure
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r
-&gt; (forall d. Data d =&gt; d -&gt; r')
-&gt; DBlockPredicateFailure
-&gt; r
gmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r
-&gt; (forall d. Data d =&gt; d -&gt; r')
-&gt; DBlockPredicateFailure
-&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r
-&gt; (forall d. Data d =&gt; d -&gt; r')
-&gt; DBlockPredicateFailure
-&gt; r
gmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r
-&gt; (forall d. Data d =&gt; d -&gt; r')
-&gt; DBlockPredicateFailure
-&gt; r
$cgmapQ :: forall u.
(forall d. Data d =&gt; d -&gt; u) -&gt; DBlockPredicateFailure -&gt; [u]
gmapQ :: forall u.
(forall d. Data d =&gt; d -&gt; u) -&gt; DBlockPredicateFailure -&gt; [u]
$cgmapQi :: forall u.
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DBlockPredicateFailure -&gt; u
gmapQi :: forall u.
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DBlockPredicateFailure -&gt; u
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; DBlockPredicateFailure -&gt; m DBlockPredicateFailure
gmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; DBlockPredicateFailure -&gt; m DBlockPredicateFailure
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; DBlockPredicateFailure -&gt; m DBlockPredicateFailure
gmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; DBlockPredicateFailure -&gt; m DBlockPredicateFailure
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; DBlockPredicateFailure -&gt; m DBlockPredicateFailure
gmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; DBlockPredicateFailure -&gt; m DBlockPredicateFailure
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- | This corresponds to a state-transition rule where blocks with increasing</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- slot-numbers are produced.</span><span>
</span><span id="line-153"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679190085"><span id="local-6989586621679190089"><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#STS"><span class="hs-identifier hs-type">STS</span></a></span><span> </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBLOCK"><span class="hs-identifier hs-type">DBLOCK</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Environment"><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#Environment"><span class="hs-identifier hs-var">Environment</span></a></span></span><span> </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBLOCK"><span class="hs-identifier hs-type">DBLOCK</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DSEnv"><span class="hs-identifier hs-type">DSEnv</span></a></span><span> </span><span class="hs-comment">-- The initial environment is only used to bootstrap the initial state.</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="State"><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#State"><span class="hs-identifier hs-var">State</span></a></span></span><span> </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBLOCK"><span class="hs-identifier hs-type">DBLOCK</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DSEnv"><span class="hs-identifier hs-type">DSEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DIState"><span class="hs-identifier hs-type">DIState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Signal"><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#Signal"><span class="hs-identifier hs-var">Signal</span></a></span></span><span> </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBLOCK"><span class="hs-identifier hs-type">DBLOCK</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBlock"><span class="hs-identifier hs-type">DBlock</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PredicateFailure"><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#PredicateFailure"><span class="hs-identifier hs-var">PredicateFailure</span></a></span></span><span> </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBLOCK"><span class="hs-identifier hs-type">DBLOCK</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBlockPredicateFailure"><span class="hs-identifier hs-type">DBlockPredicateFailure</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>  </span><span id="local-6989586621679190097"><span class="annot"><span class="annottext">initialRules :: [InitialRule DBLOCK]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#initialRules"><span class="hs-identifier hs-var hs-var hs-var hs-var">initialRules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#IRC"><span class="hs-identifier hs-type">IRC</span></a></span><span> </span><span id="local-6989586621679190098"><span class="annot"><span class="annottext">Environment DBLOCK
</span><a href="#local-6989586621679190098"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rule DBLOCK 'Initial (RuleContext 'Initial DBLOCK)
F (Clause DBLOCK 'Initial) (IRC DBLOCK)
forall sts (rtype :: RuleType).
Rule sts rtype (RuleContext rtype sts)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#judgmentContext"><span class="hs-identifier hs-var">judgmentContext</span></a></span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="annottext">(DIEnv, DIState) -&gt; F (Clause DBLOCK 'Initial) (DIEnv, DIState)
forall a. a -&gt; F (Clause DBLOCK 'Initial) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DIEnv
Environment DBLOCK
</span><a href="#local-6989586621679190098"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DIState
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#initialDIState"><span class="hs-identifier hs-var">initialDIState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621679190124"><span class="annot"><span class="annottext">transitionRules :: [TransitionRule DBLOCK]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#transitionRules"><span class="hs-identifier hs-var hs-var hs-var hs-var">transitionRules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-167"></span><span>        </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#TRC"><span class="hs-identifier hs-type">TRC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Environment DBLOCK
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679190125"><span class="annot"><span class="annottext">DIEnv
</span><a href="#local-6989586621679190125"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679190126"><span class="annot"><span class="annottext">DIState
</span><a href="#local-6989586621679190126"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679190127"><span class="annot"><span class="annottext">Signal DBLOCK
</span><a href="#local-6989586621679190127"><span class="hs-identifier hs-var">dblock</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rule DBLOCK 'Transition (RuleContext 'Transition DBLOCK)
F (Clause DBLOCK 'Transition) (TRC DBLOCK)
forall sts (rtype :: RuleType).
Rule sts rtype (RuleContext rtype sts)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#judgmentContext"><span class="hs-identifier hs-var">judgmentContext</span></a></span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679190128"><span class="annot"><span class="annottext">nextSlot :: Slot
</span><a href="#local-6989586621679190128"><span class="hs-identifier hs-var hs-var">nextSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Signal DBLOCK
DBlock
</span><a href="#local-6989586621679190127"><span class="hs-identifier hs-var">dblock</span></a></span><span> </span><span class="annot"><span class="annottext">DBlock -&gt; Getting Slot DBlock Slot -&gt; Slot
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Slot DBlock Slot
Lens' DBlock Slot
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#blockSlot"><span class="hs-identifier hs-var">blockSlot</span></a></span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><span class="annottext">DIEnv
</span><a href="#local-6989586621679190125"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">DIEnv -&gt; Getting Slot DIEnv Slot -&gt; Slot
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Slot DIEnv Slot
forall s a. HasSlot s a =&gt; Lens' s a
Lens' DIEnv Slot
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#slot"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679190128"><span class="hs-identifier hs-var">nextSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; PredicateFailure DBLOCK -&gt; Rule DBLOCK 'Transition ()
forall sts (ctx :: RuleType).
Bool -&gt; PredicateFailure sts -&gt; Rule sts ctx ()
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#%3F%21"><span class="hs-operator hs-var">?!</span></a></span><span> </span><span class="annot"><span class="annottext">PredicateFailure DBLOCK
DBlockPredicateFailure
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#NotIncreasingBlockSlot"><span class="hs-identifier hs-var">NotIncreasingBlockSlot</span></a></span><span>
</span><span id="line-170"></span><span>        </span><span id="local-6989586621679190131"><span class="annot"><span class="annottext">DIState
</span><a href="#local-6989586621679190131"><span class="hs-identifier hs-var">stNext</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall sub super (rtype :: RuleType).
Embed sub super =&gt;
RuleContext rtype sub -&gt; Rule super rtype (State sub)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#trans"><span class="hs-identifier hs-var">trans</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DELEG"><span class="hs-identifier hs-type">DELEG</span></a></span><span> </span><span class="annot"><span class="annottext">(RuleContext 'Transition DELEG
 -&gt; Rule DBLOCK 'Transition (State DELEG))
-&gt; RuleContext 'Transition DELEG
-&gt; Rule DBLOCK 'Transition (State DELEG)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Environment DELEG, State DELEG, Signal DELEG) -&gt; TRC DELEG
forall sts. (Environment sts, State sts, Signal sts) -&gt; TRC sts
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#TRC"><span class="hs-identifier hs-var">TRC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DIEnv
Environment DELEG
</span><a href="#local-6989586621679190125"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DIState
State DELEG
</span><a href="#local-6989586621679190126"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Signal DBLOCK
DBlock
</span><a href="#local-6989586621679190127"><span class="hs-identifier hs-var">dblock</span></a></span><span> </span><span class="annot"><span class="annottext">DBlock -&gt; Getting [DCert] DBlock [DCert] -&gt; [DCert]
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting [DCert] DBlock [DCert]
Lens' DBlock [DCert]
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#blockCerts"><span class="hs-identifier hs-var">blockCerts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679190132"><span class="annot"><span class="annottext">nextEpoch :: Epoch
</span><a href="#local-6989586621679190132"><span class="hs-identifier hs-var hs-var">nextEpoch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-172"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">DIEnv -&gt; BlockCount
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#_dSEnvK"><span class="hs-identifier hs-var">_dSEnvK</span></a></span><span> </span><span class="annot"><span class="annottext">DIEnv
</span><a href="#local-6989586621679190125"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">BlockCount -&gt; BlockCount -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">BlockCount
</span><span class="hs-number">0</span></span><span>
</span><span id="line-173"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Epoch
</span><span class="hs-number">0</span></span><span>
</span><span id="line-174"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Epoch
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#Epoch"><span class="hs-identifier hs-var">Epoch</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Epoch) -&gt; Word64 -&gt; Epoch
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Word64
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#unSlot"><span class="hs-identifier hs-var">unSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679190128"><span class="hs-identifier hs-var">nextSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">BlockCount -&gt; Word64
forall n. Integral n =&gt; BlockCount -&gt; n
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.GlobalParams.html#slotsPerEpoch"><span class="hs-identifier hs-var">slotsPerEpoch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DIEnv -&gt; BlockCount
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#_dSEnvK"><span class="hs-identifier hs-var">_dSEnvK</span></a></span><span> </span><span class="annot"><span class="annottext">DIEnv
</span><a href="#local-6989586621679190125"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="annottext">(DIEnv, DIState) -&gt; F (Clause DBLOCK 'Transition) (DIEnv, DIState)
forall a. a -&gt; F (Clause DBLOCK 'Transition) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-176"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">DIEnv
</span><a href="#local-6989586621679190125"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-177"></span><span>              </span><span class="annot"><span class="annottext">DIEnv -&gt; (DIEnv -&gt; DIEnv) -&gt; DIEnv
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; Identity Slot) -&gt; DIEnv -&gt; Identity DIEnv
forall s a. HasSlot s a =&gt; Lens' s a
Lens' DIEnv Slot
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#slot"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">((Slot -&gt; Identity Slot) -&gt; DIEnv -&gt; Identity DIEnv)
-&gt; Slot -&gt; DIEnv -&gt; DIEnv
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679190128"><span class="hs-identifier hs-var">nextSlot</span></a></span><span>
</span><span id="line-178"></span><span>              </span><span class="annot"><span class="annottext">DIEnv -&gt; (DIEnv -&gt; DIEnv) -&gt; DIEnv
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Epoch -&gt; Identity Epoch) -&gt; DIEnv -&gt; Identity DIEnv
forall s a. HasEpoch s a =&gt; Lens' s a
Lens' DIEnv Epoch
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#epoch"><span class="hs-identifier hs-var">epoch</span></a></span><span> </span><span class="annot"><span class="annottext">((Epoch -&gt; Identity Epoch) -&gt; DIEnv -&gt; Identity DIEnv)
-&gt; Epoch -&gt; DIEnv -&gt; DIEnv
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Epoch
</span><a href="#local-6989586621679190132"><span class="hs-identifier hs-var">nextEpoch</span></a></span><span>
</span><span id="line-179"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DIState
</span><a href="#local-6989586621679190131"><span class="hs-identifier hs-var">stNext</span></a></span><span>
</span><span id="line-180"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679190143"><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DELEG"><span class="hs-identifier hs-type">DELEG</span></a></span><span> </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBLOCK"><span class="hs-identifier hs-type">DBLOCK</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>  </span><span id="local-6989586621679190148"><span class="annot"><span class="annottext">wrapFailed :: PredicateFailure DELEG -&gt; PredicateFailure DBLOCK
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#wrapFailed"><span class="hs-identifier hs-var hs-var hs-var hs-var">wrapFailed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PredicateFailure DELEG -&gt; PredicateFailure DBLOCK
PredicateFailure DELEG -&gt; DBlockPredicateFailure
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DPF"><span class="hs-identifier hs-var">DPF</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- | Check that all the delegation certificates in the trace were correctly</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- applied.</span><span>
</span><span id="line-188"></span><span id="local-6989586621679189431"><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#dcertsAreTriggeredInTrace"><span class="hs-identifier hs-type">dcertsAreTriggeredInTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#MonadTest"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189431"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBLOCK"><span class="hs-identifier hs-type">DBLOCK</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679189431"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-189"></span><span id="dcertsAreTriggeredInTrace"><span class="annot"><span class="annottext">dcertsAreTriggeredInTrace :: forall (m :: * -&gt; *). MonadTest m =&gt; Trace DBLOCK -&gt; m ()
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#dcertsAreTriggeredInTrace"><span class="hs-identifier hs-var hs-var">dcertsAreTriggeredInTrace</span></a></span></span><span> </span><span id="local-6989586621679190179"><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190179"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><span class="annottext">Bimap VKeyGenesis VKey
</span><a href="#local-6989586621679190180"><span class="hs-identifier hs-var">lastDms</span></a></span><span> </span><span class="annot"><span class="annottext">Bimap VKeyGenesis VKey -&gt; Bimap VKeyGenesis VKey -&gt; m ()
forall (m :: * -&gt; *) a.
(MonadTest m, Eq a, Show a, HasCallStack) =&gt;
a -&gt; a -&gt; m ()
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#%3D%3D%3D"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">Bimap VKeyGenesis VKey
</span><a href="#local-6989586621679190181"><span class="hs-identifier hs-var">trExpectedDms</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621679190180"><span class="annot"><span class="annottext">lastDms :: Bimap VKeyGenesis VKey
</span><a href="#local-6989586621679190180"><span class="hs-identifier hs-var hs-var">lastDms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DIState
</span><a href="#local-6989586621679190182"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">DIState
-&gt; Getting
     (Bimap VKeyGenesis VKey) DIState (Bimap VKeyGenesis VKey)
-&gt; Bimap VKeyGenesis VKey
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (Bimap VKeyGenesis VKey) DIState (Bimap VKeyGenesis VKey)
forall s a. HasDelegationMap s a =&gt; Lens' s a
Lens' DIState (Bimap VKeyGenesis VKey)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#delegationMap"><span class="hs-identifier hs-var">delegationMap</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621679190181"><span class="annot"><span class="annottext">trExpectedDms :: Bimap VKeyGenesis VKey
</span><a href="#local-6989586621679190181"><span class="hs-identifier hs-var hs-var">trExpectedDms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; [(Int, DBlock)] -&gt; Bimap VKeyGenesis VKey
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#expectedDms"><span class="hs-identifier hs-var">expectedDms</span></a></span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679190185"><span class="hs-identifier hs-var">lastSlot</span></a></span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Int) -&gt; (BlockCount -&gt; Word64) -&gt; BlockCount -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SlotCount -&gt; Word64
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#unSlotCount"><span class="hs-identifier hs-var">unSlotCount</span></a></span><span> </span><span class="annot"><span class="annottext">(SlotCount -&gt; Word64)
-&gt; (BlockCount -&gt; SlotCount) -&gt; BlockCount -&gt; Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BlockCount -&gt; SlotCount
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#liveAfter"><span class="hs-identifier hs-var">liveAfter</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DIEnv -&gt; BlockCount
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#_dSEnvK"><span class="hs-identifier hs-var">_dSEnvK</span></a></span><span> </span><span class="annot"><span class="annottext">DIEnv
</span><a href="#local-6989586621679190188"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>        </span><span class="annot"><span class="annottext">[(Int, DBlock)]
</span><a href="#local-6989586621679190189"><span class="hs-identifier hs-var">slotsAndDcerts</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679190188"><span class="annot"><span class="annottext">DIEnv
</span><a href="#local-6989586621679190188"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679190182"><span class="annot"><span class="annottext">DIState
</span><a href="#local-6989586621679190182"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Trace DBLOCK -&gt; State DBLOCK
forall s. Trace s -&gt; State s
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#lastState"><span class="hs-identifier hs-var">lastState</span></a></span><span> </span><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190179"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><a href="#local-6989586621679190185"><span class="hs-identifier hs-type">lastSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621679190185"><span class="annot"><span class="annottext">lastSlot :: Int
</span><a href="#local-6989586621679190185"><span class="hs-identifier hs-var hs-var">lastSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, DBlock) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Int, DBlock) -&gt; Int)
-&gt; ([(Int, DBlock)] -&gt; (Int, DBlock)) -&gt; [(Int, DBlock)] -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Int, DBlock)] -&gt; (Int, DBlock)
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">([(Int, DBlock)] -&gt; Int) -&gt; [(Int, DBlock)] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Int, DBlock)]
</span><a href="#local-6989586621679190189"><span class="hs-identifier hs-var">slotsAndDcerts</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><a href="#local-6989586621679190189"><span class="hs-identifier hs-type">slotsAndDcerts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBlock"><span class="hs-identifier hs-type">DBlock</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-206"></span><span>    </span><span id="local-6989586621679190189"><span class="annot"><span class="annottext">slotsAndDcerts :: [(Int, DBlock)]
</span><a href="#local-6989586621679190189"><span class="hs-identifier hs-var hs-var">slotsAndDcerts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-207"></span><span>      </span><span class="annot"><span class="annottext">((DIEnv, DIState) -&gt; Int)
-&gt; ((DIEnv, DIState), DBlock) -&gt; (Int, DBlock)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Int (DIEnv, DIState) Int -&gt; (DIEnv, DIState) -&gt; Int
forall a s. Getting a s a -&gt; s -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Extras.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((DIEnv, DIState) -&gt; DIEnv) -&gt; SimpleGetter (DIEnv, DIState) DIEnv
forall s a. (s -&gt; a) -&gt; SimpleGetter s a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#to"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">(DIEnv, DIState) -&gt; DIEnv
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">Getting Int (DIEnv, DIState) DIEnv
-&gt; ((Int -&gt; Const Int Int) -&gt; DIEnv -&gt; Const Int DIEnv)
-&gt; Getting Int (DIEnv, DIState) Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; Const Int Slot) -&gt; DIEnv -&gt; Const Int DIEnv
forall s a. HasSlot s a =&gt; Lens' s a
Lens' DIEnv Slot
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#slot"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">((Slot -&gt; Const Int Slot) -&gt; DIEnv -&gt; Const Int DIEnv)
-&gt; ((Int -&gt; Const Int Int) -&gt; Slot -&gt; Const Int Slot)
-&gt; (Int -&gt; Const Int Int)
-&gt; DIEnv
-&gt; Const Int DIEnv
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; Word64) -&gt; SimpleGetter Slot Word64
forall s a. (s -&gt; a) -&gt; SimpleGetter s a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#to"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Word64
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#unSlot"><span class="hs-identifier hs-var">unSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Int Slot Word64
-&gt; ((Int -&gt; Const Int Int) -&gt; Word64 -&gt; Const Int Word64)
-&gt; (Int -&gt; Const Int Int)
-&gt; Slot
-&gt; Const Int Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Int) -&gt; SimpleGetter Word64 Int
forall s a. (s -&gt; a) -&gt; SimpleGetter s a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#to"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><span class="annottext">(((DIEnv, DIState), DBlock) -&gt; (Int, DBlock))
-&gt; [((DIEnv, DIState), DBlock)] -&gt; [(Int, DBlock)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TraceOrder -&gt; Trace DBLOCK -&gt; [(State DBLOCK, Signal DBLOCK)]
forall s. TraceOrder -&gt; Trace s -&gt; [(State s, Signal s)]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#preStatesAndSignals"><span class="hs-identifier hs-var">preStatesAndSignals</span></a></span><span> </span><span class="annot"><span class="annottext">TraceOrder
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#OldestFirst"><span class="hs-identifier hs-var">OldestFirst</span></a></span><span> </span><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190179"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Compute the expected delegation map after applying the sequence of</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- delegation certificates contained in the given blocks.</span><span>
</span><span id="line-212"></span><span class="hs-comment">--</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- Delegation certificates are applied in the order they appear in the within a</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- block, and blocks are considered in the order they appear on the list passed</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- as parameter.</span><span>
</span><span id="line-216"></span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#expectedDms"><span class="hs-identifier hs-type">expectedDms</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Last slot that should have been considered for certificate activation.</span></span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Delegation certificate liveness parameter.</span></span><span>
</span><span id="line-220"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-comment">-- | Delegation certificates to apply, and the slot at which these</span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-comment">-- certificates where scheduled.</span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBlock"><span class="hs-identifier hs-type">DBlock</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/bimap-0.5.0-27098ee257ef2e554baff63313c57dc699014713bec5c50671e808ed86f54646/share/doc/html/src/Data.Bimap.html#Bimap"><span class="hs-identifier hs-type">Bimap</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#VKeyGenesis"><span class="hs-identifier hs-type">VKeyGenesis</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#VKey"><span class="hs-identifier hs-type">VKey</span></a></span><span>
</span><span id="line-225"></span><span id="expectedDms"><span class="annot"><span class="annottext">expectedDms :: Int -&gt; Int -&gt; [(Int, DBlock)] -&gt; Bimap VKeyGenesis VKey
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#expectedDms"><span class="hs-identifier hs-var hs-var">expectedDms</span></a></span></span><span> </span><span id="local-6989586621679190193"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679190193"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679190194"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679190194"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679190195"><span class="annot"><span class="annottext">[(Int, DBlock)]
</span><a href="#local-6989586621679190195"><span class="hs-identifier hs-var">sbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><span class="annottext">(Bimap VKeyGenesis VKey
 -&gt; (VKeyGenesis, VKey) -&gt; Bimap VKeyGenesis VKey)
-&gt; Bimap VKeyGenesis VKey
-&gt; [(VKeyGenesis, VKey)]
-&gt; Bimap VKeyGenesis VKey
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">F.foldl'</span></span><span> </span><span class="annot"><span class="annottext">Bimap VKeyGenesis VKey
-&gt; (VKeyGenesis, VKey) -&gt; Bimap VKeyGenesis VKey
</span><a href="#local-6989586621679190196"><span class="hs-identifier hs-var">insertIfInjective</span></a></span><span> </span><span class="annot"><span class="annottext">Bimap VKeyGenesis VKey
forall a b. Bimap a b
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/bimap-0.5.0-27098ee257ef2e554baff63313c57dc699014713bec5c50671e808ed86f54646/share/doc/html/src/Data.Bimap.html#empty"><span class="hs-identifier hs-var">Bimap.empty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DCert -&gt; (VKeyGenesis, VKey)) -&gt; [DCert] -&gt; [(VKeyGenesis, VKey)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DCert -&gt; (VKeyGenesis, VKey)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#delegatorDelegate"><span class="hs-identifier hs-var">delegatorDelegate</span></a></span><span> </span><span class="annot"><span class="annottext">[DCert]
</span><a href="#local-6989586621679190198"><span class="hs-identifier hs-var">activeCerts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><a href="#local-6989586621679190196"><span class="hs-identifier hs-type">insertIfInjective</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-229"></span><span>      </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/bimap-0.5.0-27098ee257ef2e554baff63313c57dc699014713bec5c50671e808ed86f54646/share/doc/html/src/Data.Bimap.html#Bimap"><span class="hs-identifier hs-type">Bimap</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#VKeyGenesis"><span class="hs-identifier hs-type">VKeyGenesis</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#VKey"><span class="hs-identifier hs-type">VKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-230"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#VKeyGenesis"><span class="hs-identifier hs-type">VKeyGenesis</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#VKey"><span class="hs-identifier hs-type">VKey</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-231"></span><span>      </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/bimap-0.5.0-27098ee257ef2e554baff63313c57dc699014713bec5c50671e808ed86f54646/share/doc/html/src/Data.Bimap.html#Bimap"><span class="hs-identifier hs-type">Bimap</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#VKeyGenesis"><span class="hs-identifier hs-type">VKeyGenesis</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#VKey"><span class="hs-identifier hs-type">VKey</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span id="local-6989586621679190196"><span class="annot"><span class="annottext">insertIfInjective :: Bimap VKeyGenesis VKey
-&gt; (VKeyGenesis, VKey) -&gt; Bimap VKeyGenesis VKey
</span><a href="#local-6989586621679190196"><span class="hs-identifier hs-var hs-var">insertIfInjective</span></a></span></span><span> </span><span id="local-6989586621679190199"><span class="annot"><span class="annottext">Bimap VKeyGenesis VKey
</span><a href="#local-6989586621679190199"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679190200"><span class="annot"><span class="annottext">VKeyGenesis
</span><a href="#local-6989586621679190200"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679190201"><span class="annot"><span class="annottext">VKey
</span><a href="#local-6989586621679190201"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-233"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">VKey -&gt; Bimap VKeyGenesis VKey -&gt; Bool
forall a b. (Ord a, Ord b) =&gt; b -&gt; Bimap a b -&gt; Bool
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/bimap-0.5.0-27098ee257ef2e554baff63313c57dc699014713bec5c50671e808ed86f54646/share/doc/html/src/Data.Bimap.html#memberR"><span class="hs-identifier hs-var">Bimap.memberR</span></a></span><span> </span><span class="annot"><span class="annottext">VKey
</span><a href="#local-6989586621679190201"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Bimap VKeyGenesis VKey
</span><a href="#local-6989586621679190199"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bimap VKeyGenesis VKey
</span><a href="#local-6989586621679190199"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-235"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">VKeyGenesis
-&gt; VKey -&gt; Bimap VKeyGenesis VKey -&gt; Bimap VKeyGenesis VKey
forall a b. (Ord a, Ord b) =&gt; a -&gt; b -&gt; Bimap a b -&gt; Bimap a b
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/bimap-0.5.0-27098ee257ef2e554baff63313c57dc699014713bec5c50671e808ed86f54646/share/doc/html/src/Data.Bimap.html#insert"><span class="hs-identifier hs-var">Bimap.insert</span></a></span><span> </span><span class="annot"><span class="annottext">VKeyGenesis
</span><a href="#local-6989586621679190200"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">VKey
</span><a href="#local-6989586621679190201"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Bimap VKeyGenesis VKey
</span><a href="#local-6989586621679190199"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><a href="#local-6989586621679190198"><span class="hs-identifier hs-type">activeCerts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DCert"><span class="hs-identifier hs-type">DCert</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621679190198"><span class="annot"><span class="annottext">activeCerts :: [DCert]
</span><a href="#local-6989586621679190198"><span class="hs-identifier hs-var hs-var">activeCerts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DBlock -&gt; [DCert]) -&gt; [DBlock] -&gt; [DCert]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">DBlock -&gt; [DCert]
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#_blockCerts"><span class="hs-identifier hs-var">_blockCerts</span></a></span><span> </span><span class="annot"><span class="annottext">[DBlock]
</span><a href="#local-6989586621679190205"><span class="hs-identifier hs-var">activeBlocks</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><a href="#local-6989586621679190205"><span class="hs-identifier hs-type">activeBlocks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBlock"><span class="hs-identifier hs-type">DBlock</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-240"></span><span>    </span><span id="local-6989586621679190205"><span class="annot"><span class="annottext">activeBlocks :: [DBlock]
</span><a href="#local-6989586621679190205"><span class="hs-identifier hs-var hs-var">activeBlocks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-241"></span><span>      </span><span class="annot"><span class="annottext">(Int, DBlock) -&gt; DBlock
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span>
</span><span id="line-242"></span><span>        </span><span class="annot"><span class="annottext">((Int, DBlock) -&gt; DBlock) -&gt; [(Int, DBlock)] -&gt; [DBlock]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">((Int, DBlock) -&gt; Bool) -&gt; [(Int, DBlock)] -&gt; [(Int, DBlock)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679190208"><span class="hs-identifier hs-var">activationSlot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, DBlock) -&gt; Int) -&gt; (Int, DBlock) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, DBlock) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int, DBlock)]
</span><a href="#local-6989586621679190195"><span class="hs-identifier hs-var">sbs</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span>    </span><span class="annot"><a href="#local-6989586621679190208"><span class="hs-identifier hs-type">activationSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-245"></span><span>    </span><span id="local-6989586621679190208"><span class="annot"><span class="annottext">activationSlot :: Int
</span><a href="#local-6989586621679190208"><span class="hs-identifier hs-var hs-var">activationSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679190193"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679190194"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679190212"><span id="local-6989586621679190219"><span id="local-6989586621679190222"><span id="local-6989586621679190225"><span id="local-6989586621679190228"><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#HasTrace"><span class="hs-identifier hs-type">HasTrace</span></a></span><span> </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBLOCK"><span class="hs-identifier hs-type">DBLOCK</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621679190241"><span class="annot"><span class="annottext">envGen :: Word64 -&gt; Gen (Environment DBLOCK)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#envGen"><span class="hs-identifier hs-var hs-var hs-var hs-var">envGen</span></a></span></span><span>
</span><span id="line-249"></span><span>    </span><span id="local-6989586621679190242"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679190242"><span class="hs-identifier hs-var">chainLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-250"></span><span>      </span><span class="annot"><span class="annottext">Set VKeyGenesis -&gt; Epoch -&gt; Slot -&gt; BlockCount -&gt; DIEnv
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DSEnv"><span class="hs-identifier hs-var">DSEnv</span></a></span><span>
</span><span id="line-251"></span><span>        </span><span class="annot"><span class="annottext">(Set VKeyGenesis -&gt; Epoch -&gt; Slot -&gt; BlockCount -&gt; DIEnv)
-&gt; GenT Identity (Set VKeyGenesis)
-&gt; GenT Identity (Epoch -&gt; Slot -&gt; BlockCount -&gt; DIEnv)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">GenT Identity (Set VKeyGenesis)
</span><a href="#local-6989586621679190244"><span class="hs-identifier hs-var">allowedDelegators'</span></a></span><span>
</span><span id="line-252"></span><span>        </span><span class="hs-comment">-- We do not expect the current epoch to have an influence on the tests, so</span><span>
</span><span id="line-253"></span><span>        </span><span class="hs-comment">-- we chose a small value here.</span><span>
</span><span id="line-254"></span><span>        </span><span class="annot"><span class="annottext">GenT Identity (Epoch -&gt; Slot -&gt; BlockCount -&gt; DIEnv)
-&gt; GenT Identity Epoch
-&gt; GenT Identity (Slot -&gt; BlockCount -&gt; DIEnv)
forall a b.
GenT Identity (a -&gt; b) -&gt; GenT Identity a -&gt; GenT Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; GenT Identity Epoch
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.Generators.html#epochGen"><span class="hs-identifier hs-var">epochGen</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span>
</span><span id="line-255"></span><span>        </span><span class="hs-comment">-- As with epochs, the current slot should not have influence in the tests.</span><span>
</span><span id="line-256"></span><span>        </span><span class="annot"><span class="annottext">GenT Identity (Slot -&gt; BlockCount -&gt; DIEnv)
-&gt; GenT Identity Slot -&gt; GenT Identity (BlockCount -&gt; DIEnv)
forall a b.
GenT Identity (a -&gt; b) -&gt; GenT Identity a -&gt; GenT Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; GenT Identity Slot
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.Generators.html#slotGen"><span class="hs-identifier hs-var">slotGen</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span>
</span><span id="line-257"></span><span>        </span><span class="hs-comment">-- 2160 the value of @k@ used in production. However, delegation certificates are activated</span><span>
</span><span id="line-258"></span><span>        </span><span class="hs-comment">-- @2*k@ slots from the slot in which they are issued. This means that if we want to see</span><span>
</span><span id="line-259"></span><span>        </span><span class="hs-comment">-- delegation activations, we need to choose a small value for @k@ since we do not want to blow</span><span>
</span><span id="line-260"></span><span>        </span><span class="hs-comment">-- up the testing time by using large trace lengths.</span><span>
</span><span id="line-261"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-262"></span><span>        </span><span class="hs-comment">-- Choosing a small @k@ value amounts to picking a large number of epochs. Given a trace length</span><span>
</span><span id="line-263"></span><span>        </span><span class="hs-comment">-- of @n@, if we have @10k@ slots per-epoch, we can have at most @n `div` 10@ epochs (by</span><span>
</span><span id="line-264"></span><span>        </span><span class="hs-comment">-- choosing @k == 1@).</span><span>
</span><span id="line-265"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><span class="annottext">GenT Identity (BlockCount -&gt; DIEnv)
-&gt; GenT Identity BlockCount -&gt; GenT Identity DIEnv
forall a b.
GenT Identity (a -&gt; b) -&gt; GenT Identity a -&gt; GenT Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; GenT Identity BlockCount
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.Generators.html#k"><span class="hs-identifier hs-var">CoreGen.k</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679190242"><span class="hs-identifier hs-var">chainLength</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679190242"><span class="hs-identifier hs-var">chainLength</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>        </span><span class="hs-comment">-- We scale the number of delegators linearly up to twice the number of genesis keys we use in</span><span>
</span><span id="line-269"></span><span>        </span><span class="hs-comment">-- production. Factor 2 is chosen ad-hoc here.</span><span>
</span><span id="line-270"></span><span>        </span><span id="local-6989586621679190244"><span class="annot"><span class="annottext">allowedDelegators' :: GenT Identity (Set VKeyGenesis)
</span><a href="#local-6989586621679190244"><span class="hs-identifier hs-var hs-var">allowedDelegators'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-271"></span><span>          </span><span id="local-6989586621679190271"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679190271"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Range Natural -&gt; GenT Identity Natural
forall (m :: * -&gt; *) a. (MonadGen m, Integral a) =&gt; Range a -&gt; m a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Gen.html#integral"><span class="hs-identifier hs-var">Gen.integral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Range Natural
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Range.html#linear"><span class="hs-identifier hs-var">Range.linear</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">13</span></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>          </span><span class="annot"><span class="annottext">Set VKeyGenesis -&gt; GenT Identity (Set VKeyGenesis)
forall a. a -&gt; GenT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Set VKeyGenesis -&gt; GenT Identity (Set VKeyGenesis))
-&gt; Set VKeyGenesis -&gt; GenT Identity (Set VKeyGenesis)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">[VKeyGenesis] -&gt; Set VKeyGenesis
forall a. Eq a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromAscList</span></span><span> </span><span class="annot"><span class="annottext">([VKeyGenesis] -&gt; Set VKeyGenesis)
-&gt; [VKeyGenesis] -&gt; Set VKeyGenesis
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; VKeyGenesis
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#mkVKeyGenesis"><span class="hs-identifier hs-var">mkVKeyGenesis</span></a></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; VKeyGenesis) -&gt; [Natural] -&gt; [VKeyGenesis]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679190271"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span>  </span><span id="local-6989586621679190279"><span class="annot"><span class="annottext">sigGen :: SignalGenerator DBLOCK
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#sigGen"><span class="hs-identifier hs-var hs-var hs-var hs-var">sigGen</span></a></span></span><span> </span><span class="annot"><span class="annottext">Environment DBLOCK
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679190280"><span class="annot"><span class="annottext">DIEnv
</span><a href="#local-6989586621679190280"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679190281"><span class="annot"><span class="annottext">DIState
</span><a href="#local-6989586621679190281"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><span class="annottext">Slot -&gt; [DCert] -&gt; DBlock
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBlock"><span class="hs-identifier hs-var">DBlock</span></a></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; [DCert] -&gt; DBlock)
-&gt; GenT Identity Slot -&gt; GenT Identity ([DCert] -&gt; DBlock)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DIEnv -&gt; GenT Identity Slot
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#nextSlotGen"><span class="hs-identifier hs-var">nextSlotGen</span></a></span><span> </span><span class="annot"><span class="annottext">DIEnv
</span><a href="#local-6989586621679190280"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">GenT Identity ([DCert] -&gt; DBlock)
-&gt; GenT Identity [DCert] -&gt; GenT Identity DBlock
forall a b.
GenT Identity (a -&gt; b) -&gt; GenT Identity a -&gt; GenT Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall s. HasTrace s =&gt; SignalGenerator s
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#sigGen"><span class="hs-identifier hs-var">sigGen</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DELEG"><span class="hs-identifier hs-type">DELEG</span></a></span><span> </span><span class="annot"><span class="annottext">DIEnv
Environment DELEG
</span><a href="#local-6989586621679190280"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">DIState
State DELEG
</span><a href="#local-6989586621679190281"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-comment">-- | Generate a next slot. We want the resulting trace to include a large number of epoch changes,</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- so we generate an epoch change with higher frequency.</span><span>
</span><span id="line-279"></span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#nextSlotGen"><span class="hs-identifier hs-type">nextSlotGen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DSEnv"><span class="hs-identifier hs-type">DSEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#Slot"><span class="hs-identifier hs-type">Slot</span></a></span><span>
</span><span id="line-280"></span><span id="nextSlotGen"><span class="annot"><span class="annottext">nextSlotGen :: DIEnv -&gt; GenT Identity Slot
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#nextSlotGen"><span class="hs-identifier hs-var hs-var">nextSlotGen</span></a></span></span><span> </span><span id="local-6989586621679190283"><span class="annot"><span class="annottext">DIEnv
</span><a href="#local-6989586621679190283"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><span class="annottext">Word64 -&gt; Slot
</span><a href="#local-6989586621679190284"><span class="hs-identifier hs-var">incSlot</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><span class="annottext">(Word64 -&gt; Slot) -&gt; GenT Identity Word64 -&gt; GenT Identity Slot
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Int, GenT Identity Word64)] -&gt; GenT Identity Word64
forall (m :: * -&gt; *) a.
(HasCallStack, MonadGen m) =&gt;
[(Int, m a)] -&gt; m a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Gen.html#frequency"><span class="hs-identifier hs-var">Gen.frequency</span></a></span><span>
</span><span id="line-283"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Range Word64 -&gt; GenT Identity Word64
forall (m :: * -&gt; *) a. (MonadGen m, Integral a) =&gt; Range a -&gt; m a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Gen.html#integral"><span class="hs-identifier hs-var">Gen.integral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Range Word64
forall a. a -&gt; a -&gt; Range a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Range.html#constant"><span class="hs-identifier hs-var">Range.constant</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; GenT Identity Word64
forall a. a -&gt; GenT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; GenT Identity Word64) -&gt; Word64 -&gt; GenT Identity Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">BlockCount -&gt; Word64
forall n. Integral n =&gt; BlockCount -&gt; n
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.GlobalParams.html#slotsPerEpoch"><span class="hs-identifier hs-var">slotsPerEpoch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DIEnv -&gt; BlockCount
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#_dSEnvK"><span class="hs-identifier hs-var">_dSEnvK</span></a></span><span> </span><span class="annot"><span class="annottext">DIEnv
</span><a href="#local-6989586621679190283"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621679190284"><span class="annot"><span class="annottext">incSlot :: Word64 -&gt; Slot
</span><a href="#local-6989586621679190284"><span class="hs-identifier hs-var hs-var">incSlot</span></a></span></span><span> </span><span id="local-6989586621679190287"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679190287"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DIEnv
</span><a href="#local-6989586621679190283"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">DIEnv -&gt; Getting Slot DIEnv Slot -&gt; Slot
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Slot DIEnv Slot
forall s a. HasSlot s a =&gt; Lens' s a
Lens' DIEnv Slot
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#slot"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Slot -&gt; SlotCount -&gt; Slot
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#addSlot"><span class="hs-operator hs-var">`addSlot`</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; SlotCount
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#SlotCount"><span class="hs-identifier hs-var">SlotCount</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679190287"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#HasSizeInfo"><span class="hs-identifier hs-type">HasSizeInfo</span></a></span><span> </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBlock"><span class="hs-identifier hs-type">DBlock</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621679190292"><span class="annot"><span class="annottext">isTrivial :: DBlock -&gt; Bool
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#isTrivial"><span class="hs-identifier hs-var hs-var hs-var hs-var">isTrivial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DCert] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([DCert] -&gt; Bool) -&gt; (DBlock -&gt; [DCert]) -&gt; DBlock -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting [DCert] DBlock [DCert] -&gt; DBlock -&gt; [DCert]
forall a s. Getting a s a -&gt; s -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Extras.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting [DCert] DBlock [DCert]
Lens' DBlock [DCert]
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#blockCerts"><span class="hs-identifier hs-var">blockCerts</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#dcertsAreTriggered"><span class="hs-identifier hs-type">dcertsAreTriggered</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-293"></span><span id="dcertsAreTriggered"><span class="annot"><span class="annottext">dcertsAreTriggered :: Property
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#dcertsAreTriggered"><span class="hs-identifier hs-var hs-var">dcertsAreTriggered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-294"></span><span>  </span><span class="annot"><span class="annottext">TestLimit -&gt; Property -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#withTests"><span class="hs-identifier hs-var">withTests</span></a></span><span> </span><span class="annot"><span class="annottext">TestLimit
</span><span class="hs-number">300</span></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-296"></span><span>      </span><span class="hs-comment">-- The number of tests was determined ad-hoc, since the default failed to</span><span>
</span><span id="line-297"></span><span>      </span><span class="hs-comment">-- uncover the presence of errors.</span><span>
</span><span id="line-298"></span><span>      </span><span class="annot"><span class="annottext">Gen (Trace DBLOCK) -&gt; PropertyT IO (Trace DBLOCK)
forall (m :: * -&gt; *) a.
(Monad m, Show a, HasCallStack) =&gt;
Gen a -&gt; PropertyT m a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BaseEnv DBLOCK -&gt; Word64 -&gt; Gen (Trace DBLOCK)
forall s.
(HasTrace s, HasSizeInfo (Signal s)) =&gt;
BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#nonTrivialTrace"><span class="hs-identifier hs-var">nonTrivialTrace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PropertyT IO (Trace DBLOCK)
-&gt; (Trace DBLOCK -&gt; PropertyT IO ()) -&gt; PropertyT IO ()
forall a b.
PropertyT IO a -&gt; (a -&gt; PropertyT IO b) -&gt; PropertyT IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Trace DBLOCK -&gt; PropertyT IO ()
forall (m :: * -&gt; *). MonadTest m =&gt; Trace DBLOCK -&gt; m ()
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#dcertsAreTriggeredInTrace"><span class="hs-identifier hs-var">dcertsAreTriggeredInTrace</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#dblockTracesAreClassified"><span class="hs-identifier hs-type">dblockTracesAreClassified</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-301"></span><span id="dblockTracesAreClassified"><span class="annot"><span class="annottext">dblockTracesAreClassified :: Property
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#dblockTracesAreClassified"><span class="hs-identifier hs-var hs-var">dblockTracesAreClassified</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestLimit -&gt; Property -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#withTests"><span class="hs-identifier hs-var">withTests</span></a></span><span> </span><span class="annot"><span class="annottext">TestLimit
</span><span class="hs-number">200</span></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679190296"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679190296"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679190297"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679190297"><span class="hs-identifier hs-var">step</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">100</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>    </span><span id="local-6989586621679190298"><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190298"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Trace DBLOCK) -&gt; PropertyT IO (Trace DBLOCK)
forall (m :: * -&gt; *) a.
(Monad m, Show a, HasCallStack) =&gt;
Gen a -&gt; PropertyT m a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. HasTrace s =&gt; BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#trace"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBLOCK"><span class="hs-identifier hs-type">DBLOCK</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679190296"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><span class="annottext">Trace DBLOCK -&gt; Word64 -&gt; Word64 -&gt; PropertyT IO ()
forall s. Trace s -&gt; Word64 -&gt; Word64 -&gt; PropertyT IO ()
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#classifyTraceLength"><span class="hs-identifier hs-var">classifyTraceLength</span></a></span><span> </span><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190298"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679190296"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679190297"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-comment">-- Classify the traces by the total number of delegation certificates on</span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-comment">-- them.</span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><span class="annottext">[Char]
-&gt; [DCert]
-&gt; ([DCert] -&gt; Word64)
-&gt; Word64
-&gt; Word64
-&gt; PropertyT IO ()
forall n a.
(Show n, Integral n) =&gt;
[Char] -&gt; a -&gt; (a -&gt; n) -&gt; n -&gt; n -&gt; PropertyT IO ()
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#classifySize"><span class="hs-identifier hs-var">classifySize</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;total dcerts&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace DBLOCK -&gt; [DCert]
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#traceDCerts"><span class="hs-identifier hs-var">traceDCerts</span></a></span><span> </span><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190298"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word64) -&gt; ([DCert] -&gt; Int) -&gt; [DCert] -&gt; Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[DCert] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679190296"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679190297"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="annot"><span class="annottext">PropertyT IO ()
forall (m :: * -&gt; *). MonadTest m =&gt; m ()
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#success"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-- | Extract the delegation certificates in the blocks, in the order they would</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- have been applied.</span><span>
</span><span id="line-313"></span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#traceDCertsByBlock"><span class="hs-identifier hs-type">traceDCertsByBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBLOCK"><span class="hs-identifier hs-type">DBLOCK</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DCert"><span class="hs-identifier hs-type">DCert</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-314"></span><span id="traceDCertsByBlock"><span class="annot"><span class="annottext">traceDCertsByBlock :: Trace DBLOCK -&gt; [[DCert]]
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#traceDCertsByBlock"><span class="hs-identifier hs-var hs-var">traceDCertsByBlock</span></a></span></span><span> </span><span id="local-6989586621679190302"><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190302"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DBlock -&gt; [DCert]
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#_blockCerts"><span class="hs-identifier hs-var">_blockCerts</span></a></span><span> </span><span class="annot"><span class="annottext">(DBlock -&gt; [DCert]) -&gt; [DBlock] -&gt; [[DCert]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TraceOrder -&gt; Trace DBLOCK -&gt; [Signal DBLOCK]
forall s. TraceOrder -&gt; Trace s -&gt; [Signal s]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#traceSignals"><span class="hs-identifier hs-var">traceSignals</span></a></span><span> </span><span class="annot"><span class="annottext">TraceOrder
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#OldestFirst"><span class="hs-identifier hs-var">OldestFirst</span></a></span><span> </span><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190302"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="annot"><span class="hs-comment">-- | Flattended list of DCerts for the given Trace</span></span><span>
</span><span id="line-317"></span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#traceDCerts"><span class="hs-identifier hs-type">traceDCerts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBLOCK"><span class="hs-identifier hs-type">DBLOCK</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DCert"><span class="hs-identifier hs-type">DCert</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-318"></span><span id="traceDCerts"><span class="annot"><span class="annottext">traceDCerts :: Trace DBLOCK -&gt; [DCert]
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#traceDCerts"><span class="hs-identifier hs-var hs-var">traceDCerts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[DCert]] -&gt; [DCert]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[DCert]] -&gt; [DCert])
-&gt; (Trace DBLOCK -&gt; [[DCert]]) -&gt; Trace DBLOCK -&gt; [DCert]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Trace DBLOCK -&gt; [[DCert]]
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#traceDCertsByBlock"><span class="hs-identifier hs-var">traceDCertsByBlock</span></a></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#relevantCasesAreCovered"><span class="hs-identifier hs-type">relevantCasesAreCovered</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-321"></span><span id="relevantCasesAreCovered"><span class="annot"><span class="annottext">relevantCasesAreCovered :: Property
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#relevantCasesAreCovered"><span class="hs-identifier hs-var hs-var">relevantCasesAreCovered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestLimit -&gt; Property -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#withTests"><span class="hs-identifier hs-var">withTests</span></a></span><span> </span><span class="annot"><span class="annottext">TestLimit
</span><span class="hs-number">400</span></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679190305"><span class="annot"><span class="annottext">tl :: Word64
</span><a href="#local-6989586621679190305"><span class="hs-identifier hs-var hs-var">tl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">100</span></span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621679190306"><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190306"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Trace DBLOCK) -&gt; PropertyT IO (Trace DBLOCK)
forall (m :: * -&gt; *) a.
(Monad m, Show a, HasCallStack) =&gt;
Gen a -&gt; PropertyT m a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s. HasTrace s =&gt; BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#trace"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBLOCK"><span class="hs-identifier hs-type">DBLOCK</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679190305"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-comment">-- 40% of the traces must contain as many delegation certificates as blocks.</span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><span class="annottext">CoverPercentage -&gt; LabelName -&gt; Bool -&gt; PropertyT IO ()
forall (m :: * -&gt; *).
(MonadTest m, HasCallStack) =&gt;
CoverPercentage -&gt; LabelName -&gt; Bool -&gt; m ()
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#cover"><span class="hs-identifier hs-var">cover</span></a></span><span>
</span><span id="line-328"></span><span>      </span><span class="annot"><span class="annottext">CoverPercentage
</span><span class="hs-number">40</span></span><span>
</span><span id="line-329"></span><span>      </span><span class="annot"><span class="annottext">LabelName
</span><span class="hs-string">&quot;there are at least as many delegation certificates as blocks&quot;</span></span><span>
</span><span id="line-330"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace DBLOCK -&gt; Int
forall s. Trace s -&gt; Int
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#traceLength"><span class="hs-identifier hs-var">traceLength</span></a></span><span> </span><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190306"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">[DCert] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace DBLOCK -&gt; [DCert]
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#traceDCerts"><span class="hs-identifier hs-var">traceDCerts</span></a></span><span> </span><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190306"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-comment">-- 50% of the traces must contain at most 25% of blocks with empty delegation payload.</span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><span class="annottext">CoverPercentage -&gt; LabelName -&gt; Bool -&gt; PropertyT IO ()
forall (m :: * -&gt; *).
(MonadTest m, HasCallStack) =&gt;
CoverPercentage -&gt; LabelName -&gt; Bool -&gt; m ()
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#cover"><span class="hs-identifier hs-var">cover</span></a></span><span>
</span><span id="line-334"></span><span>      </span><span class="annot"><span class="annottext">CoverPercentage
</span><span class="hs-number">50</span></span><span>
</span><span id="line-335"></span><span>      </span><span class="annot"><span class="annottext">LabelName
</span><span class="hs-string">&quot;at most 25% of the blocks can contain empty delegation payload&quot;</span></span><span>
</span><span id="line-336"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.25</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[[DCert]] -&gt; Double
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#emptyDelegationPayloadRatio"><span class="hs-identifier hs-var">emptyDelegationPayloadRatio</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace DBLOCK -&gt; [[DCert]]
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#traceDCertsByBlock"><span class="hs-identifier hs-var">traceDCertsByBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190306"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-comment">-- 50% of the traces must contain at least 30% of delegations to this epoch.</span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><span class="annottext">CoverPercentage -&gt; LabelName -&gt; Bool -&gt; PropertyT IO ()
forall (m :: * -&gt; *).
(MonadTest m, HasCallStack) =&gt;
CoverPercentage -&gt; LabelName -&gt; Bool -&gt; m ()
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#cover"><span class="hs-identifier hs-var">cover</span></a></span><span>
</span><span id="line-340"></span><span>      </span><span class="annot"><span class="annottext">CoverPercentage
</span><span class="hs-number">50</span></span><span>
</span><span id="line-341"></span><span>      </span><span class="annot"><span class="annottext">LabelName
</span><span class="hs-string">&quot;at least 30% of all certificates delegate in this epoch&quot;</span></span><span>
</span><span id="line-342"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">[(Epoch, Epoch)] -&gt; Double
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#thisEpochDelegationsRatio"><span class="hs-identifier hs-var">thisEpochDelegationsRatio</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace DBLOCK -&gt; [(Epoch, Epoch)]
</span><a href="#local-6989586621679190309"><span class="hs-identifier hs-var">epochDelegationEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190306"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-comment">-- 70% of the traces must contain at least 50% of delegations to the next</span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-comment">-- epoch.</span><span>
</span><span id="line-346"></span><span>    </span><span class="annot"><span class="annottext">CoverPercentage -&gt; LabelName -&gt; Bool -&gt; PropertyT IO ()
forall (m :: * -&gt; *).
(MonadTest m, HasCallStack) =&gt;
CoverPercentage -&gt; LabelName -&gt; Bool -&gt; m ()
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#cover"><span class="hs-identifier hs-var">cover</span></a></span><span>
</span><span id="line-347"></span><span>      </span><span class="annot"><span class="annottext">CoverPercentage
</span><span class="hs-number">70</span></span><span>
</span><span id="line-348"></span><span>      </span><span class="annot"><span class="annottext">LabelName
</span><span class="hs-string">&quot;at least 50% of the certificates delegate in the next epoch&quot;</span></span><span>
</span><span id="line-349"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">[(Epoch, Epoch)] -&gt; Double
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#nextEpochDelegationsRatio"><span class="hs-identifier hs-var">nextEpochDelegationsRatio</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace DBLOCK -&gt; [(Epoch, Epoch)]
</span><a href="#local-6989586621679190309"><span class="hs-identifier hs-var">epochDelegationEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190306"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-comment">-- 30% of the traces must contain at least 30% of self-delegations.</span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><span class="annottext">CoverPercentage -&gt; LabelName -&gt; Bool -&gt; PropertyT IO ()
forall (m :: * -&gt; *).
(MonadTest m, HasCallStack) =&gt;
CoverPercentage -&gt; LabelName -&gt; Bool -&gt; m ()
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#cover"><span class="hs-identifier hs-var">cover</span></a></span><span>
</span><span id="line-353"></span><span>      </span><span class="annot"><span class="annottext">CoverPercentage
</span><span class="hs-number">30</span></span><span>
</span><span id="line-354"></span><span>      </span><span class="annot"><span class="annottext">LabelName
</span><span class="hs-string">&quot;at least 30% of the certificates self delegate&quot;</span></span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">[DCert] -&gt; Double
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#selfDelegationsRatio"><span class="hs-identifier hs-var">selfDelegationsRatio</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace DBLOCK -&gt; [DCert]
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#traceDCerts"><span class="hs-identifier hs-var">traceDCerts</span></a></span><span> </span><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190306"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-comment">-- 15% of the traces must contain at least 10% of delegations to the same</span><span>
</span><span id="line-358"></span><span>    </span><span class="hs-comment">-- delegate.</span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><span class="annottext">CoverPercentage -&gt; LabelName -&gt; Bool -&gt; PropertyT IO ()
forall (m :: * -&gt; *).
(MonadTest m, HasCallStack) =&gt;
CoverPercentage -&gt; LabelName -&gt; Bool -&gt; m ()
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#cover"><span class="hs-identifier hs-var">cover</span></a></span><span>
</span><span id="line-360"></span><span>      </span><span class="annot"><span class="annottext">CoverPercentage
</span><span class="hs-number">50</span></span><span>
</span><span id="line-361"></span><span>      </span><span class="annot"><span class="annottext">LabelName
</span><span class="hs-string">&quot;at least 25% of delegates have multiple delegators&quot;</span></span><span>
</span><span id="line-362"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.05</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">[DCert] -&gt; Double
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#multipleDelegationsRatio"><span class="hs-identifier hs-var">multipleDelegationsRatio</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace DBLOCK -&gt; [DCert]
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#traceDCerts"><span class="hs-identifier hs-var">traceDCerts</span></a></span><span> </span><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190306"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-comment">-- Get the epoch in which the delegation certificates of the trace were</span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-comment">-- applied, paired with the epoch of the delegation certificate.</span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><a href="#local-6989586621679190309"><span class="hs-identifier hs-type">epochDelegationEpoch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBLOCK"><span class="hs-identifier hs-type">DBLOCK</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#Epoch"><span class="hs-identifier hs-type">Epoch</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#Epoch"><span class="hs-identifier hs-type">Epoch</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-367"></span><span>    </span><span id="local-6989586621679190309"><span class="annot"><span class="annottext">epochDelegationEpoch :: Trace DBLOCK -&gt; [(Epoch, Epoch)]
</span><a href="#local-6989586621679190309"><span class="hs-identifier hs-var hs-var">epochDelegationEpoch</span></a></span></span><span> </span><span id="local-6989586621679190313"><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190313"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-368"></span><span>      </span><span class="annot"><span class="annottext">forall s. TraceOrder -&gt; Trace s -&gt; [(State s, Signal s)]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#preStatesAndSignals"><span class="hs-identifier hs-var">preStatesAndSignals</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBLOCK"><span class="hs-identifier hs-type">DBLOCK</span></a></span><span> </span><span class="annot"><span class="annottext">TraceOrder
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#OldestFirst"><span class="hs-identifier hs-var">OldestFirst</span></a></span><span> </span><span class="annot"><span class="annottext">Trace DBLOCK
</span><a href="#local-6989586621679190313"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-369"></span><span>        </span><span class="annot"><span class="annottext">[((DIEnv, DIState), DBlock)]
-&gt; ([((DIEnv, DIState), DBlock)] -&gt; [(Epoch, [Epoch])])
-&gt; [(Epoch, [Epoch])]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(((DIEnv, DIState), DBlock) -&gt; (Epoch, [Epoch]))
-&gt; [((DIEnv, DIState), DBlock)] -&gt; [(Epoch, [Epoch])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DIEnv -&gt; Epoch
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#_dSEnvEpoch"><span class="hs-identifier hs-var">_dSEnvEpoch</span></a></span><span> </span><span class="annot"><span class="annottext">(DIEnv -&gt; Epoch)
-&gt; ((DIEnv, DIState) -&gt; DIEnv) -&gt; (DIEnv, DIState) -&gt; Epoch
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DIEnv, DIState) -&gt; DIEnv
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((DIEnv, DIState) -&gt; Epoch)
-&gt; (DBlock -&gt; [Epoch])
-&gt; ((DIEnv, DIState), DBlock)
-&gt; (Epoch, [Epoch])
forall b c b' c'. (b -&gt; c) -&gt; (b' -&gt; c') -&gt; (b, b') -&gt; (c, c')
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><span class="hs-operator hs-var">***</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DCert -&gt; Epoch) -&gt; [DCert] -&gt; [Epoch]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DCert -&gt; Epoch
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#depoch"><span class="hs-identifier hs-var">depoch</span></a></span><span> </span><span class="annot"><span class="annottext">([DCert] -&gt; [Epoch]) -&gt; (DBlock -&gt; [DCert]) -&gt; DBlock -&gt; [Epoch]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DBlock -&gt; [DCert]
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#_blockCerts"><span class="hs-identifier hs-var">_blockCerts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>        </span><span class="annot"><span class="annottext">[(Epoch, [Epoch])]
-&gt; ([(Epoch, [Epoch])] -&gt; [[(Epoch, Epoch)]]) -&gt; [[(Epoch, Epoch)]]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">((Epoch, [Epoch]) -&gt; [(Epoch, Epoch)])
-&gt; [(Epoch, [Epoch])] -&gt; [[(Epoch, Epoch)]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679190316"><span class="annot"><span class="annottext">Epoch
</span><a href="#local-6989586621679190316"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679190317"><span class="annot"><span class="annottext">[Epoch]
</span><a href="#local-6989586621679190317"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Epoch] -&gt; [Epoch] -&gt; [(Epoch, Epoch)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Epoch -&gt; [Epoch]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">Epoch
</span><a href="#local-6989586621679190316"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Epoch]
</span><a href="#local-6989586621679190317"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>        </span><span class="annot"><span class="annottext">[[(Epoch, Epoch)]]
-&gt; ([[(Epoch, Epoch)]] -&gt; [(Epoch, Epoch)]) -&gt; [(Epoch, Epoch)]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">[[(Epoch, Epoch)]] -&gt; [(Epoch, Epoch)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#onlyValidSignalsAreGenerated"><span class="hs-identifier hs-type">onlyValidSignalsAreGenerated</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-374"></span><span id="onlyValidSignalsAreGenerated"><span class="annot"><span class="annottext">onlyValidSignalsAreGenerated :: Property
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#onlyValidSignalsAreGenerated"><span class="hs-identifier hs-var hs-var">onlyValidSignalsAreGenerated</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-375"></span><span>  </span><span class="annot"><span class="annottext">TestLimit -&gt; Property -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#withTests"><span class="hs-identifier hs-var">withTests</span></a></span><span> </span><span class="annot"><span class="annottext">TestLimit
</span><span class="hs-number">300</span></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s.
(HasTrace s, Show (Environment s), Show (State s), Show (Signal s),
 HasCallStack) =&gt;
BaseEnv s -&gt; Word64 -&gt; Property
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#onlyValidSignalsAreGenerated"><span class="hs-identifier hs-var">Transition.Generator.onlyValidSignalsAreGenerated</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#DBLOCK"><span class="hs-identifier hs-type">DBLOCK</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">100</span></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- Properties related to the transition rules</span><span>
</span><span id="line-379"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">-- | Reject delegation certificates where a genesis key tries to delegate in</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- the same slot.</span><span>
</span><span id="line-383"></span><span class="hs-comment">--</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- This property tries to generate a trace where the last state contains a</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- non-empty sequence of scheduled delegations. If such trace cannot be</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- generated, then the test will fail when the heap limit is reached, or</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- hedgehog gives up.</span><span>
</span><span id="line-388"></span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#rejectDupSchedDelegs"><span class="hs-identifier hs-type">rejectDupSchedDelegs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-389"></span><span id="rejectDupSchedDelegs"><span class="annot"><span class="annottext">rejectDupSchedDelegs :: Property
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#rejectDupSchedDelegs"><span class="hs-identifier hs-var hs-var">rejectDupSchedDelegs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestLimit -&gt; Property -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#withTests"><span class="hs-identifier hs-var">withTests</span></a></span><span> </span><span class="annot"><span class="annottext">TestLimit
</span><span class="hs-number">300</span></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-390"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679190320"><span class="annot"><span class="annottext">Trace DELEG
</span><a href="#local-6989586621679190320"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679190321"><span class="annot"><span class="annottext">DCert
</span><a href="#local-6989586621679190321"><span class="hs-identifier hs-var">dcert</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Trace DELEG, DCert) -&gt; PropertyT IO (Trace DELEG, DCert)
forall (m :: * -&gt; *) a.
(Monad m, Show a, HasCallStack) =&gt;
Gen a -&gt; PropertyT m a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen (Trace DELEG, DCert) -&gt; PropertyT IO (Trace DELEG, DCert))
-&gt; Gen (Trace DELEG, DCert) -&gt; PropertyT IO (Trace DELEG, DCert)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-392"></span><span>      </span><span id="local-6989586621679190322"><span class="annot"><span class="annottext">Trace DELEG
</span><a href="#local-6989586621679190322"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-393"></span><span>        </span><span class="annot"><span class="annottext">forall s. HasTrace s =&gt; BaseEnv s -&gt; Word64 -&gt; Gen (Trace s)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#trace"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DELEG"><span class="hs-identifier hs-type">DELEG</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">100</span></span><span>
</span><span id="line-394"></span><span>          </span><span class="annot"><span class="annottext">Gen (Trace DELEG) -&gt; (State DELEG -&gt; Bool) -&gt; Gen (Trace DELEG)
forall s. Gen (Trace s) -&gt; (State s -&gt; Bool) -&gt; Gen (Trace s)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#suchThatLastState"><span class="hs-operator hs-var">`suchThatLastState`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (DIState -&gt; Bool) -&gt; DIState -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Slot, (VKeyGenesis, VKey))] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([(Slot, (VKeyGenesis, VKey))] -&gt; Bool)
-&gt; (DIState -&gt; [(Slot, (VKeyGenesis, VKey))]) -&gt; DIState -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  [(Slot, (VKeyGenesis, VKey))] DIState [(Slot, (VKeyGenesis, VKey))]
-&gt; DIState -&gt; [(Slot, (VKeyGenesis, VKey))]
forall a s. Getting a s a -&gt; s -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.Extras.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  [(Slot, (VKeyGenesis, VKey))] DIState [(Slot, (VKeyGenesis, VKey))]
forall s a. HasScheduledDelegations s a =&gt; Lens' s a
Lens' DIState [(Slot, (VKeyGenesis, VKey))]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#scheduledDelegations"><span class="hs-identifier hs-var">scheduledDelegations</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679190324"><span class="annot"><span class="annottext">vkS :: VKeyGenesis
</span><a href="#local-6989586621679190324"><span class="hs-identifier hs-var hs-var">vkS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-396"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Trace DELEG -&gt; State DELEG
forall s. Trace s -&gt; State s
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#lastState"><span class="hs-identifier hs-var">lastState</span></a></span><span> </span><span class="annot"><span class="annottext">Trace DELEG
</span><a href="#local-6989586621679190322"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">DIState
-&gt; Getting
     [(Slot, (VKeyGenesis, VKey))] DIState [(Slot, (VKeyGenesis, VKey))]
-&gt; [(Slot, (VKeyGenesis, VKey))]
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  [(Slot, (VKeyGenesis, VKey))] DIState [(Slot, (VKeyGenesis, VKey))]
forall s a. HasScheduledDelegations s a =&gt; Lens' s a
Lens' DIState [(Slot, (VKeyGenesis, VKey))]
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#scheduledDelegations"><span class="hs-identifier hs-var">scheduledDelegations</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-397"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679190325"><span class="annot"><span class="annottext">VKeyGenesis
</span><a href="#local-6989586621679190325"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VKey
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[(Slot, (VKeyGenesis, VKey))]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VKeyGenesis
</span><a href="#local-6989586621679190325"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-398"></span><span>              </span><span class="annot"><span class="annottext">[(Slot, (VKeyGenesis, VKey))]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-399"></span><span>                </span><span class="annot"><span class="annottext">[Char] -&gt; VKeyGenesis
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; VKeyGenesis) -&gt; [Char] -&gt; VKeyGenesis
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-400"></span><span>                  </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;This should not happen: &quot;</span></span><span>
</span><span id="line-401"></span><span>                    </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tr is guaranteed to contain a non-empty sequence of scheduled delegations&quot;</span></span><span>
</span><span id="line-402"></span><span>      </span><span id="local-6989586621679190327"><span class="annot"><span class="annottext">VKey
</span><a href="#local-6989586621679190327"><span class="hs-identifier hs-var">vkD</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen VKey
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.Generators.html#vkGen"><span class="hs-identifier hs-var">vkGen</span></a></span><span>
</span><span id="line-403"></span><span>      </span><span id="local-6989586621679190328"><span class="annot"><span class="annottext">Epoch
</span><a href="#local-6989586621679190328"><span class="hs-identifier hs-var">epo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Epoch
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#Epoch"><span class="hs-identifier hs-var">Epoch</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Epoch) -&gt; GenT Identity Word64 -&gt; GenT Identity Epoch
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Range Word64 -&gt; GenT Identity Word64
forall (m :: * -&gt; *) a. (MonadGen m, Integral a) =&gt; Range a -&gt; m a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Gen.html#integral"><span class="hs-identifier hs-var">Gen.integral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Range Word64
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Range.html#linear"><span class="hs-identifier hs-var">Range.linear</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679190329"><span class="annot"><span class="annottext">dcert :: DCert
</span><a href="#local-6989586621679190329"><span class="hs-identifier hs-var hs-var">dcert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VKeyGenesis -&gt; Sig (VKey, Epoch) -&gt; VKey -&gt; Epoch -&gt; DCert
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#mkDCert"><span class="hs-identifier hs-var">mkDCert</span></a></span><span> </span><span class="annot"><span class="annottext">VKeyGenesis
</span><a href="#local-6989586621679190324"><span class="hs-identifier hs-var">vkS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VKey, Epoch) -&gt; Owner -&gt; Sig (VKey, Epoch)
forall a. a -&gt; Owner -&gt; Sig a
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#Sig"><span class="hs-identifier hs-var">Sig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VKey
</span><a href="#local-6989586621679190327"><span class="hs-identifier hs-var">vkD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Epoch
</span><a href="#local-6989586621679190328"><span class="hs-identifier hs-var">epo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VKeyGenesis -&gt; Owner
forall a. HasOwner a =&gt; a -&gt; Owner
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Core.html#owner"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">VKeyGenesis
</span><a href="#local-6989586621679190324"><span class="hs-identifier hs-var">vkS</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VKey
</span><a href="#local-6989586621679190327"><span class="hs-identifier hs-var">vkD</span></a></span><span> </span><span class="annot"><span class="annottext">Epoch
</span><a href="#local-6989586621679190328"><span class="hs-identifier hs-var">epo</span></a></span><span>
</span><span id="line-405"></span><span>      </span><span class="annot"><span class="annottext">(Trace DELEG, DCert) -&gt; Gen (Trace DELEG, DCert)
forall a. a -&gt; GenT Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace DELEG
</span><a href="#local-6989586621679190322"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DCert
</span><a href="#local-6989586621679190329"><span class="hs-identifier hs-var">dcert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679190331"><span class="annot"><span class="annottext">pfs :: [DelegPredicateFailure]
</span><a href="#local-6989586621679190331"><span class="hs-identifier hs-var hs-var">pfs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall s (rtype :: RuleType).
(STS s, RuleTypeRep rtype, BaseM s ~ Identity) =&gt;
RuleContext rtype s
-&gt; Either (NonEmpty (PredicateFailure s)) (State s)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Simple.html#applySTS"><span class="hs-identifier hs-var">applySTS</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DELEG"><span class="hs-identifier hs-type">DELEG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Environment DELEG, State DELEG, Signal DELEG) -&gt; TRC DELEG
forall sts. (Environment sts, State sts, Signal sts) -&gt; TRC sts
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/doc/html/small-steps/src/Control.State.Transition.Extended.html#TRC"><span class="hs-identifier hs-var">TRC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace DELEG
</span><a href="#local-6989586621679190320"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Trace DELEG -&gt; Getting DIEnv (Trace DELEG) DIEnv -&gt; DIEnv
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/microlens-0.4.13.1-71c999e1e9d35dc39dc696ab4bf56f0958d34c6f1e240362775e227e5e550787/share/doc/html/src/Lens.Micro.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting DIEnv (Trace DELEG) DIEnv
(Environment DELEG -&gt; Const DIEnv (Environment DELEG))
-&gt; Trace DELEG -&gt; Const DIEnv (Trace DELEG)
forall s (f :: * -&gt; *).
Functor f =&gt;
(Environment s -&gt; f (Environment s)) -&gt; Trace s -&gt; f (Trace s)
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#traceEnv"><span class="hs-identifier hs-var">traceEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Trace DELEG -&gt; State DELEG
forall s. Trace s -&gt; State s
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Trace.html#lastState"><span class="hs-identifier hs-var">lastState</span></a></span><span> </span><span class="annot"><span class="annottext">Trace DELEG
</span><a href="#local-6989586621679190320"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DCert
</span><a href="#local-6989586621679190321"><span class="hs-identifier hs-var">dcert</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-407"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679190332"><span class="annot"><span class="annottext">NonEmpty (PredicateFailure DELEG)
</span><a href="#local-6989586621679190332"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NonEmpty DelegPredicateFailure -&gt; [DelegPredicateFailure]
forall a. NonEmpty a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (PredicateFailure DELEG)
NonEmpty DelegPredicateFailure
</span><a href="#local-6989586621679190332"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-408"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">State DELEG
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-409"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; PropertyT IO ()
forall (m :: * -&gt; *). (MonadTest m, HasCallStack) =&gt; Bool -&gt; m ()
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; PropertyT IO ()) -&gt; Bool -&gt; PropertyT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PredicateFailure SDELEGS -&gt; DelegPredicateFailure
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#SDelegSFailure"><span class="hs-identifier hs-var">SDelegSFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PredicateFailure SDELEG -&gt; SdelegsPredicateFailure
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#SDelegFailure"><span class="hs-identifier hs-var">SDelegFailure</span></a></span><span> </span><span class="annot"><span class="annottext">PredicateFailure SDELEG
SdelegPredicateFailure
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#IsAlreadyScheduled"><span class="hs-identifier hs-var">IsAlreadyScheduled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DelegPredicateFailure -&gt; [DelegPredicateFailure] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[DelegPredicateFailure]
</span><a href="#local-6989586621679190331"><span class="hs-identifier hs-var">pfs</span></a></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="annot"><span class="hs-comment">-- | Classify the traces.</span></span><span>
</span><span id="line-412"></span><span class="annot"><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#tracesAreClassified"><span class="hs-identifier hs-type">tracesAreClassified</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.6.7/hedgehog-1.7-491273c491675cc21dc684e9f0d432f387f0f4ec3482f7b96db864fe9e6aa6fd/share/doc/html/src/Hedgehog.Internal.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-413"></span><span id="tracesAreClassified"><span class="annot"><span class="annottext">tracesAreClassified :: Property
</span><a href="Test.Byron.Spec.Ledger.Delegation.Properties.html#tracesAreClassified"><span class="hs-identifier hs-var hs-var">tracesAreClassified</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s.
(HasTrace s, Show (Environment s), Show (State s),
 Show (Signal s)) =&gt;
BaseEnv s -&gt; Word64 -&gt; Word64 -&gt; Property
</span><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/small-steps-1.1.2.0/l/testlib/doc/html/small-steps/src/Test.Control.State.Transition.Generator.html#traceLengthsAreClassified"><span class="hs-identifier hs-var">traceLengthsAreClassified</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/runner/work/cardano-ledger/cardano-ledger/dist-newstyle/build/x86_64-linux/ghc-9.6.7/byron-spec-ledger-1.1.0.1/doc/html/byron-spec-ledger/src/Byron.Spec.Ledger.Delegation.html#DELEG"><span class="hs-identifier hs-type">DELEG</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1000</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">100</span></span><span>
</span><span id="line-414"></span></pre></body></html>